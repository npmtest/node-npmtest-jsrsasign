<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-jsrsasign/node_modules/jsrsasign/lib/jsrsasign.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-jsrsasign">npmtest-jsrsasign (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-jsrsasign/node_modules/jsrsasign/lib/jsrsasign.js</span></h1>
    <h2>
        
        Statements: <span class="metric">13.58% <small>(1221 / 8993)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">4.95% <small>(185 / 3739)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">6.39% <small>(67 / 1048)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">87.22% <small>(116 / 133)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-jsrsasign/node_modules/jsrsasign/lib/</a> &#187; jsrsasign.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">79</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">199</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">160</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">3</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">256</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">64</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1118</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">160</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">80</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3430</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">128</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">40</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">50</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">&nbsp;
var navigator = {};
navigator.userAgent = false;
&nbsp;
var window = {};
/*
 * jsrsasign(all) 7.1.3 (2017-04-16) (c) 2010-2017 Kenji Urushima | kjur.github.com/jsrsasign/license
 */
&nbsp;
/*
yahoo-min.js
Copyright (c) 2011, Yahoo! Inc. All rights reserved.
Code licensed under the BSD License:
http://developer.yahoo.com/yui/license.html
version: 2.9.0
*/
<span class="missing-if-branch" title="else path not taken" >E</span>if(typeof YAHOO=="undefined"||<span class="branch-1 cbranch-no" title="branch not covered" >!YAHOO)</span>{var YAHOO={};}YAHOO.namespace=function(){var b=arguments,g=null,e,c,f;for(e=0;e&lt;b.length;e=e+1){f=(""+b[e]).split(".");g=YAHOO;for(c=(f[0]=="YAHOO")?1:0;c&lt;f.length;c=c+1){g[f[c]]=g[f[c]]||{};g=g[f[c]];}}return g;};YAHOO.log=<span class="fstat-no" title="function not covered" >function(d,a,c){<span class="cstat-no" title="statement not covered" ></span>var b=YAHOO.widget.Logger;<span class="cstat-no" title="statement not covered" >i</span>f(b&amp;&amp;b.log){<span class="cstat-no" title="statement not covered" >return b.log(d,a,c);}</span>else{<span class="cstat-no" title="statement not covered" >return false;}</span>}</span>;YAHOO.register=function(a,f,e){var k=YAHOO.env.modules,c,j,h,g,d;<span class="missing-if-branch" title="else path not taken" >E</span>if(!k[a]){k[a]={versions:[],builds:[]};}c=k[a];j=e.version;h=e.build;g=YAHOO.env.listeners;c.name=a;c.version=j;c.build=h;c.versions.push(j);c.builds.push(h);c.mainClass=f;for(d=0;d&lt;g.length;d=d+1){<span class="cstat-no" title="statement not covered" >g[d](c);}<span class="missing-if-branch" title="else path not taken" >E</span></span>if(f){f.VERSION=j;f.BUILD=h;}else{<span class="cstat-no" title="statement not covered" >YAHOO.log("mainClass is undefined for module "+a,"warn");}</span>};YAHOO.env=YAHOO.env||{modules:[],listeners:[]};YAHOO.env.getVersion=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>return YAHOO.env.modules[a]||null;}</span>;YAHOO.env.parseUA=function(d){var e=<span class="fstat-no" title="function not covered" >function(i){<span class="cstat-no" title="statement not covered" ></span>var j=0;<span class="cstat-no" title="statement not covered" >r</span>eturn parseFloat(i.replace(/\./g,<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>return(j++==1)?"":".";}</span>));}</span>,h=navigator,g={ie:0,opera:0,gecko:0,webkit:0,chrome:0,mobile:null,air:0,ipad:0,iphone:0,ipod:0,ios:null,android:0,webos:0,caja:h&amp;&amp;h.cajaVersion,secure:false,os:null},c=d||(navigator&amp;&amp;navigator.userAgent),f=window&amp;&amp;window.location,b=f&amp;&amp;<span class="branch-1 cbranch-no" title="branch not covered" >f.href,</span>a;g.secure=b&amp;&amp;(<span class="branch-1 cbranch-no" title="branch not covered" >b.toLowerCase().indexOf("https")===0)</span>;<span class="missing-if-branch" title="if path not taken" >I</span>if(c){<span class="cstat-no" title="statement not covered" >if((/windows|win32/i).test(c)){<span class="cstat-no" title="statement not covered" >g.os="windows";}</span>else{<span class="cstat-no" title="statement not covered" >if((/macintosh/i).test(c)){<span class="cstat-no" title="statement not covered" >g.os="macintosh";}</span>else{<span class="cstat-no" title="statement not covered" >if((/rhino/i).test(c)){<span class="cstat-no" title="statement not covered" >g.os="rhino";}</span>}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f((/KHTML/).test(c)){<span class="cstat-no" title="statement not covered" >g.webkit=1;}<span class="cstat-no" title="statement not covered" ></span>a</span>=c.match(/AppleWebKit\/([^\s]*)/);<span class="cstat-no" title="statement not covered" >i</span>f(a&amp;&amp;a[1]){<span class="cstat-no" title="statement not covered" >g.webkit=e(a[1]);<span class="cstat-no" title="statement not covered" >i</span>f(/ Mobile\//.test(c)){<span class="cstat-no" title="statement not covered" >g.mobile="Apple";<span class="cstat-no" title="statement not covered" >a</span>=c.match(/OS ([^\s]*)/);<span class="cstat-no" title="statement not covered" >i</span>f(a&amp;&amp;a[1]){<span class="cstat-no" title="statement not covered" >a=e(a[1].replace("_","."));}<span class="cstat-no" title="statement not covered" ></span>g</span>.ios=a;<span class="cstat-no" title="statement not covered" >g</span>.ipad=g.ipod=g.iphone=0;<span class="cstat-no" title="statement not covered" >a</span>=c.match(/iPad|iPod|iPhone/);<span class="cstat-no" title="statement not covered" >i</span>f(a&amp;&amp;a[0]){<span class="cstat-no" title="statement not covered" >g[a[0].toLowerCase()]=g.ios;}</span>}</span>else{<span class="cstat-no" title="statement not covered" >a=c.match(/NokiaN[^\/]*|Android \d\.\d|webOS\/\d\.\d/);<span class="cstat-no" title="statement not covered" >i</span>f(a){<span class="cstat-no" title="statement not covered" >g.mobile=a[0];}<span class="cstat-no" title="statement not covered" ></span>i</span>f(/webOS/.test(c)){<span class="cstat-no" title="statement not covered" >g.mobile="WebOS";<span class="cstat-no" title="statement not covered" >a</span>=c.match(/webOS\/([^\s]*);/);<span class="cstat-no" title="statement not covered" >i</span>f(a&amp;&amp;a[1]){<span class="cstat-no" title="statement not covered" >g.webos=e(a[1]);}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(/ Android/.test(c)){<span class="cstat-no" title="statement not covered" >g.mobile="Android";<span class="cstat-no" title="statement not covered" >a</span>=c.match(/Android ([^\s]*);/);<span class="cstat-no" title="statement not covered" >i</span>f(a&amp;&amp;a[1]){<span class="cstat-no" title="statement not covered" >g.android=e(a[1]);}</span>}</span>}<span class="cstat-no" title="statement not covered" ></span>a</span>=c.match(/Chrome\/([^\s]*)/);<span class="cstat-no" title="statement not covered" >i</span>f(a&amp;&amp;a[1]){<span class="cstat-no" title="statement not covered" >g.chrome=e(a[1]);}</span>else{<span class="cstat-no" title="statement not covered" >a=c.match(/AdobeAIR\/([^\s]*)/);<span class="cstat-no" title="statement not covered" >i</span>f(a){<span class="cstat-no" title="statement not covered" >g.air=a[0];}</span>}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(!g.webkit){<span class="cstat-no" title="statement not covered" >a=c.match(/Opera[\s\/]([^\s]*)/);<span class="cstat-no" title="statement not covered" >i</span>f(a&amp;&amp;a[1]){<span class="cstat-no" title="statement not covered" >g.opera=e(a[1]);<span class="cstat-no" title="statement not covered" >a</span>=c.match(/Version\/([^\s]*)/);<span class="cstat-no" title="statement not covered" >i</span>f(a&amp;&amp;a[1]){<span class="cstat-no" title="statement not covered" >g.opera=e(a[1]);}<span class="cstat-no" title="statement not covered" ></span>a</span>=c.match(/Opera Mini[^;]*/);<span class="cstat-no" title="statement not covered" >i</span>f(a){<span class="cstat-no" title="statement not covered" >g.mobile=a[0];}</span>}</span>else{<span class="cstat-no" title="statement not covered" >a=c.match(/MSIE\s([^;]*)/);<span class="cstat-no" title="statement not covered" >i</span>f(a&amp;&amp;a[1]){<span class="cstat-no" title="statement not covered" >g.ie=e(a[1]);}</span>else{<span class="cstat-no" title="statement not covered" >a=c.match(/Gecko\/([^\s]*)/);<span class="cstat-no" title="statement not covered" >i</span>f(a){<span class="cstat-no" title="statement not covered" >g.gecko=1;<span class="cstat-no" title="statement not covered" >a</span>=c.match(/rv:([^\s\)]*)/);<span class="cstat-no" title="statement not covered" >i</span>f(a&amp;&amp;a[1]){<span class="cstat-no" title="statement not covered" >g.gecko=e(a[1]);}</span>}</span>}</span>}</span>}</span>}</span>return g;};YAHOO.env.ua=YAHOO.env.parseUA();(function(){YAHOO.namespace("util","widget","example");<span class="missing-if-branch" title="if path not taken" >I</span>if("undefined"!==typeof YAHOO_config){<span class="cstat-no" title="statement not covered" >var b=YAHOO_config.listener,a=YAHOO.env.listeners,d=true,c;<span class="cstat-no" title="statement not covered" >i</span>f(b){<span class="cstat-no" title="statement not covered" >for(c=0;c&lt;a.length;c++){<span class="cstat-no" title="statement not covered" >if(a[c]==b){<span class="cstat-no" title="statement not covered" >d=false;<span class="cstat-no" title="statement not covered" >b</span>reak;}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(d){<span class="cstat-no" title="statement not covered" >a.push(b);}</span>}</span>}</span>})();YAHOO.lang=YAHOO.lang||{};(function(){var f=YAHOO.lang,a=Object.prototype,c="[object Array]",h="[object Function]",i="[object Object]",b=[],g={"&amp;":"&amp;amp;","&lt;":"&amp;lt;","&gt;":"&amp;gt;",'"':"&amp;quot;","'":"&amp;#x27;","/":"&amp;#x2F;","`":"&amp;#x60;"},d=["toString","valueOf"],e={isArray:<span class="fstat-no" title="function not covered" >function(j){<span class="cstat-no" title="statement not covered" ></span>return a.toString.apply(j)===c;}</span>,isBoolean:<span class="fstat-no" title="function not covered" >function(j){<span class="cstat-no" title="statement not covered" ></span>return typeof j==="boolean";}</span>,isFunction:<span class="fstat-no" title="function not covered" >function(j){<span class="cstat-no" title="statement not covered" ></span>return(typeof j==="function")||a.toString.apply(j)===h;}</span>,isNull:<span class="fstat-no" title="function not covered" >function(j){<span class="cstat-no" title="statement not covered" ></span>return j===null;}</span>,isNumber:<span class="fstat-no" title="function not covered" >function(j){<span class="cstat-no" title="statement not covered" ></span>return typeof j==="number"&amp;&amp;isFinite(j);}</span>,isObject:<span class="fstat-no" title="function not covered" >function(j){<span class="cstat-no" title="statement not covered" ></span>return(j&amp;&amp;(typeof j==="object"||f.isFunction(j)))||false;}</span>,isString:<span class="fstat-no" title="function not covered" >function(j){<span class="cstat-no" title="statement not covered" ></span>return typeof j==="string";}</span>,isUndefined:<span class="fstat-no" title="function not covered" >function(j){<span class="cstat-no" title="statement not covered" ></span>return typeof j==="undefined";}</span>,_IEEnumFix:(YAHOO.env.ua.ie)?<span class="fstat-no" title="function not covered" ><span class="branch-0 cbranch-no" title="branch not covered" >function(l,k){<span class="cstat-no" title="statement not covered" ></span>var j,n,m;<span class="cstat-no" title="statement not covered" >f</span>or(j=0;j&lt;d.length;j=j+1){<span class="cstat-no" title="statement not covered" >n=d[j];<span class="cstat-no" title="statement not covered" >m</span>=k[n];<span class="cstat-no" title="statement not covered" >i</span>f(f.isFunction(m)&amp;&amp;m!=a[n]){<span class="cstat-no" title="statement not covered" >l[n]=m;}</span>}</span>}</span>:</span>function(){},escapeHTML:<span class="fstat-no" title="function not covered" >function(j){<span class="cstat-no" title="statement not covered" ></span>return j.replace(/[&amp;&lt;&gt;"'\/`]/g,<span class="fstat-no" title="function not covered" >function(k){<span class="cstat-no" title="statement not covered" ></span>return g[k];}</span>);}</span>,extend:function(m,n,l){<span class="missing-if-branch" title="if path not taken" >I</span>if(!n||!m){<span class="cstat-no" title="statement not covered" >throw new Error("extend failed, please check that "+"all dependencies are included.");}</span>var k=function(){},j;k.prototype=n.prototype;m.prototype=new k();m.prototype.constructor=m;m.superclass=n.prototype;<span class="missing-if-branch" title="if path not taken" >I</span>if(n.prototype.constructor==a.constructor){<span class="cstat-no" title="statement not covered" >n.prototype.constructor=n;}<span class="missing-if-branch" title="if path not taken" >I</span></span>if(l){<span class="cstat-no" title="statement not covered" >for(j in l){<span class="cstat-no" title="statement not covered" >if(f.hasOwnProperty(l,j)){<span class="cstat-no" title="statement not covered" >m.prototype[j]=l[j];}</span>}<span class="cstat-no" title="statement not covered" ></span>f</span>._IEEnumFix(m.prototype,l);}</span>},augmentObject:function(n,m){<span class="missing-if-branch" title="if path not taken" >I</span>if(!m||!n){<span class="cstat-no" title="statement not covered" >throw new Error("Absorb failed, verify dependencies.");}</span>var j=arguments,l,o,k=j[2];<span class="missing-if-branch" title="if path not taken" >I</span>if(k&amp;&amp;k!==true){<span class="cstat-no" title="statement not covered" >for(l=2;l&lt;j.length;l=l+1){<span class="cstat-no" title="statement not covered" >n[j[l]]=m[j[l]];}</span>}</span>else{for(o in m){<span class="missing-if-branch" title="else path not taken" >E</span>if(k||<span class="branch-1 cbranch-no" title="branch not covered" >!(o in n))</span>{n[o]=m[o];}}f._IEEnumFix(n,m);}return n;},augmentProto:<span class="fstat-no" title="function not covered" >function(m,l){<span class="cstat-no" title="statement not covered" ></span>if(!l||!m){<span class="cstat-no" title="statement not covered" >throw new Error("Augment failed, verify dependencies.");}<span class="cstat-no" title="statement not covered" ></span>v</span>ar j=[m.prototype,l.prototype],k;<span class="cstat-no" title="statement not covered" >f</span>or(k=2;k&lt;arguments.length;k=k+1){<span class="cstat-no" title="statement not covered" >j.push(arguments[k]);}<span class="cstat-no" title="statement not covered" ></span>f</span>.augmentObject.apply(this,j);<span class="cstat-no" title="statement not covered" >r</span>eturn m;}</span>,dump:<span class="fstat-no" title="function not covered" >function(j,p){<span class="cstat-no" title="statement not covered" ></span>var l,n,r=[],t="{...}",k="f(){...}",q=", ",m=" =&gt; ";<span class="cstat-no" title="statement not covered" >i</span>f(!f.isObject(j)){<span class="cstat-no" title="statement not covered" >return j+"";}</span>else{<span class="cstat-no" title="statement not covered" >if(j instanceof Date||("nodeType" in j&amp;&amp;"tagName" in j)){<span class="cstat-no" title="statement not covered" >return j;}</span>else{<span class="cstat-no" title="statement not covered" >if(f.isFunction(j)){<span class="cstat-no" title="statement not covered" >return k;}</span>}</span>}<span class="cstat-no" title="statement not covered" ></span>p</span>=(f.isNumber(p))?p:3;<span class="cstat-no" title="statement not covered" >i</span>f(f.isArray(j)){<span class="cstat-no" title="statement not covered" >r.push("[");<span class="cstat-no" title="statement not covered" >f</span>or(l=0,n=j.length;l&lt;n;l=l+1){<span class="cstat-no" title="statement not covered" >if(f.isObject(j[l])){<span class="cstat-no" title="statement not covered" >r.push((p&gt;0)?f.dump(j[l],p-1):t);}</span>else{<span class="cstat-no" title="statement not covered" >r.push(j[l]);}<span class="cstat-no" title="statement not covered" ></span>r</span>.push(q);}<span class="cstat-no" title="statement not covered" ></span>i</span>f(r.length&gt;1){<span class="cstat-no" title="statement not covered" >r.pop();}<span class="cstat-no" title="statement not covered" ></span>r</span>.push("]");}</span>else{<span class="cstat-no" title="statement not covered" >r.push("{");<span class="cstat-no" title="statement not covered" >f</span>or(l in j){<span class="cstat-no" title="statement not covered" >if(f.hasOwnProperty(j,l)){<span class="cstat-no" title="statement not covered" >r.push(l+m);<span class="cstat-no" title="statement not covered" >i</span>f(f.isObject(j[l])){<span class="cstat-no" title="statement not covered" >r.push((p&gt;0)?f.dump(j[l],p-1):t);}</span>else{<span class="cstat-no" title="statement not covered" >r.push(j[l]);}<span class="cstat-no" title="statement not covered" ></span>r</span>.push(q);}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(r.length&gt;1){<span class="cstat-no" title="statement not covered" >r.pop();}<span class="cstat-no" title="statement not covered" ></span>r</span>.push("}");}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn r.join("");}</span>,substitute:<span class="fstat-no" title="function not covered" >function(x,y,E,l){<span class="cstat-no" title="statement not covered" ></span>var D,C,B,G,t,u,F=[],p,z=x.length,A="dump",r=" ",q="{",m="}",n,w;<span class="cstat-no" title="statement not covered" >f</span>or(;;){<span class="cstat-no" title="statement not covered" >D=x.lastIndexOf(q,z);<span class="cstat-no" title="statement not covered" >i</span>f(D&lt;0){<span class="cstat-no" title="statement not covered" >break;}<span class="cstat-no" title="statement not covered" ></span>C</span>=x.indexOf(m,D);<span class="cstat-no" title="statement not covered" >i</span>f(D+1&gt;C){<span class="cstat-no" title="statement not covered" >break;}<span class="cstat-no" title="statement not covered" ></span>p</span>=x.substring(D+1,C);<span class="cstat-no" title="statement not covered" >G</span>=p;<span class="cstat-no" title="statement not covered" >u</span>=null;<span class="cstat-no" title="statement not covered" >B</span>=G.indexOf(r);<span class="cstat-no" title="statement not covered" >i</span>f(B&gt;-1){<span class="cstat-no" title="statement not covered" >u=G.substring(B+1);<span class="cstat-no" title="statement not covered" >G</span>=G.substring(0,B);}<span class="cstat-no" title="statement not covered" ></span>t</span>=y[G];<span class="cstat-no" title="statement not covered" >i</span>f(E){<span class="cstat-no" title="statement not covered" >t=E(G,t,u);}<span class="cstat-no" title="statement not covered" ></span>i</span>f(f.isObject(t)){<span class="cstat-no" title="statement not covered" >if(f.isArray(t)){<span class="cstat-no" title="statement not covered" >t=f.dump(t,parseInt(u,10));}</span>else{<span class="cstat-no" title="statement not covered" >u=u||"";<span class="cstat-no" title="statement not covered" >n</span>=u.indexOf(A);<span class="cstat-no" title="statement not covered" >i</span>f(n&gt;-1){<span class="cstat-no" title="statement not covered" >u=u.substring(4);}<span class="cstat-no" title="statement not covered" ></span>w</span>=t.toString();<span class="cstat-no" title="statement not covered" >i</span>f(w===i||n&gt;-1){<span class="cstat-no" title="statement not covered" >t=f.dump(t,parseInt(u,10));}</span>else{<span class="cstat-no" title="statement not covered" >t=w;}</span>}</span>}</span>else{<span class="cstat-no" title="statement not covered" >if(!f.isString(t)&amp;&amp;!f.isNumber(t)){<span class="cstat-no" title="statement not covered" >t="~-"+F.length+"-~";<span class="cstat-no" title="statement not covered" >F</span>[F.length]=p;}</span>}<span class="cstat-no" title="statement not covered" ></span>x</span>=x.substring(0,D)+t+x.substring(C+1);<span class="cstat-no" title="statement not covered" >i</span>f(l===false){<span class="cstat-no" title="statement not covered" >z=D-1;}</span>}<span class="cstat-no" title="statement not covered" ></span>f</span>or(D=F.length-1;D&gt;=0;D=D-1){<span class="cstat-no" title="statement not covered" >x=x.replace(new RegExp("~-"+D+"-~"),"{"+F[D]+"}","g");}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn x;}</span>,trim:<span class="fstat-no" title="function not covered" >function(j){<span class="cstat-no" title="statement not covered" ></span>try{<span class="cstat-no" title="statement not covered" >return j.replace(/^\s+|\s+$/g,"");}</span>catch(k){<span class="cstat-no" title="statement not covered" >return j;</span></span>
}},merge:<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var n={},k=arguments,j=k.length,m;<span class="cstat-no" title="statement not covered" >f</span>or(m=0;m&lt;j;m=m+1){<span class="cstat-no" title="statement not covered" >f.augmentObject(n,k[m],true);}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn n;}</span>,later:<span class="fstat-no" title="function not covered" >function(t,k,u,n,p){<span class="cstat-no" title="statement not covered" ></span>t=t||0;<span class="cstat-no" title="statement not covered" >k</span>=k||{};<span class="cstat-no" title="statement not covered" >v</span>ar l=u,s=n,q,j;<span class="cstat-no" title="statement not covered" >i</span>f(f.isString(u)){<span class="cstat-no" title="statement not covered" >l=k[u];}<span class="cstat-no" title="statement not covered" ></span>i</span>f(!l){<span class="cstat-no" title="statement not covered" >throw new TypeError("method undefined");}<span class="cstat-no" title="statement not covered" ></span>i</span>f(!f.isUndefined(n)&amp;&amp;!f.isArray(s)){<span class="cstat-no" title="statement not covered" >s=[n];}<span class="cstat-no" title="statement not covered" ></span>q</span>=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>l.apply(k,s||b);}</span>;<span class="cstat-no" title="statement not covered" >j</span>=(p)?setInterval(q,t):setTimeout(q,t);<span class="cstat-no" title="statement not covered" >r</span>eturn{interval:p,cancel:<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>if(this.interval){<span class="cstat-no" title="statement not covered" >clearInterval(j);}</span>else{<span class="cstat-no" title="statement not covered" >clearTimeout(j);}</span>}</span>};}</span>,isValue:<span class="fstat-no" title="function not covered" >function(j){<span class="cstat-no" title="statement not covered" ></span>return(f.isObject(j)||f.isString(j)||f.isNumber(j)||f.isBoolean(j));}</span>};f.hasOwnProperty=(a.hasOwnProperty)?<span class="fstat-no" title="function not covered" >function(j,k){<span class="cstat-no" title="statement not covered" ></span>return j&amp;&amp;j.hasOwnProperty&amp;&amp;j.hasOwnProperty(k);}</span>:<span class="fstat-no" title="function not covered" ><span class="branch-1 cbranch-no" title="branch not covered" >function(j,k){<span class="cstat-no" title="statement not covered" ></span>return !f.isUndefined(j[k])&amp;&amp;j.constructor.prototype[k]!==j[k];}</span>;</span>e.augmentObject(f,e,true);YAHOO.util.Lang=f;f.augment=f.augmentProto;YAHOO.augment=f.augmentProto;YAHOO.extend=f.extend;})();YAHOO.register("yahoo",YAHOO,{version:"2.9.0",build:"2800"});
&nbsp;
/*! CryptoJS v3.1.2 core-fix.js
 * code.google.com/p/crypto-js
 * (c) 2009-2013 by Jeff Mott. All rights reserved.
 * code.google.com/p/crypto-js/wiki/License
 * THIS IS FIX of 'core.js' to fix Hmac issue.
 * https://code.google.com/p/crypto-js/issues/detail?id=84
 * https://crypto-js.googlecode.com/svn-history/r667/branches/3.x/src/core.js
 */
var CryptoJS=CryptoJS||(function(e,g){var a={};var b=a.lib={};var j=b.Base=(function(){function n(){}return{extend:function(p){n.prototype=this;var o=new n();if(p){o.mixIn(p)}if(!o.hasOwnProperty("init")){o.init=function(){o.$super.init.apply(this,arguments)}}o.init.prototype=o;o.$super=this;return o},create:function(){var o=this.extend();o.init.apply(o,arguments);return o},init:<span class="fstat-no" title="function not covered" >function(){</span>},mixIn:function(p){for(var o in p){<span class="missing-if-branch" title="else path not taken" >E</span>if(p.hasOwnProperty(o)){this[o]=p[o]}}if(p.hasOwnProperty("toString")){this.toString=p.toString}},clone:<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>return this.init.prototype.extend(this)}</span>}}());var l=b.WordArray=j.extend({init:function(o,n){o=this.words=o||<span class="branch-1 cbranch-no" title="branch not covered" >[];<span class="missing-if-branch" title="if path not taken" >I</span></span>if(n!=g){<span class="cstat-no" title="statement not covered" >this.sigBytes=n}</span>else{this.sigBytes=o.length*4}},toString:<span class="fstat-no" title="function not covered" >function(n){<span class="cstat-no" title="statement not covered" ></span>return(n||h).stringify(this)}</span>,concat:<span class="fstat-no" title="function not covered" >function(t){<span class="cstat-no" title="statement not covered" ></span>var q=this.words;<span class="cstat-no" title="statement not covered" >v</span>ar p=t.words;<span class="cstat-no" title="statement not covered" >v</span>ar n=this.sigBytes;<span class="cstat-no" title="statement not covered" >v</span>ar s=t.sigBytes;<span class="cstat-no" title="statement not covered" >t</span>his.clamp();<span class="cstat-no" title="statement not covered" >i</span>f(n%4){<span class="cstat-no" title="statement not covered" >for(var r=0;r&lt;s;r++){<span class="cstat-no" title="statement not covered" >var o=(p[r&gt;&gt;&gt;2]&gt;&gt;&gt;(24-(r%4)*8))&amp;255;<span class="cstat-no" title="statement not covered" >q</span>[(n+r)&gt;&gt;&gt;2]|=o&lt;&lt;(24-((n+r)%4)*8)}</span>}</span>else{<span class="cstat-no" title="statement not covered" >for(var r=0;r&lt;s;r+=4){<span class="cstat-no" title="statement not covered" >q[(n+r)&gt;&gt;&gt;2]=p[r&gt;&gt;&gt;2]}</span>}<span class="cstat-no" title="statement not covered" ></span>t</span>his.sigBytes+=s;<span class="cstat-no" title="statement not covered" >r</span>eturn this}</span>,clamp:<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var o=this.words;<span class="cstat-no" title="statement not covered" >v</span>ar n=this.sigBytes;<span class="cstat-no" title="statement not covered" >o</span>[n&gt;&gt;&gt;2]&amp;=4294967295&lt;&lt;(32-(n%4)*8);<span class="cstat-no" title="statement not covered" >o</span>.length=e.ceil(n/4)}</span>,clone:<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var n=j.clone.call(this);<span class="cstat-no" title="statement not covered" >n</span>.words=this.words.slice(0);<span class="cstat-no" title="statement not covered" >r</span>eturn n}</span>,random:<span class="fstat-no" title="function not covered" >function(p){<span class="cstat-no" title="statement not covered" ></span>var o=[];<span class="cstat-no" title="statement not covered" >f</span>or(var n=0;n&lt;p;n+=4){<span class="cstat-no" title="statement not covered" >o.push((e.random()*4294967296)|0)}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn new l.init(o,p)}</span>});var m=a.enc={};var h=m.Hex={stringify:<span class="fstat-no" title="function not covered" >function(p){<span class="cstat-no" title="statement not covered" ></span>var r=p.words;<span class="cstat-no" title="statement not covered" >v</span>ar o=p.sigBytes;<span class="cstat-no" title="statement not covered" >v</span>ar q=[];<span class="cstat-no" title="statement not covered" >f</span>or(var n=0;n&lt;o;n++){<span class="cstat-no" title="statement not covered" >var s=(r[n&gt;&gt;&gt;2]&gt;&gt;&gt;(24-(n%4)*8))&amp;255;<span class="cstat-no" title="statement not covered" >q</span>.push((s&gt;&gt;&gt;4).toString(16));<span class="cstat-no" title="statement not covered" >q</span>.push((s&amp;15).toString(16))}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn q.join("")}</span>,parse:<span class="fstat-no" title="function not covered" >function(p){<span class="cstat-no" title="statement not covered" ></span>var n=p.length;<span class="cstat-no" title="statement not covered" >v</span>ar q=[];<span class="cstat-no" title="statement not covered" >f</span>or(var o=0;o&lt;n;o+=2){<span class="cstat-no" title="statement not covered" >q[o&gt;&gt;&gt;3]|=parseInt(p.substr(o,2),16)&lt;&lt;(24-(o%8)*4)}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn new l.init(q,n/2)}</span>};var d=m.Latin1={stringify:<span class="fstat-no" title="function not covered" >function(q){<span class="cstat-no" title="statement not covered" ></span>var r=q.words;<span class="cstat-no" title="statement not covered" >v</span>ar p=q.sigBytes;<span class="cstat-no" title="statement not covered" >v</span>ar n=[];<span class="cstat-no" title="statement not covered" >f</span>or(var o=0;o&lt;p;o++){<span class="cstat-no" title="statement not covered" >var s=(r[o&gt;&gt;&gt;2]&gt;&gt;&gt;(24-(o%4)*8))&amp;255;<span class="cstat-no" title="statement not covered" >n</span>.push(String.fromCharCode(s))}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn n.join("")}</span>,parse:<span class="fstat-no" title="function not covered" >function(p){<span class="cstat-no" title="statement not covered" ></span>var n=p.length;<span class="cstat-no" title="statement not covered" >v</span>ar q=[];<span class="cstat-no" title="statement not covered" >f</span>or(var o=0;o&lt;n;o++){<span class="cstat-no" title="statement not covered" >q[o&gt;&gt;&gt;2]|=(p.charCodeAt(o)&amp;255)&lt;&lt;(24-(o%4)*8)}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn new l.init(q,n)}</span>};var c=m.Utf8={stringify:<span class="fstat-no" title="function not covered" >function(n){<span class="cstat-no" title="statement not covered" ></span>try{<span class="cstat-no" title="statement not covered" >return decodeURIComponent(escape(d.stringify(n)))}</span>catch(o){<span class="cstat-no" title="statement not covered" >throw new Error("Malformed UTF-8 data")}</span>}</span>,parse:<span class="fstat-no" title="function not covered" >function(n){<span class="cstat-no" title="statement not covered" ></span>return d.parse(unescape(encodeURIComponent(n)))}</span>};var i=b.BufferedBlockAlgorithm=j.extend({reset:<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>this._data=new l.init();<span class="cstat-no" title="statement not covered" >t</span>his._nDataBytes=0}</span>,_append:<span class="fstat-no" title="function not covered" >function(n){<span class="cstat-no" title="statement not covered" ></span>if(typeof n=="string"){<span class="cstat-no" title="statement not covered" >n=c.parse(n)}<span class="cstat-no" title="statement not covered" ></span>t</span>his._data.concat(n);<span class="cstat-no" title="statement not covered" >t</span>his._nDataBytes+=n.sigBytes}</span>,_process:<span class="fstat-no" title="function not covered" >function(w){<span class="cstat-no" title="statement not covered" ></span>var q=this._data;<span class="cstat-no" title="statement not covered" >v</span>ar x=q.words;<span class="cstat-no" title="statement not covered" >v</span>ar n=q.sigBytes;<span class="cstat-no" title="statement not covered" >v</span>ar t=this.blockSize;<span class="cstat-no" title="statement not covered" >v</span>ar v=t*4;<span class="cstat-no" title="statement not covered" >v</span>ar u=n/v;<span class="cstat-no" title="statement not covered" >i</span>f(w){<span class="cstat-no" title="statement not covered" >u=e.ceil(u)}</span>else{<span class="cstat-no" title="statement not covered" >u=e.max((u|0)-this._minBufferSize,0)}<span class="cstat-no" title="statement not covered" ></span>v</span>ar s=u*t;<span class="cstat-no" title="statement not covered" >v</span>ar r=e.min(s*4,n);<span class="cstat-no" title="statement not covered" >i</span>f(s){<span class="cstat-no" title="statement not covered" >for(var p=0;p&lt;s;p+=t){<span class="cstat-no" title="statement not covered" >this._doProcessBlock(x,p)}<span class="cstat-no" title="statement not covered" ></span>v</span>ar o=x.splice(0,s);<span class="cstat-no" title="statement not covered" >q</span>.sigBytes-=r}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn new l.init(o,r)}</span>,clone:<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var n=j.clone.call(this);<span class="cstat-no" title="statement not covered" >n</span>._data=this._data.clone();<span class="cstat-no" title="statement not covered" >r</span>eturn n}</span>,_minBufferSize:0});var f=b.Hasher=i.extend({cfg:j.extend(),init:<span class="fstat-no" title="function not covered" >function(n){<span class="cstat-no" title="statement not covered" ></span>this.cfg=this.cfg.extend(n);<span class="cstat-no" title="statement not covered" >t</span>his.reset()}</span>,reset:<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>i.reset.call(this);<span class="cstat-no" title="statement not covered" >t</span>his._doReset()}</span>,update:<span class="fstat-no" title="function not covered" >function(n){<span class="cstat-no" title="statement not covered" ></span>this._append(n);<span class="cstat-no" title="statement not covered" >t</span>his._process();<span class="cstat-no" title="statement not covered" >r</span>eturn this}</span>,finalize:<span class="fstat-no" title="function not covered" >function(n){<span class="cstat-no" title="statement not covered" ></span>if(n){<span class="cstat-no" title="statement not covered" >this._append(n)}<span class="cstat-no" title="statement not covered" ></span>v</span>ar o=this._doFinalize();<span class="cstat-no" title="statement not covered" >r</span>eturn o}</span>,blockSize:512/32,_createHelper:function(n){return <span class="fstat-no" title="function not covered" >function(p,o){<span class="cstat-no" title="statement not covered" ></span>return new n.init(o).finalize(p)}</span>},_createHmacHelper:function(n){return <span class="fstat-no" title="function not covered" >function(p,o){<span class="cstat-no" title="statement not covered" ></span>return new k.HMAC.init(n,o).finalize(p)}</span>}});var k=a.algo={};return a}(Math));
/*
CryptoJS v3.1.2 x64-core-min.js
code.google.com/p/crypto-js
(c) 2009-2013 by Jeff Mott. All rights reserved.
code.google.com/p/crypto-js/wiki/License
*/
(function(g){var a=CryptoJS,f=a.lib,e=f.Base,h=f.WordArray,a=a.x64={};a.Word=e.extend({init:function(b,c){this.high=b;this.low=c}});a.WordArray=e.extend({init:<span class="fstat-no" title="function not covered" >function(b,c){<span class="cstat-no" title="statement not covered" ></span>b=this.words=b||[];<span class="cstat-no" title="statement not covered" >t</span>his.sigBytes=c!=g?c:8*b.length}</span>,toX32:<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>for(var b=this.words,c=b.length,a=[],d=0;d&lt;c;d++){<span class="cstat-no" title="statement not covered" >var e=b[d];<span class="cstat-no" title="statement not covered" >a</span>.push(e.high);<span class="cstat-no" title="statement not covered" >a</span>.push(e.low)}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn h.create(a,this.sigBytes)}</span>,clone:<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>for(var b=e.clone.call(this),c=b.words=this.words.slice(0),a=c.length,d=0;d&lt;a;d++)<span class="cstat-no" title="statement not covered" >c[d]=c[d].clone();<span class="cstat-no" title="statement not covered" >r</span></span>eturn b}</span>})})();
&nbsp;
/*
CryptoJS v3.1.2 cipher-core.js
code.google.com/p/crypto-js
(c) 2009-2013 by Jeff Mott. All rights reserved.
code.google.com/p/crypto-js/wiki/License
*/
CryptoJS.lib.Cipher||function(u){var g=CryptoJS,f=g.lib,k=f.Base,l=f.WordArray,q=f.BufferedBlockAlgorithm,r=g.enc.Base64,v=g.algo.EvpKDF,n=f.Cipher=q.extend({cfg:k.extend(),createEncryptor:<span class="fstat-no" title="function not covered" >function(a,b){<span class="cstat-no" title="statement not covered" ></span>return this.create(this._ENC_XFORM_MODE,a,b)}</span>,createDecryptor:<span class="fstat-no" title="function not covered" >function(a,b){<span class="cstat-no" title="statement not covered" ></span>return this.create(this._DEC_XFORM_MODE,a,b)}</span>,init:<span class="fstat-no" title="function not covered" >function(a,b,c){<span class="cstat-no" title="statement not covered" ></span>this.cfg=this.cfg.extend(c);<span class="cstat-no" title="statement not covered" >t</span>his._xformMode=a;<span class="cstat-no" title="statement not covered" >t</span>his._key=b;<span class="cstat-no" title="statement not covered" >t</span>his.reset()}</span>,reset:<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>q.reset.call(this);<span class="cstat-no" title="statement not covered" >t</span>his._doReset()}</span>,process:<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>this._append(a);</span>
<span class="cstat-no" title="statement not covered" >return this._process()}</span>,finalize:<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>a&amp;&amp;this._append(a);<span class="cstat-no" title="statement not covered" >r</span>eturn this._doFinalize()}</span>,keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(a){return{encrypt:<span class="fstat-no" title="function not covered" >function(b,c,d){<span class="cstat-no" title="statement not covered" ></span>return("string"==typeof c?s:j).encrypt(a,b,c,d)}</span>,decrypt:<span class="fstat-no" title="function not covered" >function(b,c,d){<span class="cstat-no" title="statement not covered" ></span>return("string"==typeof c?s:j).decrypt(a,b,c,d)}</span>}}});f.StreamCipher=n.extend({_doFinalize:<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>return this._process(!0)}</span>,blockSize:1});var m=g.mode={},t=<span class="fstat-no" title="function not covered" >function(a,b,c){<span class="cstat-no" title="statement not covered" ></span>var d=this._iv;<span class="cstat-no" title="statement not covered" >d</span>?this._iv=u:d=this._prevBlock;<span class="cstat-no" title="statement not covered" >f</span>or(var e=</span>
0;e&lt;c;e++)<span class="cstat-no" title="statement not covered" >a[b+e]^=d[e]}</span>,h=(f.BlockCipherMode=k.extend({createEncryptor:<span class="fstat-no" title="function not covered" >function(a,b){<span class="cstat-no" title="statement not covered" ></span>return this.Encryptor.create(a,b)}</span>,createDecryptor:<span class="fstat-no" title="function not covered" >function(a,b){<span class="cstat-no" title="statement not covered" ></span>return this.Decryptor.create(a,b)}</span>,init:<span class="fstat-no" title="function not covered" >function(a,b){<span class="cstat-no" title="statement not covered" ></span>this._cipher=a;<span class="cstat-no" title="statement not covered" >t</span>his._iv=b}</span>})).extend();h.Encryptor=h.extend({processBlock:<span class="fstat-no" title="function not covered" >function(a,b){<span class="cstat-no" title="statement not covered" ></span>var c=this._cipher,d=c.blockSize;<span class="cstat-no" title="statement not covered" >t</span>.call(this,a,b,d);<span class="cstat-no" title="statement not covered" >c</span>.encryptBlock(a,b);<span class="cstat-no" title="statement not covered" >t</span>his._prevBlock=a.slice(b,b+d)}</span>});h.Decryptor=h.extend({processBlock:<span class="fstat-no" title="function not covered" >function(a,b){<span class="cstat-no" title="statement not covered" ></span>var c=this._cipher,d=c.blockSize,e=a.slice(b,b+d);<span class="cstat-no" title="statement not covered" >c</span>.decryptBlock(a,</span>
b);<span class="cstat-no" title="statement not covered" >t.call(this,a,b,d);<span class="cstat-no" title="statement not covered" >t</span>his._prevBlock=e}</span>});m=m.CBC=h;h=(g.pad={}).Pkcs7={pad:<span class="fstat-no" title="function not covered" >function(a,b){<span class="cstat-no" title="statement not covered" ></span>for(var c=4*b,c=c-a.sigBytes%c,d=c&lt;&lt;24|c&lt;&lt;16|c&lt;&lt;8|c,e=[],f=0;f&lt;c;f+=4)<span class="cstat-no" title="statement not covered" >e.push(d);<span class="cstat-no" title="statement not covered" >c</span></span>=l.create(e,c);<span class="cstat-no" title="statement not covered" >a</span>.concat(c)}</span>,unpad:<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>a.sigBytes-=a.words[a.sigBytes-1&gt;&gt;&gt;2]&amp;255}</span>};f.BlockCipher=n.extend({cfg:n.cfg.extend({mode:m,padding:h}),reset:<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>n.reset.call(this);<span class="cstat-no" title="statement not covered" >v</span>ar a=this.cfg,b=a.iv,a=a.mode;<span class="cstat-no" title="statement not covered" >i</span>f(this._xformMode==this._ENC_XFORM_MODE)<span class="cstat-no" title="statement not covered" >var c=a.createEncryptor;e</span>lse <span class="cstat-no" title="statement not covered" >c=a.createDecryptor,this._minBufferSize=1;</span></span>
<span class="cstat-no" title="statement not covered" >this._mode=c.call(a,this,b&amp;&amp;b.words)}</span>,_doProcessBlock:<span class="fstat-no" title="function not covered" >function(a,b){<span class="cstat-no" title="statement not covered" ></span>this._mode.processBlock(a,b)}</span>,_doFinalize:<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var a=this.cfg.padding;<span class="cstat-no" title="statement not covered" >i</span>f(this._xformMode==this._ENC_XFORM_MODE){<span class="cstat-no" title="statement not covered" >a.pad(this._data,this.blockSize);<span class="cstat-no" title="statement not covered" >v</span>ar b=this._process(!0)}</span>else <span class="cstat-no" title="statement not covered" >b=this._process(!0),a.unpad(b);<span class="cstat-no" title="statement not covered" >r</span></span>eturn b}</span>,blockSize:4});var p=f.CipherParams=k.extend({init:<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>this.mixIn(a)}</span>,toString:<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>return(a||this.formatter).stringify(this)}</span>}),m=(g.format={}).OpenSSL={stringify:<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>var b=a.ciphertext;<span class="cstat-no" title="statement not covered" >a</span>=a.salt;</span>
<span class="cstat-no" title="statement not covered" >return(a?l.create([1398893684,1701076831]).concat(a).concat(b):b).toString(r)}</span>,parse:<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>a=r.parse(a);<span class="cstat-no" title="statement not covered" >v</span>ar b=a.words;<span class="cstat-no" title="statement not covered" >i</span>f(1398893684==b[0]&amp;&amp;1701076831==b[1]){<span class="cstat-no" title="statement not covered" >var c=l.create(b.slice(2,4));<span class="cstat-no" title="statement not covered" >b</span>.splice(0,4);<span class="cstat-no" title="statement not covered" >a</span>.sigBytes-=16}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn p.create({ciphertext:a,salt:c})}</span>},j=f.SerializableCipher=k.extend({cfg:k.extend({format:m}),encrypt:<span class="fstat-no" title="function not covered" >function(a,b,c,d){<span class="cstat-no" title="statement not covered" ></span>d=this.cfg.extend(d);<span class="cstat-no" title="statement not covered" >v</span>ar e=a.createEncryptor(c,d);<span class="cstat-no" title="statement not covered" >b</span>=e.finalize(b);<span class="cstat-no" title="statement not covered" >e</span>=e.cfg;<span class="cstat-no" title="statement not covered" >r</span>eturn p.create({ciphertext:b,key:c,iv:e.iv,algorithm:a,mode:e.mode,padding:e.padding,</span>
blockSize:a.blockSize,formatter:d.format})},decrypt:<span class="fstat-no" title="function not covered" >function(a,b,c,d){<span class="cstat-no" title="statement not covered" ></span>d=this.cfg.extend(d);<span class="cstat-no" title="statement not covered" >b</span>=this._parse(b,d.format);<span class="cstat-no" title="statement not covered" >r</span>eturn a.createDecryptor(c,d).finalize(b.ciphertext)}</span>,_parse:<span class="fstat-no" title="function not covered" >function(a,b){<span class="cstat-no" title="statement not covered" ></span>return"string"==typeof a?b.parse(a,this):a}</span>}),g=(g.kdf={}).OpenSSL={execute:<span class="fstat-no" title="function not covered" >function(a,b,c,d){<span class="cstat-no" title="statement not covered" ></span>d||(d=l.random(8));<span class="cstat-no" title="statement not covered" >a</span>=v.create({keySize:b+c}).compute(a,d);<span class="cstat-no" title="statement not covered" >c</span>=l.create(a.words.slice(b),4*c);<span class="cstat-no" title="statement not covered" >a</span>.sigBytes=4*b;<span class="cstat-no" title="statement not covered" >r</span>eturn p.create({key:a,iv:c,salt:d})}</span>},s=f.PasswordBasedCipher=j.extend({cfg:j.cfg.extend({kdf:g}),encrypt:<span class="fstat-no" title="function not covered" >function(a,</span>
b,c,d){<span class="cstat-no" title="statement not covered" >d=this.cfg.extend(d);<span class="cstat-no" title="statement not covered" >c</span>=d.kdf.execute(c,a.keySize,a.ivSize);<span class="cstat-no" title="statement not covered" >d</span>.iv=c.iv;<span class="cstat-no" title="statement not covered" >a</span>=j.encrypt.call(this,a,b,c.key,d);<span class="cstat-no" title="statement not covered" >a</span>.mixIn(c);<span class="cstat-no" title="statement not covered" >r</span>eturn a}</span>,decrypt:<span class="fstat-no" title="function not covered" >function(a,b,c,d){<span class="cstat-no" title="statement not covered" ></span>d=this.cfg.extend(d);<span class="cstat-no" title="statement not covered" >b</span>=this._parse(b,d.format);<span class="cstat-no" title="statement not covered" >c</span>=d.kdf.execute(c,a.keySize,a.ivSize,b.salt);<span class="cstat-no" title="statement not covered" >d</span>.iv=c.iv;<span class="cstat-no" title="statement not covered" >r</span>eturn j.decrypt.call(this,a,b,c.key,d)}</span>})}();
&nbsp;
/*
CryptoJS v3.1.2 aes.js
code.google.com/p/crypto-js
(c) 2009-2013 by Jeff Mott. All rights reserved.
code.google.com/p/crypto-js/wiki/License
*/
(function(){for(var q=CryptoJS,x=q.lib.BlockCipher,r=q.algo,j=[],y=[],z=[],A=[],B=[],C=[],s=[],u=[],v=[],w=[],g=[],k=0;256&gt;k;k++)g[k]=128&gt;k?k&lt;&lt;1:k&lt;&lt;1^283;for(var n=0,l=0,k=0;256&gt;k;k++){var f=l^l&lt;&lt;1^l&lt;&lt;2^l&lt;&lt;3^l&lt;&lt;4,f=f&gt;&gt;&gt;8^f&amp;255^99;j[n]=f;y[f]=n;var t=g[n],D=g[t],E=g[D],b=257*g[f]^16843008*f;z[n]=b&lt;&lt;24|b&gt;&gt;&gt;8;A[n]=b&lt;&lt;16|b&gt;&gt;&gt;16;B[n]=b&lt;&lt;8|b&gt;&gt;&gt;24;C[n]=b;b=16843009*E^65537*D^257*t^16843008*n;s[f]=b&lt;&lt;24|b&gt;&gt;&gt;8;u[f]=b&lt;&lt;16|b&gt;&gt;&gt;16;v[f]=b&lt;&lt;8|b&gt;&gt;&gt;24;w[f]=b;n?(n=t^g[g[g[E^t]]],l^=g[g[l]]):n=l=1}var F=[0,1,2,4,8,
16,32,64,128,27,54],r=r.AES=x.extend({_doReset:<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>for(var c=this._key,e=c.words,a=c.sigBytes/4,c=4*((this._nRounds=a+6)+1),b=this._keySchedule=[],h=0;h&lt;c;h++)<span class="cstat-no" title="statement not covered" >if(h&lt;a)<span class="cstat-no" title="statement not covered" >b[h]=e[h];e</span>lse{<span class="cstat-no" title="statement not covered" >var d=b[h-1];<span class="cstat-no" title="statement not covered" >h</span>%a?6&lt;a&amp;&amp;4==h%a&amp;&amp;(d=j[d&gt;&gt;&gt;24]&lt;&lt;24|j[d&gt;&gt;&gt;16&amp;255]&lt;&lt;16|j[d&gt;&gt;&gt;8&amp;255]&lt;&lt;8|j[d&amp;255]):(d=d&lt;&lt;8|d&gt;&gt;&gt;24,d=j[d&gt;&gt;&gt;24]&lt;&lt;24|j[d&gt;&gt;&gt;16&amp;255]&lt;&lt;16|j[d&gt;&gt;&gt;8&amp;255]&lt;&lt;8|j[d&amp;255],d^=F[h/a|0]&lt;&lt;24);<span class="cstat-no" title="statement not covered" >b</span>[h]=b[h-a]^d}<span class="cstat-no" title="statement not covered" ></span>e</span></span>=this._invKeySchedule=[];<span class="cstat-no" title="statement not covered" >f</span>or(a=0;a&lt;c;a++)<span class="cstat-no" title="statement not covered" >h=c-a,d=a%4?b[h]:b[h-4],e[a]=4&gt;a||4&gt;=h?d:s[j[d&gt;&gt;&gt;24]]^u[j[d&gt;&gt;&gt;16&amp;255]]^v[j[d&gt;&gt;&gt;</span></span>
8&amp;255]]^w[j[d&amp;255]]},encryptBlock:<span class="fstat-no" title="function not covered" >function(c,e){<span class="cstat-no" title="statement not covered" ></span>this._doCryptBlock(c,e,this._keySchedule,z,A,B,C,j)}</span>,decryptBlock:<span class="fstat-no" title="function not covered" >function(c,e){<span class="cstat-no" title="statement not covered" ></span>var a=c[e+1];<span class="cstat-no" title="statement not covered" >c</span>[e+1]=c[e+3];<span class="cstat-no" title="statement not covered" >c</span>[e+3]=a;<span class="cstat-no" title="statement not covered" >t</span>his._doCryptBlock(c,e,this._invKeySchedule,s,u,v,w,y);<span class="cstat-no" title="statement not covered" >a</span>=c[e+1];<span class="cstat-no" title="statement not covered" >c</span>[e+1]=c[e+3];<span class="cstat-no" title="statement not covered" >c</span>[e+3]=a}</span>,_doCryptBlock:<span class="fstat-no" title="function not covered" >function(c,e,a,b,h,d,j,m){<span class="cstat-no" title="statement not covered" ></span>for(var n=this._nRounds,f=c[e]^a[0],g=c[e+1]^a[1],k=c[e+2]^a[2],p=c[e+3]^a[3],l=4,t=1;t&lt;n;t++)<span class="cstat-no" title="statement not covered" >var q=b[f&gt;&gt;&gt;24]^h[g&gt;&gt;&gt;16&amp;255]^d[k&gt;&gt;&gt;8&amp;255]^j[p&amp;255]^a[l++],r=b[g&gt;&gt;&gt;24]^h[k&gt;&gt;&gt;16&amp;255]^d[p&gt;&gt;&gt;8&amp;255]^j[f&amp;255]^a[l++],s=</span></span>
b[k&gt;&gt;&gt;24]^h[p&gt;&gt;&gt;16&amp;255]^d[f&gt;&gt;&gt;8&amp;255]^j[g&amp;255]^a[l++],p=b[p&gt;&gt;&gt;24]^h[f&gt;&gt;&gt;16&amp;255]^d[g&gt;&gt;&gt;8&amp;255]^j[k&amp;255]^a[l++],f=q,g=r,k=s;<span class="cstat-no" title="statement not covered" >q=(m[f&gt;&gt;&gt;24]&lt;&lt;24|m[g&gt;&gt;&gt;16&amp;255]&lt;&lt;16|m[k&gt;&gt;&gt;8&amp;255]&lt;&lt;8|m[p&amp;255])^a[l++];<span class="cstat-no" title="statement not covered" >r</span>=(m[g&gt;&gt;&gt;24]&lt;&lt;24|m[k&gt;&gt;&gt;16&amp;255]&lt;&lt;16|m[p&gt;&gt;&gt;8&amp;255]&lt;&lt;8|m[f&amp;255])^a[l++];<span class="cstat-no" title="statement not covered" >s</span>=(m[k&gt;&gt;&gt;24]&lt;&lt;24|m[p&gt;&gt;&gt;16&amp;255]&lt;&lt;16|m[f&gt;&gt;&gt;8&amp;255]&lt;&lt;8|m[g&amp;255])^a[l++];<span class="cstat-no" title="statement not covered" >p</span>=(m[p&gt;&gt;&gt;24]&lt;&lt;24|m[f&gt;&gt;&gt;16&amp;255]&lt;&lt;16|m[g&gt;&gt;&gt;8&amp;255]&lt;&lt;8|m[k&amp;255])^a[l++];<span class="cstat-no" title="statement not covered" >c</span>[e]=q;<span class="cstat-no" title="statement not covered" >c</span>[e+1]=r;<span class="cstat-no" title="statement not covered" >c</span>[e+2]=s;<span class="cstat-no" title="statement not covered" >c</span>[e+3]=p}</span>,keySize:8});q.AES=x._createHelper(r)})();
&nbsp;
/*
CryptoJS v3.1.2 tripledes-min.js
code.google.com/p/crypto-js
(c) 2009-2013 by Jeff Mott. All rights reserved.
code.google.com/p/crypto-js/wiki/License
*/
(function(){<span class="fstat-no" title="function not covered" >function j(b,c){<span class="cstat-no" title="statement not covered" ></span>var a=(this._lBlock&gt;&gt;&gt;b^this._rBlock)&amp;c;<span class="cstat-no" title="statement not covered" >t</span>his._rBlock^=a;<span class="cstat-no" title="statement not covered" >t</span>his._lBlock^=a&lt;&lt;b}<span class="fstat-no" title="function not covered" ></span>function l(b,c){<span class="cstat-no" title="statement not covered" ></span>var a=(this._rBlock&gt;&gt;&gt;b^this._lBlock)&amp;c;<span class="cstat-no" title="statement not covered" >t</span>his._lBlock^=a;<span class="cstat-no" title="statement not covered" >t</span>his._rBlock^=a&lt;&lt;b}</span>var h=CryptoJS,e=h.lib,n=e.WordArray,e=e.BlockCipher,g=h.algo,q=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],p=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,
55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],r=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],s=[{"0":8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,
2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,
1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{"0":1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,
75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,
276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{"0":260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,
14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,
17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{"0":2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,
98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,
1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{"0":128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,
10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,
83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{"0":268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,
2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{"0":1048576,
16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,
496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{"0":134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,
2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,
2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],t=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],m=g.DES=e.extend({_doReset:<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>for(var b=this._key.words,c=[],a=0;56&gt;a;a++){<span class="cstat-no" title="statement not covered" >var f=q[a]-1;<span class="cstat-no" title="statement not covered" >c</span>[a]=b[f&gt;&gt;&gt;5]&gt;&gt;&gt;31-f%32&amp;1}<span class="cstat-no" title="statement not covered" ></span>b</span>=this._subKeys=[];<span class="cstat-no" title="statement not covered" >f</span>or(f=0;16&gt;f;f++){<span class="cstat-no" title="statement not covered" >for(var d=b[f]=[],e=r[f],a=0;24&gt;a;a++)<span class="cstat-no" title="statement not covered" >d[a/6|0]|=c[(p[a]-1+e)%28]&lt;&lt;31-a%6,d[4+(a/6|0)]|=c[28+(p[a+24]-1+e)%28]&lt;&lt;31-a%6;<span class="cstat-no" title="statement not covered" >d</span></span>[0]=d[0]&lt;&lt;1|d[0]&gt;&gt;&gt;31;<span class="cstat-no" title="statement not covered" >f</span>or(a=1;7&gt;a;a++)<span class="cstat-no" title="statement not covered" >d[a]&gt;&gt;&gt;=</span></span></span>
4*(a-1)+3;<span class="cstat-no" title="statement not covered" >d[7]=d[7]&lt;&lt;5|d[7]&gt;&gt;&gt;27}<span class="cstat-no" title="statement not covered" ></span>c=this._invSubKeys=[];<span class="cstat-no" title="statement not covered" >f</span>or(a=0;16&gt;a;a++)<span class="cstat-no" title="statement not covered" >c[a]=b[15-a]}</span></span>,encryptBlock:<span class="fstat-no" title="function not covered" >function(b,c){<span class="cstat-no" title="statement not covered" ></span>this._doCryptBlock(b,c,this._subKeys)}</span>,decryptBlock:<span class="fstat-no" title="function not covered" >function(b,c){<span class="cstat-no" title="statement not covered" ></span>this._doCryptBlock(b,c,this._invSubKeys)}</span>,_doCryptBlock:<span class="fstat-no" title="function not covered" >function(b,c,a){<span class="cstat-no" title="statement not covered" ></span>this._lBlock=b[c];<span class="cstat-no" title="statement not covered" >t</span>his._rBlock=b[c+1];<span class="cstat-no" title="statement not covered" >j</span>.call(this,4,252645135);<span class="cstat-no" title="statement not covered" >j</span>.call(this,16,65535);<span class="cstat-no" title="statement not covered" >l</span>.call(this,2,858993459);<span class="cstat-no" title="statement not covered" >l</span>.call(this,8,16711935);<span class="cstat-no" title="statement not covered" >j</span>.call(this,1,1431655765);<span class="cstat-no" title="statement not covered" >f</span>or(var f=0;16&gt;f;f++){<span class="cstat-no" title="statement not covered" >for(var d=a[f],e=this._lBlock,h=this._rBlock,g=0,k=0;8&gt;k;k++)<span class="cstat-no" title="statement not covered" >g|=s[k][((h^</span></span></span>
d[k])&amp;t[k])&gt;&gt;&gt;0];<span class="cstat-no" title="statement not covered" >this._lBlock=h;<span class="cstat-no" title="statement not covered" >t</span>his._rBlock=e^g}<span class="cstat-no" title="statement not covered" ></span>a=this._lBlock;<span class="cstat-no" title="statement not covered" >t</span>his._lBlock=this._rBlock;<span class="cstat-no" title="statement not covered" >t</span>his._rBlock=a;<span class="cstat-no" title="statement not covered" >j</span>.call(this,1,1431655765);<span class="cstat-no" title="statement not covered" >l</span>.call(this,8,16711935);<span class="cstat-no" title="statement not covered" >l</span>.call(this,2,858993459);<span class="cstat-no" title="statement not covered" >j</span>.call(this,16,65535);<span class="cstat-no" title="statement not covered" >j</span>.call(this,4,252645135);<span class="cstat-no" title="statement not covered" >b</span>[c]=this._lBlock;<span class="cstat-no" title="statement not covered" >b</span>[c+1]=this._rBlock}</span>,keySize:2,ivSize:2,blockSize:2});h.DES=e._createHelper(m);g=g.TripleDES=e.extend({_doReset:<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var b=this._key.words;<span class="cstat-no" title="statement not covered" >t</span>his._des1=m.createEncryptor(n.create(b.slice(0,2)));<span class="cstat-no" title="statement not covered" >t</span>his._des2=m.createEncryptor(n.create(b.slice(2,4)));<span class="cstat-no" title="statement not covered" >t</span>his._des3=</span>
m.createEncryptor(n.create(b.slice(4,6)))},encryptBlock:<span class="fstat-no" title="function not covered" >function(b,c){<span class="cstat-no" title="statement not covered" ></span>this._des1.encryptBlock(b,c);<span class="cstat-no" title="statement not covered" >t</span>his._des2.decryptBlock(b,c);<span class="cstat-no" title="statement not covered" >t</span>his._des3.encryptBlock(b,c)}</span>,decryptBlock:<span class="fstat-no" title="function not covered" >function(b,c){<span class="cstat-no" title="statement not covered" ></span>this._des3.decryptBlock(b,c);<span class="cstat-no" title="statement not covered" >t</span>his._des2.encryptBlock(b,c);<span class="cstat-no" title="statement not covered" >t</span>his._des1.decryptBlock(b,c)}</span>,keySize:6,ivSize:2,blockSize:2});h.TripleDES=e._createHelper(g)})();
&nbsp;
/*
CryptoJS v3.1.2 enc-base64.js
code.google.com/p/crypto-js
(c) 2009-2013 by Jeff Mott. All rights reserved.
code.google.com/p/crypto-js/wiki/License
*/
(function(){var h=CryptoJS,j=h.lib.WordArray;h.enc.Base64={stringify:<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>var e=b.words,f=b.sigBytes,c=this._map;<span class="cstat-no" title="statement not covered" >b</span>.clamp();<span class="cstat-no" title="statement not covered" >b</span>=[];<span class="cstat-no" title="statement not covered" >f</span>or(var a=0;a&lt;f;a+=3)<span class="cstat-no" title="statement not covered" >for(var d=(e[a&gt;&gt;&gt;2]&gt;&gt;&gt;24-8*(a%4)&amp;255)&lt;&lt;16|(e[a+1&gt;&gt;&gt;2]&gt;&gt;&gt;24-8*((a+1)%4)&amp;255)&lt;&lt;8|e[a+2&gt;&gt;&gt;2]&gt;&gt;&gt;24-8*((a+2)%4)&amp;255,g=0;4&gt;g&amp;&amp;a+0.75*g&lt;f;g++)<span class="cstat-no" title="statement not covered" >b.push(c.charAt(d&gt;&gt;&gt;6*(3-g)&amp;63));<span class="cstat-no" title="statement not covered" >i</span></span></span>f(e=c.charAt(64))<span class="cstat-no" title="statement not covered" >for(;b.length%4;)<span class="cstat-no" title="statement not covered" >b.push(e);<span class="cstat-no" title="statement not covered" >r</span></span></span>eturn b.join("")}</span>,parse:<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>var e=b.length,f=this._map,c=f.charAt(64);<span class="cstat-no" title="statement not covered" >c</span>&amp;&amp;(c=b.indexOf(c),-1!=c&amp;&amp;(e=c));<span class="cstat-no" title="statement not covered" >f</span>or(var c=[],a=0,d=0;d&lt;</span>
e;d++)<span class="cstat-no" title="statement not covered" >if(d%4){<span class="cstat-no" title="statement not covered" >var g=f.indexOf(b.charAt(d-1))&lt;&lt;2*(d%4),h=f.indexOf(b.charAt(d))&gt;&gt;&gt;6-2*(d%4);<span class="cstat-no" title="statement not covered" >c</span>[a&gt;&gt;&gt;2]|=(g|h)&lt;&lt;24-8*(a%4);<span class="cstat-no" title="statement not covered" >a</span>++}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn j.create(c,a)}</span>,_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}})();
&nbsp;
/*
CryptoJS v3.1.2 md5.js
code.google.com/p/crypto-js
(c) 2009-2013 by Jeff Mott. All rights reserved.
code.google.com/p/crypto-js/wiki/License
*/
(function(E){<span class="fstat-no" title="function not covered" >function h(a,f,g,j,p,h,k){<span class="cstat-no" title="statement not covered" ></span>a=a+(f&amp;g|~f&amp;j)+p+k;<span class="cstat-no" title="statement not covered" >r</span>eturn(a&lt;&lt;h|a&gt;&gt;&gt;32-h)+f}<span class="fstat-no" title="function not covered" ></span>function k(a,f,g,j,p,h,k){<span class="cstat-no" title="statement not covered" ></span>a=a+(f&amp;j|g&amp;~j)+p+k;<span class="cstat-no" title="statement not covered" >r</span>eturn(a&lt;&lt;h|a&gt;&gt;&gt;32-h)+f}<span class="fstat-no" title="function not covered" ></span>function l(a,f,g,j,h,k,l){<span class="cstat-no" title="statement not covered" ></span>a=a+(f^g^j)+h+l;<span class="cstat-no" title="statement not covered" >r</span>eturn(a&lt;&lt;k|a&gt;&gt;&gt;32-k)+f}<span class="fstat-no" title="function not covered" ></span>function n(a,f,g,j,h,k,l){<span class="cstat-no" title="statement not covered" ></span>a=a+(g^(f|~j))+h+l;<span class="cstat-no" title="statement not covered" >r</span>eturn(a&lt;&lt;k|a&gt;&gt;&gt;32-k)+f}</span>for(var r=CryptoJS,q=r.lib,F=q.WordArray,s=q.Hasher,q=r.algo,a=[],t=0;64&gt;t;t++)a[t]=4294967296*E.abs(E.sin(t+1))|0;q=q.MD5=s.extend({_doReset:<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>this._hash=new F.init([1732584193,4023233417,2562383102,271733878])}</span>,
_doProcessBlock:<span class="fstat-no" title="function not covered" >function(m,f){<span class="cstat-no" title="statement not covered" ></span>for(var g=0;16&gt;g;g++){<span class="cstat-no" title="statement not covered" >var j=f+g,p=m[j];<span class="cstat-no" title="statement not covered" >m</span>[j]=(p&lt;&lt;8|p&gt;&gt;&gt;24)&amp;16711935|(p&lt;&lt;24|p&gt;&gt;&gt;8)&amp;4278255360}<span class="cstat-no" title="statement not covered" ></span>v</span>ar g=this._hash.words,j=m[f+0],p=m[f+1],q=m[f+2],r=m[f+3],s=m[f+4],t=m[f+5],u=m[f+6],v=m[f+7],w=m[f+8],x=m[f+9],y=m[f+10],z=m[f+11],A=m[f+12],B=m[f+13],C=m[f+14],D=m[f+15],b=g[0],c=g[1],d=g[2],e=g[3],b=h(b,c,d,e,j,7,a[0]),e=h(e,b,c,d,p,12,a[1]),d=h(d,e,b,c,q,17,a[2]),c=h(c,d,e,b,r,22,a[3]),b=h(b,c,d,e,s,7,a[4]),e=h(e,b,c,d,t,12,a[5]),d=h(d,e,b,c,u,17,a[6]),c=h(c,d,e,b,v,22,a[7]),</span>
b=h(b,c,d,e,w,7,a[8]),e=h(e,b,c,d,x,12,a[9]),d=h(d,e,b,c,y,17,a[10]),c=h(c,d,e,b,z,22,a[11]),b=h(b,c,d,e,A,7,a[12]),e=h(e,b,c,d,B,12,a[13]),d=h(d,e,b,c,C,17,a[14]),c=h(c,d,e,b,D,22,a[15]),b=k(b,c,d,e,p,5,a[16]),e=k(e,b,c,d,u,9,a[17]),d=k(d,e,b,c,z,14,a[18]),c=k(c,d,e,b,j,20,a[19]),b=k(b,c,d,e,t,5,a[20]),e=k(e,b,c,d,y,9,a[21]),d=k(d,e,b,c,D,14,a[22]),c=k(c,d,e,b,s,20,a[23]),b=k(b,c,d,e,x,5,a[24]),e=k(e,b,c,d,C,9,a[25]),d=k(d,e,b,c,r,14,a[26]),c=k(c,d,e,b,w,20,a[27]),b=k(b,c,d,e,B,5,a[28]),e=k(e,b,
c,d,q,9,a[29]),d=k(d,e,b,c,v,14,a[30]),c=k(c,d,e,b,A,20,a[31]),b=l(b,c,d,e,t,4,a[32]),e=l(e,b,c,d,w,11,a[33]),d=l(d,e,b,c,z,16,a[34]),c=l(c,d,e,b,C,23,a[35]),b=l(b,c,d,e,p,4,a[36]),e=l(e,b,c,d,s,11,a[37]),d=l(d,e,b,c,v,16,a[38]),c=l(c,d,e,b,y,23,a[39]),b=l(b,c,d,e,B,4,a[40]),e=l(e,b,c,d,j,11,a[41]),d=l(d,e,b,c,r,16,a[42]),c=l(c,d,e,b,u,23,a[43]),b=l(b,c,d,e,x,4,a[44]),e=l(e,b,c,d,A,11,a[45]),d=l(d,e,b,c,D,16,a[46]),c=l(c,d,e,b,q,23,a[47]),b=n(b,c,d,e,j,6,a[48]),e=n(e,b,c,d,v,10,a[49]),d=n(d,e,b,c,
C,15,a[50]),c=n(c,d,e,b,t,21,a[51]),b=n(b,c,d,e,A,6,a[52]),e=n(e,b,c,d,r,10,a[53]),d=n(d,e,b,c,y,15,a[54]),c=n(c,d,e,b,p,21,a[55]),b=n(b,c,d,e,w,6,a[56]),e=n(e,b,c,d,D,10,a[57]),d=n(d,e,b,c,u,15,a[58]),c=n(c,d,e,b,B,21,a[59]),b=n(b,c,d,e,s,6,a[60]),e=n(e,b,c,d,z,10,a[61]),d=n(d,e,b,c,q,15,a[62]),c=n(c,d,e,b,x,21,a[63]);<span class="cstat-no" title="statement not covered" >g[0]=g[0]+b|0;<span class="cstat-no" title="statement not covered" >g</span>[1]=g[1]+c|0;<span class="cstat-no" title="statement not covered" >g</span>[2]=g[2]+d|0;<span class="cstat-no" title="statement not covered" >g</span>[3]=g[3]+e|0}</span>,_doFinalize:<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var a=this._data,f=a.words,g=8*this._nDataBytes,j=8*a.sigBytes;<span class="cstat-no" title="statement not covered" >f</span>[j&gt;&gt;&gt;5]|=128&lt;&lt;24-j%32;<span class="cstat-no" title="statement not covered" >v</span>ar h=E.floor(g/</span>
4294967296);<span class="cstat-no" title="statement not covered" >f[(j+64&gt;&gt;&gt;9&lt;&lt;4)+15]=(h&lt;&lt;8|h&gt;&gt;&gt;24)&amp;16711935|(h&lt;&lt;24|h&gt;&gt;&gt;8)&amp;4278255360;<span class="cstat-no" title="statement not covered" >f</span>[(j+64&gt;&gt;&gt;9&lt;&lt;4)+14]=(g&lt;&lt;8|g&gt;&gt;&gt;24)&amp;16711935|(g&lt;&lt;24|g&gt;&gt;&gt;8)&amp;4278255360;<span class="cstat-no" title="statement not covered" >a</span>.sigBytes=4*(f.length+1);<span class="cstat-no" title="statement not covered" >t</span>his._process();<span class="cstat-no" title="statement not covered" >a</span>=this._hash;<span class="cstat-no" title="statement not covered" >f</span>=a.words;<span class="cstat-no" title="statement not covered" >f</span>or(g=0;4&gt;g;g++)<span class="cstat-no" title="statement not covered" >j=f[g],f[g]=(j&lt;&lt;8|j&gt;&gt;&gt;24)&amp;16711935|(j&lt;&lt;24|j&gt;&gt;&gt;8)&amp;4278255360;<span class="cstat-no" title="statement not covered" >r</span></span>eturn a}</span>,clone:<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var a=s.clone.call(this);<span class="cstat-no" title="statement not covered" >a</span>._hash=this._hash.clone();<span class="cstat-no" title="statement not covered" >r</span>eturn a}</span>});r.MD5=s._createHelper(q);r.HmacMD5=s._createHmacHelper(q)})(Math);
&nbsp;
/*
CryptoJS v3.1.2 sha1-min.js
code.google.com/p/crypto-js
(c) 2009-2013 by Jeff Mott. All rights reserved.
code.google.com/p/crypto-js/wiki/License
*/
(function(){var k=CryptoJS,b=k.lib,m=b.WordArray,l=b.Hasher,d=[],b=k.algo.SHA1=l.extend({_doReset:<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>this._hash=new m.init([1732584193,4023233417,2562383102,271733878,3285377520])}</span>,_doProcessBlock:<span class="fstat-no" title="function not covered" >function(n,p){<span class="cstat-no" title="statement not covered" ></span>for(var a=this._hash.words,e=a[0],f=a[1],h=a[2],j=a[3],b=a[4],c=0;80&gt;c;c++){<span class="cstat-no" title="statement not covered" >if(16&gt;c)<span class="cstat-no" title="statement not covered" >d[c]=n[p+c]|0;e</span>lse{<span class="cstat-no" title="statement not covered" >var g=d[c-3]^d[c-8]^d[c-14]^d[c-16];<span class="cstat-no" title="statement not covered" >d</span>[c]=g&lt;&lt;1|g&gt;&gt;&gt;31}<span class="cstat-no" title="statement not covered" ></span>g</span>=(e&lt;&lt;5|e&gt;&gt;&gt;27)+b+d[c];<span class="cstat-no" title="statement not covered" >g</span>=20&gt;c?g+((f&amp;h|~f&amp;j)+1518500249):40&gt;c?g+((f^h^j)+1859775393):60&gt;c?g+((f&amp;h|f&amp;j|h&amp;j)-1894007588):g+((f^h^</span></span>
j)-899497514);<span class="cstat-no" title="statement not covered" >b=j;<span class="cstat-no" title="statement not covered" >j</span>=h;<span class="cstat-no" title="statement not covered" >h</span>=f&lt;&lt;30|f&gt;&gt;&gt;2;<span class="cstat-no" title="statement not covered" >f</span>=e;<span class="cstat-no" title="statement not covered" >e</span>=g}<span class="cstat-no" title="statement not covered" ></span>a[0]=a[0]+e|0;<span class="cstat-no" title="statement not covered" >a</span>[1]=a[1]+f|0;<span class="cstat-no" title="statement not covered" >a</span>[2]=a[2]+h|0;<span class="cstat-no" title="statement not covered" >a</span>[3]=a[3]+j|0;<span class="cstat-no" title="statement not covered" >a</span>[4]=a[4]+b|0}</span>,_doFinalize:<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var b=this._data,d=b.words,a=8*this._nDataBytes,e=8*b.sigBytes;<span class="cstat-no" title="statement not covered" >d</span>[e&gt;&gt;&gt;5]|=128&lt;&lt;24-e%32;<span class="cstat-no" title="statement not covered" >d</span>[(e+64&gt;&gt;&gt;9&lt;&lt;4)+14]=Math.floor(a/4294967296);<span class="cstat-no" title="statement not covered" >d</span>[(e+64&gt;&gt;&gt;9&lt;&lt;4)+15]=a;<span class="cstat-no" title="statement not covered" >b</span>.sigBytes=4*d.length;<span class="cstat-no" title="statement not covered" >t</span>his._process();<span class="cstat-no" title="statement not covered" >r</span>eturn this._hash}</span>,clone:<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var b=l.clone.call(this);<span class="cstat-no" title="statement not covered" >b</span>._hash=this._hash.clone();<span class="cstat-no" title="statement not covered" >r</span>eturn b}</span>});k.SHA1=l._createHelper(b);k.HmacSHA1=l._createHmacHelper(b)})();
&nbsp;
/*
CryptoJS v3.1.2 sha256-min.js
code.google.com/p/crypto-js
(c) 2009-2013 by Jeff Mott. All rights reserved.
code.google.com/p/crypto-js/wiki/License
*/
(function(k){for(var g=CryptoJS,h=g.lib,v=h.WordArray,j=h.Hasher,h=g.algo,s=[],t=[],u=function(q){return 4294967296*(q-(q|0))|0},l=2,b=0;64&gt;b;){var d;a:{d=l;for(var w=k.sqrt(d),r=2;r&lt;=w;r++)if(!(d%r)){d=!1;break a}d=!0}d&amp;&amp;(8&gt;b&amp;&amp;(s[b]=u(k.pow(l,0.5))),t[b]=u(k.pow(l,1/3)),b++);l++}var n=[],h=h.SHA256=j.extend({_doReset:<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>this._hash=new v.init(s.slice(0))}</span>,_doProcessBlock:<span class="fstat-no" title="function not covered" >function(q,h){<span class="cstat-no" title="statement not covered" ></span>for(var a=this._hash.words,c=a[0],d=a[1],b=a[2],k=a[3],f=a[4],g=a[5],j=a[6],l=a[7],e=0;64&gt;e;e++){<span class="cstat-no" title="statement not covered" >if(16&gt;e)<span class="cstat-no" title="statement not covered" >n[e]=</span></span></span>
q[h+e]|0;else{<span class="cstat-no" title="statement not covered" >var m=n[e-15],p=n[e-2];<span class="cstat-no" title="statement not covered" >n</span>[e]=((m&lt;&lt;25|m&gt;&gt;&gt;7)^(m&lt;&lt;14|m&gt;&gt;&gt;18)^m&gt;&gt;&gt;3)+n[e-7]+((p&lt;&lt;15|p&gt;&gt;&gt;17)^(p&lt;&lt;13|p&gt;&gt;&gt;19)^p&gt;&gt;&gt;10)+n[e-16]}<span class="cstat-no" title="statement not covered" ></span>m=l+((f&lt;&lt;26|f&gt;&gt;&gt;6)^(f&lt;&lt;21|f&gt;&gt;&gt;11)^(f&lt;&lt;7|f&gt;&gt;&gt;25))+(f&amp;g^~f&amp;j)+t[e]+n[e];<span class="cstat-no" title="statement not covered" >p</span>=((c&lt;&lt;30|c&gt;&gt;&gt;2)^(c&lt;&lt;19|c&gt;&gt;&gt;13)^(c&lt;&lt;10|c&gt;&gt;&gt;22))+(c&amp;d^c&amp;b^d&amp;b);<span class="cstat-no" title="statement not covered" >l</span>=j;<span class="cstat-no" title="statement not covered" >j</span>=g;<span class="cstat-no" title="statement not covered" >g</span>=f;<span class="cstat-no" title="statement not covered" >f</span>=k+m|0;<span class="cstat-no" title="statement not covered" >k</span>=b;<span class="cstat-no" title="statement not covered" >b</span>=d;<span class="cstat-no" title="statement not covered" >d</span>=c;<span class="cstat-no" title="statement not covered" >c</span>=m+p|0}<span class="cstat-no" title="statement not covered" ></span>a[0]=a[0]+c|0;<span class="cstat-no" title="statement not covered" >a</span>[1]=a[1]+d|0;<span class="cstat-no" title="statement not covered" >a</span>[2]=a[2]+b|0;<span class="cstat-no" title="statement not covered" >a</span>[3]=a[3]+k|0;<span class="cstat-no" title="statement not covered" >a</span>[4]=a[4]+f|0;<span class="cstat-no" title="statement not covered" >a</span>[5]=a[5]+g|0;<span class="cstat-no" title="statement not covered" >a</span>[6]=a[6]+j|0;<span class="cstat-no" title="statement not covered" >a</span>[7]=a[7]+l|0}</span>,_doFinalize:<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var d=this._data,b=d.words,a=8*this._nDataBytes,c=8*d.sigBytes;</span>
<span class="cstat-no" title="statement not covered" >b[c&gt;&gt;&gt;5]|=128&lt;&lt;24-c%32;<span class="cstat-no" title="statement not covered" >b</span>[(c+64&gt;&gt;&gt;9&lt;&lt;4)+14]=k.floor(a/4294967296);<span class="cstat-no" title="statement not covered" >b</span>[(c+64&gt;&gt;&gt;9&lt;&lt;4)+15]=a;<span class="cstat-no" title="statement not covered" >d</span>.sigBytes=4*b.length;<span class="cstat-no" title="statement not covered" >t</span>his._process();<span class="cstat-no" title="statement not covered" >r</span>eturn this._hash}</span>,clone:<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var b=j.clone.call(this);<span class="cstat-no" title="statement not covered" >b</span>._hash=this._hash.clone();<span class="cstat-no" title="statement not covered" >r</span>eturn b}</span>});g.SHA256=j._createHelper(h);g.HmacSHA256=j._createHmacHelper(h)})(Math);
&nbsp;
/*
CryptoJS v3.1.2 sha224-min.js
code.google.com/p/crypto-js
(c) 2009-2013 by Jeff Mott. All rights reserved.
code.google.com/p/crypto-js/wiki/License
*/
(function(){var b=CryptoJS,d=b.lib.WordArray,a=b.algo,c=a.SHA256,a=a.SHA224=c.extend({_doReset:<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>this._hash=new d.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])}</span>,_doFinalize:<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var a=c._doFinalize.call(this);<span class="cstat-no" title="statement not covered" >a</span>.sigBytes-=4;<span class="cstat-no" title="statement not covered" >r</span>eturn a}</span>});b.SHA224=c._createHelper(a);b.HmacSHA224=c._createHmacHelper(a)})();
&nbsp;
/*
CryptoJS v3.1.2 sha512-min.js
code.google.com/p/crypto-js
(c) 2009-2013 by Jeff Mott. All rights reserved.
code.google.com/p/crypto-js/wiki/License
*/
(function(){function a(){return d.create.apply(d,arguments)}for(var n=CryptoJS,r=n.lib.Hasher,e=n.x64,d=e.Word,T=e.WordArray,e=n.algo,ea=[a(1116352408,3609767458),a(1899447441,602891725),a(3049323471,3964484399),a(3921009573,2173295548),a(961987163,4081628472),a(1508970993,3053834265),a(2453635748,2937671579),a(2870763221,3664609560),a(3624381080,2734883394),a(310598401,1164996542),a(607225278,1323610764),a(1426881987,3590304994),a(1925078388,4068182383),a(2162078206,991336113),a(2614888103,633803317),
a(3248222580,3479774868),a(3835390401,2666613458),a(4022224774,944711139),a(264347078,2341262773),a(604807628,2007800933),a(770255983,1495990901),a(1249150122,1856431235),a(1555081692,3175218132),a(1996064986,2198950837),a(2554220882,3999719339),a(2821834349,766784016),a(2952996808,2566594879),a(3210313671,3203337956),a(3336571891,1034457026),a(3584528711,2466948901),a(113926993,3758326383),a(338241895,168717936),a(666307205,1188179964),a(773529912,1546045734),a(1294757372,1522805485),a(1396182291,
2643833823),a(1695183700,2343527390),a(1986661051,1014477480),a(2177026350,1206759142),a(2456956037,344077627),a(2730485921,1290863460),a(2820302411,3158454273),a(3259730800,3505952657),a(3345764771,106217008),a(3516065817,3606008344),a(3600352804,1432725776),a(4094571909,1467031594),a(275423344,851169720),a(430227734,3100823752),a(506948616,1363258195),a(659060556,3750685593),a(883997877,3785050280),a(958139571,3318307427),a(1322822218,3812723403),a(1537002063,2003034995),a(1747873779,3602036899),
a(1955562222,1575990012),a(2024104815,1125592928),a(2227730452,2716904306),a(2361852424,442776044),a(2428436474,593698344),a(2756734187,3733110249),a(3204031479,2999351573),a(3329325298,3815920427),a(3391569614,3928383900),a(3515267271,566280711),a(3940187606,3454069534),a(4118630271,4000239992),a(116418474,1914138554),a(174292421,2731055270),a(289380356,3203993006),a(460393269,320620315),a(685471733,587496836),a(852142971,1086792851),a(1017036298,365543100),a(1126000580,2618297676),a(1288033470,
3409855158),a(1501505948,4234509866),a(1607167915,987167468),a(1816402316,1246189591)],v=[],w=0;80&gt;w;w++)v[w]=a();e=e.SHA512=r.extend({_doReset:<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>this._hash=new T.init([new d.init(1779033703,4089235720),new d.init(3144134277,2227873595),new d.init(1013904242,4271175723),new d.init(2773480762,1595750129),new d.init(1359893119,2917565137),new d.init(2600822924,725511199),new d.init(528734635,4215389547),new d.init(1541459225,327033209)])}</span>,_doProcessBlock:<span class="fstat-no" title="function not covered" >function(a,d){<span class="cstat-no" title="statement not covered" ></span>for(var f=this._hash.words,</span>
F=f[0],e=f[1],n=f[2],r=f[3],G=f[4],H=f[5],I=f[6],f=f[7],w=F.high,J=F.low,X=e.high,K=e.low,Y=n.high,L=n.low,Z=r.high,M=r.low,$=G.high,N=G.low,aa=H.high,O=H.low,ba=I.high,P=I.low,ca=f.high,Q=f.low,k=w,g=J,z=X,x=K,A=Y,y=L,U=Z,B=M,l=$,h=N,R=aa,C=O,S=ba,D=P,V=ca,E=Q,m=0;80&gt;m;m++){<span class="cstat-no" title="statement not covered" >var s=v[m];<span class="cstat-no" title="statement not covered" >i</span>f(16&gt;m)<span class="cstat-no" title="statement not covered" >var j=s.high=a[d+2*m]|0,b=s.low=a[d+2*m+1]|0;e</span>lse{<span class="cstat-no" title="statement not covered" >var j=v[m-15],b=j.high,p=j.low,j=(b&gt;&gt;&gt;1|p&lt;&lt;31)^(b&gt;&gt;&gt;8|p&lt;&lt;24)^b&gt;&gt;&gt;7,p=(p&gt;&gt;&gt;1|b&lt;&lt;31)^(p&gt;&gt;&gt;8|b&lt;&lt;24)^(p&gt;&gt;&gt;7|b&lt;&lt;25),u=v[m-2],b=u.high,c=u.low,u=(b&gt;&gt;&gt;19|c&lt;&lt;13)^(b&lt;&lt;</span></span>
3|c&gt;&gt;&gt;29)^b&gt;&gt;&gt;6,c=(c&gt;&gt;&gt;19|b&lt;&lt;13)^(c&lt;&lt;3|b&gt;&gt;&gt;29)^(c&gt;&gt;&gt;6|b&lt;&lt;26),b=v[m-7],W=b.high,t=v[m-16],q=t.high,t=t.low,b=p+b.low,j=j+W+(b&gt;&gt;&gt;0&lt;p&gt;&gt;&gt;0?1:0),b=b+c,j=j+u+(b&gt;&gt;&gt;0&lt;c&gt;&gt;&gt;0?1:0),b=b+t,j=j+q+(b&gt;&gt;&gt;0&lt;t&gt;&gt;&gt;0?1:0);<span class="cstat-no" title="statement not covered" >s.high=j;<span class="cstat-no" title="statement not covered" >s</span>.low=b}<span class="cstat-no" title="statement not covered" ></span>var W=l&amp;R^~l&amp;S,t=h&amp;C^~h&amp;D,s=k&amp;z^k&amp;A^z&amp;A,T=g&amp;x^g&amp;y^x&amp;y,p=(k&gt;&gt;&gt;28|g&lt;&lt;4)^(k&lt;&lt;30|g&gt;&gt;&gt;2)^(k&lt;&lt;25|g&gt;&gt;&gt;7),u=(g&gt;&gt;&gt;28|k&lt;&lt;4)^(g&lt;&lt;30|k&gt;&gt;&gt;2)^(g&lt;&lt;25|k&gt;&gt;&gt;7),c=ea[m],fa=c.high,da=c.low,c=E+((h&gt;&gt;&gt;14|l&lt;&lt;18)^(h&gt;&gt;&gt;18|l&lt;&lt;14)^(h&lt;&lt;23|l&gt;&gt;&gt;9)),q=V+((l&gt;&gt;&gt;14|h&lt;&lt;18)^(l&gt;&gt;&gt;18|h&lt;&lt;14)^(l&lt;&lt;23|h&gt;&gt;&gt;9))+(c&gt;&gt;&gt;0&lt;E&gt;&gt;&gt;0?1:</span>
0),c=c+t,q=q+W+(c&gt;&gt;&gt;0&lt;t&gt;&gt;&gt;0?1:0),c=c+da,q=q+fa+(c&gt;&gt;&gt;0&lt;da&gt;&gt;&gt;0?1:0),c=c+b,q=q+j+(c&gt;&gt;&gt;0&lt;b&gt;&gt;&gt;0?1:0),b=u+T,s=p+s+(b&gt;&gt;&gt;0&lt;u&gt;&gt;&gt;0?1:0),V=S,E=D,S=R,D=C,R=l,C=h,h=B+c|0,l=U+q+(h&gt;&gt;&gt;0&lt;B&gt;&gt;&gt;0?1:0)|0,U=A,B=y,A=z,y=x,z=k,x=g,g=c+b|0,k=q+s+(g&gt;&gt;&gt;0&lt;c&gt;&gt;&gt;0?1:0)|0}<span class="cstat-no" title="statement not covered" >J=F.low=J+g;<span class="cstat-no" title="statement not covered" >F</span>.high=w+k+(J&gt;&gt;&gt;0&lt;g&gt;&gt;&gt;0?1:0);<span class="cstat-no" title="statement not covered" >K</span>=e.low=K+x;<span class="cstat-no" title="statement not covered" >e</span>.high=X+z+(K&gt;&gt;&gt;0&lt;x&gt;&gt;&gt;0?1:0);<span class="cstat-no" title="statement not covered" >L</span>=n.low=L+y;<span class="cstat-no" title="statement not covered" >n</span>.high=Y+A+(L&gt;&gt;&gt;0&lt;y&gt;&gt;&gt;0?1:0);<span class="cstat-no" title="statement not covered" >M</span>=r.low=M+B;<span class="cstat-no" title="statement not covered" >r</span>.high=Z+U+(M&gt;&gt;&gt;0&lt;B&gt;&gt;&gt;0?1:0);<span class="cstat-no" title="statement not covered" >N</span>=G.low=N+h;<span class="cstat-no" title="statement not covered" >G</span>.high=$+l+(N&gt;&gt;&gt;0&lt;h&gt;&gt;&gt;0?1:0);<span class="cstat-no" title="statement not covered" >O</span>=H.low=O+C;<span class="cstat-no" title="statement not covered" >H</span>.high=aa+R+(O&gt;&gt;&gt;0&lt;C&gt;&gt;&gt;0?1:0);<span class="cstat-no" title="statement not covered" >P</span>=I.low=P+D;</span>
<span class="cstat-no" title="statement not covered" >I.high=ba+S+(P&gt;&gt;&gt;0&lt;D&gt;&gt;&gt;0?1:0);<span class="cstat-no" title="statement not covered" >Q</span>=f.low=Q+E;<span class="cstat-no" title="statement not covered" >f</span>.high=ca+V+(Q&gt;&gt;&gt;0&lt;E&gt;&gt;&gt;0?1:0)}</span>,_doFinalize:<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var a=this._data,d=a.words,f=8*this._nDataBytes,e=8*a.sigBytes;<span class="cstat-no" title="statement not covered" >d</span>[e&gt;&gt;&gt;5]|=128&lt;&lt;24-e%32;<span class="cstat-no" title="statement not covered" >d</span>[(e+128&gt;&gt;&gt;10&lt;&lt;5)+30]=Math.floor(f/4294967296);<span class="cstat-no" title="statement not covered" >d</span>[(e+128&gt;&gt;&gt;10&lt;&lt;5)+31]=f;<span class="cstat-no" title="statement not covered" >a</span>.sigBytes=4*d.length;<span class="cstat-no" title="statement not covered" >t</span>his._process();<span class="cstat-no" title="statement not covered" >r</span>eturn this._hash.toX32()}</span>,clone:<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var a=r.clone.call(this);<span class="cstat-no" title="statement not covered" >a</span>._hash=this._hash.clone();<span class="cstat-no" title="statement not covered" >r</span>eturn a}</span>,blockSize:32});n.SHA512=r._createHelper(e);n.HmacSHA512=r._createHmacHelper(e)})();
&nbsp;
/*
CryptoJS v3.1.2 sha384-min.js
code.google.com/p/crypto-js
(c) 2009-2013 by Jeff Mott. All rights reserved.
code.google.com/p/crypto-js/wiki/License
*/
(function(){var c=CryptoJS,a=c.x64,b=a.Word,e=a.WordArray,a=c.algo,d=a.SHA512,a=a.SHA384=d.extend({_doReset:<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>this._hash=new e.init([new b.init(3418070365,3238371032),new b.init(1654270250,914150663),new b.init(2438529370,812702999),new b.init(355462360,4144912697),new b.init(1731405415,4290775857),new b.init(2394180231,1750603025),new b.init(3675008525,1694076839),new b.init(1203062813,3204075428)])}</span>,_doFinalize:<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var a=d._doFinalize.call(this);<span class="cstat-no" title="statement not covered" >a</span>.sigBytes-=16;<span class="cstat-no" title="statement not covered" >r</span>eturn a}</span>});c.SHA384=
d._createHelper(a);c.HmacSHA384=d._createHmacHelper(a)})();
&nbsp;
/*
CryptoJS v3.1.2 ripemd160-min.js
code.google.com/p/crypto-js
(c) 2009-2013 by Jeff Mott. All rights reserved.
code.google.com/p/crypto-js/wiki/License
*/
/*
&nbsp;
(c) 2012 by Cedric Mesnil. All rights reserved.
&nbsp;
Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
&nbsp;
    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
&nbsp;
THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/
(function(){var q=CryptoJS,d=q.lib,n=d.WordArray,p=d.Hasher,d=q.algo,x=n.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),y=n.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),z=n.create([11,14,15,12,
5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),A=n.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),B=n.create([0,1518500249,1859775393,2400959708,2840853838]),C=n.create([1352829926,1548603684,1836072691,
2053994217,0]),d=d.RIPEMD160=p.extend({_doReset:<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>this._hash=n.create([1732584193,4023233417,2562383102,271733878,3285377520])}</span>,_doProcessBlock:<span class="fstat-no" title="function not covered" >function(e,v){<span class="cstat-no" title="statement not covered" ></span>for(var b=0;16&gt;b;b++){<span class="cstat-no" title="statement not covered" >var c=v+b,f=e[c];<span class="cstat-no" title="statement not covered" >e</span>[c]=(f&lt;&lt;8|f&gt;&gt;&gt;24)&amp;16711935|(f&lt;&lt;24|f&gt;&gt;&gt;8)&amp;4278255360}<span class="cstat-no" title="statement not covered" ></span>v</span>ar c=this._hash.words,f=B.words,d=C.words,n=x.words,q=y.words,p=z.words,w=A.words,t,g,h,j,r,u,k,l,m,s;<span class="cstat-no" title="statement not covered" >u</span>=t=c[0];<span class="cstat-no" title="statement not covered" >k</span>=g=c[1];<span class="cstat-no" title="statement not covered" >l</span>=h=c[2];<span class="cstat-no" title="statement not covered" >m</span>=j=c[3];<span class="cstat-no" title="statement not covered" >s</span>=r=c[4];<span class="cstat-no" title="statement not covered" >f</span>or(var a,b=0;80&gt;b;b+=1)<span class="cstat-no" title="statement not covered" >a=t+e[v+n[b]]|0,a=16&gt;b?a+((g^h^j)+f[0]):32&gt;b?a+((g&amp;h|~g&amp;j)+f[1]):48&gt;b?</span></span>
a+(((g|~h)^j)+f[2]):64&gt;b?a+((g&amp;j|h&amp;~j)+f[3]):a+((g^(h|~j))+f[4]),a|=0,a=a&lt;&lt;p[b]|a&gt;&gt;&gt;32-p[b],a=a+r|0,t=r,r=j,j=h&lt;&lt;10|h&gt;&gt;&gt;22,h=g,g=a,a=u+e[v+q[b]]|0,a=16&gt;b?a+((k^(l|~m))+d[0]):32&gt;b?a+((k&amp;m|l&amp;~m)+d[1]):48&gt;b?a+(((k|~l)^m)+d[2]):64&gt;b?a+((k&amp;l|~k&amp;m)+d[3]):a+((k^l^m)+d[4]),a|=0,a=a&lt;&lt;w[b]|a&gt;&gt;&gt;32-w[b],a=a+s|0,u=s,s=m,m=l&lt;&lt;10|l&gt;&gt;&gt;22,l=k,k=a;<span class="cstat-no" title="statement not covered" >a=c[1]+h+m|0;<span class="cstat-no" title="statement not covered" >c</span>[1]=c[2]+j+s|0;<span class="cstat-no" title="statement not covered" >c</span>[2]=c[3]+r+u|0;<span class="cstat-no" title="statement not covered" >c</span>[3]=c[4]+t+k|0;<span class="cstat-no" title="statement not covered" >c</span>[4]=c[0]+g+l|0;<span class="cstat-no" title="statement not covered" >c</span>[0]=a}</span>,_doFinalize:<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var e=this._data,d=e.words,b=8*this._nDataBytes,c=8*e.sigBytes;</span>
<span class="cstat-no" title="statement not covered" >d[c&gt;&gt;&gt;5]|=128&lt;&lt;24-c%32;<span class="cstat-no" title="statement not covered" >d</span>[(c+64&gt;&gt;&gt;9&lt;&lt;4)+14]=(b&lt;&lt;8|b&gt;&gt;&gt;24)&amp;16711935|(b&lt;&lt;24|b&gt;&gt;&gt;8)&amp;4278255360;<span class="cstat-no" title="statement not covered" >e</span>.sigBytes=4*(d.length+1);<span class="cstat-no" title="statement not covered" >t</span>his._process();<span class="cstat-no" title="statement not covered" >e</span>=this._hash;<span class="cstat-no" title="statement not covered" >d</span>=e.words;<span class="cstat-no" title="statement not covered" >f</span>or(b=0;5&gt;b;b++)<span class="cstat-no" title="statement not covered" >c=d[b],d[b]=(c&lt;&lt;8|c&gt;&gt;&gt;24)&amp;16711935|(c&lt;&lt;24|c&gt;&gt;&gt;8)&amp;4278255360;<span class="cstat-no" title="statement not covered" >r</span></span>eturn e}</span>,clone:<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var d=p.clone.call(this);<span class="cstat-no" title="statement not covered" >d</span>._hash=this._hash.clone();<span class="cstat-no" title="statement not covered" >r</span>eturn d}</span>});q.RIPEMD160=p._createHelper(d);q.HmacRIPEMD160=p._createHmacHelper(d)})(Math);
&nbsp;
/*
CryptoJS v3.1.2 hmac.js
code.google.com/p/crypto-js
(c) 2009-2013 by Jeff Mott. All rights reserved.
code.google.com/p/crypto-js/wiki/License
*/
(function(){var c=CryptoJS,k=c.enc.Utf8;c.algo.HMAC=c.lib.Base.extend({init:<span class="fstat-no" title="function not covered" >function(a,b){<span class="cstat-no" title="statement not covered" ></span>a=this._hasher=new a.init;<span class="cstat-no" title="statement not covered" >"</span>string"==typeof b&amp;&amp;(b=k.parse(b));<span class="cstat-no" title="statement not covered" >v</span>ar c=a.blockSize,e=4*c;<span class="cstat-no" title="statement not covered" >b</span>.sigBytes&gt;e&amp;&amp;(b=a.finalize(b));<span class="cstat-no" title="statement not covered" >b</span>.clamp();<span class="cstat-no" title="statement not covered" >f</span>or(var f=this._oKey=b.clone(),g=this._iKey=b.clone(),h=f.words,j=g.words,d=0;d&lt;c;d++)<span class="cstat-no" title="statement not covered" >h[d]^=1549556828,j[d]^=909522486;<span class="cstat-no" title="statement not covered" >f</span></span>.sigBytes=g.sigBytes=e;<span class="cstat-no" title="statement not covered" >t</span>his.reset()}</span>,reset:<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var a=this._hasher;<span class="cstat-no" title="statement not covered" >a</span>.reset();<span class="cstat-no" title="statement not covered" >a</span>.update(this._iKey)}</span>,update:<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>this._hasher.update(a);<span class="cstat-no" title="statement not covered" >r</span>eturn this}</span>,finalize:<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>var b=</span>
this._hasher;<span class="cstat-no" title="statement not covered" >a=b.finalize(a);<span class="cstat-no" title="statement not covered" >b</span>.reset();<span class="cstat-no" title="statement not covered" >r</span>eturn b.finalize(this._oKey.clone().concat(a))}</span>})})();
&nbsp;
/*
CryptoJS v3.1.2 pbkdf2-min.js
code.google.com/p/crypto-js
(c) 2009-2013 by Jeff Mott. All rights reserved.
code.google.com/p/crypto-js/wiki/License
*/
(function(){var b=CryptoJS,a=b.lib,d=a.Base,m=a.WordArray,a=b.algo,q=a.HMAC,l=a.PBKDF2=d.extend({cfg:d.extend({keySize:4,hasher:a.SHA1,iterations:1}),init:<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>this.cfg=this.cfg.extend(a)}</span>,compute:<span class="fstat-no" title="function not covered" >function(a,b){<span class="cstat-no" title="statement not covered" ></span>for(var c=this.cfg,f=q.create(c.hasher,a),g=m.create(),d=m.create([1]),l=g.words,r=d.words,n=c.keySize,c=c.iterations;l.length&lt;n;){<span class="cstat-no" title="statement not covered" >var h=f.update(b).finalize(d);<span class="cstat-no" title="statement not covered" >f</span>.reset();<span class="cstat-no" title="statement not covered" >f</span>or(var j=h.words,s=j.length,k=h,p=1;p&lt;c;p++){<span class="cstat-no" title="statement not covered" >k=f.finalize(k);<span class="cstat-no" title="statement not covered" >f</span>.reset();<span class="cstat-no" title="statement not covered" >f</span>or(var t=k.words,e=0;e&lt;s;e++)<span class="cstat-no" title="statement not covered" >j[e]^=t[e]}<span class="cstat-no" title="statement not covered" ></span></span>g</span>.concat(h);</span></span>
<span class="cstat-no" title="statement not covered" >r[0]++}<span class="cstat-no" title="statement not covered" ></span>g.sigBytes=4*n;<span class="cstat-no" title="statement not covered" >r</span>eturn g}</span>});b.PBKDF2=<span class="fstat-no" title="function not covered" >function(a,b,c){<span class="cstat-no" title="statement not covered" ></span>return l.create(c).compute(a,b)}</span>})();
&nbsp;
/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */
var b64map="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var b64pad="=";<span class="fstat-no" title="function not covered" >function hex2b64(d){<span class="cstat-no" title="statement not covered" ></span>var b;<span class="cstat-no" title="statement not covered" >v</span>ar e;<span class="cstat-no" title="statement not covered" >v</span>ar a="";<span class="cstat-no" title="statement not covered" >f</span>or(b=0;b+3&lt;=d.length;b+=3){<span class="cstat-no" title="statement not covered" >e=parseInt(d.substring(b,b+3),16);<span class="cstat-no" title="statement not covered" >a</span>+=b64map.charAt(e&gt;&gt;6)+b64map.charAt(e&amp;63)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(b+1==d.length){<span class="cstat-no" title="statement not covered" >e=parseInt(d.substring(b,b+1),16);<span class="cstat-no" title="statement not covered" >a</span>+=b64map.charAt(e&lt;&lt;2)}</span>else{<span class="cstat-no" title="statement not covered" >if(b+2==d.length){<span class="cstat-no" title="statement not covered" >e=parseInt(d.substring(b,b+2),16);<span class="cstat-no" title="statement not covered" >a</span>+=b64map.charAt(e&gt;&gt;2)+b64map.charAt((e&amp;3)&lt;&lt;4)}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(b64pad){<span class="cstat-no" title="statement not covered" >while((a.length&amp;3)&gt;0){<span class="cstat-no" title="statement not covered" >a+=b64pad}</span>}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn a}<span class="fstat-no" title="function not covered" ></span>function b64tohex(f){<span class="cstat-no" title="statement not covered" ></span>var d="";<span class="cstat-no" title="statement not covered" >v</span>ar e;<span class="cstat-no" title="statement not covered" >v</span>ar b=0;<span class="cstat-no" title="statement not covered" >v</span>ar c;<span class="cstat-no" title="statement not covered" >v</span>ar a;<span class="cstat-no" title="statement not covered" >f</span>or(e=0;e&lt;f.length;++e){<span class="cstat-no" title="statement not covered" >if(f.charAt(e)==b64pad){<span class="cstat-no" title="statement not covered" >break}<span class="cstat-no" title="statement not covered" ></span>a</span>=b64map.indexOf(f.charAt(e));<span class="cstat-no" title="statement not covered" >i</span>f(a&lt;0){<span class="cstat-no" title="statement not covered" >continue}<span class="cstat-no" title="statement not covered" ></span>i</span>f(b==0){<span class="cstat-no" title="statement not covered" >d+=int2char(a&gt;&gt;2);<span class="cstat-no" title="statement not covered" >c</span>=a&amp;3;<span class="cstat-no" title="statement not covered" >b</span>=1}</span>else{<span class="cstat-no" title="statement not covered" >if(b==1){<span class="cstat-no" title="statement not covered" >d+=int2char((c&lt;&lt;2)|(a&gt;&gt;4));<span class="cstat-no" title="statement not covered" >c</span>=a&amp;15;<span class="cstat-no" title="statement not covered" >b</span>=2}</span>else{<span class="cstat-no" title="statement not covered" >if(b==2){<span class="cstat-no" title="statement not covered" >d+=int2char(c);<span class="cstat-no" title="statement not covered" >d</span>+=int2char(a&gt;&gt;2);<span class="cstat-no" title="statement not covered" >c</span>=a&amp;3;<span class="cstat-no" title="statement not covered" >b</span>=3}</span>else{<span class="cstat-no" title="statement not covered" >d+=int2char((c&lt;&lt;2)|(a&gt;&gt;4));<span class="cstat-no" title="statement not covered" >d</span>+=int2char(a&amp;15);<span class="cstat-no" title="statement not covered" >b</span>=0}</span>}</span>}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(b==1){<span class="cstat-no" title="statement not covered" >d+=int2char(c&lt;&lt;2)}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn d}<span class="fstat-no" title="function not covered" ></span>function b64toBA(e){<span class="cstat-no" title="statement not covered" ></span>var d=b64tohex(e);<span class="cstat-no" title="statement not covered" >v</span>ar c;<span class="cstat-no" title="statement not covered" >v</span>ar b=new Array();<span class="cstat-no" title="statement not covered" >f</span>or(c=0;2*c&lt;d.length;++c){<span class="cstat-no" title="statement not covered" >b[c]=parseInt(d.substring(2*c,2*c+2),16)}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn b}</span>;
/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */
var dbits;var canary=244837814094590;var j_lm=((canary&amp;16777215)==15715070);function BigInteger(e,d,f){if(e!=null){<span class="missing-if-branch" title="if path not taken" >I</span>if("number"==typeof e){<span class="cstat-no" title="statement not covered" >this.fromNumber(e,d,f)}</span>else{<span class="missing-if-branch" title="if path not taken" >I</span>if(d==null&amp;&amp;<span class="branch-1 cbranch-no" title="branch not covered" >"string"!=typeof e)</span>{<span class="cstat-no" title="statement not covered" >this.fromString(e,256)}</span>else{this.fromString(e,d)}}}}function nbi(){return new BigInteger(null)}<span class="fstat-no" title="function not covered" >function am1(f,a,b,e,h,g){<span class="cstat-no" title="statement not covered" ></span>while(--g&gt;=0){<span class="cstat-no" title="statement not covered" >var d=a*this[f++]+b[e]+h;<span class="cstat-no" title="statement not covered" >h</span>=Math.floor(d/67108864);<span class="cstat-no" title="statement not covered" >b</span>[e++]=d&amp;67108863}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn h}<span class="fstat-no" title="function not covered" ></span>function am2(f,q,r,e,o,a){<span class="cstat-no" title="statement not covered" ></span>var k=q&amp;32767,p=q&gt;&gt;15;<span class="cstat-no" title="statement not covered" >w</span>hile(--a&gt;=0){<span class="cstat-no" title="statement not covered" >var d=this[f]&amp;32767;<span class="cstat-no" title="statement not covered" >v</span>ar g=this[f++]&gt;&gt;15;<span class="cstat-no" title="statement not covered" >v</span>ar b=p*d+g*k;<span class="cstat-no" title="statement not covered" >d</span>=k*d+((b&amp;32767)&lt;&lt;15)+r[e]+(o&amp;1073741823);<span class="cstat-no" title="statement not covered" >o</span>=(d&gt;&gt;&gt;30)+(b&gt;&gt;&gt;15)+p*g+(o&gt;&gt;&gt;30);<span class="cstat-no" title="statement not covered" >r</span>[e++]=d&amp;1073741823}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn o}<span class="fstat-no" title="function not covered" ></span>function am3(f,q,r,e,o,a){<span class="cstat-no" title="statement not covered" ></span>var k=q&amp;16383,p=q&gt;&gt;14;<span class="cstat-no" title="statement not covered" >w</span>hile(--a&gt;=0){<span class="cstat-no" title="statement not covered" >var d=this[f]&amp;16383;<span class="cstat-no" title="statement not covered" >v</span>ar g=this[f++]&gt;&gt;14;<span class="cstat-no" title="statement not covered" >v</span>ar b=p*d+g*k;<span class="cstat-no" title="statement not covered" >d</span>=k*d+((b&amp;16383)&lt;&lt;14)+r[e]+o;<span class="cstat-no" title="statement not covered" >o</span>=(d&gt;&gt;28)+(b&gt;&gt;14)+p*g;<span class="cstat-no" title="statement not covered" >r</span>[e++]=d&amp;268435455}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn o}<span class="missing-if-branch" title="if path not taken" >I</span></span>if(j_lm&amp;&amp;(navigator.appName=="Microsoft Internet Explorer")){<span class="cstat-no" title="statement not covered" >BigInteger.prototype.am=am2;<span class="cstat-no" title="statement not covered" >d</span>bits=30}</span>else{<span class="missing-if-branch" title="else path not taken" >E</span>if(j_lm&amp;&amp;(navigator.appName!="Netscape")){BigInteger.prototype.am=am1;dbits=26}else{<span class="cstat-no" title="statement not covered" >BigInteger.prototype.am=am3;<span class="cstat-no" title="statement not covered" >d</span>bits=28}</span>}BigInteger.prototype.DB=dbits;BigInteger.prototype.DM=((1&lt;&lt;dbits)-1);BigInteger.prototype.DV=(1&lt;&lt;dbits);var BI_FP=52;BigInteger.prototype.FV=Math.pow(2,BI_FP);BigInteger.prototype.F1=BI_FP-dbits;BigInteger.prototype.F2=2*dbits-BI_FP;var BI_RM="0123456789abcdefghijklmnopqrstuvwxyz";var BI_RC=new Array();var rr,vv;rr="0".charCodeAt(0);for(vv=0;vv&lt;=9;++vv){BI_RC[rr++]=vv}rr="a".charCodeAt(0);for(vv=10;vv&lt;36;++vv){BI_RC[rr++]=vv}rr="A".charCodeAt(0);for(vv=10;vv&lt;36;++vv){BI_RC[rr++]=vv}<span class="fstat-no" title="function not covered" >function int2char(a){<span class="cstat-no" title="statement not covered" ></span>return BI_RM.charAt(a)}</span>function intAt(b,a){var d=BI_RC[b.charCodeAt(a)];return(d==null)?<span class="branch-0 cbranch-no" title="branch not covered" >-1:</span>d}<span class="fstat-no" title="function not covered" >function bnpCopyTo(b){<span class="cstat-no" title="statement not covered" ></span>for(var a=this.t-1;a&gt;=0;--a){<span class="cstat-no" title="statement not covered" >b[a]=this[a]}<span class="cstat-no" title="statement not covered" ></span>b</span>.t=this.t;<span class="cstat-no" title="statement not covered" >b</span>.s=this.s}</span>function bnpFromInt(a){this.t=1;this.s=(a&lt;0)?<span class="branch-0 cbranch-no" title="branch not covered" >-1:</span>0;if(a&gt;0){this[0]=a}else{<span class="missing-if-branch" title="if path not taken" >I</span>if(a&lt;-1){<span class="cstat-no" title="statement not covered" >this[0]=a+this.DV}</span>else{this.t=0}}}function nbv(a){var b=nbi();b.fromInt(a);return b}function bnpFromString(h,c){var e;<span class="missing-if-branch" title="else path not taken" >E</span>if(c==16){e=4}else{<span class="cstat-no" title="statement not covered" >if(c==8){<span class="cstat-no" title="statement not covered" >e=3}</span>else{<span class="cstat-no" title="statement not covered" >if(c==256){<span class="cstat-no" title="statement not covered" >e=8}</span>else{<span class="cstat-no" title="statement not covered" >if(c==2){<span class="cstat-no" title="statement not covered" >e=1}</span>else{<span class="cstat-no" title="statement not covered" >if(c==32){<span class="cstat-no" title="statement not covered" >e=5}</span>else{<span class="cstat-no" title="statement not covered" >if(c==4){<span class="cstat-no" title="statement not covered" >e=2}</span>else{<span class="cstat-no" title="statement not covered" >this.fromRadix(h,c);<span class="cstat-no" title="statement not covered" >r</span>eturn}</span>}</span>}</span>}</span>}</span>}</span>this.t=0;this.s=0;var g=h.length,d=false,f=0;while(--g&gt;=0){var a=(e==8)?<span class="branch-0 cbranch-no" title="branch not covered" >h[g]&amp;255:</span>intAt(h,g);<span class="missing-if-branch" title="if path not taken" >I</span>if(a&lt;0){<span class="cstat-no" title="statement not covered" >if(h.charAt(g)=="-"){<span class="cstat-no" title="statement not covered" >d=true}<span class="cstat-no" title="statement not covered" ></span>c</span>ontinue}</span>d=false;if(f==0){this[this.t++]=a}else{if(f+e&gt;this.DB){this[this.t-1]|=(a&amp;((1&lt;&lt;(this.DB-f))-1))&lt;&lt;f;this[this.t++]=(a&gt;&gt;(this.DB-f))}else{this[this.t-1]|=a&lt;&lt;f}}f+=e;if(f&gt;=this.DB){f-=this.DB}}<span class="missing-if-branch" title="if path not taken" >I</span>if(e==8&amp;&amp;<span class="branch-1 cbranch-no" title="branch not covered" >(h[0]&amp;128)!=0)</span>{<span class="cstat-no" title="statement not covered" >this.s=-1;<span class="cstat-no" title="statement not covered" >i</span>f(f&gt;0){<span class="cstat-no" title="statement not covered" >this[this.t-1]|=((1&lt;&lt;(this.DB-f))-1)&lt;&lt;f}</span>}</span>this.clamp();<span class="missing-if-branch" title="if path not taken" >I</span>if(d){<span class="cstat-no" title="statement not covered" >BigInteger.ZERO.subTo(this,this)}</span>}function bnpClamp(){var a=this.s&amp;this.DM;while(this.t&gt;0&amp;&amp;this[this.t-1]==a){--this.t}}<span class="fstat-no" title="function not covered" >function bnToString(c){<span class="cstat-no" title="statement not covered" ></span>if(this.s&lt;0){<span class="cstat-no" title="statement not covered" >return"-"+this.negate().toString(c)}<span class="cstat-no" title="statement not covered" ></span>v</span>ar e;<span class="cstat-no" title="statement not covered" >i</span>f(c==16){<span class="cstat-no" title="statement not covered" >e=4}</span>else{<span class="cstat-no" title="statement not covered" >if(c==8){<span class="cstat-no" title="statement not covered" >e=3}</span>else{<span class="cstat-no" title="statement not covered" >if(c==2){<span class="cstat-no" title="statement not covered" >e=1}</span>else{<span class="cstat-no" title="statement not covered" >if(c==32){<span class="cstat-no" title="statement not covered" >e=5}</span>else{<span class="cstat-no" title="statement not covered" >if(c==4){<span class="cstat-no" title="statement not covered" >e=2}</span>else{<span class="cstat-no" title="statement not covered" >return this.toRadix(c)}</span>}</span>}</span>}</span>}<span class="cstat-no" title="statement not covered" ></span>v</span>ar g=(1&lt;&lt;e)-1,l,a=false,h="",f=this.t;<span class="cstat-no" title="statement not covered" >v</span>ar j=this.DB-(f*this.DB)%e;<span class="cstat-no" title="statement not covered" >i</span>f(f--&gt;0){<span class="cstat-no" title="statement not covered" >if(j&lt;this.DB&amp;&amp;(l=this[f]&gt;&gt;j)&gt;0){<span class="cstat-no" title="statement not covered" >a=true;<span class="cstat-no" title="statement not covered" >h</span>=int2char(l)}<span class="cstat-no" title="statement not covered" ></span>w</span>hile(f&gt;=0){<span class="cstat-no" title="statement not covered" >if(j&lt;e){<span class="cstat-no" title="statement not covered" >l=(this[f]&amp;((1&lt;&lt;j)-1))&lt;&lt;(e-j);<span class="cstat-no" title="statement not covered" >l</span>|=this[--f]&gt;&gt;(j+=this.DB-e)}</span>else{<span class="cstat-no" title="statement not covered" >l=(this[f]&gt;&gt;(j-=e))&amp;g;<span class="cstat-no" title="statement not covered" >i</span>f(j&lt;=0){<span class="cstat-no" title="statement not covered" >j+=this.DB;<span class="cstat-no" title="statement not covered" >-</span>-f}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(l&gt;0){<span class="cstat-no" title="statement not covered" >a=true}<span class="cstat-no" title="statement not covered" ></span>i</span>f(a){<span class="cstat-no" title="statement not covered" >h+=int2char(l)}</span>}</span>}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn a?h:"0"}<span class="fstat-no" title="function not covered" ></span>function bnNegate(){<span class="cstat-no" title="statement not covered" ></span>var a=nbi();<span class="cstat-no" title="statement not covered" >B</span>igInteger.ZERO.subTo(this,a);<span class="cstat-no" title="statement not covered" >r</span>eturn a}<span class="fstat-no" title="function not covered" ></span>function bnAbs(){<span class="cstat-no" title="statement not covered" ></span>return(this.s&lt;0)?this.negate():this}<span class="fstat-no" title="function not covered" ></span>function bnCompareTo(b){<span class="cstat-no" title="statement not covered" ></span>var d=this.s-b.s;<span class="cstat-no" title="statement not covered" >i</span>f(d!=0){<span class="cstat-no" title="statement not covered" >return d}<span class="cstat-no" title="statement not covered" ></span>v</span>ar c=this.t;<span class="cstat-no" title="statement not covered" >d</span>=c-b.t;<span class="cstat-no" title="statement not covered" >i</span>f(d!=0){<span class="cstat-no" title="statement not covered" >return(this.s&lt;0)?-d:d}<span class="cstat-no" title="statement not covered" ></span>w</span>hile(--c&gt;=0){<span class="cstat-no" title="statement not covered" >if((d=this[c]-b[c])!=0){<span class="cstat-no" title="statement not covered" >return d}</span>}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn 0}<span class="fstat-no" title="function not covered" ></span>function nbits(a){<span class="cstat-no" title="statement not covered" ></span>var c=1,b;<span class="cstat-no" title="statement not covered" >i</span>f((b=a&gt;&gt;&gt;16)!=0){<span class="cstat-no" title="statement not covered" >a=b;<span class="cstat-no" title="statement not covered" >c</span>+=16}<span class="cstat-no" title="statement not covered" ></span>i</span>f((b=a&gt;&gt;8)!=0){<span class="cstat-no" title="statement not covered" >a=b;<span class="cstat-no" title="statement not covered" >c</span>+=8}<span class="cstat-no" title="statement not covered" ></span>i</span>f((b=a&gt;&gt;4)!=0){<span class="cstat-no" title="statement not covered" >a=b;<span class="cstat-no" title="statement not covered" >c</span>+=4}<span class="cstat-no" title="statement not covered" ></span>i</span>f((b=a&gt;&gt;2)!=0){<span class="cstat-no" title="statement not covered" >a=b;<span class="cstat-no" title="statement not covered" >c</span>+=2}<span class="cstat-no" title="statement not covered" ></span>i</span>f((b=a&gt;&gt;1)!=0){<span class="cstat-no" title="statement not covered" >a=b;<span class="cstat-no" title="statement not covered" >c</span>+=1}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn c}<span class="fstat-no" title="function not covered" ></span>function bnBitLength(){<span class="cstat-no" title="statement not covered" ></span>if(this.t&lt;=0){<span class="cstat-no" title="statement not covered" >return 0}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn this.DB*(this.t-1)+nbits(this[this.t-1]^(this.s&amp;this.DM))}<span class="fstat-no" title="function not covered" ></span>function bnpDLShiftTo(c,b){<span class="cstat-no" title="statement not covered" ></span>var a;<span class="cstat-no" title="statement not covered" >f</span>or(a=this.t-1;a&gt;=0;--a){<span class="cstat-no" title="statement not covered" >b[a+c]=this[a]}<span class="cstat-no" title="statement not covered" ></span>f</span>or(a=c-1;a&gt;=0;--a){<span class="cstat-no" title="statement not covered" >b[a]=0}<span class="cstat-no" title="statement not covered" ></span>b</span>.t=this.t+c;<span class="cstat-no" title="statement not covered" >b</span>.s=this.s}<span class="fstat-no" title="function not covered" ></span>function bnpDRShiftTo(c,b){<span class="cstat-no" title="statement not covered" ></span>for(var a=c;a&lt;this.t;++a){<span class="cstat-no" title="statement not covered" >b[a-c]=this[a]}<span class="cstat-no" title="statement not covered" ></span>b</span>.t=Math.max(this.t-c,0);<span class="cstat-no" title="statement not covered" >b</span>.s=this.s}<span class="fstat-no" title="function not covered" ></span>function bnpLShiftTo(j,e){<span class="cstat-no" title="statement not covered" ></span>var b=j%this.DB;<span class="cstat-no" title="statement not covered" >v</span>ar a=this.DB-b;<span class="cstat-no" title="statement not covered" >v</span>ar g=(1&lt;&lt;a)-1;<span class="cstat-no" title="statement not covered" >v</span>ar f=Math.floor(j/this.DB),h=(this.s&lt;&lt;b)&amp;this.DM,d;<span class="cstat-no" title="statement not covered" >f</span>or(d=this.t-1;d&gt;=0;--d){<span class="cstat-no" title="statement not covered" >e[d+f+1]=(this[d]&gt;&gt;a)|h;<span class="cstat-no" title="statement not covered" >h</span>=(this[d]&amp;g)&lt;&lt;b}<span class="cstat-no" title="statement not covered" ></span>f</span>or(d=f-1;d&gt;=0;--d){<span class="cstat-no" title="statement not covered" >e[d]=0}<span class="cstat-no" title="statement not covered" ></span>e</span>[f]=h;<span class="cstat-no" title="statement not covered" >e</span>.t=this.t+f+1;<span class="cstat-no" title="statement not covered" >e</span>.s=this.s;<span class="cstat-no" title="statement not covered" >e</span>.clamp()}<span class="fstat-no" title="function not covered" ></span>function bnpRShiftTo(g,d){<span class="cstat-no" title="statement not covered" ></span>d.s=this.s;<span class="cstat-no" title="statement not covered" >v</span>ar e=Math.floor(g/this.DB);<span class="cstat-no" title="statement not covered" >i</span>f(e&gt;=this.t){<span class="cstat-no" title="statement not covered" >d.t=0;<span class="cstat-no" title="statement not covered" >r</span>eturn}<span class="cstat-no" title="statement not covered" ></span>v</span>ar b=g%this.DB;<span class="cstat-no" title="statement not covered" >v</span>ar a=this.DB-b;<span class="cstat-no" title="statement not covered" >v</span>ar f=(1&lt;&lt;b)-1;<span class="cstat-no" title="statement not covered" >d</span>[0]=this[e]&gt;&gt;b;<span class="cstat-no" title="statement not covered" >f</span>or(var c=e+1;c&lt;this.t;++c){<span class="cstat-no" title="statement not covered" >d[c-e-1]|=(this[c]&amp;f)&lt;&lt;a;<span class="cstat-no" title="statement not covered" >d</span>[c-e]=this[c]&gt;&gt;b}<span class="cstat-no" title="statement not covered" ></span>i</span>f(b&gt;0){<span class="cstat-no" title="statement not covered" >d[this.t-e-1]|=(this.s&amp;f)&lt;&lt;a}<span class="cstat-no" title="statement not covered" ></span>d</span>.t=this.t-e;<span class="cstat-no" title="statement not covered" >d</span>.clamp()}<span class="fstat-no" title="function not covered" ></span>function bnpSubTo(d,f){<span class="cstat-no" title="statement not covered" ></span>var e=0,g=0,b=Math.min(d.t,this.t);<span class="cstat-no" title="statement not covered" >w</span>hile(e&lt;b){<span class="cstat-no" title="statement not covered" >g+=this[e]-d[e];<span class="cstat-no" title="statement not covered" >f</span>[e++]=g&amp;this.DM;<span class="cstat-no" title="statement not covered" >g</span>&gt;&gt;=this.DB}<span class="cstat-no" title="statement not covered" ></span>i</span>f(d.t&lt;this.t){<span class="cstat-no" title="statement not covered" >g-=d.s;<span class="cstat-no" title="statement not covered" >w</span>hile(e&lt;this.t){<span class="cstat-no" title="statement not covered" >g+=this[e];<span class="cstat-no" title="statement not covered" >f</span>[e++]=g&amp;this.DM;<span class="cstat-no" title="statement not covered" >g</span>&gt;&gt;=this.DB}<span class="cstat-no" title="statement not covered" ></span>g</span>+=this.s}</span>else{<span class="cstat-no" title="statement not covered" >g+=this.s;<span class="cstat-no" title="statement not covered" >w</span>hile(e&lt;d.t){<span class="cstat-no" title="statement not covered" >g-=d[e];<span class="cstat-no" title="statement not covered" >f</span>[e++]=g&amp;this.DM;<span class="cstat-no" title="statement not covered" >g</span>&gt;&gt;=this.DB}<span class="cstat-no" title="statement not covered" ></span>g</span>-=d.s}<span class="cstat-no" title="statement not covered" ></span>f</span>.s=(g&lt;0)?-1:0;<span class="cstat-no" title="statement not covered" >i</span>f(g&lt;-1){<span class="cstat-no" title="statement not covered" >f[e++]=this.DV+g}</span>else{<span class="cstat-no" title="statement not covered" >if(g&gt;0){<span class="cstat-no" title="statement not covered" >f[e++]=g}</span>}<span class="cstat-no" title="statement not covered" ></span>f</span>.t=e;<span class="cstat-no" title="statement not covered" >f</span>.clamp()}<span class="fstat-no" title="function not covered" ></span>function bnpMultiplyTo(c,e){<span class="cstat-no" title="statement not covered" ></span>var b=this.abs(),f=c.abs();<span class="cstat-no" title="statement not covered" >v</span>ar d=b.t;<span class="cstat-no" title="statement not covered" >e</span>.t=d+f.t;<span class="cstat-no" title="statement not covered" >w</span>hile(--d&gt;=0){<span class="cstat-no" title="statement not covered" >e[d]=0}<span class="cstat-no" title="statement not covered" ></span>f</span>or(d=0;d&lt;f.t;++d){<span class="cstat-no" title="statement not covered" >e[d+b.t]=b.am(0,f[d],e,d,0,b.t)}<span class="cstat-no" title="statement not covered" ></span>e</span>.s=0;<span class="cstat-no" title="statement not covered" >e</span>.clamp();<span class="cstat-no" title="statement not covered" >i</span>f(this.s!=c.s){<span class="cstat-no" title="statement not covered" >BigInteger.ZERO.subTo(e,e)}</span>}<span class="fstat-no" title="function not covered" ></span>function bnpSquareTo(d){<span class="cstat-no" title="statement not covered" ></span>var a=this.abs();<span class="cstat-no" title="statement not covered" >v</span>ar b=d.t=2*a.t;<span class="cstat-no" title="statement not covered" >w</span>hile(--b&gt;=0){<span class="cstat-no" title="statement not covered" >d[b]=0}<span class="cstat-no" title="statement not covered" ></span>f</span>or(b=0;b&lt;a.t-1;++b){<span class="cstat-no" title="statement not covered" >var e=a.am(b,a[b],d,2*b,0,1);<span class="cstat-no" title="statement not covered" >i</span>f((d[b+a.t]+=a.am(b+1,2*a[b],d,2*b+1,e,a.t-b-1))&gt;=a.DV){<span class="cstat-no" title="statement not covered" >d[b+a.t]-=a.DV;<span class="cstat-no" title="statement not covered" >d</span>[b+a.t+1]=1}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(d.t&gt;0){<span class="cstat-no" title="statement not covered" >d[d.t-1]+=a.am(b,a[b],d,2*b,0,1)}<span class="cstat-no" title="statement not covered" ></span>d</span>.s=0;<span class="cstat-no" title="statement not covered" >d</span>.clamp()}<span class="fstat-no" title="function not covered" ></span>function bnpDivRemTo(n,h,g){<span class="cstat-no" title="statement not covered" ></span>var w=n.abs();<span class="cstat-no" title="statement not covered" >i</span>f(w.t&lt;=0){<span class="cstat-no" title="statement not covered" >return}<span class="cstat-no" title="statement not covered" ></span>v</span>ar k=this.abs();<span class="cstat-no" title="statement not covered" >i</span>f(k.t&lt;w.t){<span class="cstat-no" title="statement not covered" >if(h!=null){<span class="cstat-no" title="statement not covered" >h.fromInt(0)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(g!=null){<span class="cstat-no" title="statement not covered" >this.copyTo(g)}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn}<span class="cstat-no" title="statement not covered" ></span>i</span>f(g==null){<span class="cstat-no" title="statement not covered" >g=nbi()}<span class="cstat-no" title="statement not covered" ></span>v</span>ar d=nbi(),a=this.s,l=n.s;<span class="cstat-no" title="statement not covered" >v</span>ar v=this.DB-nbits(w[w.t-1]);<span class="cstat-no" title="statement not covered" >i</span>f(v&gt;0){<span class="cstat-no" title="statement not covered" >w.lShiftTo(v,d);<span class="cstat-no" title="statement not covered" >k</span>.lShiftTo(v,g)}</span>else{<span class="cstat-no" title="statement not covered" >w.copyTo(d);<span class="cstat-no" title="statement not covered" >k</span>.copyTo(g)}<span class="cstat-no" title="statement not covered" ></span>v</span>ar p=d.t;<span class="cstat-no" title="statement not covered" >v</span>ar b=d[p-1];<span class="cstat-no" title="statement not covered" >i</span>f(b==0){<span class="cstat-no" title="statement not covered" >return}<span class="cstat-no" title="statement not covered" ></span>v</span>ar o=b*(1&lt;&lt;this.F1)+((p&gt;1)?d[p-2]&gt;&gt;this.F2:0);<span class="cstat-no" title="statement not covered" >v</span>ar A=this.FV/o,z=(1&lt;&lt;this.F1)/o,x=1&lt;&lt;this.F2;<span class="cstat-no" title="statement not covered" >v</span>ar u=g.t,s=u-p,f=(h==null)?nbi():h;<span class="cstat-no" title="statement not covered" >d</span>.dlShiftTo(s,f);<span class="cstat-no" title="statement not covered" >i</span>f(g.compareTo(f)&gt;=0){<span class="cstat-no" title="statement not covered" >g[g.t++]=1;<span class="cstat-no" title="statement not covered" >g</span>.subTo(f,g)}<span class="cstat-no" title="statement not covered" ></span>B</span>igInteger.ONE.dlShiftTo(p,f);<span class="cstat-no" title="statement not covered" >f</span>.subTo(d,d);<span class="cstat-no" title="statement not covered" >w</span>hile(d.t&lt;p){<span class="cstat-no" title="statement not covered" >d[d.t++]=0}<span class="cstat-no" title="statement not covered" ></span>w</span>hile(--s&gt;=0){<span class="cstat-no" title="statement not covered" >var c=(g[--u]==b)?this.DM:Math.floor(g[u]*A+(g[u-1]+x)*z);<span class="cstat-no" title="statement not covered" >i</span>f((g[u]+=d.am(0,c,g,s,0,p))&lt;c){<span class="cstat-no" title="statement not covered" >d.dlShiftTo(s,f);<span class="cstat-no" title="statement not covered" >g</span>.subTo(f,g);<span class="cstat-no" title="statement not covered" >w</span>hile(g[u]&lt;--c){<span class="cstat-no" title="statement not covered" >g.subTo(f,g)}</span>}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(h!=null){<span class="cstat-no" title="statement not covered" >g.drShiftTo(p,h);<span class="cstat-no" title="statement not covered" >i</span>f(a!=l){<span class="cstat-no" title="statement not covered" >BigInteger.ZERO.subTo(h,h)}</span>}<span class="cstat-no" title="statement not covered" ></span>g</span>.t=p;<span class="cstat-no" title="statement not covered" >g</span>.clamp();<span class="cstat-no" title="statement not covered" >i</span>f(v&gt;0){<span class="cstat-no" title="statement not covered" >g.rShiftTo(v,g)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(a&lt;0){<span class="cstat-no" title="statement not covered" >BigInteger.ZERO.subTo(g,g)}</span>}<span class="fstat-no" title="function not covered" ></span>function bnMod(b){<span class="cstat-no" title="statement not covered" ></span>var c=nbi();<span class="cstat-no" title="statement not covered" >t</span>his.abs().divRemTo(b,null,c);<span class="cstat-no" title="statement not covered" >i</span>f(this.s&lt;0&amp;&amp;c.compareTo(BigInteger.ZERO)&gt;0){<span class="cstat-no" title="statement not covered" >b.subTo(c,c)}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn c}<span class="fstat-no" title="function not covered" ></span>function Classic(a){<span class="cstat-no" title="statement not covered" ></span>this.m=a}<span class="fstat-no" title="function not covered" ></span>function cConvert(a){<span class="cstat-no" title="statement not covered" ></span>if(a.s&lt;0||a.compareTo(this.m)&gt;=0){<span class="cstat-no" title="statement not covered" >return a.mod(this.m)}</span>else{<span class="cstat-no" title="statement not covered" >return a}</span>}<span class="fstat-no" title="function not covered" ></span>function cRevert(a){<span class="cstat-no" title="statement not covered" ></span>return a}<span class="fstat-no" title="function not covered" ></span>function cReduce(a){<span class="cstat-no" title="statement not covered" ></span>a.divRemTo(this.m,null,a)}<span class="fstat-no" title="function not covered" ></span>function cMulTo(a,c,b){<span class="cstat-no" title="statement not covered" ></span>a.multiplyTo(c,b);<span class="cstat-no" title="statement not covered" >t</span>his.reduce(b)}<span class="fstat-no" title="function not covered" ></span>function cSqrTo(a,b){<span class="cstat-no" title="statement not covered" ></span>a.squareTo(b);<span class="cstat-no" title="statement not covered" >t</span>his.reduce(b)}</span>Classic.prototype.convert=cConvert;Classic.prototype.revert=cRevert;Classic.prototype.reduce=cReduce;Classic.prototype.mulTo=cMulTo;Classic.prototype.sqrTo=cSqrTo;<span class="fstat-no" title="function not covered" >function bnpInvDigit(){<span class="cstat-no" title="statement not covered" ></span>if(this.t&lt;1){<span class="cstat-no" title="statement not covered" >return 0}<span class="cstat-no" title="statement not covered" ></span>v</span>ar a=this[0];<span class="cstat-no" title="statement not covered" >i</span>f((a&amp;1)==0){<span class="cstat-no" title="statement not covered" >return 0}<span class="cstat-no" title="statement not covered" ></span>v</span>ar b=a&amp;3;<span class="cstat-no" title="statement not covered" >b</span>=(b*(2-(a&amp;15)*b))&amp;15;<span class="cstat-no" title="statement not covered" >b</span>=(b*(2-(a&amp;255)*b))&amp;255;<span class="cstat-no" title="statement not covered" >b</span>=(b*(2-(((a&amp;65535)*b)&amp;65535)))&amp;65535;<span class="cstat-no" title="statement not covered" >b</span>=(b*(2-a*b%this.DV))%this.DV;<span class="cstat-no" title="statement not covered" >r</span>eturn(b&gt;0)?this.DV-b:-b}<span class="fstat-no" title="function not covered" ></span>function Montgomery(a){<span class="cstat-no" title="statement not covered" ></span>this.m=a;<span class="cstat-no" title="statement not covered" >t</span>his.mp=a.invDigit();<span class="cstat-no" title="statement not covered" >t</span>his.mpl=this.mp&amp;32767;<span class="cstat-no" title="statement not covered" >t</span>his.mph=this.mp&gt;&gt;15;<span class="cstat-no" title="statement not covered" >t</span>his.um=(1&lt;&lt;(a.DB-15))-1;<span class="cstat-no" title="statement not covered" >t</span>his.mt2=2*a.t}<span class="fstat-no" title="function not covered" ></span>function montConvert(a){<span class="cstat-no" title="statement not covered" ></span>var b=nbi();<span class="cstat-no" title="statement not covered" >a</span>.abs().dlShiftTo(this.m.t,b);<span class="cstat-no" title="statement not covered" >b</span>.divRemTo(this.m,null,b);<span class="cstat-no" title="statement not covered" >i</span>f(a.s&lt;0&amp;&amp;b.compareTo(BigInteger.ZERO)&gt;0){<span class="cstat-no" title="statement not covered" >this.m.subTo(b,b)}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn b}<span class="fstat-no" title="function not covered" ></span>function montRevert(a){<span class="cstat-no" title="statement not covered" ></span>var b=nbi();<span class="cstat-no" title="statement not covered" >a</span>.copyTo(b);<span class="cstat-no" title="statement not covered" >t</span>his.reduce(b);<span class="cstat-no" title="statement not covered" >r</span>eturn b}<span class="fstat-no" title="function not covered" ></span>function montReduce(a){<span class="cstat-no" title="statement not covered" ></span>while(a.t&lt;=this.mt2){<span class="cstat-no" title="statement not covered" >a[a.t++]=0}<span class="cstat-no" title="statement not covered" ></span>f</span>or(var c=0;c&lt;this.m.t;++c){<span class="cstat-no" title="statement not covered" >var b=a[c]&amp;32767;<span class="cstat-no" title="statement not covered" >v</span>ar d=(b*this.mpl+(((b*this.mph+(a[c]&gt;&gt;15)*this.mpl)&amp;this.um)&lt;&lt;15))&amp;a.DM;<span class="cstat-no" title="statement not covered" >b</span>=c+this.m.t;<span class="cstat-no" title="statement not covered" >a</span>[b]+=this.m.am(0,d,a,c,0,this.m.t);<span class="cstat-no" title="statement not covered" >w</span>hile(a[b]&gt;=a.DV){<span class="cstat-no" title="statement not covered" >a[b]-=a.DV;<span class="cstat-no" title="statement not covered" >a</span>[++b]++}</span>}<span class="cstat-no" title="statement not covered" ></span>a</span>.clamp();<span class="cstat-no" title="statement not covered" >a</span>.drShiftTo(this.m.t,a);<span class="cstat-no" title="statement not covered" >i</span>f(a.compareTo(this.m)&gt;=0){<span class="cstat-no" title="statement not covered" >a.subTo(this.m,a)}</span>}<span class="fstat-no" title="function not covered" ></span>function montSqrTo(a,b){<span class="cstat-no" title="statement not covered" ></span>a.squareTo(b);<span class="cstat-no" title="statement not covered" >t</span>his.reduce(b)}<span class="fstat-no" title="function not covered" ></span>function montMulTo(a,c,b){<span class="cstat-no" title="statement not covered" ></span>a.multiplyTo(c,b);<span class="cstat-no" title="statement not covered" >t</span>his.reduce(b)}</span>Montgomery.prototype.convert=montConvert;Montgomery.prototype.revert=montRevert;Montgomery.prototype.reduce=montReduce;Montgomery.prototype.mulTo=montMulTo;Montgomery.prototype.sqrTo=montSqrTo;<span class="fstat-no" title="function not covered" >function bnpIsEven(){<span class="cstat-no" title="statement not covered" ></span>return((this.t&gt;0)?(this[0]&amp;1):this.s)==0}<span class="fstat-no" title="function not covered" ></span>function bnpExp(h,j){<span class="cstat-no" title="statement not covered" ></span>if(h&gt;4294967295||h&lt;1){<span class="cstat-no" title="statement not covered" >return BigInteger.ONE}<span class="cstat-no" title="statement not covered" ></span>v</span>ar f=nbi(),a=nbi(),d=j.convert(this),c=nbits(h)-1;<span class="cstat-no" title="statement not covered" >d</span>.copyTo(f);<span class="cstat-no" title="statement not covered" >w</span>hile(--c&gt;=0){<span class="cstat-no" title="statement not covered" >j.sqrTo(f,a);<span class="cstat-no" title="statement not covered" >i</span>f((h&amp;(1&lt;&lt;c))&gt;0){<span class="cstat-no" title="statement not covered" >j.mulTo(a,d,f)}</span>else{<span class="cstat-no" title="statement not covered" >var b=f;<span class="cstat-no" title="statement not covered" >f</span>=a;<span class="cstat-no" title="statement not covered" >a</span>=b}</span>}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn j.revert(f)}<span class="fstat-no" title="function not covered" ></span>function bnModPowInt(b,a){<span class="cstat-no" title="statement not covered" ></span>var c;<span class="cstat-no" title="statement not covered" >i</span>f(b&lt;256||a.isEven()){<span class="cstat-no" title="statement not covered" >c=new Classic(a)}</span>else{<span class="cstat-no" title="statement not covered" >c=new Montgomery(a)}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn this.exp(b,c)}</span>BigInteger.prototype.copyTo=bnpCopyTo;BigInteger.prototype.fromInt=bnpFromInt;BigInteger.prototype.fromString=bnpFromString;BigInteger.prototype.clamp=bnpClamp;BigInteger.prototype.dlShiftTo=bnpDLShiftTo;BigInteger.prototype.drShiftTo=bnpDRShiftTo;BigInteger.prototype.lShiftTo=bnpLShiftTo;BigInteger.prototype.rShiftTo=bnpRShiftTo;BigInteger.prototype.subTo=bnpSubTo;BigInteger.prototype.multiplyTo=bnpMultiplyTo;BigInteger.prototype.squareTo=bnpSquareTo;BigInteger.prototype.divRemTo=bnpDivRemTo;BigInteger.prototype.invDigit=bnpInvDigit;BigInteger.prototype.isEven=bnpIsEven;BigInteger.prototype.exp=bnpExp;BigInteger.prototype.toString=bnToString;BigInteger.prototype.negate=bnNegate;BigInteger.prototype.abs=bnAbs;BigInteger.prototype.compareTo=bnCompareTo;BigInteger.prototype.bitLength=bnBitLength;BigInteger.prototype.mod=bnMod;BigInteger.prototype.modPowInt=bnModPowInt;BigInteger.ZERO=nbv(0);BigInteger.ONE=nbv(1);
/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */
<span class="fstat-no" title="function not covered" >function bnClone(){<span class="cstat-no" title="statement not covered" ></span>var a=nbi();<span class="cstat-no" title="statement not covered" >t</span>his.copyTo(a);<span class="cstat-no" title="statement not covered" >r</span>eturn a}<span class="fstat-no" title="function not covered" ></span>function bnIntValue(){<span class="cstat-no" title="statement not covered" ></span>if(this.s&lt;0){<span class="cstat-no" title="statement not covered" >if(this.t==1){<span class="cstat-no" title="statement not covered" >return this[0]-this.DV}</span>else{<span class="cstat-no" title="statement not covered" >if(this.t==0){<span class="cstat-no" title="statement not covered" >return -1}</span>}</span>}</span>else{<span class="cstat-no" title="statement not covered" >if(this.t==1){<span class="cstat-no" title="statement not covered" >return this[0]}</span>else{<span class="cstat-no" title="statement not covered" >if(this.t==0){<span class="cstat-no" title="statement not covered" >return 0}</span>}</span>}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn((this[1]&amp;((1&lt;&lt;(32-this.DB))-1))&lt;&lt;this.DB)|this[0]}<span class="fstat-no" title="function not covered" ></span>function bnByteValue(){<span class="cstat-no" title="statement not covered" ></span>return(this.t==0)?this.s:(this[0]&lt;&lt;24)&gt;&gt;24}<span class="fstat-no" title="function not covered" ></span>function bnShortValue(){<span class="cstat-no" title="statement not covered" ></span>return(this.t==0)?this.s:(this[0]&lt;&lt;16)&gt;&gt;16}<span class="fstat-no" title="function not covered" ></span>function bnpChunkSize(a){<span class="cstat-no" title="statement not covered" ></span>return Math.floor(Math.LN2*this.DB/Math.log(a))}<span class="fstat-no" title="function not covered" ></span>function bnSigNum(){<span class="cstat-no" title="statement not covered" ></span>if(this.s&lt;0){<span class="cstat-no" title="statement not covered" >return -1}</span>else{<span class="cstat-no" title="statement not covered" >if(this.t&lt;=0||(this.t==1&amp;&amp;this[0]&lt;=0)){<span class="cstat-no" title="statement not covered" >return 0}</span>else{<span class="cstat-no" title="statement not covered" >return 1}</span>}</span>}<span class="fstat-no" title="function not covered" ></span>function bnpToRadix(c){<span class="cstat-no" title="statement not covered" ></span>if(c==null){<span class="cstat-no" title="statement not covered" >c=10}<span class="cstat-no" title="statement not covered" ></span>i</span>f(this.signum()==0||c&lt;2||c&gt;36){<span class="cstat-no" title="statement not covered" >return"0"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar f=this.chunkSize(c);<span class="cstat-no" title="statement not covered" >v</span>ar e=Math.pow(c,f);<span class="cstat-no" title="statement not covered" >v</span>ar i=nbv(e),j=nbi(),h=nbi(),g="";<span class="cstat-no" title="statement not covered" >t</span>his.divRemTo(i,j,h);<span class="cstat-no" title="statement not covered" >w</span>hile(j.signum()&gt;0){<span class="cstat-no" title="statement not covered" >g=(e+h.intValue()).toString(c).substr(1)+g;<span class="cstat-no" title="statement not covered" >j</span>.divRemTo(i,j,h)}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn h.intValue().toString(c)+g}<span class="fstat-no" title="function not covered" ></span>function bnpFromRadix(m,h){<span class="cstat-no" title="statement not covered" ></span>this.fromInt(0);<span class="cstat-no" title="statement not covered" >i</span>f(h==null){<span class="cstat-no" title="statement not covered" >h=10}<span class="cstat-no" title="statement not covered" ></span>v</span>ar f=this.chunkSize(h);<span class="cstat-no" title="statement not covered" >v</span>ar g=Math.pow(h,f),e=false,a=0,l=0;<span class="cstat-no" title="statement not covered" >f</span>or(var c=0;c&lt;m.length;++c){<span class="cstat-no" title="statement not covered" >var k=intAt(m,c);<span class="cstat-no" title="statement not covered" >i</span>f(k&lt;0){<span class="cstat-no" title="statement not covered" >if(m.charAt(c)=="-"&amp;&amp;this.signum()==0){<span class="cstat-no" title="statement not covered" >e=true}<span class="cstat-no" title="statement not covered" ></span>c</span>ontinue}<span class="cstat-no" title="statement not covered" ></span>l</span>=h*l+k;<span class="cstat-no" title="statement not covered" >i</span>f(++a&gt;=f){<span class="cstat-no" title="statement not covered" >this.dMultiply(g);<span class="cstat-no" title="statement not covered" >t</span>his.dAddOffset(l,0);<span class="cstat-no" title="statement not covered" >a</span>=0;<span class="cstat-no" title="statement not covered" >l</span>=0}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(a&gt;0){<span class="cstat-no" title="statement not covered" >this.dMultiply(Math.pow(h,a));<span class="cstat-no" title="statement not covered" >t</span>his.dAddOffset(l,0)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(e){<span class="cstat-no" title="statement not covered" >BigInteger.ZERO.subTo(this,this)}</span>}<span class="fstat-no" title="function not covered" ></span>function bnpFromNumber(f,e,h){<span class="cstat-no" title="statement not covered" ></span>if("number"==typeof e){<span class="cstat-no" title="statement not covered" >if(f&lt;2){<span class="cstat-no" title="statement not covered" >this.fromInt(1)}</span>else{<span class="cstat-no" title="statement not covered" >this.fromNumber(f,h);<span class="cstat-no" title="statement not covered" >i</span>f(!this.testBit(f-1)){<span class="cstat-no" title="statement not covered" >this.bitwiseTo(BigInteger.ONE.shiftLeft(f-1),op_or,this)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(this.isEven()){<span class="cstat-no" title="statement not covered" >this.dAddOffset(1,0)}<span class="cstat-no" title="statement not covered" ></span>w</span>hile(!this.isProbablePrime(e)){<span class="cstat-no" title="statement not covered" >this.dAddOffset(2,0);<span class="cstat-no" title="statement not covered" >i</span>f(this.bitLength()&gt;f){<span class="cstat-no" title="statement not covered" >this.subTo(BigInteger.ONE.shiftLeft(f-1),this)}</span>}</span>}</span>}</span>else{<span class="cstat-no" title="statement not covered" >var d=new Array(),g=f&amp;7;<span class="cstat-no" title="statement not covered" >d</span>.length=(f&gt;&gt;3)+1;<span class="cstat-no" title="statement not covered" >e</span>.nextBytes(d);<span class="cstat-no" title="statement not covered" >i</span>f(g&gt;0){<span class="cstat-no" title="statement not covered" >d[0]&amp;=((1&lt;&lt;g)-1)}</span>else{<span class="cstat-no" title="statement not covered" >d[0]=0}<span class="cstat-no" title="statement not covered" ></span>t</span>his.fromString(d,256)}</span>}<span class="fstat-no" title="function not covered" ></span>function bnToByteArray(){<span class="cstat-no" title="statement not covered" ></span>var b=this.t,c=new Array();<span class="cstat-no" title="statement not covered" >c</span>[0]=this.s;<span class="cstat-no" title="statement not covered" >v</span>ar e=this.DB-(b*this.DB)%8,f,a=0;<span class="cstat-no" title="statement not covered" >i</span>f(b--&gt;0){<span class="cstat-no" title="statement not covered" >if(e&lt;this.DB&amp;&amp;(f=this[b]&gt;&gt;e)!=(this.s&amp;this.DM)&gt;&gt;e){<span class="cstat-no" title="statement not covered" >c[a++]=f|(this.s&lt;&lt;(this.DB-e))}<span class="cstat-no" title="statement not covered" ></span>w</span>hile(b&gt;=0){<span class="cstat-no" title="statement not covered" >if(e&lt;8){<span class="cstat-no" title="statement not covered" >f=(this[b]&amp;((1&lt;&lt;e)-1))&lt;&lt;(8-e);<span class="cstat-no" title="statement not covered" >f</span>|=this[--b]&gt;&gt;(e+=this.DB-8)}</span>else{<span class="cstat-no" title="statement not covered" >f=(this[b]&gt;&gt;(e-=8))&amp;255;<span class="cstat-no" title="statement not covered" >i</span>f(e&lt;=0){<span class="cstat-no" title="statement not covered" >e+=this.DB;<span class="cstat-no" title="statement not covered" >-</span>-b}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f((f&amp;128)!=0){<span class="cstat-no" title="statement not covered" >f|=-256}<span class="cstat-no" title="statement not covered" ></span>i</span>f(a==0&amp;&amp;(this.s&amp;128)!=(f&amp;128)){<span class="cstat-no" title="statement not covered" >++a}<span class="cstat-no" title="statement not covered" ></span>i</span>f(a&gt;0||f!=this.s){<span class="cstat-no" title="statement not covered" >c[a++]=f}</span>}</span>}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn c}<span class="fstat-no" title="function not covered" ></span>function bnEquals(b){<span class="cstat-no" title="statement not covered" ></span>return(this.compareTo(b)==0)}<span class="fstat-no" title="function not covered" ></span>function bnMin(b){<span class="cstat-no" title="statement not covered" ></span>return(this.compareTo(b)&lt;0)?this:b}<span class="fstat-no" title="function not covered" ></span>function bnMax(b){<span class="cstat-no" title="statement not covered" ></span>return(this.compareTo(b)&gt;0)?this:b}<span class="fstat-no" title="function not covered" ></span>function bnpBitwiseTo(c,h,e){<span class="cstat-no" title="statement not covered" ></span>var d,g,b=Math.min(c.t,this.t);<span class="cstat-no" title="statement not covered" >f</span>or(d=0;d&lt;b;++d){<span class="cstat-no" title="statement not covered" >e[d]=h(this[d],c[d])}<span class="cstat-no" title="statement not covered" ></span>i</span>f(c.t&lt;this.t){<span class="cstat-no" title="statement not covered" >g=c.s&amp;this.DM;<span class="cstat-no" title="statement not covered" >f</span>or(d=b;d&lt;this.t;++d){<span class="cstat-no" title="statement not covered" >e[d]=h(this[d],g)}<span class="cstat-no" title="statement not covered" ></span>e</span>.t=this.t}</span>else{<span class="cstat-no" title="statement not covered" >g=this.s&amp;this.DM;<span class="cstat-no" title="statement not covered" >f</span>or(d=b;d&lt;c.t;++d){<span class="cstat-no" title="statement not covered" >e[d]=h(g,c[d])}<span class="cstat-no" title="statement not covered" ></span>e</span>.t=c.t}<span class="cstat-no" title="statement not covered" ></span>e</span>.s=h(this.s,c.s);<span class="cstat-no" title="statement not covered" >e</span>.clamp()}<span class="fstat-no" title="function not covered" ></span>function op_and(a,b){<span class="cstat-no" title="statement not covered" ></span>return a&amp;b}<span class="fstat-no" title="function not covered" ></span>function bnAnd(b){<span class="cstat-no" title="statement not covered" ></span>var c=nbi();<span class="cstat-no" title="statement not covered" >t</span>his.bitwiseTo(b,op_and,c);<span class="cstat-no" title="statement not covered" >r</span>eturn c}<span class="fstat-no" title="function not covered" ></span>function op_or(a,b){<span class="cstat-no" title="statement not covered" ></span>return a|b}<span class="fstat-no" title="function not covered" ></span>function bnOr(b){<span class="cstat-no" title="statement not covered" ></span>var c=nbi();<span class="cstat-no" title="statement not covered" >t</span>his.bitwiseTo(b,op_or,c);<span class="cstat-no" title="statement not covered" >r</span>eturn c}<span class="fstat-no" title="function not covered" ></span>function op_xor(a,b){<span class="cstat-no" title="statement not covered" ></span>return a^b}<span class="fstat-no" title="function not covered" ></span>function bnXor(b){<span class="cstat-no" title="statement not covered" ></span>var c=nbi();<span class="cstat-no" title="statement not covered" >t</span>his.bitwiseTo(b,op_xor,c);<span class="cstat-no" title="statement not covered" >r</span>eturn c}<span class="fstat-no" title="function not covered" ></span>function op_andnot(a,b){<span class="cstat-no" title="statement not covered" ></span>return a&amp;~b}<span class="fstat-no" title="function not covered" ></span>function bnAndNot(b){<span class="cstat-no" title="statement not covered" ></span>var c=nbi();<span class="cstat-no" title="statement not covered" >t</span>his.bitwiseTo(b,op_andnot,c);<span class="cstat-no" title="statement not covered" >r</span>eturn c}<span class="fstat-no" title="function not covered" ></span>function bnNot(){<span class="cstat-no" title="statement not covered" ></span>var b=nbi();<span class="cstat-no" title="statement not covered" >f</span>or(var a=0;a&lt;this.t;++a){<span class="cstat-no" title="statement not covered" >b[a]=this.DM&amp;~this[a]}<span class="cstat-no" title="statement not covered" ></span>b</span>.t=this.t;<span class="cstat-no" title="statement not covered" >b</span>.s=~this.s;<span class="cstat-no" title="statement not covered" >r</span>eturn b}<span class="fstat-no" title="function not covered" ></span>function bnShiftLeft(b){<span class="cstat-no" title="statement not covered" ></span>var a=nbi();<span class="cstat-no" title="statement not covered" >i</span>f(b&lt;0){<span class="cstat-no" title="statement not covered" >this.rShiftTo(-b,a)}</span>else{<span class="cstat-no" title="statement not covered" >this.lShiftTo(b,a)}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn a}<span class="fstat-no" title="function not covered" ></span>function bnShiftRight(b){<span class="cstat-no" title="statement not covered" ></span>var a=nbi();<span class="cstat-no" title="statement not covered" >i</span>f(b&lt;0){<span class="cstat-no" title="statement not covered" >this.lShiftTo(-b,a)}</span>else{<span class="cstat-no" title="statement not covered" >this.rShiftTo(b,a)}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn a}<span class="fstat-no" title="function not covered" ></span>function lbit(a){<span class="cstat-no" title="statement not covered" ></span>if(a==0){<span class="cstat-no" title="statement not covered" >return -1}<span class="cstat-no" title="statement not covered" ></span>v</span>ar b=0;<span class="cstat-no" title="statement not covered" >i</span>f((a&amp;65535)==0){<span class="cstat-no" title="statement not covered" >a&gt;&gt;=16;<span class="cstat-no" title="statement not covered" >b</span>+=16}<span class="cstat-no" title="statement not covered" ></span>i</span>f((a&amp;255)==0){<span class="cstat-no" title="statement not covered" >a&gt;&gt;=8;<span class="cstat-no" title="statement not covered" >b</span>+=8}<span class="cstat-no" title="statement not covered" ></span>i</span>f((a&amp;15)==0){<span class="cstat-no" title="statement not covered" >a&gt;&gt;=4;<span class="cstat-no" title="statement not covered" >b</span>+=4}<span class="cstat-no" title="statement not covered" ></span>i</span>f((a&amp;3)==0){<span class="cstat-no" title="statement not covered" >a&gt;&gt;=2;<span class="cstat-no" title="statement not covered" >b</span>+=2}<span class="cstat-no" title="statement not covered" ></span>i</span>f((a&amp;1)==0){<span class="cstat-no" title="statement not covered" >++b}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn b}<span class="fstat-no" title="function not covered" ></span>function bnGetLowestSetBit(){<span class="cstat-no" title="statement not covered" ></span>for(var a=0;a&lt;this.t;++a){<span class="cstat-no" title="statement not covered" >if(this[a]!=0){<span class="cstat-no" title="statement not covered" >return a*this.DB+lbit(this[a])}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(this.s&lt;0){<span class="cstat-no" title="statement not covered" >return this.t*this.DB}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn -1}<span class="fstat-no" title="function not covered" ></span>function cbit(a){<span class="cstat-no" title="statement not covered" ></span>var b=0;<span class="cstat-no" title="statement not covered" >w</span>hile(a!=0){<span class="cstat-no" title="statement not covered" >a&amp;=a-1;<span class="cstat-no" title="statement not covered" >+</span>+b}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn b}<span class="fstat-no" title="function not covered" ></span>function bnBitCount(){<span class="cstat-no" title="statement not covered" ></span>var c=0,a=this.s&amp;this.DM;<span class="cstat-no" title="statement not covered" >f</span>or(var b=0;b&lt;this.t;++b){<span class="cstat-no" title="statement not covered" >c+=cbit(this[b]^a)}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn c}<span class="fstat-no" title="function not covered" ></span>function bnTestBit(b){<span class="cstat-no" title="statement not covered" ></span>var a=Math.floor(b/this.DB);<span class="cstat-no" title="statement not covered" >i</span>f(a&gt;=this.t){<span class="cstat-no" title="statement not covered" >return(this.s!=0)}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn((this[a]&amp;(1&lt;&lt;(b%this.DB)))!=0)}<span class="fstat-no" title="function not covered" ></span>function bnpChangeBit(c,b){<span class="cstat-no" title="statement not covered" ></span>var a=BigInteger.ONE.shiftLeft(c);<span class="cstat-no" title="statement not covered" >t</span>his.bitwiseTo(a,b,a);<span class="cstat-no" title="statement not covered" >r</span>eturn a}<span class="fstat-no" title="function not covered" ></span>function bnSetBit(a){<span class="cstat-no" title="statement not covered" ></span>return this.changeBit(a,op_or)}<span class="fstat-no" title="function not covered" ></span>function bnClearBit(a){<span class="cstat-no" title="statement not covered" ></span>return this.changeBit(a,op_andnot)}<span class="fstat-no" title="function not covered" ></span>function bnFlipBit(a){<span class="cstat-no" title="statement not covered" ></span>return this.changeBit(a,op_xor)}<span class="fstat-no" title="function not covered" ></span>function bnpAddTo(d,f){<span class="cstat-no" title="statement not covered" ></span>var e=0,g=0,b=Math.min(d.t,this.t);<span class="cstat-no" title="statement not covered" >w</span>hile(e&lt;b){<span class="cstat-no" title="statement not covered" >g+=this[e]+d[e];<span class="cstat-no" title="statement not covered" >f</span>[e++]=g&amp;this.DM;<span class="cstat-no" title="statement not covered" >g</span>&gt;&gt;=this.DB}<span class="cstat-no" title="statement not covered" ></span>i</span>f(d.t&lt;this.t){<span class="cstat-no" title="statement not covered" >g+=d.s;<span class="cstat-no" title="statement not covered" >w</span>hile(e&lt;this.t){<span class="cstat-no" title="statement not covered" >g+=this[e];<span class="cstat-no" title="statement not covered" >f</span>[e++]=g&amp;this.DM;<span class="cstat-no" title="statement not covered" >g</span>&gt;&gt;=this.DB}<span class="cstat-no" title="statement not covered" ></span>g</span>+=this.s}</span>else{<span class="cstat-no" title="statement not covered" >g+=this.s;<span class="cstat-no" title="statement not covered" >w</span>hile(e&lt;d.t){<span class="cstat-no" title="statement not covered" >g+=d[e];<span class="cstat-no" title="statement not covered" >f</span>[e++]=g&amp;this.DM;<span class="cstat-no" title="statement not covered" >g</span>&gt;&gt;=this.DB}<span class="cstat-no" title="statement not covered" ></span>g</span>+=d.s}<span class="cstat-no" title="statement not covered" ></span>f</span>.s=(g&lt;0)?-1:0;<span class="cstat-no" title="statement not covered" >i</span>f(g&gt;0){<span class="cstat-no" title="statement not covered" >f[e++]=g}</span>else{<span class="cstat-no" title="statement not covered" >if(g&lt;-1){<span class="cstat-no" title="statement not covered" >f[e++]=this.DV+g}</span>}<span class="cstat-no" title="statement not covered" ></span>f</span>.t=e;<span class="cstat-no" title="statement not covered" >f</span>.clamp()}<span class="fstat-no" title="function not covered" ></span>function bnAdd(b){<span class="cstat-no" title="statement not covered" ></span>var c=nbi();<span class="cstat-no" title="statement not covered" >t</span>his.addTo(b,c);<span class="cstat-no" title="statement not covered" >r</span>eturn c}<span class="fstat-no" title="function not covered" ></span>function bnSubtract(b){<span class="cstat-no" title="statement not covered" ></span>var c=nbi();<span class="cstat-no" title="statement not covered" >t</span>his.subTo(b,c);<span class="cstat-no" title="statement not covered" >r</span>eturn c}<span class="fstat-no" title="function not covered" ></span>function bnMultiply(b){<span class="cstat-no" title="statement not covered" ></span>var c=nbi();<span class="cstat-no" title="statement not covered" >t</span>his.multiplyTo(b,c);<span class="cstat-no" title="statement not covered" >r</span>eturn c}<span class="fstat-no" title="function not covered" ></span>function bnSquare(){<span class="cstat-no" title="statement not covered" ></span>var a=nbi();<span class="cstat-no" title="statement not covered" >t</span>his.squareTo(a);<span class="cstat-no" title="statement not covered" >r</span>eturn a}<span class="fstat-no" title="function not covered" ></span>function bnDivide(b){<span class="cstat-no" title="statement not covered" ></span>var c=nbi();<span class="cstat-no" title="statement not covered" >t</span>his.divRemTo(b,c,null);<span class="cstat-no" title="statement not covered" >r</span>eturn c}<span class="fstat-no" title="function not covered" ></span>function bnRemainder(b){<span class="cstat-no" title="statement not covered" ></span>var c=nbi();<span class="cstat-no" title="statement not covered" >t</span>his.divRemTo(b,null,c);<span class="cstat-no" title="statement not covered" >r</span>eturn c}<span class="fstat-no" title="function not covered" ></span>function bnDivideAndRemainder(b){<span class="cstat-no" title="statement not covered" ></span>var d=nbi(),c=nbi();<span class="cstat-no" title="statement not covered" >t</span>his.divRemTo(b,d,c);<span class="cstat-no" title="statement not covered" >r</span>eturn new Array(d,c)}<span class="fstat-no" title="function not covered" ></span>function bnpDMultiply(a){<span class="cstat-no" title="statement not covered" ></span>this[this.t]=this.am(0,a-1,this,0,0,this.t);<span class="cstat-no" title="statement not covered" >+</span>+this.t;<span class="cstat-no" title="statement not covered" >t</span>his.clamp()}<span class="fstat-no" title="function not covered" ></span>function bnpDAddOffset(b,a){<span class="cstat-no" title="statement not covered" ></span>if(b==0){<span class="cstat-no" title="statement not covered" >return}<span class="cstat-no" title="statement not covered" ></span>w</span>hile(this.t&lt;=a){<span class="cstat-no" title="statement not covered" >this[this.t++]=0}<span class="cstat-no" title="statement not covered" ></span>t</span>his[a]+=b;<span class="cstat-no" title="statement not covered" >w</span>hile(this[a]&gt;=this.DV){<span class="cstat-no" title="statement not covered" >this[a]-=this.DV;<span class="cstat-no" title="statement not covered" >i</span>f(++a&gt;=this.t){<span class="cstat-no" title="statement not covered" >this[this.t++]=0}<span class="cstat-no" title="statement not covered" ></span>+</span>+this[a]}</span>}<span class="fstat-no" title="function not covered" ></span>function NullExp(){</span>}<span class="fstat-no" title="function not covered" >function nNop(a){<span class="cstat-no" title="statement not covered" ></span>return a}<span class="fstat-no" title="function not covered" ></span>function nMulTo(a,c,b){<span class="cstat-no" title="statement not covered" ></span>a.multiplyTo(c,b)}<span class="fstat-no" title="function not covered" ></span>function nSqrTo(a,b){<span class="cstat-no" title="statement not covered" ></span>a.squareTo(b)}</span>NullExp.prototype.convert=nNop;NullExp.prototype.revert=nNop;NullExp.prototype.mulTo=nMulTo;NullExp.prototype.sqrTo=nSqrTo;<span class="fstat-no" title="function not covered" >function bnPow(a){<span class="cstat-no" title="statement not covered" ></span>return this.exp(a,new NullExp())}<span class="fstat-no" title="function not covered" ></span>function bnpMultiplyLowerTo(b,f,e){<span class="cstat-no" title="statement not covered" ></span>var d=Math.min(this.t+b.t,f);<span class="cstat-no" title="statement not covered" >e</span>.s=0;<span class="cstat-no" title="statement not covered" >e</span>.t=d;<span class="cstat-no" title="statement not covered" >w</span>hile(d&gt;0){<span class="cstat-no" title="statement not covered" >e[--d]=0}<span class="cstat-no" title="statement not covered" ></span>v</span>ar c;<span class="cstat-no" title="statement not covered" >f</span>or(c=e.t-this.t;d&lt;c;++d){<span class="cstat-no" title="statement not covered" >e[d+this.t]=this.am(0,b[d],e,d,0,this.t)}<span class="cstat-no" title="statement not covered" ></span>f</span>or(c=Math.min(b.t,f);d&lt;c;++d){<span class="cstat-no" title="statement not covered" >this.am(0,b[d],e,d,0,f-d)}<span class="cstat-no" title="statement not covered" ></span>e</span>.clamp()}<span class="fstat-no" title="function not covered" ></span>function bnpMultiplyUpperTo(b,e,d){<span class="cstat-no" title="statement not covered" ></span>--e;<span class="cstat-no" title="statement not covered" >v</span>ar c=d.t=this.t+b.t-e;<span class="cstat-no" title="statement not covered" >d</span>.s=0;<span class="cstat-no" title="statement not covered" >w</span>hile(--c&gt;=0){<span class="cstat-no" title="statement not covered" >d[c]=0}<span class="cstat-no" title="statement not covered" ></span>f</span>or(c=Math.max(e-this.t,0);c&lt;b.t;++c){<span class="cstat-no" title="statement not covered" >d[this.t+c-e]=this.am(e-c,b[c],d,0,0,this.t+c-e)}<span class="cstat-no" title="statement not covered" ></span>d</span>.clamp();<span class="cstat-no" title="statement not covered" >d</span>.drShiftTo(1,d)}<span class="fstat-no" title="function not covered" ></span>function Barrett(a){<span class="cstat-no" title="statement not covered" ></span>this.r2=nbi();<span class="cstat-no" title="statement not covered" >t</span>his.q3=nbi();<span class="cstat-no" title="statement not covered" >B</span>igInteger.ONE.dlShiftTo(2*a.t,this.r2);<span class="cstat-no" title="statement not covered" >t</span>his.mu=this.r2.divide(a);<span class="cstat-no" title="statement not covered" >t</span>his.m=a}<span class="fstat-no" title="function not covered" ></span>function barrettConvert(a){<span class="cstat-no" title="statement not covered" ></span>if(a.s&lt;0||a.t&gt;2*this.m.t){<span class="cstat-no" title="statement not covered" >return a.mod(this.m)}</span>else{<span class="cstat-no" title="statement not covered" >if(a.compareTo(this.m)&lt;0){<span class="cstat-no" title="statement not covered" >return a}</span>else{<span class="cstat-no" title="statement not covered" >var b=nbi();<span class="cstat-no" title="statement not covered" >a</span>.copyTo(b);<span class="cstat-no" title="statement not covered" >t</span>his.reduce(b);<span class="cstat-no" title="statement not covered" >r</span>eturn b}</span>}</span>}<span class="fstat-no" title="function not covered" ></span>function barrettRevert(a){<span class="cstat-no" title="statement not covered" ></span>return a}<span class="fstat-no" title="function not covered" ></span>function barrettReduce(a){<span class="cstat-no" title="statement not covered" ></span>a.drShiftTo(this.m.t-1,this.r2);<span class="cstat-no" title="statement not covered" >i</span>f(a.t&gt;this.m.t+1){<span class="cstat-no" title="statement not covered" >a.t=this.m.t+1;<span class="cstat-no" title="statement not covered" >a</span>.clamp()}<span class="cstat-no" title="statement not covered" ></span>t</span>his.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);<span class="cstat-no" title="statement not covered" >t</span>his.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);<span class="cstat-no" title="statement not covered" >w</span>hile(a.compareTo(this.r2)&lt;0){<span class="cstat-no" title="statement not covered" >a.dAddOffset(1,this.m.t+1)}<span class="cstat-no" title="statement not covered" ></span>a</span>.subTo(this.r2,a);<span class="cstat-no" title="statement not covered" >w</span>hile(a.compareTo(this.m)&gt;=0){<span class="cstat-no" title="statement not covered" >a.subTo(this.m,a)}</span>}<span class="fstat-no" title="function not covered" ></span>function barrettSqrTo(a,b){<span class="cstat-no" title="statement not covered" ></span>a.squareTo(b);<span class="cstat-no" title="statement not covered" >t</span>his.reduce(b)}<span class="fstat-no" title="function not covered" ></span>function barrettMulTo(a,c,b){<span class="cstat-no" title="statement not covered" ></span>a.multiplyTo(c,b);<span class="cstat-no" title="statement not covered" >t</span>his.reduce(b)}</span>Barrett.prototype.convert=barrettConvert;Barrett.prototype.revert=barrettRevert;Barrett.prototype.reduce=barrettReduce;Barrett.prototype.mulTo=barrettMulTo;Barrett.prototype.sqrTo=barrettSqrTo;<span class="fstat-no" title="function not covered" >function bnModPow(q,f){<span class="cstat-no" title="statement not covered" ></span>var o=q.bitLength(),h,b=nbv(1),v;<span class="cstat-no" title="statement not covered" >i</span>f(o&lt;=0){<span class="cstat-no" title="statement not covered" >return b}</span>else{<span class="cstat-no" title="statement not covered" >if(o&lt;18){<span class="cstat-no" title="statement not covered" >h=1}</span>else{<span class="cstat-no" title="statement not covered" >if(o&lt;48){<span class="cstat-no" title="statement not covered" >h=3}</span>else{<span class="cstat-no" title="statement not covered" >if(o&lt;144){<span class="cstat-no" title="statement not covered" >h=4}</span>else{<span class="cstat-no" title="statement not covered" >if(o&lt;768){<span class="cstat-no" title="statement not covered" >h=5}</span>else{<span class="cstat-no" title="statement not covered" >h=6}</span>}</span>}</span>}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(o&lt;8){<span class="cstat-no" title="statement not covered" >v=new Classic(f)}</span>else{<span class="cstat-no" title="statement not covered" >if(f.isEven()){<span class="cstat-no" title="statement not covered" >v=new Barrett(f)}</span>else{<span class="cstat-no" title="statement not covered" >v=new Montgomery(f)}</span>}<span class="cstat-no" title="statement not covered" ></span>v</span>ar p=new Array(),d=3,s=h-1,a=(1&lt;&lt;h)-1;<span class="cstat-no" title="statement not covered" >p</span>[1]=v.convert(this);<span class="cstat-no" title="statement not covered" >i</span>f(h&gt;1){<span class="cstat-no" title="statement not covered" >var A=nbi();<span class="cstat-no" title="statement not covered" >v</span>.sqrTo(p[1],A);<span class="cstat-no" title="statement not covered" >w</span>hile(d&lt;=a){<span class="cstat-no" title="statement not covered" >p[d]=nbi();<span class="cstat-no" title="statement not covered" >v</span>.mulTo(A,p[d-2],p[d]);<span class="cstat-no" title="statement not covered" >d</span>+=2}</span>}<span class="cstat-no" title="statement not covered" ></span>v</span>ar l=q.t-1,x,u=true,c=nbi(),y;<span class="cstat-no" title="statement not covered" >o</span>=nbits(q[l])-1;<span class="cstat-no" title="statement not covered" >w</span>hile(l&gt;=0){<span class="cstat-no" title="statement not covered" >if(o&gt;=s){<span class="cstat-no" title="statement not covered" >x=(q[l]&gt;&gt;(o-s))&amp;a}</span>else{<span class="cstat-no" title="statement not covered" >x=(q[l]&amp;((1&lt;&lt;(o+1))-1))&lt;&lt;(s-o);<span class="cstat-no" title="statement not covered" >i</span>f(l&gt;0){<span class="cstat-no" title="statement not covered" >x|=q[l-1]&gt;&gt;(this.DB+o-s)}</span>}<span class="cstat-no" title="statement not covered" ></span>d</span>=h;<span class="cstat-no" title="statement not covered" >w</span>hile((x&amp;1)==0){<span class="cstat-no" title="statement not covered" >x&gt;&gt;=1;<span class="cstat-no" title="statement not covered" >-</span>-d}<span class="cstat-no" title="statement not covered" ></span>i</span>f((o-=d)&lt;0){<span class="cstat-no" title="statement not covered" >o+=this.DB;<span class="cstat-no" title="statement not covered" >-</span>-l}<span class="cstat-no" title="statement not covered" ></span>i</span>f(u){<span class="cstat-no" title="statement not covered" >p[x].copyTo(b);<span class="cstat-no" title="statement not covered" >u</span>=false}</span>else{<span class="cstat-no" title="statement not covered" >while(d&gt;1){<span class="cstat-no" title="statement not covered" >v.sqrTo(b,c);<span class="cstat-no" title="statement not covered" >v</span>.sqrTo(c,b);<span class="cstat-no" title="statement not covered" >d</span>-=2}<span class="cstat-no" title="statement not covered" ></span>i</span>f(d&gt;0){<span class="cstat-no" title="statement not covered" >v.sqrTo(b,c)}</span>else{<span class="cstat-no" title="statement not covered" >y=b;<span class="cstat-no" title="statement not covered" >b</span>=c;<span class="cstat-no" title="statement not covered" >c</span>=y}<span class="cstat-no" title="statement not covered" ></span>v</span>.mulTo(c,p[x],b)}<span class="cstat-no" title="statement not covered" ></span>w</span>hile(l&gt;=0&amp;&amp;(q[l]&amp;(1&lt;&lt;o))==0){<span class="cstat-no" title="statement not covered" >v.sqrTo(b,c);<span class="cstat-no" title="statement not covered" >y</span>=b;<span class="cstat-no" title="statement not covered" >b</span>=c;<span class="cstat-no" title="statement not covered" >c</span>=y;<span class="cstat-no" title="statement not covered" >i</span>f(--o&lt;0){<span class="cstat-no" title="statement not covered" >o=this.DB-1;<span class="cstat-no" title="statement not covered" >-</span>-l}</span>}</span>}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn v.revert(b)}<span class="fstat-no" title="function not covered" ></span>function bnGCD(c){<span class="cstat-no" title="statement not covered" ></span>var b=(this.s&lt;0)?this.negate():this.clone();<span class="cstat-no" title="statement not covered" >v</span>ar h=(c.s&lt;0)?c.negate():c.clone();<span class="cstat-no" title="statement not covered" >i</span>f(b.compareTo(h)&lt;0){<span class="cstat-no" title="statement not covered" >var e=b;<span class="cstat-no" title="statement not covered" >b</span>=h;<span class="cstat-no" title="statement not covered" >h</span>=e}<span class="cstat-no" title="statement not covered" ></span>v</span>ar d=b.getLowestSetBit(),f=h.getLowestSetBit();<span class="cstat-no" title="statement not covered" >i</span>f(f&lt;0){<span class="cstat-no" title="statement not covered" >return b}<span class="cstat-no" title="statement not covered" ></span>i</span>f(d&lt;f){<span class="cstat-no" title="statement not covered" >f=d}<span class="cstat-no" title="statement not covered" ></span>i</span>f(f&gt;0){<span class="cstat-no" title="statement not covered" >b.rShiftTo(f,b);<span class="cstat-no" title="statement not covered" >h</span>.rShiftTo(f,h)}<span class="cstat-no" title="statement not covered" ></span>w</span>hile(b.signum()&gt;0){<span class="cstat-no" title="statement not covered" >if((d=b.getLowestSetBit())&gt;0){<span class="cstat-no" title="statement not covered" >b.rShiftTo(d,b)}<span class="cstat-no" title="statement not covered" ></span>i</span>f((d=h.getLowestSetBit())&gt;0){<span class="cstat-no" title="statement not covered" >h.rShiftTo(d,h)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(b.compareTo(h)&gt;=0){<span class="cstat-no" title="statement not covered" >b.subTo(h,b);<span class="cstat-no" title="statement not covered" >b</span>.rShiftTo(1,b)}</span>else{<span class="cstat-no" title="statement not covered" >h.subTo(b,h);<span class="cstat-no" title="statement not covered" >h</span>.rShiftTo(1,h)}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(f&gt;0){<span class="cstat-no" title="statement not covered" >h.lShiftTo(f,h)}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn h}<span class="fstat-no" title="function not covered" ></span>function bnpModInt(e){<span class="cstat-no" title="statement not covered" ></span>if(e&lt;=0){<span class="cstat-no" title="statement not covered" >return 0}<span class="cstat-no" title="statement not covered" ></span>v</span>ar c=this.DV%e,b=(this.s&lt;0)?e-1:0;<span class="cstat-no" title="statement not covered" >i</span>f(this.t&gt;0){<span class="cstat-no" title="statement not covered" >if(c==0){<span class="cstat-no" title="statement not covered" >b=this[0]%e}</span>else{<span class="cstat-no" title="statement not covered" >for(var a=this.t-1;a&gt;=0;--a){<span class="cstat-no" title="statement not covered" >b=(c*b+this[a])%e}</span>}</span>}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn b}<span class="fstat-no" title="function not covered" ></span>function bnModInverse(f){<span class="cstat-no" title="statement not covered" ></span>var j=f.isEven();<span class="cstat-no" title="statement not covered" >i</span>f((this.isEven()&amp;&amp;j)||f.signum()==0){<span class="cstat-no" title="statement not covered" >return BigInteger.ZERO}<span class="cstat-no" title="statement not covered" ></span>v</span>ar i=f.clone(),h=this.clone();<span class="cstat-no" title="statement not covered" >v</span>ar g=nbv(1),e=nbv(0),l=nbv(0),k=nbv(1);<span class="cstat-no" title="statement not covered" >w</span>hile(i.signum()!=0){<span class="cstat-no" title="statement not covered" >while(i.isEven()){<span class="cstat-no" title="statement not covered" >i.rShiftTo(1,i);<span class="cstat-no" title="statement not covered" >i</span>f(j){<span class="cstat-no" title="statement not covered" >if(!g.isEven()||!e.isEven()){<span class="cstat-no" title="statement not covered" >g.addTo(this,g);<span class="cstat-no" title="statement not covered" >e</span>.subTo(f,e)}<span class="cstat-no" title="statement not covered" ></span>g</span>.rShiftTo(1,g)}</span>else{<span class="cstat-no" title="statement not covered" >if(!e.isEven()){<span class="cstat-no" title="statement not covered" >e.subTo(f,e)}</span>}<span class="cstat-no" title="statement not covered" ></span>e</span>.rShiftTo(1,e)}<span class="cstat-no" title="statement not covered" ></span>w</span>hile(h.isEven()){<span class="cstat-no" title="statement not covered" >h.rShiftTo(1,h);<span class="cstat-no" title="statement not covered" >i</span>f(j){<span class="cstat-no" title="statement not covered" >if(!l.isEven()||!k.isEven()){<span class="cstat-no" title="statement not covered" >l.addTo(this,l);<span class="cstat-no" title="statement not covered" >k</span>.subTo(f,k)}<span class="cstat-no" title="statement not covered" ></span>l</span>.rShiftTo(1,l)}</span>else{<span class="cstat-no" title="statement not covered" >if(!k.isEven()){<span class="cstat-no" title="statement not covered" >k.subTo(f,k)}</span>}<span class="cstat-no" title="statement not covered" ></span>k</span>.rShiftTo(1,k)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(i.compareTo(h)&gt;=0){<span class="cstat-no" title="statement not covered" >i.subTo(h,i);<span class="cstat-no" title="statement not covered" >i</span>f(j){<span class="cstat-no" title="statement not covered" >g.subTo(l,g)}<span class="cstat-no" title="statement not covered" ></span>e</span>.subTo(k,e)}</span>else{<span class="cstat-no" title="statement not covered" >h.subTo(i,h);<span class="cstat-no" title="statement not covered" >i</span>f(j){<span class="cstat-no" title="statement not covered" >l.subTo(g,l)}<span class="cstat-no" title="statement not covered" ></span>k</span>.subTo(e,k)}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(h.compareTo(BigInteger.ONE)!=0){<span class="cstat-no" title="statement not covered" >return BigInteger.ZERO}<span class="cstat-no" title="statement not covered" ></span>i</span>f(k.compareTo(f)&gt;=0){<span class="cstat-no" title="statement not covered" >return k.subtract(f)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(k.signum()&lt;0){<span class="cstat-no" title="statement not covered" >k.addTo(f,k)}</span>else{<span class="cstat-no" title="statement not covered" >return k}<span class="cstat-no" title="statement not covered" ></span>i</span>f(k.signum()&lt;0){<span class="cstat-no" title="statement not covered" >return k.add(f)}</span>else{<span class="cstat-no" title="statement not covered" >return k}</span>}</span>var lowprimes=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997];var lplim=(1&lt;&lt;26)/lowprimes[lowprimes.length-1];<span class="fstat-no" title="function not covered" >function bnIsProbablePrime(e){<span class="cstat-no" title="statement not covered" ></span>var d,b=this.abs();<span class="cstat-no" title="statement not covered" >i</span>f(b.t==1&amp;&amp;b[0]&lt;=lowprimes[lowprimes.length-1]){<span class="cstat-no" title="statement not covered" >for(d=0;d&lt;lowprimes.length;++d){<span class="cstat-no" title="statement not covered" >if(b[0]==lowprimes[d]){<span class="cstat-no" title="statement not covered" >return true}</span>}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn false}<span class="cstat-no" title="statement not covered" ></span>i</span>f(b.isEven()){<span class="cstat-no" title="statement not covered" >return false}<span class="cstat-no" title="statement not covered" ></span>d</span>=1;<span class="cstat-no" title="statement not covered" >w</span>hile(d&lt;lowprimes.length){<span class="cstat-no" title="statement not covered" >var a=lowprimes[d],c=d+1;<span class="cstat-no" title="statement not covered" >w</span>hile(c&lt;lowprimes.length&amp;&amp;a&lt;lplim){<span class="cstat-no" title="statement not covered" >a*=lowprimes[c++]}<span class="cstat-no" title="statement not covered" ></span>a</span>=b.modInt(a);<span class="cstat-no" title="statement not covered" >w</span>hile(d&lt;c){<span class="cstat-no" title="statement not covered" >if(a%lowprimes[d++]==0){<span class="cstat-no" title="statement not covered" >return false}</span>}</span>}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn b.millerRabin(e)}<span class="fstat-no" title="function not covered" ></span>function bnpMillerRabin(f){<span class="cstat-no" title="statement not covered" ></span>var g=this.subtract(BigInteger.ONE);<span class="cstat-no" title="statement not covered" >v</span>ar c=g.getLowestSetBit();<span class="cstat-no" title="statement not covered" >i</span>f(c&lt;=0){<span class="cstat-no" title="statement not covered" >return false}<span class="cstat-no" title="statement not covered" ></span>v</span>ar h=g.shiftRight(c);<span class="cstat-no" title="statement not covered" >f</span>=(f+1)&gt;&gt;1;<span class="cstat-no" title="statement not covered" >i</span>f(f&gt;lowprimes.length){<span class="cstat-no" title="statement not covered" >f=lowprimes.length}<span class="cstat-no" title="statement not covered" ></span>v</span>ar b=nbi();<span class="cstat-no" title="statement not covered" >f</span>or(var e=0;e&lt;f;++e){<span class="cstat-no" title="statement not covered" >b.fromInt(lowprimes[Math.floor(Math.random()*lowprimes.length)]);<span class="cstat-no" title="statement not covered" >v</span>ar l=b.modPow(h,this);<span class="cstat-no" title="statement not covered" >i</span>f(l.compareTo(BigInteger.ONE)!=0&amp;&amp;l.compareTo(g)!=0){<span class="cstat-no" title="statement not covered" >var d=1;<span class="cstat-no" title="statement not covered" >w</span>hile(d++&lt;c&amp;&amp;l.compareTo(g)!=0){<span class="cstat-no" title="statement not covered" >l=l.modPowInt(2,this);<span class="cstat-no" title="statement not covered" >i</span>f(l.compareTo(BigInteger.ONE)==0){<span class="cstat-no" title="statement not covered" >return false}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(l.compareTo(g)!=0){<span class="cstat-no" title="statement not covered" >return false}</span>}</span>}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn true}</span>BigInteger.prototype.chunkSize=bnpChunkSize;BigInteger.prototype.toRadix=bnpToRadix;BigInteger.prototype.fromRadix=bnpFromRadix;BigInteger.prototype.fromNumber=bnpFromNumber;BigInteger.prototype.bitwiseTo=bnpBitwiseTo;BigInteger.prototype.changeBit=bnpChangeBit;BigInteger.prototype.addTo=bnpAddTo;BigInteger.prototype.dMultiply=bnpDMultiply;BigInteger.prototype.dAddOffset=bnpDAddOffset;BigInteger.prototype.multiplyLowerTo=bnpMultiplyLowerTo;BigInteger.prototype.multiplyUpperTo=bnpMultiplyUpperTo;BigInteger.prototype.modInt=bnpModInt;BigInteger.prototype.millerRabin=bnpMillerRabin;BigInteger.prototype.clone=bnClone;BigInteger.prototype.intValue=bnIntValue;BigInteger.prototype.byteValue=bnByteValue;BigInteger.prototype.shortValue=bnShortValue;BigInteger.prototype.signum=bnSigNum;BigInteger.prototype.toByteArray=bnToByteArray;BigInteger.prototype.equals=bnEquals;BigInteger.prototype.min=bnMin;BigInteger.prototype.max=bnMax;BigInteger.prototype.and=bnAnd;BigInteger.prototype.or=bnOr;BigInteger.prototype.xor=bnXor;BigInteger.prototype.andNot=bnAndNot;BigInteger.prototype.not=bnNot;BigInteger.prototype.shiftLeft=bnShiftLeft;BigInteger.prototype.shiftRight=bnShiftRight;BigInteger.prototype.getLowestSetBit=bnGetLowestSetBit;BigInteger.prototype.bitCount=bnBitCount;BigInteger.prototype.testBit=bnTestBit;BigInteger.prototype.setBit=bnSetBit;BigInteger.prototype.clearBit=bnClearBit;BigInteger.prototype.flipBit=bnFlipBit;BigInteger.prototype.add=bnAdd;BigInteger.prototype.subtract=bnSubtract;BigInteger.prototype.multiply=bnMultiply;BigInteger.prototype.divide=bnDivide;BigInteger.prototype.remainder=bnRemainder;BigInteger.prototype.divideAndRemainder=bnDivideAndRemainder;BigInteger.prototype.modPow=bnModPow;BigInteger.prototype.modInverse=bnModInverse;BigInteger.prototype.pow=bnPow;BigInteger.prototype.gcd=bnGCD;BigInteger.prototype.isProbablePrime=bnIsProbablePrime;BigInteger.prototype.square=bnSquare;
/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */
<span class="fstat-no" title="function not covered" >function Arcfour(){<span class="cstat-no" title="statement not covered" ></span>this.i=0;<span class="cstat-no" title="statement not covered" >t</span>his.j=0;<span class="cstat-no" title="statement not covered" >t</span>his.S=new Array()}<span class="fstat-no" title="function not covered" ></span>function ARC4init(d){<span class="cstat-no" title="statement not covered" ></span>var c,a,b;<span class="cstat-no" title="statement not covered" >f</span>or(c=0;c&lt;256;++c){<span class="cstat-no" title="statement not covered" >this.S[c]=c}<span class="cstat-no" title="statement not covered" ></span>a</span>=0;<span class="cstat-no" title="statement not covered" >f</span>or(c=0;c&lt;256;++c){<span class="cstat-no" title="statement not covered" >a=(a+this.S[c]+d[c%d.length])&amp;255;<span class="cstat-no" title="statement not covered" >b</span>=this.S[c];<span class="cstat-no" title="statement not covered" >t</span>his.S[c]=this.S[a];<span class="cstat-no" title="statement not covered" >t</span>his.S[a]=b}<span class="cstat-no" title="statement not covered" ></span>t</span>his.i=0;<span class="cstat-no" title="statement not covered" >t</span>his.j=0}<span class="fstat-no" title="function not covered" ></span>function ARC4next(){<span class="cstat-no" title="statement not covered" ></span>var a;<span class="cstat-no" title="statement not covered" >t</span>his.i=(this.i+1)&amp;255;<span class="cstat-no" title="statement not covered" >t</span>his.j=(this.j+this.S[this.i])&amp;255;<span class="cstat-no" title="statement not covered" >a</span>=this.S[this.i];<span class="cstat-no" title="statement not covered" >t</span>his.S[this.i]=this.S[this.j];<span class="cstat-no" title="statement not covered" >t</span>his.S[this.j]=a;<span class="cstat-no" title="statement not covered" >r</span>eturn this.S[(a+this.S[this.i])&amp;255]}</span>Arcfour.prototype.init=ARC4init;Arcfour.prototype.next=ARC4next;<span class="fstat-no" title="function not covered" >function prng_newstate(){<span class="cstat-no" title="statement not covered" ></span>return new Arcfour()}</span>var rng_psize=256;
/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */
var rng_state;var rng_pool;var rng_pptr;function rng_seed_int(a){rng_pool[rng_pptr++]^=a&amp;255;rng_pool[rng_pptr++]^=(a&gt;&gt;8)&amp;255;rng_pool[rng_pptr++]^=(a&gt;&gt;16)&amp;255;rng_pool[rng_pptr++]^=(a&gt;&gt;24)&amp;255;<span class="missing-if-branch" title="if path not taken" >I</span>if(rng_pptr&gt;=rng_psize){<span class="cstat-no" title="statement not covered" >rng_pptr-=rng_psize}</span>}function rng_seed_time(){rng_seed_int(new Date().getTime())}<span class="missing-if-branch" title="else path not taken" >E</span>if(rng_pool==null){rng_pool=new Array();rng_pptr=0;var t;<span class="missing-if-branch" title="if path not taken" >I</span>if(window.crypto&amp;&amp;<span class="branch-1 cbranch-no" title="branch not covered" >window.crypto.getRandomValues)</span>{<span class="cstat-no" title="statement not covered" >var ua=new Uint8Array(32);<span class="cstat-no" title="statement not covered" >w</span>indow.crypto.getRandomValues(ua);<span class="cstat-no" title="statement not covered" >f</span>or(t=0;t&lt;32;++t){<span class="cstat-no" title="statement not covered" >rng_pool[rng_pptr++]=ua[t]}</span>}<span class="missing-if-branch" title="if path not taken" >I</span></span>if(navigator.appName=="Netscape"&amp;&amp;<span class="branch-1 cbranch-no" title="branch not covered" >navigator.appVersion&lt;"5"&amp;</span>&amp;<span class="branch-2 cbranch-no" title="branch not covered" >window.crypto&amp;</span>&amp;<span class="branch-3 cbranch-no" title="branch not covered" >window.crypto.random)</span>{<span class="cstat-no" title="statement not covered" >var z=window.crypto.random(32);<span class="cstat-no" title="statement not covered" >f</span>or(t=0;t&lt;z.length;++t){<span class="cstat-no" title="statement not covered" >rng_pool[rng_pptr++]=z.charCodeAt(t)&amp;255}</span>}</span>while(rng_pptr&lt;rng_psize){t=Math.floor(65536*Math.random());rng_pool[rng_pptr++]=t&gt;&gt;&gt;8;rng_pool[rng_pptr++]=t&amp;255}rng_pptr=0;rng_seed_time()}<span class="fstat-no" title="function not covered" >function rng_get_byte(){<span class="cstat-no" title="statement not covered" ></span>if(rng_state==null){<span class="cstat-no" title="statement not covered" >rng_seed_time();<span class="cstat-no" title="statement not covered" >r</span>ng_state=prng_newstate();<span class="cstat-no" title="statement not covered" >r</span>ng_state.init(rng_pool);<span class="cstat-no" title="statement not covered" >f</span>or(rng_pptr=0;rng_pptr&lt;rng_pool.length;++rng_pptr){<span class="cstat-no" title="statement not covered" >rng_pool[rng_pptr]=0}<span class="cstat-no" title="statement not covered" ></span>r</span>ng_pptr=0}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn rng_state.next()}<span class="fstat-no" title="function not covered" ></span>function rng_get_bytes(b){<span class="cstat-no" title="statement not covered" ></span>var a;<span class="cstat-no" title="statement not covered" >f</span>or(a=0;a&lt;b.length;++a){<span class="cstat-no" title="statement not covered" >b[a]=rng_get_byte()}</span>}</span>function SecureRandom(){}SecureRandom.prototype.nextBytes=rng_get_bytes;
/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */
<span class="fstat-no" title="function not covered" >function parseBigInt(b,a){<span class="cstat-no" title="statement not covered" ></span>return new BigInteger(b,a)}<span class="fstat-no" title="function not covered" ></span>function linebrk(c,d){<span class="cstat-no" title="statement not covered" ></span>var a="";<span class="cstat-no" title="statement not covered" >v</span>ar b=0;<span class="cstat-no" title="statement not covered" >w</span>hile(b+d&lt;c.length){<span class="cstat-no" title="statement not covered" >a+=c.substring(b,b+d)+"\n";<span class="cstat-no" title="statement not covered" >b</span>+=d}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn a+c.substring(b,c.length)}<span class="fstat-no" title="function not covered" ></span>function byte2Hex(a){<span class="cstat-no" title="statement not covered" ></span>if(a&lt;16){<span class="cstat-no" title="statement not covered" >return"0"+a.toString(16)}</span>else{<span class="cstat-no" title="statement not covered" >return a.toString(16)}</span>}<span class="fstat-no" title="function not covered" ></span>function pkcs1pad2(e,h){<span class="cstat-no" title="statement not covered" ></span>if(h&lt;e.length+11){<span class="cstat-no" title="statement not covered" >alert("Message too long for RSA");<span class="cstat-no" title="statement not covered" >r</span>eturn null}<span class="cstat-no" title="statement not covered" ></span>v</span>ar g=new Array();<span class="cstat-no" title="statement not covered" >v</span>ar d=e.length-1;<span class="cstat-no" title="statement not covered" >w</span>hile(d&gt;=0&amp;&amp;h&gt;0){<span class="cstat-no" title="statement not covered" >var f=e.charCodeAt(d--);<span class="cstat-no" title="statement not covered" >i</span>f(f&lt;128){<span class="cstat-no" title="statement not covered" >g[--h]=f}</span>else{<span class="cstat-no" title="statement not covered" >if((f&gt;127)&amp;&amp;(f&lt;2048)){<span class="cstat-no" title="statement not covered" >g[--h]=(f&amp;63)|128;<span class="cstat-no" title="statement not covered" >g</span>[--h]=(f&gt;&gt;6)|192}</span>else{<span class="cstat-no" title="statement not covered" >g[--h]=(f&amp;63)|128;<span class="cstat-no" title="statement not covered" >g</span>[--h]=((f&gt;&gt;6)&amp;63)|128;<span class="cstat-no" title="statement not covered" >g</span>[--h]=(f&gt;&gt;12)|224}</span>}</span>}<span class="cstat-no" title="statement not covered" ></span>g</span>[--h]=0;<span class="cstat-no" title="statement not covered" >v</span>ar b=new SecureRandom();<span class="cstat-no" title="statement not covered" >v</span>ar a=new Array();<span class="cstat-no" title="statement not covered" >w</span>hile(h&gt;2){<span class="cstat-no" title="statement not covered" >a[0]=0;<span class="cstat-no" title="statement not covered" >w</span>hile(a[0]==0){<span class="cstat-no" title="statement not covered" >b.nextBytes(a)}<span class="cstat-no" title="statement not covered" ></span>g</span>[--h]=a[0]}<span class="cstat-no" title="statement not covered" ></span>g</span>[--h]=2;<span class="cstat-no" title="statement not covered" >g</span>[--h]=0;<span class="cstat-no" title="statement not covered" >r</span>eturn new BigInteger(g)}<span class="fstat-no" title="function not covered" ></span>function oaep_mgf1_arr(c,a,e){<span class="cstat-no" title="statement not covered" ></span>var b="",d=0;<span class="cstat-no" title="statement not covered" >w</span>hile(b.length&lt;a){<span class="cstat-no" title="statement not covered" >b+=e(String.fromCharCode.apply(String,c.concat([(d&amp;4278190080)&gt;&gt;24,(d&amp;16711680)&gt;&gt;16,(d&amp;65280)&gt;&gt;8,d&amp;255])));<span class="cstat-no" title="statement not covered" >d</span>+=1}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn b}<span class="fstat-no" title="function not covered" ></span>function oaep_pad(q,a,f,l){<span class="cstat-no" title="statement not covered" ></span>var c=KJUR.crypto.MessageDigest;<span class="cstat-no" title="statement not covered" >v</span>ar o=KJUR.crypto.Util;<span class="cstat-no" title="statement not covered" >v</span>ar b=null;<span class="cstat-no" title="statement not covered" >i</span>f(!f){<span class="cstat-no" title="statement not covered" >f="sha1"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof f==="string"){<span class="cstat-no" title="statement not covered" >b=c.getCanonicalAlgName(f);<span class="cstat-no" title="statement not covered" >l</span>=c.getHashLength(b);<span class="cstat-no" title="statement not covered" >f</span>=<span class="fstat-no" title="function not covered" >function(i){<span class="cstat-no" title="statement not covered" ></span>return hextorstr(o.hashString(i,b))}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(q.length+2*l+2&gt;a){<span class="cstat-no" title="statement not covered" >throw"Message too long for RSA"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar k="",e;<span class="cstat-no" title="statement not covered" >f</span>or(e=0;e&lt;a-q.length-2*l-2;e+=1){<span class="cstat-no" title="statement not covered" >k+="\x00"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar h=f("")+k+"\x01"+q;<span class="cstat-no" title="statement not covered" >v</span>ar g=new Array(l);<span class="cstat-no" title="statement not covered" >n</span>ew SecureRandom().nextBytes(g);<span class="cstat-no" title="statement not covered" >v</span>ar j=oaep_mgf1_arr(g,h.length,f);<span class="cstat-no" title="statement not covered" >v</span>ar p=[];<span class="cstat-no" title="statement not covered" >f</span>or(e=0;e&lt;h.length;e+=1){<span class="cstat-no" title="statement not covered" >p[e]=h.charCodeAt(e)^j.charCodeAt(e)}<span class="cstat-no" title="statement not covered" ></span>v</span>ar m=oaep_mgf1_arr(p,g.length,f);<span class="cstat-no" title="statement not covered" >v</span>ar d=[0];<span class="cstat-no" title="statement not covered" >f</span>or(e=0;e&lt;g.length;e+=1){<span class="cstat-no" title="statement not covered" >d[e+1]=g[e]^m.charCodeAt(e)}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn new BigInteger(d.concat(p))}<span class="fstat-no" title="function not covered" ></span>function RSAKey(){<span class="cstat-no" title="statement not covered" ></span>this.n=null;<span class="cstat-no" title="statement not covered" >t</span>his.e=0;<span class="cstat-no" title="statement not covered" >t</span>his.d=null;<span class="cstat-no" title="statement not covered" >t</span>his.p=null;<span class="cstat-no" title="statement not covered" >t</span>his.q=null;<span class="cstat-no" title="statement not covered" >t</span>his.dmp1=null;<span class="cstat-no" title="statement not covered" >t</span>his.dmq1=null;<span class="cstat-no" title="statement not covered" >t</span>his.coeff=null}<span class="fstat-no" title="function not covered" ></span>function RSASetPublic(b,a){<span class="cstat-no" title="statement not covered" ></span>this.isPublic=true;<span class="cstat-no" title="statement not covered" >t</span>his.isPrivate=false;<span class="cstat-no" title="statement not covered" >i</span>f(typeof b!=="string"){<span class="cstat-no" title="statement not covered" >this.n=b;<span class="cstat-no" title="statement not covered" >t</span>his.e=a}</span>else{<span class="cstat-no" title="statement not covered" >if(b!=null&amp;&amp;a!=null&amp;&amp;b.length&gt;0&amp;&amp;a.length&gt;0){<span class="cstat-no" title="statement not covered" >this.n=parseBigInt(b,16);<span class="cstat-no" title="statement not covered" >t</span>his.e=parseInt(a,16)}</span>else{<span class="cstat-no" title="statement not covered" >throw"Invalid RSA public key"}</span>}</span>}<span class="fstat-no" title="function not covered" ></span>function RSADoPublic(a){<span class="cstat-no" title="statement not covered" ></span>return a.modPowInt(this.e,this.n)}<span class="fstat-no" title="function not covered" ></span>function RSAEncrypt(d){<span class="cstat-no" title="statement not covered" ></span>var a=pkcs1pad2(d,(this.n.bitLength()+7)&gt;&gt;3);<span class="cstat-no" title="statement not covered" >i</span>f(a==null){<span class="cstat-no" title="statement not covered" >return null}<span class="cstat-no" title="statement not covered" ></span>v</span>ar e=this.doPublic(a);<span class="cstat-no" title="statement not covered" >i</span>f(e==null){<span class="cstat-no" title="statement not covered" >return null}<span class="cstat-no" title="statement not covered" ></span>v</span>ar b=e.toString(16);<span class="cstat-no" title="statement not covered" >i</span>f((b.length&amp;1)==0){<span class="cstat-no" title="statement not covered" >return b}</span>else{<span class="cstat-no" title="statement not covered" >return"0"+b}</span>}<span class="fstat-no" title="function not covered" ></span>function RSAEncryptOAEP(f,e,b){<span class="cstat-no" title="statement not covered" ></span>var a=oaep_pad(f,(this.n.bitLength()+7)&gt;&gt;3,e,b);<span class="cstat-no" title="statement not covered" >i</span>f(a==null){<span class="cstat-no" title="statement not covered" >return null}<span class="cstat-no" title="statement not covered" ></span>v</span>ar g=this.doPublic(a);<span class="cstat-no" title="statement not covered" >i</span>f(g==null){<span class="cstat-no" title="statement not covered" >return null}<span class="cstat-no" title="statement not covered" ></span>v</span>ar d=g.toString(16);<span class="cstat-no" title="statement not covered" >i</span>f((d.length&amp;1)==0){<span class="cstat-no" title="statement not covered" >return d}</span>else{<span class="cstat-no" title="statement not covered" >return"0"+d}</span>}</span>RSAKey.prototype.doPublic=RSADoPublic;RSAKey.prototype.setPublic=RSASetPublic;RSAKey.prototype.encrypt=RSAEncrypt;RSAKey.prototype.encryptOAEP=RSAEncryptOAEP;RSAKey.prototype.type="RSA";
/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */
<span class="fstat-no" title="function not covered" >function pkcs1unpad2(g,j){<span class="cstat-no" title="statement not covered" ></span>var a=g.toByteArray();<span class="cstat-no" title="statement not covered" >v</span>ar f=0;<span class="cstat-no" title="statement not covered" >w</span>hile(f&lt;a.length&amp;&amp;a[f]==0){<span class="cstat-no" title="statement not covered" >++f}<span class="cstat-no" title="statement not covered" ></span>i</span>f(a.length-f!=j-1||a[f]!=2){<span class="cstat-no" title="statement not covered" >return null}<span class="cstat-no" title="statement not covered" ></span>+</span>+f;<span class="cstat-no" title="statement not covered" >w</span>hile(a[f]!=0){<span class="cstat-no" title="statement not covered" >if(++f&gt;=a.length){<span class="cstat-no" title="statement not covered" >return null}</span>}<span class="cstat-no" title="statement not covered" ></span>v</span>ar e="";<span class="cstat-no" title="statement not covered" >w</span>hile(++f&lt;a.length){<span class="cstat-no" title="statement not covered" >var h=a[f]&amp;255;<span class="cstat-no" title="statement not covered" >i</span>f(h&lt;128){<span class="cstat-no" title="statement not covered" >e+=String.fromCharCode(h)}</span>else{<span class="cstat-no" title="statement not covered" >if((h&gt;191)&amp;&amp;(h&lt;224)){<span class="cstat-no" title="statement not covered" >e+=String.fromCharCode(((h&amp;31)&lt;&lt;6)|(a[f+1]&amp;63));<span class="cstat-no" title="statement not covered" >+</span>+f}</span>else{<span class="cstat-no" title="statement not covered" >e+=String.fromCharCode(((h&amp;15)&lt;&lt;12)|((a[f+1]&amp;63)&lt;&lt;6)|(a[f+2]&amp;63));<span class="cstat-no" title="statement not covered" >f</span>+=2}</span>}</span>}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn e}<span class="fstat-no" title="function not covered" ></span>function oaep_mgf1_str(c,a,e){<span class="cstat-no" title="statement not covered" ></span>var b="",d=0;<span class="cstat-no" title="statement not covered" >w</span>hile(b.length&lt;a){<span class="cstat-no" title="statement not covered" >b+=e(c+String.fromCharCode.apply(String,[(d&amp;4278190080)&gt;&gt;24,(d&amp;16711680)&gt;&gt;16,(d&amp;65280)&gt;&gt;8,d&amp;255]));<span class="cstat-no" title="statement not covered" >d</span>+=1}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn b}<span class="fstat-no" title="function not covered" ></span>function oaep_unpad(o,b,g,p){<span class="cstat-no" title="statement not covered" ></span>var e=KJUR.crypto.MessageDigest;<span class="cstat-no" title="statement not covered" >v</span>ar r=KJUR.crypto.Util;<span class="cstat-no" title="statement not covered" >v</span>ar c=null;<span class="cstat-no" title="statement not covered" >i</span>f(!g){<span class="cstat-no" title="statement not covered" >g="sha1"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof g==="string"){<span class="cstat-no" title="statement not covered" >c=e.getCanonicalAlgName(g);<span class="cstat-no" title="statement not covered" >p</span>=e.getHashLength(c);<span class="cstat-no" title="statement not covered" >g</span>=<span class="fstat-no" title="function not covered" >function(d){<span class="cstat-no" title="statement not covered" ></span>return hextorstr(r.hashString(d,c))}</span>}<span class="cstat-no" title="statement not covered" ></span>o</span>=o.toByteArray();<span class="cstat-no" title="statement not covered" >v</span>ar h;<span class="cstat-no" title="statement not covered" >f</span>or(h=0;h&lt;o.length;h+=1){<span class="cstat-no" title="statement not covered" >o[h]&amp;=255}<span class="cstat-no" title="statement not covered" ></span>w</span>hile(o.length&lt;b){<span class="cstat-no" title="statement not covered" >o.unshift(0)}<span class="cstat-no" title="statement not covered" ></span>o</span>=String.fromCharCode.apply(String,o);<span class="cstat-no" title="statement not covered" >i</span>f(o.length&lt;2*p+2){<span class="cstat-no" title="statement not covered" >throw"Cipher too short"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar f=o.substr(1,p);<span class="cstat-no" title="statement not covered" >v</span>ar s=o.substr(p+1);<span class="cstat-no" title="statement not covered" >v</span>ar q=oaep_mgf1_str(s,p,g);<span class="cstat-no" title="statement not covered" >v</span>ar k=[],h;<span class="cstat-no" title="statement not covered" >f</span>or(h=0;h&lt;f.length;h+=1){<span class="cstat-no" title="statement not covered" >k[h]=f.charCodeAt(h)^q.charCodeAt(h)}<span class="cstat-no" title="statement not covered" ></span>v</span>ar l=oaep_mgf1_str(String.fromCharCode.apply(String,k),o.length-p,g);<span class="cstat-no" title="statement not covered" >v</span>ar j=[];<span class="cstat-no" title="statement not covered" >f</span>or(h=0;h&lt;s.length;h+=1){<span class="cstat-no" title="statement not covered" >j[h]=s.charCodeAt(h)^l.charCodeAt(h)}<span class="cstat-no" title="statement not covered" ></span>j</span>=String.fromCharCode.apply(String,j);<span class="cstat-no" title="statement not covered" >i</span>f(j.substr(0,p)!==g("")){<span class="cstat-no" title="statement not covered" >throw"Hash mismatch"}<span class="cstat-no" title="statement not covered" ></span>j</span>=j.substr(p);<span class="cstat-no" title="statement not covered" >v</span>ar a=j.indexOf("\x01");<span class="cstat-no" title="statement not covered" >v</span>ar m=(a!=-1)?j.substr(0,a).lastIndexOf("\x00"):-1;<span class="cstat-no" title="statement not covered" >i</span>f(m+1!=a){<span class="cstat-no" title="statement not covered" >throw"Malformed data"}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn j.substr(a+1)}<span class="fstat-no" title="function not covered" ></span>function RSASetPrivate(c,a,b){<span class="cstat-no" title="statement not covered" ></span>this.isPrivate=true;<span class="cstat-no" title="statement not covered" >i</span>f(typeof c!=="string"){<span class="cstat-no" title="statement not covered" >this.n=c;<span class="cstat-no" title="statement not covered" >t</span>his.e=a;<span class="cstat-no" title="statement not covered" >t</span>his.d=b}</span>else{<span class="cstat-no" title="statement not covered" >if(c!=null&amp;&amp;a!=null&amp;&amp;c.length&gt;0&amp;&amp;a.length&gt;0){<span class="cstat-no" title="statement not covered" >this.n=parseBigInt(c,16);<span class="cstat-no" title="statement not covered" >t</span>his.e=parseInt(a,16);<span class="cstat-no" title="statement not covered" >t</span>his.d=parseBigInt(b,16)}</span>else{<span class="cstat-no" title="statement not covered" >alert("Invalid RSA private key")}</span>}</span>}<span class="fstat-no" title="function not covered" ></span>function RSASetPrivateEx(g,d,e,c,b,a,h,f){<span class="cstat-no" title="statement not covered" ></span>this.isPrivate=true;<span class="cstat-no" title="statement not covered" >t</span>his.isPublic=false;<span class="cstat-no" title="statement not covered" >i</span>f(g==null){<span class="cstat-no" title="statement not covered" >throw"RSASetPrivateEx N == null"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(d==null){<span class="cstat-no" title="statement not covered" >throw"RSASetPrivateEx E == null"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(g.length==0){<span class="cstat-no" title="statement not covered" >throw"RSASetPrivateEx N.length == 0"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(d.length==0){<span class="cstat-no" title="statement not covered" >throw"RSASetPrivateEx E.length == 0"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(g!=null&amp;&amp;d!=null&amp;&amp;g.length&gt;0&amp;&amp;d.length&gt;0){<span class="cstat-no" title="statement not covered" >this.n=parseBigInt(g,16);<span class="cstat-no" title="statement not covered" >t</span>his.e=parseInt(d,16);<span class="cstat-no" title="statement not covered" >t</span>his.d=parseBigInt(e,16);<span class="cstat-no" title="statement not covered" >t</span>his.p=parseBigInt(c,16);<span class="cstat-no" title="statement not covered" >t</span>his.q=parseBigInt(b,16);<span class="cstat-no" title="statement not covered" >t</span>his.dmp1=parseBigInt(a,16);<span class="cstat-no" title="statement not covered" >t</span>his.dmq1=parseBigInt(h,16);<span class="cstat-no" title="statement not covered" >t</span>his.coeff=parseBigInt(f,16)}</span>else{<span class="cstat-no" title="statement not covered" >alert("Invalid RSA private key in RSASetPrivateEx")}</span>}<span class="fstat-no" title="function not covered" ></span>function RSAGenerate(b,i){<span class="cstat-no" title="statement not covered" ></span>var a=new SecureRandom();<span class="cstat-no" title="statement not covered" >v</span>ar f=b&gt;&gt;1;<span class="cstat-no" title="statement not covered" >t</span>his.e=parseInt(i,16);<span class="cstat-no" title="statement not covered" >v</span>ar c=new BigInteger(i,16);<span class="cstat-no" title="statement not covered" >f</span>or(;;){<span class="cstat-no" title="statement not covered" >for(;;){<span class="cstat-no" title="statement not covered" >this.p=new BigInteger(b-f,1,a);<span class="cstat-no" title="statement not covered" >i</span>f(this.p.subtract(BigInteger.ONE).gcd(c).compareTo(BigInteger.ONE)==0&amp;&amp;this.p.isProbablePrime(10)){<span class="cstat-no" title="statement not covered" >break}</span>}<span class="cstat-no" title="statement not covered" ></span>f</span>or(;;){<span class="cstat-no" title="statement not covered" >this.q=new BigInteger(f,1,a);<span class="cstat-no" title="statement not covered" >i</span>f(this.q.subtract(BigInteger.ONE).gcd(c).compareTo(BigInteger.ONE)==0&amp;&amp;this.q.isProbablePrime(10)){<span class="cstat-no" title="statement not covered" >break}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(this.p.compareTo(this.q)&lt;=0){<span class="cstat-no" title="statement not covered" >var h=this.p;<span class="cstat-no" title="statement not covered" >t</span>his.p=this.q;<span class="cstat-no" title="statement not covered" >t</span>his.q=h}<span class="cstat-no" title="statement not covered" ></span>v</span>ar g=this.p.subtract(BigInteger.ONE);<span class="cstat-no" title="statement not covered" >v</span>ar d=this.q.subtract(BigInteger.ONE);<span class="cstat-no" title="statement not covered" >v</span>ar e=g.multiply(d);<span class="cstat-no" title="statement not covered" >i</span>f(e.gcd(c).compareTo(BigInteger.ONE)==0){<span class="cstat-no" title="statement not covered" >this.n=this.p.multiply(this.q);<span class="cstat-no" title="statement not covered" >t</span>his.d=c.modInverse(e);<span class="cstat-no" title="statement not covered" >t</span>his.dmp1=this.d.mod(g);<span class="cstat-no" title="statement not covered" >t</span>his.dmq1=this.d.mod(d);<span class="cstat-no" title="statement not covered" >t</span>his.coeff=this.q.modInverse(this.p);<span class="cstat-no" title="statement not covered" >b</span>reak}</span>}<span class="cstat-no" title="statement not covered" ></span>t</span>his.isPrivate=true}<span class="fstat-no" title="function not covered" ></span>function RSADoPrivate(a){<span class="cstat-no" title="statement not covered" ></span>if(this.p==null||this.q==null){<span class="cstat-no" title="statement not covered" >return a.modPow(this.d,this.n)}<span class="cstat-no" title="statement not covered" ></span>v</span>ar c=a.mod(this.p).modPow(this.dmp1,this.p);<span class="cstat-no" title="statement not covered" >v</span>ar b=a.mod(this.q).modPow(this.dmq1,this.q);<span class="cstat-no" title="statement not covered" >w</span>hile(c.compareTo(b)&lt;0){<span class="cstat-no" title="statement not covered" >c=c.add(this.p)}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn c.subtract(b).multiply(this.coeff).mod(this.p).multiply(this.q).add(b)}<span class="fstat-no" title="function not covered" ></span>function RSADecrypt(b){<span class="cstat-no" title="statement not covered" ></span>var d=parseBigInt(b,16);<span class="cstat-no" title="statement not covered" >v</span>ar a=this.doPrivate(d);<span class="cstat-no" title="statement not covered" >i</span>f(a==null){<span class="cstat-no" title="statement not covered" >return null}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn pkcs1unpad2(a,(this.n.bitLength()+7)&gt;&gt;3)}<span class="fstat-no" title="function not covered" ></span>function RSADecryptOAEP(e,d,b){<span class="cstat-no" title="statement not covered" ></span>var f=parseBigInt(e,16);<span class="cstat-no" title="statement not covered" >v</span>ar a=this.doPrivate(f);<span class="cstat-no" title="statement not covered" >i</span>f(a==null){<span class="cstat-no" title="statement not covered" >return null}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn oaep_unpad(a,(this.n.bitLength()+7)&gt;&gt;3,d,b)}</span>RSAKey.prototype.doPrivate=RSADoPrivate;RSAKey.prototype.setPrivate=RSASetPrivate;RSAKey.prototype.setPrivateEx=RSASetPrivateEx;RSAKey.prototype.generate=RSAGenerate;RSAKey.prototype.decrypt=RSADecrypt;RSAKey.prototype.decryptOAEP=RSADecryptOAEP;
/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */
function ECFieldElementFp(b,a){this.x=a;this.q=b}<span class="fstat-no" title="function not covered" >function feFpEquals(a){<span class="cstat-no" title="statement not covered" ></span>if(a==this){<span class="cstat-no" title="statement not covered" >return true}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn(this.q.equals(a.q)&amp;&amp;this.x.equals(a.x))}<span class="fstat-no" title="function not covered" ></span>function feFpToBigInteger(){<span class="cstat-no" title="statement not covered" ></span>return this.x}<span class="fstat-no" title="function not covered" ></span>function feFpNegate(){<span class="cstat-no" title="statement not covered" ></span>return new ECFieldElementFp(this.q,this.x.negate().mod(this.q))}<span class="fstat-no" title="function not covered" ></span>function feFpAdd(a){<span class="cstat-no" title="statement not covered" ></span>return new ECFieldElementFp(this.q,this.x.add(a.toBigInteger()).mod(this.q))}<span class="fstat-no" title="function not covered" ></span>function feFpSubtract(a){<span class="cstat-no" title="statement not covered" ></span>return new ECFieldElementFp(this.q,this.x.subtract(a.toBigInteger()).mod(this.q))}<span class="fstat-no" title="function not covered" ></span>function feFpMultiply(a){<span class="cstat-no" title="statement not covered" ></span>return new ECFieldElementFp(this.q,this.x.multiply(a.toBigInteger()).mod(this.q))}<span class="fstat-no" title="function not covered" ></span>function feFpSquare(){<span class="cstat-no" title="statement not covered" ></span>return new ECFieldElementFp(this.q,this.x.square().mod(this.q))}<span class="fstat-no" title="function not covered" ></span>function feFpDivide(a){<span class="cstat-no" title="statement not covered" ></span>return new ECFieldElementFp(this.q,this.x.multiply(a.toBigInteger().modInverse(this.q)).mod(this.q))}</span>ECFieldElementFp.prototype.equals=feFpEquals;ECFieldElementFp.prototype.toBigInteger=feFpToBigInteger;ECFieldElementFp.prototype.negate=feFpNegate;ECFieldElementFp.prototype.add=feFpAdd;ECFieldElementFp.prototype.subtract=feFpSubtract;ECFieldElementFp.prototype.multiply=feFpMultiply;ECFieldElementFp.prototype.square=feFpSquare;ECFieldElementFp.prototype.divide=feFpDivide;function ECPointFp(c,a,d,b){this.curve=c;this.x=a;this.y=d;<span class="missing-if-branch" title="else path not taken" >E</span>if(b==null){this.z=BigInteger.ONE}else{<span class="cstat-no" title="statement not covered" >this.z=b}</span>this.zinv=null}<span class="fstat-no" title="function not covered" >function pointFpGetX(){<span class="cstat-no" title="statement not covered" ></span>if(this.zinv==null){<span class="cstat-no" title="statement not covered" >this.zinv=this.z.modInverse(this.curve.q)}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))}<span class="fstat-no" title="function not covered" ></span>function pointFpGetY(){<span class="cstat-no" title="statement not covered" ></span>if(this.zinv==null){<span class="cstat-no" title="statement not covered" >this.zinv=this.z.modInverse(this.curve.q)}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))}<span class="fstat-no" title="function not covered" ></span>function pointFpEquals(a){<span class="cstat-no" title="statement not covered" ></span>if(a==this){<span class="cstat-no" title="statement not covered" >return true}<span class="cstat-no" title="statement not covered" ></span>i</span>f(this.isInfinity()){<span class="cstat-no" title="statement not covered" >return a.isInfinity()}<span class="cstat-no" title="statement not covered" ></span>i</span>f(a.isInfinity()){<span class="cstat-no" title="statement not covered" >return this.isInfinity()}<span class="cstat-no" title="statement not covered" ></span>v</span>ar c,b;<span class="cstat-no" title="statement not covered" >c</span>=a.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(a.z)).mod(this.curve.q);<span class="cstat-no" title="statement not covered" >i</span>f(!c.equals(BigInteger.ZERO)){<span class="cstat-no" title="statement not covered" >return false}<span class="cstat-no" title="statement not covered" ></span>b</span>=a.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(a.z)).mod(this.curve.q);<span class="cstat-no" title="statement not covered" >r</span>eturn b.equals(BigInteger.ZERO)}<span class="fstat-no" title="function not covered" ></span>function pointFpIsInfinity(){<span class="cstat-no" title="statement not covered" ></span>if((this.x==null)&amp;&amp;(this.y==null)){<span class="cstat-no" title="statement not covered" >return true}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn this.z.equals(BigInteger.ZERO)&amp;&amp;!this.y.toBigInteger().equals(BigInteger.ZERO)}<span class="fstat-no" title="function not covered" ></span>function pointFpNegate(){<span class="cstat-no" title="statement not covered" ></span>return new ECPointFp(this.curve,this.x,this.y.negate(),this.z)}<span class="fstat-no" title="function not covered" ></span>function pointFpAdd(l){<span class="cstat-no" title="statement not covered" ></span>if(this.isInfinity()){<span class="cstat-no" title="statement not covered" >return l}<span class="cstat-no" title="statement not covered" ></span>i</span>f(l.isInfinity()){<span class="cstat-no" title="statement not covered" >return this}<span class="cstat-no" title="statement not covered" ></span>v</span>ar p=l.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(l.z)).mod(this.curve.q);<span class="cstat-no" title="statement not covered" >v</span>ar o=l.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(l.z)).mod(this.curve.q);<span class="cstat-no" title="statement not covered" >i</span>f(BigInteger.ZERO.equals(o)){<span class="cstat-no" title="statement not covered" >if(BigInteger.ZERO.equals(p)){<span class="cstat-no" title="statement not covered" >return this.twice()}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn this.curve.getInfinity()}<span class="cstat-no" title="statement not covered" ></span>v</span>ar j=new BigInteger("3");<span class="cstat-no" title="statement not covered" >v</span>ar e=this.x.toBigInteger();<span class="cstat-no" title="statement not covered" >v</span>ar n=this.y.toBigInteger();<span class="cstat-no" title="statement not covered" >v</span>ar c=l.x.toBigInteger();<span class="cstat-no" title="statement not covered" >v</span>ar k=l.y.toBigInteger();<span class="cstat-no" title="statement not covered" >v</span>ar m=o.square();<span class="cstat-no" title="statement not covered" >v</span>ar i=m.multiply(o);<span class="cstat-no" title="statement not covered" >v</span>ar d=e.multiply(m);<span class="cstat-no" title="statement not covered" >v</span>ar g=p.square().multiply(this.z);<span class="cstat-no" title="statement not covered" >v</span>ar a=g.subtract(d.shiftLeft(1)).multiply(l.z).subtract(i).multiply(o).mod(this.curve.q);<span class="cstat-no" title="statement not covered" >v</span>ar h=d.multiply(j).multiply(p).subtract(n.multiply(i)).subtract(g.multiply(p)).multiply(l.z).add(p.multiply(i)).mod(this.curve.q);<span class="cstat-no" title="statement not covered" >v</span>ar f=i.multiply(this.z).multiply(l.z).mod(this.curve.q);<span class="cstat-no" title="statement not covered" >r</span>eturn new ECPointFp(this.curve,this.curve.fromBigInteger(a),this.curve.fromBigInteger(h),f)}<span class="fstat-no" title="function not covered" ></span>function pointFpTwice(){<span class="cstat-no" title="statement not covered" ></span>if(this.isInfinity()){<span class="cstat-no" title="statement not covered" >return this}<span class="cstat-no" title="statement not covered" ></span>i</span>f(this.y.toBigInteger().signum()==0){<span class="cstat-no" title="statement not covered" >return this.curve.getInfinity()}<span class="cstat-no" title="statement not covered" ></span>v</span>ar g=new BigInteger("3");<span class="cstat-no" title="statement not covered" >v</span>ar c=this.x.toBigInteger();<span class="cstat-no" title="statement not covered" >v</span>ar h=this.y.toBigInteger();<span class="cstat-no" title="statement not covered" >v</span>ar e=h.multiply(this.z);<span class="cstat-no" title="statement not covered" >v</span>ar j=e.multiply(h).mod(this.curve.q);<span class="cstat-no" title="statement not covered" >v</span>ar i=this.curve.a.toBigInteger();<span class="cstat-no" title="statement not covered" >v</span>ar k=c.square().multiply(g);<span class="cstat-no" title="statement not covered" >i</span>f(!BigInteger.ZERO.equals(i)){<span class="cstat-no" title="statement not covered" >k=k.add(this.z.square().multiply(i))}<span class="cstat-no" title="statement not covered" ></span>k</span>=k.mod(this.curve.q);<span class="cstat-no" title="statement not covered" >v</span>ar b=k.square().subtract(c.shiftLeft(3).multiply(j)).shiftLeft(1).multiply(e).mod(this.curve.q);<span class="cstat-no" title="statement not covered" >v</span>ar f=k.multiply(g).multiply(c).subtract(j.shiftLeft(1)).shiftLeft(2).multiply(j).subtract(k.square().multiply(k)).mod(this.curve.q);<span class="cstat-no" title="statement not covered" >v</span>ar d=e.square().multiply(e).shiftLeft(3).mod(this.curve.q);<span class="cstat-no" title="statement not covered" >r</span>eturn new ECPointFp(this.curve,this.curve.fromBigInteger(b),this.curve.fromBigInteger(f),d)}<span class="fstat-no" title="function not covered" ></span>function pointFpMultiply(b){<span class="cstat-no" title="statement not covered" ></span>if(this.isInfinity()){<span class="cstat-no" title="statement not covered" >return this}<span class="cstat-no" title="statement not covered" ></span>i</span>f(b.signum()==0){<span class="cstat-no" title="statement not covered" >return this.curve.getInfinity()}<span class="cstat-no" title="statement not covered" ></span>v</span>ar g=b;<span class="cstat-no" title="statement not covered" >v</span>ar f=g.multiply(new BigInteger("3"));<span class="cstat-no" title="statement not covered" >v</span>ar l=this.negate();<span class="cstat-no" title="statement not covered" >v</span>ar d=this;<span class="cstat-no" title="statement not covered" >v</span>ar c;<span class="cstat-no" title="statement not covered" >f</span>or(c=f.bitLength()-2;c&gt;0;--c){<span class="cstat-no" title="statement not covered" >d=d.twice();<span class="cstat-no" title="statement not covered" >v</span>ar a=f.testBit(c);<span class="cstat-no" title="statement not covered" >v</span>ar j=g.testBit(c);<span class="cstat-no" title="statement not covered" >i</span>f(a!=j){<span class="cstat-no" title="statement not covered" >d=d.add(a?this:l)}</span>}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn d}<span class="fstat-no" title="function not covered" ></span>function pointFpMultiplyTwo(c,a,b){<span class="cstat-no" title="statement not covered" ></span>var d;<span class="cstat-no" title="statement not covered" >i</span>f(c.bitLength()&gt;b.bitLength()){<span class="cstat-no" title="statement not covered" >d=c.bitLength()-1}</span>else{<span class="cstat-no" title="statement not covered" >d=b.bitLength()-1}<span class="cstat-no" title="statement not covered" ></span>v</span>ar f=this.curve.getInfinity();<span class="cstat-no" title="statement not covered" >v</span>ar e=this.add(a);<span class="cstat-no" title="statement not covered" >w</span>hile(d&gt;=0){<span class="cstat-no" title="statement not covered" >f=f.twice();<span class="cstat-no" title="statement not covered" >i</span>f(c.testBit(d)){<span class="cstat-no" title="statement not covered" >if(b.testBit(d)){<span class="cstat-no" title="statement not covered" >f=f.add(e)}</span>else{<span class="cstat-no" title="statement not covered" >f=f.add(this)}</span>}</span>else{<span class="cstat-no" title="statement not covered" >if(b.testBit(d)){<span class="cstat-no" title="statement not covered" >f=f.add(a)}</span>}<span class="cstat-no" title="statement not covered" ></span>-</span>-d}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn f}</span>ECPointFp.prototype.getX=pointFpGetX;ECPointFp.prototype.getY=pointFpGetY;ECPointFp.prototype.equals=pointFpEquals;ECPointFp.prototype.isInfinity=pointFpIsInfinity;ECPointFp.prototype.negate=pointFpNegate;ECPointFp.prototype.add=pointFpAdd;ECPointFp.prototype.twice=pointFpTwice;ECPointFp.prototype.multiply=pointFpMultiply;ECPointFp.prototype.multiplyTwo=pointFpMultiplyTwo;function ECCurveFp(e,d,c){this.q=e;this.a=this.fromBigInteger(d);this.b=this.fromBigInteger(c);this.infinity=new ECPointFp(this,null,null)}<span class="fstat-no" title="function not covered" >function curveFpGetQ(){<span class="cstat-no" title="statement not covered" ></span>return this.q}<span class="fstat-no" title="function not covered" ></span>function curveFpGetA(){<span class="cstat-no" title="statement not covered" ></span>return this.a}<span class="fstat-no" title="function not covered" ></span>function curveFpGetB(){<span class="cstat-no" title="statement not covered" ></span>return this.b}<span class="fstat-no" title="function not covered" ></span>function curveFpEquals(a){<span class="cstat-no" title="statement not covered" ></span>if(a==this){<span class="cstat-no" title="statement not covered" >return true}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn(this.q.equals(a.q)&amp;&amp;this.a.equals(a.a)&amp;&amp;this.b.equals(a.b))}<span class="fstat-no" title="function not covered" ></span>function curveFpGetInfinity(){<span class="cstat-no" title="statement not covered" ></span>return this.infinity}</span>function curveFpFromBigInteger(a){return new ECFieldElementFp(this.q,a)}function curveFpDecodePointHex(d){switch(parseInt(d.substr(0,2),16)){<span class="branch-0 cbranch-no" title="branch not covered" >case 0:<span class="cstat-no" title="statement not covered" >return this.infinity;<span class="branch-1 cbranch-no" title="branch not covered" >c</span></span>ase 2:<span class="branch-2 cbranch-no" title="branch not covered" >c</span>ase 3:<span class="cstat-no" title="statement not covered" >return null;c</span></span>ase 4:case 6:case 7:var a=(d.length-2)/2;var c=d.substr(2,a);var b=d.substr(a+2,a);return new ECPointFp(this,this.fromBigInteger(new BigInteger(c,16)),this.fromBigInteger(new BigInteger(b,16)));<span class="branch-6 cbranch-no" title="branch not covered" >default:<span class="cstat-no" title="statement not covered" >return null}</span></span>}ECCurveFp.prototype.getQ=curveFpGetQ;ECCurveFp.prototype.getA=curveFpGetA;ECCurveFp.prototype.getB=curveFpGetB;ECCurveFp.prototype.equals=curveFpEquals;ECCurveFp.prototype.getInfinity=curveFpGetInfinity;ECCurveFp.prototype.fromBigInteger=curveFpFromBigInteger;ECCurveFp.prototype.decodePointHex=curveFpDecodePointHex;
/*! (c) Stefan Thomas | https://github.com/bitcoinjs/bitcoinjs-lib
 */
ECFieldElementFp.prototype.getByteLength=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>return Math.floor((this.toBigInteger().bitLength()+7)/8)}</span>;ECPointFp.prototype.getEncoded=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>var d=<span class="fstat-no" title="function not covered" >function(h,f){<span class="cstat-no" title="statement not covered" ></span>var g=h.toByteArrayUnsigned();<span class="cstat-no" title="statement not covered" >i</span>f(f&lt;g.length){<span class="cstat-no" title="statement not covered" >g=g.slice(g.length-f)}</span>else{<span class="cstat-no" title="statement not covered" >while(f&gt;g.length){<span class="cstat-no" title="statement not covered" >g.unshift(0)}</span>}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn g}</span>;<span class="cstat-no" title="statement not covered" >v</span>ar a=this.getX().toBigInteger();<span class="cstat-no" title="statement not covered" >v</span>ar e=this.getY().toBigInteger();<span class="cstat-no" title="statement not covered" >v</span>ar b=d(a,32);<span class="cstat-no" title="statement not covered" >i</span>f(c){<span class="cstat-no" title="statement not covered" >if(e.isEven()){<span class="cstat-no" title="statement not covered" >b.unshift(2)}</span>else{<span class="cstat-no" title="statement not covered" >b.unshift(3)}</span>}</span>else{<span class="cstat-no" title="statement not covered" >b.unshift(4);<span class="cstat-no" title="statement not covered" >b</span>=b.concat(d(e,32))}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn b}</span>;ECPointFp.decodeFrom=<span class="fstat-no" title="function not covered" >function(g,c){<span class="cstat-no" title="statement not covered" ></span>var f=c[0];<span class="cstat-no" title="statement not covered" >v</span>ar e=c.length-1;<span class="cstat-no" title="statement not covered" >v</span>ar d=c.slice(1,1+e/2);<span class="cstat-no" title="statement not covered" >v</span>ar b=c.slice(1+e/2,1+e);<span class="cstat-no" title="statement not covered" >d</span>.unshift(0);<span class="cstat-no" title="statement not covered" >b</span>.unshift(0);<span class="cstat-no" title="statement not covered" >v</span>ar a=new BigInteger(d);<span class="cstat-no" title="statement not covered" >v</span>ar h=new BigInteger(b);<span class="cstat-no" title="statement not covered" >r</span>eturn new ECPointFp(g,g.fromBigInteger(a),g.fromBigInteger(h))}</span>;ECPointFp.decodeFromHex=<span class="fstat-no" title="function not covered" >function(g,c){<span class="cstat-no" title="statement not covered" ></span>var f=c.substr(0,2);<span class="cstat-no" title="statement not covered" >v</span>ar e=c.length-2;<span class="cstat-no" title="statement not covered" >v</span>ar d=c.substr(2,e/2);<span class="cstat-no" title="statement not covered" >v</span>ar b=c.substr(2+e/2,e/2);<span class="cstat-no" title="statement not covered" >v</span>ar a=new BigInteger(d,16);<span class="cstat-no" title="statement not covered" >v</span>ar h=new BigInteger(b,16);<span class="cstat-no" title="statement not covered" >r</span>eturn new ECPointFp(g,g.fromBigInteger(a),g.fromBigInteger(h))}</span>;ECPointFp.prototype.add2D=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>if(this.isInfinity()){<span class="cstat-no" title="statement not covered" >return c}<span class="cstat-no" title="statement not covered" ></span>i</span>f(c.isInfinity()){<span class="cstat-no" title="statement not covered" >return this}<span class="cstat-no" title="statement not covered" ></span>i</span>f(this.x.equals(c.x)){<span class="cstat-no" title="statement not covered" >if(this.y.equals(c.y)){<span class="cstat-no" title="statement not covered" >return this.twice()}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn this.curve.getInfinity()}<span class="cstat-no" title="statement not covered" ></span>v</span>ar g=c.x.subtract(this.x);<span class="cstat-no" title="statement not covered" >v</span>ar e=c.y.subtract(this.y);<span class="cstat-no" title="statement not covered" >v</span>ar a=e.divide(g);<span class="cstat-no" title="statement not covered" >v</span>ar d=a.square().subtract(this.x).subtract(c.x);<span class="cstat-no" title="statement not covered" >v</span>ar f=a.multiply(this.x.subtract(d)).subtract(this.y);<span class="cstat-no" title="statement not covered" >r</span>eturn new ECPointFp(this.curve,d,f)}</span>;ECPointFp.prototype.twice2D=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>if(this.isInfinity()){<span class="cstat-no" title="statement not covered" >return this}<span class="cstat-no" title="statement not covered" ></span>i</span>f(this.y.toBigInteger().signum()==0){<span class="cstat-no" title="statement not covered" >return this.curve.getInfinity()}<span class="cstat-no" title="statement not covered" ></span>v</span>ar b=this.curve.fromBigInteger(BigInteger.valueOf(2));<span class="cstat-no" title="statement not covered" >v</span>ar e=this.curve.fromBigInteger(BigInteger.valueOf(3));<span class="cstat-no" title="statement not covered" >v</span>ar a=this.x.square().multiply(e).add(this.curve.a).divide(this.y.multiply(b));<span class="cstat-no" title="statement not covered" >v</span>ar c=a.square().subtract(this.x.multiply(b));<span class="cstat-no" title="statement not covered" >v</span>ar d=a.multiply(this.x.subtract(c)).subtract(this.y);<span class="cstat-no" title="statement not covered" >r</span>eturn new ECPointFp(this.curve,c,d)}</span>;ECPointFp.prototype.multiply2D=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>if(this.isInfinity()){<span class="cstat-no" title="statement not covered" >return this}<span class="cstat-no" title="statement not covered" ></span>i</span>f(b.signum()==0){<span class="cstat-no" title="statement not covered" >return this.curve.getInfinity()}<span class="cstat-no" title="statement not covered" ></span>v</span>ar g=b;<span class="cstat-no" title="statement not covered" >v</span>ar f=g.multiply(new BigInteger("3"));<span class="cstat-no" title="statement not covered" >v</span>ar l=this.negate();<span class="cstat-no" title="statement not covered" >v</span>ar d=this;<span class="cstat-no" title="statement not covered" >v</span>ar c;<span class="cstat-no" title="statement not covered" >f</span>or(c=f.bitLength()-2;c&gt;0;--c){<span class="cstat-no" title="statement not covered" >d=d.twice();<span class="cstat-no" title="statement not covered" >v</span>ar a=f.testBit(c);<span class="cstat-no" title="statement not covered" >v</span>ar j=g.testBit(c);<span class="cstat-no" title="statement not covered" >i</span>f(a!=j){<span class="cstat-no" title="statement not covered" >d=d.add2D(a?this:l)}</span>}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn d}</span>;ECPointFp.prototype.isOnCurve=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var d=this.getX().toBigInteger();<span class="cstat-no" title="statement not covered" >v</span>ar i=this.getY().toBigInteger();<span class="cstat-no" title="statement not covered" >v</span>ar f=this.curve.getA().toBigInteger();<span class="cstat-no" title="statement not covered" >v</span>ar c=this.curve.getB().toBigInteger();<span class="cstat-no" title="statement not covered" >v</span>ar h=this.curve.getQ();<span class="cstat-no" title="statement not covered" >v</span>ar e=i.multiply(i).mod(h);<span class="cstat-no" title="statement not covered" >v</span>ar g=d.multiply(d).multiply(d).add(f.multiply(d)).add(c).mod(h);<span class="cstat-no" title="statement not covered" >r</span>eturn e.equals(g)}</span>;ECPointFp.prototype.toString=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"}</span>;ECPointFp.prototype.validate=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var c=this.curve.getQ();<span class="cstat-no" title="statement not covered" >i</span>f(this.isInfinity()){<span class="cstat-no" title="statement not covered" >throw new Error("Point is at infinity.")}<span class="cstat-no" title="statement not covered" ></span>v</span>ar a=this.getX().toBigInteger();<span class="cstat-no" title="statement not covered" >v</span>ar b=this.getY().toBigInteger();<span class="cstat-no" title="statement not covered" >i</span>f(a.compareTo(BigInteger.ONE)&lt;0||a.compareTo(c.subtract(BigInteger.ONE))&gt;0){<span class="cstat-no" title="statement not covered" >throw new Error("x coordinate out of bounds")}<span class="cstat-no" title="statement not covered" ></span>i</span>f(b.compareTo(BigInteger.ONE)&lt;0||b.compareTo(c.subtract(BigInteger.ONE))&gt;0){<span class="cstat-no" title="statement not covered" >throw new Error("y coordinate out of bounds")}<span class="cstat-no" title="statement not covered" ></span>i</span>f(!this.isOnCurve()){<span class="cstat-no" title="statement not covered" >throw new Error("Point is not on the curve.")}<span class="cstat-no" title="statement not covered" ></span>i</span>f(this.multiply(c).isInfinity()){<span class="cstat-no" title="statement not covered" >throw new Error("Point is not a scalar multiple of G.")}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn true}</span>;
/*! Mike Samuel (c) 2009 | code.google.com/p/json-sans-eval
 */
var jsonParse=(function(){var e="(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)";var j='(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))';var i='(?:"'+j+'*")';var d=new RegExp("(?:false|true|null|[\\{\\}\\[\\]]|"+e+"|"+i+")","g");var k=new RegExp("\\\\(?:([^u])|u(.{4}))","g");var g={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"};<span class="fstat-no" title="function not covered" >function h(l,m,n){<span class="cstat-no" title="statement not covered" ></span>return m?g[m]:String.fromCharCode(parseInt(n,16))}</span>var c=new String("");var a="\\";var f={"{":Object,"[":Array};var b=Object.hasOwnProperty;return <span class="fstat-no" title="function not covered" >function(u,q){<span class="cstat-no" title="statement not covered" ></span>var p=u.match(d);<span class="cstat-no" title="statement not covered" >v</span>ar x;<span class="cstat-no" title="statement not covered" >v</span>ar v=p[0];<span class="cstat-no" title="statement not covered" >v</span>ar l=false;<span class="cstat-no" title="statement not covered" >i</span>f("{"===v){<span class="cstat-no" title="statement not covered" >x={}}</span>else{<span class="cstat-no" title="statement not covered" >if("["===v){<span class="cstat-no" title="statement not covered" >x=[]}</span>else{<span class="cstat-no" title="statement not covered" >x=[];<span class="cstat-no" title="statement not covered" >l</span>=true}</span>}<span class="cstat-no" title="statement not covered" ></span>v</span>ar t;<span class="cstat-no" title="statement not covered" >v</span>ar r=[x];<span class="cstat-no" title="statement not covered" >f</span>or(var o=1-l,m=p.length;o&lt;m;++o){<span class="cstat-no" title="statement not covered" >v=p[o];<span class="cstat-no" title="statement not covered" >v</span>ar w;<span class="cstat-no" title="statement not covered" >s</span>witch(v.charCodeAt(0)){default:<span class="cstat-no" title="statement not covered" >w=r[0];<span class="cstat-no" title="statement not covered" >w</span>[t||w.length]=+(v);<span class="cstat-no" title="statement not covered" >t</span>=void 0;<span class="cstat-no" title="statement not covered" >b</span>reak;c</span>ase 34:<span class="cstat-no" title="statement not covered" >v=v.substring(1,v.length-1);<span class="cstat-no" title="statement not covered" >i</span>f(v.indexOf(a)!==-1){<span class="cstat-no" title="statement not covered" >v=v.replace(k,h)}<span class="cstat-no" title="statement not covered" ></span>w</span>=r[0];<span class="cstat-no" title="statement not covered" >i</span>f(!t){<span class="cstat-no" title="statement not covered" >if(w instanceof Array){<span class="cstat-no" title="statement not covered" >t=w.length}</span>else{<span class="cstat-no" title="statement not covered" >t=v||c;<span class="cstat-no" title="statement not covered" >b</span>reak}</span>}<span class="cstat-no" title="statement not covered" ></span>w</span>[t]=v;<span class="cstat-no" title="statement not covered" >t</span>=void 0;<span class="cstat-no" title="statement not covered" >b</span>reak;c</span>ase 91:<span class="cstat-no" title="statement not covered" >w=r[0];<span class="cstat-no" title="statement not covered" >r</span>.unshift(w[t||w.length]=[]);<span class="cstat-no" title="statement not covered" >t</span>=void 0;<span class="cstat-no" title="statement not covered" >b</span>reak;c</span>ase 93:<span class="cstat-no" title="statement not covered" >r.shift();<span class="cstat-no" title="statement not covered" >b</span>reak;c</span>ase 102:<span class="cstat-no" title="statement not covered" >w=r[0];<span class="cstat-no" title="statement not covered" >w</span>[t||w.length]=false;<span class="cstat-no" title="statement not covered" >t</span>=void 0;<span class="cstat-no" title="statement not covered" >b</span>reak;c</span>ase 110:<span class="cstat-no" title="statement not covered" >w=r[0];<span class="cstat-no" title="statement not covered" >w</span>[t||w.length]=null;<span class="cstat-no" title="statement not covered" >t</span>=void 0;<span class="cstat-no" title="statement not covered" >b</span>reak;c</span>ase 116:<span class="cstat-no" title="statement not covered" >w=r[0];<span class="cstat-no" title="statement not covered" >w</span>[t||w.length]=true;<span class="cstat-no" title="statement not covered" >t</span>=void 0;<span class="cstat-no" title="statement not covered" >b</span>reak;c</span>ase 123:<span class="cstat-no" title="statement not covered" >w=r[0];<span class="cstat-no" title="statement not covered" >r</span>.unshift(w[t||w.length]={});<span class="cstat-no" title="statement not covered" >t</span>=void 0;<span class="cstat-no" title="statement not covered" >b</span>reak;c</span>ase 125:<span class="cstat-no" title="statement not covered" >r.shift();<span class="cstat-no" title="statement not covered" >b</span>reak}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(l){<span class="cstat-no" title="statement not covered" >if(r.length!==1){<span class="cstat-no" title="statement not covered" >throw new Error()}<span class="cstat-no" title="statement not covered" ></span>x</span>=x[0]}</span>else{<span class="cstat-no" title="statement not covered" >if(r.length){<span class="cstat-no" title="statement not covered" >throw new Error()}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(q){<span class="cstat-no" title="statement not covered" >var s=<span class="fstat-no" title="function not covered" >function(C,B){<span class="cstat-no" title="statement not covered" ></span>var D=C[B];<span class="cstat-no" title="statement not covered" >i</span>f(D&amp;&amp;typeof D==="object"){<span class="cstat-no" title="statement not covered" >var n=null;<span class="cstat-no" title="statement not covered" >f</span>or(var z in D){<span class="cstat-no" title="statement not covered" >if(b.call(D,z)&amp;&amp;D!==C){<span class="cstat-no" title="statement not covered" >var y=s(D,z);<span class="cstat-no" title="statement not covered" >i</span>f(y!==void 0){<span class="cstat-no" title="statement not covered" >D[z]=y}</span>else{<span class="cstat-no" title="statement not covered" >if(!n){<span class="cstat-no" title="statement not covered" >n=[]}<span class="cstat-no" title="statement not covered" ></span>n</span>.push(z)}</span>}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(n){<span class="cstat-no" title="statement not covered" >for(var A=n.length;--A&gt;=0;){<span class="cstat-no" title="statement not covered" >delete D[n[A]]}</span>}</span>}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn q.call(C,B,D)}</span>;<span class="cstat-no" title="statement not covered" >x</span>=s({"":x},"")}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn x}</span>})();
/*! asn1-1.0.12.js (c) 2013-2016 Kenji Urushima | kjur.github.com/jsrsasign/license
 */
<span class="missing-if-branch" title="else path not taken" >E</span>if(typeof KJUR=="undefined"||<span class="branch-1 cbranch-no" title="branch not covered" >!KJUR)</span>{KJUR={}}<span class="missing-if-branch" title="else path not taken" >E</span>if(typeof KJUR.asn1=="undefined"||<span class="branch-1 cbranch-no" title="branch not covered" >!KJUR.asn1)</span>{KJUR.asn1={}}KJUR.asn1.ASN1Util=new function(){this.integerToByteHex=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>var b=a.toString(16);<span class="cstat-no" title="statement not covered" >i</span>f((b.length%2)==1){<span class="cstat-no" title="statement not covered" >b="0"+b}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn b}</span>;this.bigIntToMinTwosComplementsHex=<span class="fstat-no" title="function not covered" >function(j){<span class="cstat-no" title="statement not covered" ></span>var f=j.toString(16);<span class="cstat-no" title="statement not covered" >i</span>f(f.substr(0,1)!="-"){<span class="cstat-no" title="statement not covered" >if(f.length%2==1){<span class="cstat-no" title="statement not covered" >f="0"+f}</span>else{<span class="cstat-no" title="statement not covered" >if(!f.match(/^[0-7]/)){<span class="cstat-no" title="statement not covered" >f="00"+f}</span>}</span>}</span>else{<span class="cstat-no" title="statement not covered" >var a=f.substr(1);<span class="cstat-no" title="statement not covered" >v</span>ar e=a.length;<span class="cstat-no" title="statement not covered" >i</span>f(e%2==1){<span class="cstat-no" title="statement not covered" >e+=1}</span>else{<span class="cstat-no" title="statement not covered" >if(!f.match(/^[0-7]/)){<span class="cstat-no" title="statement not covered" >e+=2}</span>}<span class="cstat-no" title="statement not covered" ></span>v</span>ar g="";<span class="cstat-no" title="statement not covered" >f</span>or(var d=0;d&lt;e;d++){<span class="cstat-no" title="statement not covered" >g+="f"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar c=new BigInteger(g,16);<span class="cstat-no" title="statement not covered" >v</span>ar b=c.xor(j).add(BigInteger.ONE);<span class="cstat-no" title="statement not covered" >f</span>=b.toString(16).replace(/^-/,"")}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn f}</span>;this.getPEMStringFromHex=<span class="fstat-no" title="function not covered" >function(a,b){<span class="cstat-no" title="statement not covered" ></span>var c=hextob64(a);<span class="cstat-no" title="statement not covered" >v</span>ar d=c.replace(/(.{64})/g,"$1\r\n");<span class="cstat-no" title="statement not covered" >d</span>=d.replace(/\r\n$/,"");<span class="cstat-no" title="statement not covered" >r</span>eturn"-----BEGIN "+b+"-----\r\n"+d+"\r\n-----END "+b+"-----\r\n"}</span>;this.newObject=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>var g=KJUR.asn1;<span class="cstat-no" title="statement not covered" >v</span>ar k=Object.keys(b);<span class="cstat-no" title="statement not covered" >i</span>f(k.length!=1){<span class="cstat-no" title="statement not covered" >throw"key of param shall be only one."}<span class="cstat-no" title="statement not covered" ></span>v</span>ar j=k[0];<span class="cstat-no" title="statement not covered" >i</span>f(":bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:seq:set:tag:".indexOf(":"+j+":")==-1){<span class="cstat-no" title="statement not covered" >throw"undefined key: "+j}<span class="cstat-no" title="statement not covered" ></span>i</span>f(j=="bool"){<span class="cstat-no" title="statement not covered" >return new g.DERBoolean(b[j])}<span class="cstat-no" title="statement not covered" ></span>i</span>f(j=="int"){<span class="cstat-no" title="statement not covered" >return new g.DERInteger(b[j])}<span class="cstat-no" title="statement not covered" ></span>i</span>f(j=="bitstr"){<span class="cstat-no" title="statement not covered" >return new g.DERBitString(b[j])}<span class="cstat-no" title="statement not covered" ></span>i</span>f(j=="octstr"){<span class="cstat-no" title="statement not covered" >return new g.DEROctetString(b[j])}<span class="cstat-no" title="statement not covered" ></span>i</span>f(j=="null"){<span class="cstat-no" title="statement not covered" >return new g.DERNull(b[j])}<span class="cstat-no" title="statement not covered" ></span>i</span>f(j=="oid"){<span class="cstat-no" title="statement not covered" >return new g.DERObjectIdentifier(b[j])}<span class="cstat-no" title="statement not covered" ></span>i</span>f(j=="enum"){<span class="cstat-no" title="statement not covered" >return new g.DEREnumerated(b[j])}<span class="cstat-no" title="statement not covered" ></span>i</span>f(j=="utf8str"){<span class="cstat-no" title="statement not covered" >return new g.DERUTF8String(b[j])}<span class="cstat-no" title="statement not covered" ></span>i</span>f(j=="numstr"){<span class="cstat-no" title="statement not covered" >return new g.DERNumericString(b[j])}<span class="cstat-no" title="statement not covered" ></span>i</span>f(j=="prnstr"){<span class="cstat-no" title="statement not covered" >return new g.DERPrintableString(b[j])}<span class="cstat-no" title="statement not covered" ></span>i</span>f(j=="telstr"){<span class="cstat-no" title="statement not covered" >return new g.DERTeletexString(b[j])}<span class="cstat-no" title="statement not covered" ></span>i</span>f(j=="ia5str"){<span class="cstat-no" title="statement not covered" >return new g.DERIA5String(b[j])}<span class="cstat-no" title="statement not covered" ></span>i</span>f(j=="utctime"){<span class="cstat-no" title="statement not covered" >return new g.DERUTCTime(b[j])}<span class="cstat-no" title="statement not covered" ></span>i</span>f(j=="gentime"){<span class="cstat-no" title="statement not covered" >return new g.DERGeneralizedTime(b[j])}<span class="cstat-no" title="statement not covered" ></span>i</span>f(j=="seq"){<span class="cstat-no" title="statement not covered" >var m=b[j];<span class="cstat-no" title="statement not covered" >v</span>ar h=[];<span class="cstat-no" title="statement not covered" >f</span>or(var e=0;e&lt;m.length;e++){<span class="cstat-no" title="statement not covered" >var l=g.ASN1Util.newObject(m[e]);<span class="cstat-no" title="statement not covered" >h</span>.push(l)}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn new g.DERSequence({array:h})}<span class="cstat-no" title="statement not covered" ></span>i</span>f(j=="set"){<span class="cstat-no" title="statement not covered" >var m=b[j];<span class="cstat-no" title="statement not covered" >v</span>ar h=[];<span class="cstat-no" title="statement not covered" >f</span>or(var e=0;e&lt;m.length;e++){<span class="cstat-no" title="statement not covered" >var l=g.ASN1Util.newObject(m[e]);<span class="cstat-no" title="statement not covered" >h</span>.push(l)}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn new g.DERSet({array:h})}<span class="cstat-no" title="statement not covered" ></span>i</span>f(j=="tag"){<span class="cstat-no" title="statement not covered" >var c=b[j];<span class="cstat-no" title="statement not covered" >i</span>f(Object.prototype.toString.call(c)==="[object Array]"&amp;&amp;c.length==3){<span class="cstat-no" title="statement not covered" >var d=g.ASN1Util.newObject(c[2]);<span class="cstat-no" title="statement not covered" >r</span>eturn new g.DERTaggedObject({tag:c[0],explicit:c[1],obj:d})}</span>else{<span class="cstat-no" title="statement not covered" >var f={};<span class="cstat-no" title="statement not covered" >i</span>f(c.explicit!==undefined){<span class="cstat-no" title="statement not covered" >f.explicit=c.explicit}<span class="cstat-no" title="statement not covered" ></span>i</span>f(c.tag!==undefined){<span class="cstat-no" title="statement not covered" >f.tag=c.tag}<span class="cstat-no" title="statement not covered" ></span>i</span>f(c.obj===undefined){<span class="cstat-no" title="statement not covered" >throw"obj shall be specified for 'tag'."}<span class="cstat-no" title="statement not covered" ></span>f</span>.obj=g.ASN1Util.newObject(c.obj);<span class="cstat-no" title="statement not covered" >r</span>eturn new g.DERTaggedObject(f)}</span>}</span>}</span>;this.jsonToASN1HEX=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>var a=this.newObject(b);<span class="cstat-no" title="statement not covered" >r</span>eturn a.getEncodedHex()}</span>};KJUR.asn1.ASN1Util.oidHexToInt=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>var j="";<span class="cstat-no" title="statement not covered" >v</span>ar k=parseInt(a.substr(0,2),16);<span class="cstat-no" title="statement not covered" >v</span>ar d=Math.floor(k/40);<span class="cstat-no" title="statement not covered" >v</span>ar c=k%40;<span class="cstat-no" title="statement not covered" >v</span>ar j=d+"."+c;<span class="cstat-no" title="statement not covered" >v</span>ar e="";<span class="cstat-no" title="statement not covered" >f</span>or(var f=2;f&lt;a.length;f+=2){<span class="cstat-no" title="statement not covered" >var g=parseInt(a.substr(f,2),16);<span class="cstat-no" title="statement not covered" >v</span>ar h=("00000000"+g.toString(2)).slice(-8);<span class="cstat-no" title="statement not covered" >e</span>=e+h.substr(1,7);<span class="cstat-no" title="statement not covered" >i</span>f(h.substr(0,1)=="0"){<span class="cstat-no" title="statement not covered" >var b=new BigInteger(e,2);<span class="cstat-no" title="statement not covered" >j</span>=j+"."+b.toString(10);<span class="cstat-no" title="statement not covered" >e</span>=""}</span>}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn j}</span>;KJUR.asn1.ASN1Util.oidIntToHex=<span class="fstat-no" title="function not covered" >function(f){<span class="cstat-no" title="statement not covered" ></span>var e=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>var k=a.toString(16);<span class="cstat-no" title="statement not covered" >i</span>f(k.length==1){<span class="cstat-no" title="statement not covered" >k="0"+k}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn k}</span>;<span class="cstat-no" title="statement not covered" >v</span>ar d=<span class="fstat-no" title="function not covered" >function(o){<span class="cstat-no" title="statement not covered" ></span>var n="";<span class="cstat-no" title="statement not covered" >v</span>ar k=new BigInteger(o,10);<span class="cstat-no" title="statement not covered" >v</span>ar a=k.toString(2);<span class="cstat-no" title="statement not covered" >v</span>ar l=7-a.length%7;<span class="cstat-no" title="statement not covered" >i</span>f(l==7){<span class="cstat-no" title="statement not covered" >l=0}<span class="cstat-no" title="statement not covered" ></span>v</span>ar q="";<span class="cstat-no" title="statement not covered" >f</span>or(var m=0;m&lt;l;m++){<span class="cstat-no" title="statement not covered" >q+="0"}<span class="cstat-no" title="statement not covered" ></span>a</span>=q+a;<span class="cstat-no" title="statement not covered" >f</span>or(var m=0;m&lt;a.length-1;m+=7){<span class="cstat-no" title="statement not covered" >var p=a.substr(m,7);<span class="cstat-no" title="statement not covered" >i</span>f(m!=a.length-7){<span class="cstat-no" title="statement not covered" >p="1"+p}<span class="cstat-no" title="statement not covered" ></span>n</span>+=e(parseInt(p,2))}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn n}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(!f.match(/^[0-9.]+$/)){<span class="cstat-no" title="statement not covered" >throw"malformed oid string: "+f}<span class="cstat-no" title="statement not covered" ></span>v</span>ar g="";<span class="cstat-no" title="statement not covered" >v</span>ar b=f.split(".");<span class="cstat-no" title="statement not covered" >v</span>ar j=parseInt(b[0])*40+parseInt(b[1]);<span class="cstat-no" title="statement not covered" >g</span>+=e(j);<span class="cstat-no" title="statement not covered" >b</span>.splice(0,2);<span class="cstat-no" title="statement not covered" >f</span>or(var c=0;c&lt;b.length;c++){<span class="cstat-no" title="statement not covered" >g+=d(b[c])}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn g}</span>;KJUR.asn1.ASN1Object=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var c=true;<span class="cstat-no" title="statement not covered" >v</span>ar b=null;<span class="cstat-no" title="statement not covered" >v</span>ar d="00";<span class="cstat-no" title="statement not covered" >v</span>ar e="00";<span class="cstat-no" title="statement not covered" >v</span>ar a="";<span class="cstat-no" title="statement not covered" >t</span>his.getLengthHexFromValue=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>if(typeof this.hV=="undefined"||this.hV==null){<span class="cstat-no" title="statement not covered" >throw"this.hV is null or undefined."}<span class="cstat-no" title="statement not covered" ></span>i</span>f(this.hV.length%2==1){<span class="cstat-no" title="statement not covered" >throw"value hex must be even length: n="+a.length+",v="+this.hV}<span class="cstat-no" title="statement not covered" ></span>v</span>ar i=this.hV.length/2;<span class="cstat-no" title="statement not covered" >v</span>ar h=i.toString(16);<span class="cstat-no" title="statement not covered" >i</span>f(h.length%2==1){<span class="cstat-no" title="statement not covered" >h="0"+h}<span class="cstat-no" title="statement not covered" ></span>i</span>f(i&lt;128){<span class="cstat-no" title="statement not covered" >return h}</span>else{<span class="cstat-no" title="statement not covered" >var g=h.length/2;<span class="cstat-no" title="statement not covered" >i</span>f(g&gt;15){<span class="cstat-no" title="statement not covered" >throw"ASN.1 length too long to represent by 8x: n = "+i.toString(16)}<span class="cstat-no" title="statement not covered" ></span>v</span>ar f=128+g;<span class="cstat-no" title="statement not covered" >r</span>eturn f.toString(16)+h}</span>}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getEncodedHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>if(this.hTLV==null||this.isModified){<span class="cstat-no" title="statement not covered" >this.hV=this.getFreshValueHex();<span class="cstat-no" title="statement not covered" >t</span>his.hL=this.getLengthHexFromValue();<span class="cstat-no" title="statement not covered" >t</span>his.hTLV=this.hT+this.hL+this.hV;<span class="cstat-no" title="statement not covered" >t</span>his.isModified=false}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn this.hTLV}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getValueHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>this.getEncodedHex();<span class="cstat-no" title="statement not covered" >r</span>eturn this.hV}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getFreshValueHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>return""}</span>}</span>;KJUR.asn1.DERAbstractString=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.DERAbstractString.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >v</span>ar b=null;<span class="cstat-no" title="statement not covered" >v</span>ar a=null;<span class="cstat-no" title="statement not covered" >t</span>his.getString=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>return this.s}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setString=<span class="fstat-no" title="function not covered" >function(d){<span class="cstat-no" title="statement not covered" ></span>this.hTLV=null;<span class="cstat-no" title="statement not covered" >t</span>his.isModified=true;<span class="cstat-no" title="statement not covered" >t</span>his.s=d;<span class="cstat-no" title="statement not covered" >t</span>his.hV=stohex(this.s)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setStringHex=<span class="fstat-no" title="function not covered" >function(d){<span class="cstat-no" title="statement not covered" ></span>this.hTLV=null;<span class="cstat-no" title="statement not covered" >t</span>his.isModified=true;<span class="cstat-no" title="statement not covered" >t</span>his.s=null;<span class="cstat-no" title="statement not covered" >t</span>his.hV=d}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getFreshValueHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>return this.hV}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(typeof c!="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof c=="string"){<span class="cstat-no" title="statement not covered" >this.setString(c)}</span>else{<span class="cstat-no" title="statement not covered" >if(typeof c.str!="undefined"){<span class="cstat-no" title="statement not covered" >this.setString(c.str)}</span>else{<span class="cstat-no" title="statement not covered" >if(typeof c.hex!="undefined"){<span class="cstat-no" title="statement not covered" >this.setStringHex(c.hex)}</span>}</span>}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.DERAbstractString,KJUR.asn1.ASN1Object);KJUR.asn1.DERAbstractTime=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.DERAbstractTime.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >v</span>ar b=null;<span class="cstat-no" title="statement not covered" >v</span>ar a=null;<span class="cstat-no" title="statement not covered" >t</span>his.localDateToUTC=<span class="fstat-no" title="function not covered" >function(f){<span class="cstat-no" title="statement not covered" ></span>utc=f.getTime()+(f.getTimezoneOffset()*60000);<span class="cstat-no" title="statement not covered" >v</span>ar e=new Date(utc);<span class="cstat-no" title="statement not covered" >r</span>eturn e}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.formatDate=<span class="fstat-no" title="function not covered" >function(m,o,e){<span class="cstat-no" title="statement not covered" ></span>var g=this.zeroPadding;<span class="cstat-no" title="statement not covered" >v</span>ar n=this.localDateToUTC(m);<span class="cstat-no" title="statement not covered" >v</span>ar p=String(n.getFullYear());<span class="cstat-no" title="statement not covered" >i</span>f(o=="utc"){<span class="cstat-no" title="statement not covered" >p=p.substr(2,2)}<span class="cstat-no" title="statement not covered" ></span>v</span>ar l=g(String(n.getMonth()+1),2);<span class="cstat-no" title="statement not covered" >v</span>ar q=g(String(n.getDate()),2);<span class="cstat-no" title="statement not covered" >v</span>ar h=g(String(n.getHours()),2);<span class="cstat-no" title="statement not covered" >v</span>ar i=g(String(n.getMinutes()),2);<span class="cstat-no" title="statement not covered" >v</span>ar j=g(String(n.getSeconds()),2);<span class="cstat-no" title="statement not covered" >v</span>ar r=p+l+q+h+i+j;<span class="cstat-no" title="statement not covered" >i</span>f(e===true){<span class="cstat-no" title="statement not covered" >var f=n.getMilliseconds();<span class="cstat-no" title="statement not covered" >i</span>f(f!=0){<span class="cstat-no" title="statement not covered" >var k=g(String(f),3);<span class="cstat-no" title="statement not covered" >k</span>=k.replace(/[0]+$/,"");<span class="cstat-no" title="statement not covered" >r</span>=r+"."+k}</span>}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn r+"Z"}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.zeroPadding=<span class="fstat-no" title="function not covered" >function(e,d){<span class="cstat-no" title="statement not covered" ></span>if(e.length&gt;=d){<span class="cstat-no" title="statement not covered" >return e}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn new Array(d-e.length+1).join("0")+e}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getString=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>return this.s}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setString=<span class="fstat-no" title="function not covered" >function(d){<span class="cstat-no" title="statement not covered" ></span>this.hTLV=null;<span class="cstat-no" title="statement not covered" >t</span>his.isModified=true;<span class="cstat-no" title="statement not covered" >t</span>his.s=d;<span class="cstat-no" title="statement not covered" >t</span>his.hV=stohex(d)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setByDateValue=<span class="fstat-no" title="function not covered" >function(h,j,e,d,f,g){<span class="cstat-no" title="statement not covered" ></span>var i=new Date(Date.UTC(h,j-1,e,d,f,g,0));<span class="cstat-no" title="statement not covered" >t</span>his.setByDate(i)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getFreshValueHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>return this.hV}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.DERAbstractTime,KJUR.asn1.ASN1Object);KJUR.asn1.DERAbstractStructured=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.DERAbstractString.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >v</span>ar a=null;<span class="cstat-no" title="statement not covered" >t</span>his.setByASN1ObjectArray=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>this.hTLV=null;<span class="cstat-no" title="statement not covered" >t</span>his.isModified=true;<span class="cstat-no" title="statement not covered" >t</span>his.asn1Array=c}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.appendASN1Object=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>this.hTLV=null;<span class="cstat-no" title="statement not covered" >t</span>his.isModified=true;<span class="cstat-no" title="statement not covered" >t</span>his.asn1Array.push(c)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.asn1Array=new Array();<span class="cstat-no" title="statement not covered" >i</span>f(typeof b!="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof b.array!="undefined"){<span class="cstat-no" title="statement not covered" >this.asn1Array=b.array}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.DERAbstractStructured,KJUR.asn1.ASN1Object);KJUR.asn1.DERBoolean=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.DERBoolean.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >t</span>his.hT="01";<span class="cstat-no" title="statement not covered" >t</span>his.hTLV="0101ff"}</span>;YAHOO.lang.extend(KJUR.asn1.DERBoolean,KJUR.asn1.ASN1Object);KJUR.asn1.DERInteger=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.DERInteger.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >t</span>his.hT="02";<span class="cstat-no" title="statement not covered" >t</span>his.setByBigInteger=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>this.hTLV=null;<span class="cstat-no" title="statement not covered" >t</span>his.isModified=true;<span class="cstat-no" title="statement not covered" >t</span>his.hV=KJUR.asn1.ASN1Util.bigIntToMinTwosComplementsHex(b)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setByInteger=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>var b=new BigInteger(String(c),10);<span class="cstat-no" title="statement not covered" >t</span>his.setByBigInteger(b)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setValueHex=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>this.hV=b}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getFreshValueHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>return this.hV}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(typeof a!="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof a.bigint!="undefined"){<span class="cstat-no" title="statement not covered" >this.setByBigInteger(a.bigint)}</span>else{<span class="cstat-no" title="statement not covered" >if(typeof a["int"]!="undefined"){<span class="cstat-no" title="statement not covered" >this.setByInteger(a["int"])}</span>else{<span class="cstat-no" title="statement not covered" >if(typeof a=="number"){<span class="cstat-no" title="statement not covered" >this.setByInteger(a)}</span>else{<span class="cstat-no" title="statement not covered" >if(typeof a.hex!="undefined"){<span class="cstat-no" title="statement not covered" >this.setValueHex(a.hex)}</span>}</span>}</span>}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.DERInteger,KJUR.asn1.ASN1Object);KJUR.asn1.DERBitString=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>if(b!==undefined&amp;&amp;typeof b.obj!=="undefined"){<span class="cstat-no" title="statement not covered" >var a=KJUR.asn1.ASN1Util.newObject(b.obj);<span class="cstat-no" title="statement not covered" >b</span>.hex="00"+a.getEncodedHex()}<span class="cstat-no" title="statement not covered" ></span>K</span>JUR.asn1.DERBitString.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >t</span>his.hT="03";<span class="cstat-no" title="statement not covered" >t</span>his.setHexValueIncludingUnusedBits=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>this.hTLV=null;<span class="cstat-no" title="statement not covered" >t</span>his.isModified=true;<span class="cstat-no" title="statement not covered" >t</span>his.hV=c}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setUnusedBitsAndHexValue=<span class="fstat-no" title="function not covered" >function(c,e){<span class="cstat-no" title="statement not covered" ></span>if(c&lt;0||7&lt;c){<span class="cstat-no" title="statement not covered" >throw"unused bits shall be from 0 to 7: u = "+c}<span class="cstat-no" title="statement not covered" ></span>v</span>ar d="0"+c;<span class="cstat-no" title="statement not covered" >t</span>his.hTLV=null;<span class="cstat-no" title="statement not covered" >t</span>his.isModified=true;<span class="cstat-no" title="statement not covered" >t</span>his.hV=d+e}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setByBinaryString=<span class="fstat-no" title="function not covered" >function(e){<span class="cstat-no" title="statement not covered" ></span>e=e.replace(/0+$/,"");<span class="cstat-no" title="statement not covered" >v</span>ar f=8-e.length%8;<span class="cstat-no" title="statement not covered" >i</span>f(f==8){<span class="cstat-no" title="statement not covered" >f=0}<span class="cstat-no" title="statement not covered" ></span>f</span>or(var g=0;g&lt;=f;g++){<span class="cstat-no" title="statement not covered" >e+="0"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar j="";<span class="cstat-no" title="statement not covered" >f</span>or(var g=0;g&lt;e.length-1;g+=8){<span class="cstat-no" title="statement not covered" >var d=e.substr(g,8);<span class="cstat-no" title="statement not covered" >v</span>ar c=parseInt(d,2).toString(16);<span class="cstat-no" title="statement not covered" >i</span>f(c.length==1){<span class="cstat-no" title="statement not covered" >c="0"+c}<span class="cstat-no" title="statement not covered" ></span>j</span>+=c}<span class="cstat-no" title="statement not covered" ></span>t</span>his.hTLV=null;<span class="cstat-no" title="statement not covered" >t</span>his.isModified=true;<span class="cstat-no" title="statement not covered" >t</span>his.hV="0"+f+j}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setByBooleanArray=<span class="fstat-no" title="function not covered" >function(e){<span class="cstat-no" title="statement not covered" ></span>var d="";<span class="cstat-no" title="statement not covered" >f</span>or(var c=0;c&lt;e.length;c++){<span class="cstat-no" title="statement not covered" >if(e[c]==true){<span class="cstat-no" title="statement not covered" >d+="1"}</span>else{<span class="cstat-no" title="statement not covered" >d+="0"}</span>}<span class="cstat-no" title="statement not covered" ></span>t</span>his.setByBinaryString(d)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.newFalseArray=<span class="fstat-no" title="function not covered" >function(e){<span class="cstat-no" title="statement not covered" ></span>var c=new Array(e);<span class="cstat-no" title="statement not covered" >f</span>or(var d=0;d&lt;e;d++){<span class="cstat-no" title="statement not covered" >c[d]=false}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn c}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getFreshValueHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>return this.hV}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(typeof b!="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof b=="string"&amp;&amp;b.toLowerCase().match(/^[0-9a-f]+$/)){<span class="cstat-no" title="statement not covered" >this.setHexValueIncludingUnusedBits(b)}</span>else{<span class="cstat-no" title="statement not covered" >if(typeof b.hex!="undefined"){<span class="cstat-no" title="statement not covered" >this.setHexValueIncludingUnusedBits(b.hex)}</span>else{<span class="cstat-no" title="statement not covered" >if(typeof b.bin!="undefined"){<span class="cstat-no" title="statement not covered" >this.setByBinaryString(b.bin)}</span>else{<span class="cstat-no" title="statement not covered" >if(typeof b.array!="undefined"){<span class="cstat-no" title="statement not covered" >this.setByBooleanArray(b.array)}</span>}</span>}</span>}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.DERBitString,KJUR.asn1.ASN1Object);KJUR.asn1.DEROctetString=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>if(b!==undefined&amp;&amp;typeof b.obj!=="undefined"){<span class="cstat-no" title="statement not covered" >var a=KJUR.asn1.ASN1Util.newObject(b.obj);<span class="cstat-no" title="statement not covered" >b</span>.hex=a.getEncodedHex()}<span class="cstat-no" title="statement not covered" ></span>K</span>JUR.asn1.DEROctetString.superclass.constructor.call(this,b);<span class="cstat-no" title="statement not covered" >t</span>his.hT="04"}</span>;YAHOO.lang.extend(KJUR.asn1.DEROctetString,KJUR.asn1.DERAbstractString);KJUR.asn1.DERNull=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.DERNull.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >t</span>his.hT="05";<span class="cstat-no" title="statement not covered" >t</span>his.hTLV="0500"}</span>;YAHOO.lang.extend(KJUR.asn1.DERNull,KJUR.asn1.ASN1Object);KJUR.asn1.DERObjectIdentifier=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>var b=<span class="fstat-no" title="function not covered" >function(d){<span class="cstat-no" title="statement not covered" ></span>var e=d.toString(16);<span class="cstat-no" title="statement not covered" >i</span>f(e.length==1){<span class="cstat-no" title="statement not covered" >e="0"+e}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn e}</span>;<span class="cstat-no" title="statement not covered" >v</span>ar a=<span class="fstat-no" title="function not covered" >function(k){<span class="cstat-no" title="statement not covered" ></span>var j="";<span class="cstat-no" title="statement not covered" >v</span>ar e=new BigInteger(k,10);<span class="cstat-no" title="statement not covered" >v</span>ar d=e.toString(2);<span class="cstat-no" title="statement not covered" >v</span>ar f=7-d.length%7;<span class="cstat-no" title="statement not covered" >i</span>f(f==7){<span class="cstat-no" title="statement not covered" >f=0}<span class="cstat-no" title="statement not covered" ></span>v</span>ar m="";<span class="cstat-no" title="statement not covered" >f</span>or(var g=0;g&lt;f;g++){<span class="cstat-no" title="statement not covered" >m+="0"}<span class="cstat-no" title="statement not covered" ></span>d</span>=m+d;<span class="cstat-no" title="statement not covered" >f</span>or(var g=0;g&lt;d.length-1;g+=7){<span class="cstat-no" title="statement not covered" >var l=d.substr(g,7);<span class="cstat-no" title="statement not covered" >i</span>f(g!=d.length-7){<span class="cstat-no" title="statement not covered" >l="1"+l}<span class="cstat-no" title="statement not covered" ></span>j</span>+=b(parseInt(l,2))}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn j}</span>;<span class="cstat-no" title="statement not covered" >K</span>JUR.asn1.DERObjectIdentifier.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >t</span>his.hT="06";<span class="cstat-no" title="statement not covered" >t</span>his.setValueHex=<span class="fstat-no" title="function not covered" >function(d){<span class="cstat-no" title="statement not covered" ></span>this.hTLV=null;<span class="cstat-no" title="statement not covered" >t</span>his.isModified=true;<span class="cstat-no" title="statement not covered" >t</span>his.s=null;<span class="cstat-no" title="statement not covered" >t</span>his.hV=d}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setValueOidString=<span class="fstat-no" title="function not covered" >function(f){<span class="cstat-no" title="statement not covered" ></span>if(!f.match(/^[0-9.]+$/)){<span class="cstat-no" title="statement not covered" >throw"malformed oid string: "+f}<span class="cstat-no" title="statement not covered" ></span>v</span>ar g="";<span class="cstat-no" title="statement not covered" >v</span>ar d=f.split(".");<span class="cstat-no" title="statement not covered" >v</span>ar j=parseInt(d[0])*40+parseInt(d[1]);<span class="cstat-no" title="statement not covered" >g</span>+=b(j);<span class="cstat-no" title="statement not covered" >d</span>.splice(0,2);<span class="cstat-no" title="statement not covered" >f</span>or(var e=0;e&lt;d.length;e++){<span class="cstat-no" title="statement not covered" >g+=a(d[e])}<span class="cstat-no" title="statement not covered" ></span>t</span>his.hTLV=null;<span class="cstat-no" title="statement not covered" >t</span>his.isModified=true;<span class="cstat-no" title="statement not covered" >t</span>his.s=null;<span class="cstat-no" title="statement not covered" >t</span>his.hV=g}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setValueName=<span class="fstat-no" title="function not covered" >function(e){<span class="cstat-no" title="statement not covered" ></span>var d=KJUR.asn1.x509.OID.name2oid(e);<span class="cstat-no" title="statement not covered" >i</span>f(d!==""){<span class="cstat-no" title="statement not covered" >this.setValueOidString(d)}</span>else{<span class="cstat-no" title="statement not covered" >throw"DERObjectIdentifier oidName undefined: "+e}</span>}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getFreshValueHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>return this.hV}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(c!==undefined){<span class="cstat-no" title="statement not covered" >if(typeof c==="string"){<span class="cstat-no" title="statement not covered" >if(c.match(/^[0-2].[0-9.]+$/)){<span class="cstat-no" title="statement not covered" >this.setValueOidString(c)}</span>else{<span class="cstat-no" title="statement not covered" >this.setValueName(c)}</span>}</span>else{<span class="cstat-no" title="statement not covered" >if(c.oid!==undefined){<span class="cstat-no" title="statement not covered" >this.setValueOidString(c.oid)}</span>else{<span class="cstat-no" title="statement not covered" >if(c.hex!==undefined){<span class="cstat-no" title="statement not covered" >this.setValueHex(c.hex)}</span>else{<span class="cstat-no" title="statement not covered" >if(c.name!==undefined){<span class="cstat-no" title="statement not covered" >this.setValueName(c.name)}</span>}</span>}</span>}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.DERObjectIdentifier,KJUR.asn1.ASN1Object);KJUR.asn1.DEREnumerated=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.DEREnumerated.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >t</span>his.hT="0a";<span class="cstat-no" title="statement not covered" >t</span>his.setByBigInteger=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>this.hTLV=null;<span class="cstat-no" title="statement not covered" >t</span>his.isModified=true;<span class="cstat-no" title="statement not covered" >t</span>his.hV=KJUR.asn1.ASN1Util.bigIntToMinTwosComplementsHex(b)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setByInteger=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>var b=new BigInteger(String(c),10);<span class="cstat-no" title="statement not covered" >t</span>his.setByBigInteger(b)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setValueHex=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>this.hV=b}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getFreshValueHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>return this.hV}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(typeof a!="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof a["int"]!="undefined"){<span class="cstat-no" title="statement not covered" >this.setByInteger(a["int"])}</span>else{<span class="cstat-no" title="statement not covered" >if(typeof a=="number"){<span class="cstat-no" title="statement not covered" >this.setByInteger(a)}</span>else{<span class="cstat-no" title="statement not covered" >if(typeof a.hex!="undefined"){<span class="cstat-no" title="statement not covered" >this.setValueHex(a.hex)}</span>}</span>}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.DEREnumerated,KJUR.asn1.ASN1Object);KJUR.asn1.DERUTF8String=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.DERUTF8String.superclass.constructor.call(this,a);<span class="cstat-no" title="statement not covered" >t</span>his.hT="0c"}</span>;YAHOO.lang.extend(KJUR.asn1.DERUTF8String,KJUR.asn1.DERAbstractString);KJUR.asn1.DERNumericString=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.DERNumericString.superclass.constructor.call(this,a);<span class="cstat-no" title="statement not covered" >t</span>his.hT="12"}</span>;YAHOO.lang.extend(KJUR.asn1.DERNumericString,KJUR.asn1.DERAbstractString);KJUR.asn1.DERPrintableString=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.DERPrintableString.superclass.constructor.call(this,a);<span class="cstat-no" title="statement not covered" >t</span>his.hT="13"}</span>;YAHOO.lang.extend(KJUR.asn1.DERPrintableString,KJUR.asn1.DERAbstractString);KJUR.asn1.DERTeletexString=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.DERTeletexString.superclass.constructor.call(this,a);<span class="cstat-no" title="statement not covered" >t</span>his.hT="14"}</span>;YAHOO.lang.extend(KJUR.asn1.DERTeletexString,KJUR.asn1.DERAbstractString);KJUR.asn1.DERIA5String=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.DERIA5String.superclass.constructor.call(this,a);<span class="cstat-no" title="statement not covered" >t</span>his.hT="16"}</span>;YAHOO.lang.extend(KJUR.asn1.DERIA5String,KJUR.asn1.DERAbstractString);KJUR.asn1.DERUTCTime=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.DERUTCTime.superclass.constructor.call(this,a);<span class="cstat-no" title="statement not covered" >t</span>his.hT="17";<span class="cstat-no" title="statement not covered" >t</span>his.setByDate=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>this.hTLV=null;<span class="cstat-no" title="statement not covered" >t</span>his.isModified=true;<span class="cstat-no" title="statement not covered" >t</span>his.date=b;<span class="cstat-no" title="statement not covered" >t</span>his.s=this.formatDate(this.date,"utc");<span class="cstat-no" title="statement not covered" >t</span>his.hV=stohex(this.s)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getFreshValueHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>if(typeof this.date=="undefined"&amp;&amp;typeof this.s=="undefined"){<span class="cstat-no" title="statement not covered" >this.date=new Date();<span class="cstat-no" title="statement not covered" >t</span>his.s=this.formatDate(this.date,"utc");<span class="cstat-no" title="statement not covered" >t</span>his.hV=stohex(this.s)}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn this.hV}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(a!==undefined){<span class="cstat-no" title="statement not covered" >if(a.str!==undefined){<span class="cstat-no" title="statement not covered" >this.setString(a.str)}</span>else{<span class="cstat-no" title="statement not covered" >if(typeof a=="string"&amp;&amp;a.match(/^[0-9]{12}Z$/)){<span class="cstat-no" title="statement not covered" >this.setString(a)}</span>else{<span class="cstat-no" title="statement not covered" >if(a.hex!==undefined){<span class="cstat-no" title="statement not covered" >this.setStringHex(a.hex)}</span>else{<span class="cstat-no" title="statement not covered" >if(a.date!==undefined){<span class="cstat-no" title="statement not covered" >this.setByDate(a.date)}</span>}</span>}</span>}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.DERUTCTime,KJUR.asn1.DERAbstractTime);KJUR.asn1.DERGeneralizedTime=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.DERGeneralizedTime.superclass.constructor.call(this,a);<span class="cstat-no" title="statement not covered" >t</span>his.hT="18";<span class="cstat-no" title="statement not covered" >t</span>his.withMillis=false;<span class="cstat-no" title="statement not covered" >t</span>his.setByDate=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>this.hTLV=null;<span class="cstat-no" title="statement not covered" >t</span>his.isModified=true;<span class="cstat-no" title="statement not covered" >t</span>his.date=b;<span class="cstat-no" title="statement not covered" >t</span>his.s=this.formatDate(this.date,"gen",this.withMillis);<span class="cstat-no" title="statement not covered" >t</span>his.hV=stohex(this.s)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getFreshValueHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>if(this.date===undefined&amp;&amp;this.s===undefined){<span class="cstat-no" title="statement not covered" >this.date=new Date();<span class="cstat-no" title="statement not covered" >t</span>his.s=this.formatDate(this.date,"gen",this.withMillis);<span class="cstat-no" title="statement not covered" >t</span>his.hV=stohex(this.s)}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn this.hV}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(a!==undefined){<span class="cstat-no" title="statement not covered" >if(a.str!==undefined){<span class="cstat-no" title="statement not covered" >this.setString(a.str)}</span>else{<span class="cstat-no" title="statement not covered" >if(typeof a=="string"&amp;&amp;a.match(/^[0-9]{14}Z$/)){<span class="cstat-no" title="statement not covered" >this.setString(a)}</span>else{<span class="cstat-no" title="statement not covered" >if(a.hex!==undefined){<span class="cstat-no" title="statement not covered" >this.setStringHex(a.hex)}</span>else{<span class="cstat-no" title="statement not covered" >if(a.date!==undefined){<span class="cstat-no" title="statement not covered" >this.setByDate(a.date)}</span>}</span>}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(a.millis===true){<span class="cstat-no" title="statement not covered" >this.withMillis=true}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.DERGeneralizedTime,KJUR.asn1.DERAbstractTime);KJUR.asn1.DERSequence=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.DERSequence.superclass.constructor.call(this,a);<span class="cstat-no" title="statement not covered" >t</span>his.hT="30";<span class="cstat-no" title="statement not covered" >t</span>his.getFreshValueHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var c="";<span class="cstat-no" title="statement not covered" >f</span>or(var b=0;b&lt;this.asn1Array.length;b++){<span class="cstat-no" title="statement not covered" >var d=this.asn1Array[b];<span class="cstat-no" title="statement not covered" >c</span>+=d.getEncodedHex()}<span class="cstat-no" title="statement not covered" ></span>t</span>his.hV=c;<span class="cstat-no" title="statement not covered" >r</span>eturn this.hV}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.DERSequence,KJUR.asn1.DERAbstractStructured);KJUR.asn1.DERSet=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.DERSet.superclass.constructor.call(this,a);<span class="cstat-no" title="statement not covered" >t</span>his.hT="31";<span class="cstat-no" title="statement not covered" >t</span>his.sortFlag=true;<span class="cstat-no" title="statement not covered" >t</span>his.getFreshValueHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var b=new Array();<span class="cstat-no" title="statement not covered" >f</span>or(var c=0;c&lt;this.asn1Array.length;c++){<span class="cstat-no" title="statement not covered" >var d=this.asn1Array[c];<span class="cstat-no" title="statement not covered" >b</span>.push(d.getEncodedHex())}<span class="cstat-no" title="statement not covered" ></span>i</span>f(this.sortFlag==true){<span class="cstat-no" title="statement not covered" >b.sort()}<span class="cstat-no" title="statement not covered" ></span>t</span>his.hV=b.join("");<span class="cstat-no" title="statement not covered" >r</span>eturn this.hV}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(typeof a!="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof a.sortflag!="undefined"&amp;&amp;a.sortflag==false){<span class="cstat-no" title="statement not covered" >this.sortFlag=false}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.DERSet,KJUR.asn1.DERAbstractStructured);KJUR.asn1.DERTaggedObject=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.DERTaggedObject.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >t</span>his.hT="a0";<span class="cstat-no" title="statement not covered" >t</span>his.hV="";<span class="cstat-no" title="statement not covered" >t</span>his.isExplicit=true;<span class="cstat-no" title="statement not covered" >t</span>his.asn1Object=null;<span class="cstat-no" title="statement not covered" >t</span>his.setASN1Object=<span class="fstat-no" title="function not covered" >function(b,c,d){<span class="cstat-no" title="statement not covered" ></span>this.hT=c;<span class="cstat-no" title="statement not covered" >t</span>his.isExplicit=b;<span class="cstat-no" title="statement not covered" >t</span>his.asn1Object=d;<span class="cstat-no" title="statement not covered" >i</span>f(this.isExplicit){<span class="cstat-no" title="statement not covered" >this.hV=this.asn1Object.getEncodedHex();<span class="cstat-no" title="statement not covered" >t</span>his.hTLV=null;<span class="cstat-no" title="statement not covered" >t</span>his.isModified=true}</span>else{<span class="cstat-no" title="statement not covered" >this.hV=null;<span class="cstat-no" title="statement not covered" >t</span>his.hTLV=d.getEncodedHex();<span class="cstat-no" title="statement not covered" >t</span>his.hTLV=this.hTLV.replace(/^../,c);<span class="cstat-no" title="statement not covered" >t</span>his.isModified=false}</span>}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getFreshValueHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>return this.hV}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(typeof a!="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof a.tag!="undefined"){<span class="cstat-no" title="statement not covered" >this.hT=a.tag}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof a.explicit!="undefined"){<span class="cstat-no" title="statement not covered" >this.isExplicit=a.explicit}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof a.obj!="undefined"){<span class="cstat-no" title="statement not covered" >this.asn1Object=a.obj;<span class="cstat-no" title="statement not covered" >t</span>his.setASN1Object(this.isExplicit,this.hT,this.asn1Object)}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.DERTaggedObject,KJUR.asn1.ASN1Object);
/*! asn1hex-1.1.9.js (c) 2012-2017 Kenji Urushima | kjur.github.com/jsrsasign/license
 */
var ASN1HEX=new function(){};ASN1HEX.getByteLengthOfL_AtObj=<span class="fstat-no" title="function not covered" >function(b,c){<span class="cstat-no" title="statement not covered" ></span>if(b.substring(c+2,c+3)!="8"){<span class="cstat-no" title="statement not covered" >return 1}<span class="cstat-no" title="statement not covered" ></span>v</span>ar a=parseInt(b.substring(c+3,c+4));<span class="cstat-no" title="statement not covered" >i</span>f(a==0){<span class="cstat-no" title="statement not covered" >return -1}<span class="cstat-no" title="statement not covered" ></span>i</span>f(0&lt;a&amp;&amp;a&lt;10){<span class="cstat-no" title="statement not covered" >return a+1}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn -2}</span>;ASN1HEX.getHexOfL_AtObj=<span class="fstat-no" title="function not covered" >function(b,c){<span class="cstat-no" title="statement not covered" ></span>var a=ASN1HEX.getByteLengthOfL_AtObj(b,c);<span class="cstat-no" title="statement not covered" >i</span>f(a&lt;1){<span class="cstat-no" title="statement not covered" >return""}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn b.substring(c+2,c+2+a*2)}</span>;ASN1HEX.getIntOfL_AtObj=<span class="fstat-no" title="function not covered" >function(c,d){<span class="cstat-no" title="statement not covered" ></span>var b=ASN1HEX.getHexOfL_AtObj(c,d);<span class="cstat-no" title="statement not covered" >i</span>f(b==""){<span class="cstat-no" title="statement not covered" >return -1}<span class="cstat-no" title="statement not covered" ></span>v</span>ar a;<span class="cstat-no" title="statement not covered" >i</span>f(parseInt(b.substring(0,1))&lt;8){<span class="cstat-no" title="statement not covered" >a=new BigInteger(b,16)}</span>else{<span class="cstat-no" title="statement not covered" >a=new BigInteger(b.substring(2),16)}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn a.intValue()}</span>;ASN1HEX.getStartPosOfV_AtObj=<span class="fstat-no" title="function not covered" >function(b,c){<span class="cstat-no" title="statement not covered" ></span>var a=ASN1HEX.getByteLengthOfL_AtObj(b,c);<span class="cstat-no" title="statement not covered" >i</span>f(a&lt;0){<span class="cstat-no" title="statement not covered" >return a}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn c+(a+1)*2}</span>;ASN1HEX.getHexOfV_AtObj=<span class="fstat-no" title="function not covered" >function(c,d){<span class="cstat-no" title="statement not covered" ></span>var b=ASN1HEX.getStartPosOfV_AtObj(c,d);<span class="cstat-no" title="statement not covered" >v</span>ar a=ASN1HEX.getIntOfL_AtObj(c,d);<span class="cstat-no" title="statement not covered" >r</span>eturn c.substring(b,b+a*2)}</span>;ASN1HEX.getHexOfTLV_AtObj=<span class="fstat-no" title="function not covered" >function(c,e){<span class="cstat-no" title="statement not covered" ></span>var b=c.substr(e,2);<span class="cstat-no" title="statement not covered" >v</span>ar d=ASN1HEX.getHexOfL_AtObj(c,e);<span class="cstat-no" title="statement not covered" >v</span>ar a=ASN1HEX.getHexOfV_AtObj(c,e);<span class="cstat-no" title="statement not covered" >r</span>eturn b+d+a}</span>;ASN1HEX.getPosOfNextSibling_AtObj=<span class="fstat-no" title="function not covered" >function(c,d){<span class="cstat-no" title="statement not covered" ></span>var b=ASN1HEX.getStartPosOfV_AtObj(c,d);<span class="cstat-no" title="statement not covered" >v</span>ar a=ASN1HEX.getIntOfL_AtObj(c,d);<span class="cstat-no" title="statement not covered" >r</span>eturn b+a*2}</span>;ASN1HEX.getPosArrayOfChildren_AtObj=<span class="fstat-no" title="function not covered" >function(f,j){<span class="cstat-no" title="statement not covered" ></span>var c=new Array();<span class="cstat-no" title="statement not covered" >v</span>ar i=ASN1HEX.getStartPosOfV_AtObj(f,j);<span class="cstat-no" title="statement not covered" >i</span>f(f.substr(j,2)=="03"){<span class="cstat-no" title="statement not covered" >c.push(i+2)}</span>else{<span class="cstat-no" title="statement not covered" >c.push(i)}<span class="cstat-no" title="statement not covered" ></span>v</span>ar b=ASN1HEX.getIntOfL_AtObj(f,j);<span class="cstat-no" title="statement not covered" >v</span>ar g=i;<span class="cstat-no" title="statement not covered" >v</span>ar d=0;<span class="cstat-no" title="statement not covered" >w</span>hile(1){<span class="cstat-no" title="statement not covered" >var e=ASN1HEX.getPosOfNextSibling_AtObj(f,g);<span class="cstat-no" title="statement not covered" >i</span>f(e==null||(e-i&gt;=(b*2))){<span class="cstat-no" title="statement not covered" >break}<span class="cstat-no" title="statement not covered" ></span>i</span>f(d&gt;=200){<span class="cstat-no" title="statement not covered" >break}<span class="cstat-no" title="statement not covered" ></span>c</span>.push(e);<span class="cstat-no" title="statement not covered" >g</span>=e;<span class="cstat-no" title="statement not covered" >d</span>++}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn c}</span>;ASN1HEX.getNthChildIndex_AtObj=<span class="fstat-no" title="function not covered" >function(d,b,e){<span class="cstat-no" title="statement not covered" ></span>var c=ASN1HEX.getPosArrayOfChildren_AtObj(d,b);<span class="cstat-no" title="statement not covered" >r</span>eturn c[e]}</span>;ASN1HEX.getDecendantIndexByNthList=<span class="fstat-no" title="function not covered" >function(e,d,c){<span class="cstat-no" title="statement not covered" ></span>if(c.length==0){<span class="cstat-no" title="statement not covered" >return d}<span class="cstat-no" title="statement not covered" ></span>v</span>ar f=c.shift();<span class="cstat-no" title="statement not covered" >v</span>ar b=ASN1HEX.getPosArrayOfChildren_AtObj(e,d);<span class="cstat-no" title="statement not covered" >r</span>eturn ASN1HEX.getDecendantIndexByNthList(e,b[f],c)}</span>;ASN1HEX.getDecendantHexTLVByNthList=<span class="fstat-no" title="function not covered" >function(d,c,b){<span class="cstat-no" title="statement not covered" ></span>var a=ASN1HEX.getDecendantIndexByNthList(d,c,b);<span class="cstat-no" title="statement not covered" >r</span>eturn ASN1HEX.getHexOfTLV_AtObj(d,a)}</span>;ASN1HEX.getDecendantHexVByNthList=<span class="fstat-no" title="function not covered" >function(d,c,b){<span class="cstat-no" title="statement not covered" ></span>var a=ASN1HEX.getDecendantIndexByNthList(d,c,b);<span class="cstat-no" title="statement not covered" >r</span>eturn ASN1HEX.getHexOfV_AtObj(d,a)}</span>;ASN1HEX.getVbyList=<span class="fstat-no" title="function not covered" >function(d,c,b,e){<span class="cstat-no" title="statement not covered" ></span>var a=ASN1HEX.getDecendantIndexByNthList(d,c,b);<span class="cstat-no" title="statement not covered" >i</span>f(a===undefined){<span class="cstat-no" title="statement not covered" >throw"can't find nthList object"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(e!==undefined){<span class="cstat-no" title="statement not covered" >if(d.substr(a,2)!=e){<span class="cstat-no" title="statement not covered" >throw"checking tag doesn't match: "+d.substr(a,2)+"!="+e}</span>}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn ASN1HEX.getHexOfV_AtObj(d,a)}</span>;ASN1HEX.hextooidstr=<span class="fstat-no" title="function not covered" >function(e){<span class="cstat-no" title="statement not covered" ></span>var h=<span class="fstat-no" title="function not covered" >function(b,a){<span class="cstat-no" title="statement not covered" ></span>if(b.length&gt;=a){<span class="cstat-no" title="statement not covered" >return b}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn new Array(a-b.length+1).join("0")+b}</span>;<span class="cstat-no" title="statement not covered" >v</span>ar l=[];<span class="cstat-no" title="statement not covered" >v</span>ar o=e.substr(0,2);<span class="cstat-no" title="statement not covered" >v</span>ar f=parseInt(o,16);<span class="cstat-no" title="statement not covered" >l</span>[0]=new String(Math.floor(f/40));<span class="cstat-no" title="statement not covered" >l</span>[1]=new String(f%40);<span class="cstat-no" title="statement not covered" >v</span>ar m=e.substr(2);<span class="cstat-no" title="statement not covered" >v</span>ar k=[];<span class="cstat-no" title="statement not covered" >f</span>or(var g=0;g&lt;m.length/2;g++){<span class="cstat-no" title="statement not covered" >k.push(parseInt(m.substr(g*2,2),16))}<span class="cstat-no" title="statement not covered" ></span>v</span>ar j=[];<span class="cstat-no" title="statement not covered" >v</span>ar d="";<span class="cstat-no" title="statement not covered" >f</span>or(var g=0;g&lt;k.length;g++){<span class="cstat-no" title="statement not covered" >if(k[g]&amp;128){<span class="cstat-no" title="statement not covered" >d=d+h((k[g]&amp;127).toString(2),7)}</span>else{<span class="cstat-no" title="statement not covered" >d=d+h((k[g]&amp;127).toString(2),7);<span class="cstat-no" title="statement not covered" >j</span>.push(new String(parseInt(d,2)));<span class="cstat-no" title="statement not covered" >d</span>=""}</span>}<span class="cstat-no" title="statement not covered" ></span>v</span>ar n=l.join(".");<span class="cstat-no" title="statement not covered" >i</span>f(j.length&gt;0){<span class="cstat-no" title="statement not covered" >n=n+"."+j.join(".")}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn n}</span>;ASN1HEX.dump=<span class="fstat-no" title="function not covered" >function(q,c,k,g){<span class="cstat-no" title="statement not covered" ></span>var e=q;<span class="cstat-no" title="statement not covered" >i</span>f(q instanceof KJUR.asn1.ASN1Object){<span class="cstat-no" title="statement not covered" >e=q.getEncodedHex()}<span class="cstat-no" title="statement not covered" ></span>v</span>ar o=<span class="fstat-no" title="function not covered" >function(x,i){<span class="cstat-no" title="statement not covered" ></span>if(x.length&lt;=i*2){<span class="cstat-no" title="statement not covered" >return x}</span>else{<span class="cstat-no" title="statement not covered" >var v=x.substr(0,i)+"..(total "+x.length/2+"bytes).."+x.substr(x.length-i,i);<span class="cstat-no" title="statement not covered" >r</span>eturn v}</span>}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(c===undefined){<span class="cstat-no" title="statement not covered" >c={ommit_long_octet:32}}<span class="cstat-no" title="statement not covered" ></span>i</span>f(k===undefined){<span class="cstat-no" title="statement not covered" >k=0}<span class="cstat-no" title="statement not covered" ></span>i</span>f(g===undefined){<span class="cstat-no" title="statement not covered" >g=""}<span class="cstat-no" title="statement not covered" ></span>v</span>ar t=c.ommit_long_octet;<span class="cstat-no" title="statement not covered" >i</span>f(e.substr(k,2)=="01"){<span class="cstat-no" title="statement not covered" >var h=ASN1HEX.getHexOfV_AtObj(e,k);<span class="cstat-no" title="statement not covered" >i</span>f(h=="00"){<span class="cstat-no" title="statement not covered" >return g+"BOOLEAN FALSE\n"}</span>else{<span class="cstat-no" title="statement not covered" >return g+"BOOLEAN TRUE\n"}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(e.substr(k,2)=="02"){<span class="cstat-no" title="statement not covered" >var h=ASN1HEX.getHexOfV_AtObj(e,k);<span class="cstat-no" title="statement not covered" >r</span>eturn g+"INTEGER "+o(h,t)+"\n"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(e.substr(k,2)=="03"){<span class="cstat-no" title="statement not covered" >var h=ASN1HEX.getHexOfV_AtObj(e,k);<span class="cstat-no" title="statement not covered" >r</span>eturn g+"BITSTRING "+o(h,t)+"\n"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(e.substr(k,2)=="04"){<span class="cstat-no" title="statement not covered" >var h=ASN1HEX.getHexOfV_AtObj(e,k);<span class="cstat-no" title="statement not covered" >i</span>f(ASN1HEX.isASN1HEX(h)){<span class="cstat-no" title="statement not covered" >var j=g+"OCTETSTRING, encapsulates\n";<span class="cstat-no" title="statement not covered" >j</span>=j+ASN1HEX.dump(h,c,0,g+"  ");<span class="cstat-no" title="statement not covered" >r</span>eturn j}</span>else{<span class="cstat-no" title="statement not covered" >return g+"OCTETSTRING "+o(h,t)+"\n"}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(e.substr(k,2)=="05"){<span class="cstat-no" title="statement not covered" >return g+"NULL\n"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(e.substr(k,2)=="06"){<span class="cstat-no" title="statement not covered" >var l=ASN1HEX.getHexOfV_AtObj(e,k);<span class="cstat-no" title="statement not covered" >v</span>ar a=KJUR.asn1.ASN1Util.oidHexToInt(l);<span class="cstat-no" title="statement not covered" >v</span>ar n=KJUR.asn1.x509.OID.oid2name(a);<span class="cstat-no" title="statement not covered" >v</span>ar b=a.replace(/\./g," ");<span class="cstat-no" title="statement not covered" >i</span>f(n!=""){<span class="cstat-no" title="statement not covered" >return g+"ObjectIdentifier "+n+" ("+b+")\n"}</span>else{<span class="cstat-no" title="statement not covered" >return g+"ObjectIdentifier ("+b+")\n"}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(e.substr(k,2)=="0c"){<span class="cstat-no" title="statement not covered" >return g+"UTF8String '"+hextoutf8(ASN1HEX.getHexOfV_AtObj(e,k))+"'\n"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(e.substr(k,2)=="13"){<span class="cstat-no" title="statement not covered" >return g+"PrintableString '"+hextoutf8(ASN1HEX.getHexOfV_AtObj(e,k))+"'\n"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(e.substr(k,2)=="14"){<span class="cstat-no" title="statement not covered" >return g+"TeletexString '"+hextoutf8(ASN1HEX.getHexOfV_AtObj(e,k))+"'\n"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(e.substr(k,2)=="16"){<span class="cstat-no" title="statement not covered" >return g+"IA5String '"+hextoutf8(ASN1HEX.getHexOfV_AtObj(e,k))+"'\n"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(e.substr(k,2)=="17"){<span class="cstat-no" title="statement not covered" >return g+"UTCTime "+hextoutf8(ASN1HEX.getHexOfV_AtObj(e,k))+"\n"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(e.substr(k,2)=="18"){<span class="cstat-no" title="statement not covered" >return g+"GeneralizedTime "+hextoutf8(ASN1HEX.getHexOfV_AtObj(e,k))+"\n"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(e.substr(k,2)=="30"){<span class="cstat-no" title="statement not covered" >if(e.substr(k,4)=="3000"){<span class="cstat-no" title="statement not covered" >return g+"SEQUENCE {}\n"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar j=g+"SEQUENCE\n";<span class="cstat-no" title="statement not covered" >v</span>ar d=ASN1HEX.getPosArrayOfChildren_AtObj(e,k);<span class="cstat-no" title="statement not covered" >v</span>ar f=c;<span class="cstat-no" title="statement not covered" >i</span>f((d.length==2||d.length==3)&amp;&amp;e.substr(d[0],2)=="06"&amp;&amp;e.substr(d[d.length-1],2)=="04"){<span class="cstat-no" title="statement not covered" >var u=ASN1HEX.getHexOfV_AtObj(e,d[0]);<span class="cstat-no" title="statement not covered" >v</span>ar a=KJUR.asn1.ASN1Util.oidHexToInt(u);<span class="cstat-no" title="statement not covered" >v</span>ar n=KJUR.asn1.x509.OID.oid2name(a);<span class="cstat-no" title="statement not covered" >v</span>ar p=JSON.parse(JSON.stringify(c));<span class="cstat-no" title="statement not covered" >p</span>.x509ExtName=n;<span class="cstat-no" title="statement not covered" >f</span>=p}<span class="cstat-no" title="statement not covered" ></span>f</span>or(var r=0;r&lt;d.length;r++){<span class="cstat-no" title="statement not covered" >j=j+ASN1HEX.dump(e,f,d[r],g+"  ")}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn j}<span class="cstat-no" title="statement not covered" ></span>i</span>f(e.substr(k,2)=="31"){<span class="cstat-no" title="statement not covered" >var j=g+"SET\n";<span class="cstat-no" title="statement not covered" >v</span>ar d=ASN1HEX.getPosArrayOfChildren_AtObj(e,k);<span class="cstat-no" title="statement not covered" >f</span>or(var r=0;r&lt;d.length;r++){<span class="cstat-no" title="statement not covered" >j=j+ASN1HEX.dump(e,c,d[r],g+"  ")}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn j}<span class="cstat-no" title="statement not covered" ></span>v</span>ar w=parseInt(e.substr(k,2),16);<span class="cstat-no" title="statement not covered" >i</span>f((w&amp;128)!=0){<span class="cstat-no" title="statement not covered" >var m=w&amp;31;<span class="cstat-no" title="statement not covered" >i</span>f((w&amp;32)!=0){<span class="cstat-no" title="statement not covered" >var j=g+"["+m+"]\n";<span class="cstat-no" title="statement not covered" >v</span>ar d=ASN1HEX.getPosArrayOfChildren_AtObj(e,k);<span class="cstat-no" title="statement not covered" >f</span>or(var r=0;r&lt;d.length;r++){<span class="cstat-no" title="statement not covered" >j=j+ASN1HEX.dump(e,c,d[r],g+"  ")}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn j}</span>else{<span class="cstat-no" title="statement not covered" >var h=ASN1HEX.getHexOfV_AtObj(e,k);<span class="cstat-no" title="statement not covered" >i</span>f(h.substr(0,8)=="68747470"){<span class="cstat-no" title="statement not covered" >h=hextoutf8(h)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(c.x509ExtName==="subjectAltName"&amp;&amp;m==2){<span class="cstat-no" title="statement not covered" >h=hextoutf8(h)}<span class="cstat-no" title="statement not covered" ></span>v</span>ar j=g+"["+m+"] "+h+"\n";<span class="cstat-no" title="statement not covered" >r</span>eturn j}</span>}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn g+"UNKNOWN("+e.substr(k,2)+") "+ASN1HEX.getHexOfV_AtObj(e,k)+"\n"}</span>;ASN1HEX.isASN1HEX=<span class="fstat-no" title="function not covered" >function(d){<span class="cstat-no" title="statement not covered" ></span>if(d.length%2==1){<span class="cstat-no" title="statement not covered" >return false}<span class="cstat-no" title="statement not covered" ></span>v</span>ar c=ASN1HEX.getIntOfL_AtObj(d,0);<span class="cstat-no" title="statement not covered" >v</span>ar b=d.substr(0,2);<span class="cstat-no" title="statement not covered" >v</span>ar e=ASN1HEX.getHexOfL_AtObj(d,0);<span class="cstat-no" title="statement not covered" >v</span>ar a=d.length-b.length-e.length;<span class="cstat-no" title="statement not covered" >i</span>f(a==c*2){<span class="cstat-no" title="statement not covered" >return true}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn false}</span>;ASN1HEX.pemToHex=<span class="fstat-no" title="function not covered" >function(b,d){<span class="cstat-no" title="statement not covered" ></span>if(b.indexOf("-----BEGIN ")==-1){<span class="cstat-no" title="statement not covered" >throw"can't find PEM header: "+d}<span class="cstat-no" title="statement not covered" ></span>i</span>f(d!==undefined){<span class="cstat-no" title="statement not covered" >b=b.replace("-----BEGIN "+d+"-----","");<span class="cstat-no" title="statement not covered" >b</span>=b.replace("-----END "+d+"-----","")}</span>else{<span class="cstat-no" title="statement not covered" >b=b.replace(/-----BEGIN [^-]+-----/,"");<span class="cstat-no" title="statement not covered" >b</span>=b.replace(/-----END [^-]+-----/,"")}<span class="cstat-no" title="statement not covered" ></span>v</span>ar c=b.replace(/\s+/g,"");<span class="cstat-no" title="statement not covered" >v</span>ar a=b64tohex(c);<span class="cstat-no" title="statement not covered" >r</span>eturn a}</span>;
/*! asn1x509-1.0.22.js (c) 2013-2017 Kenji Urushima | kjur.github.com/jsrsasign/license
 */
<span class="missing-if-branch" title="if path not taken" >I</span>if(typeof KJUR=="undefined"||!KJUR){<span class="cstat-no" title="statement not covered" >KJUR={}}<span class="missing-if-branch" title="if path not taken" >I</span></span>if(typeof KJUR.asn1=="undefined"||!KJUR.asn1){<span class="cstat-no" title="statement not covered" >KJUR.asn1={}}<span class="missing-if-branch" title="else path not taken" >E</span></span>if(typeof KJUR.asn1.x509=="undefined"||<span class="branch-1 cbranch-no" title="branch not covered" >!KJUR.asn1.x509)</span>{KJUR.asn1.x509={}}KJUR.asn1.x509.Certificate=<span class="fstat-no" title="function not covered" >function(g){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.x509.Certificate.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >v</span>ar b=null;<span class="cstat-no" title="statement not covered" >v</span>ar d=null;<span class="cstat-no" title="statement not covered" >v</span>ar f=null;<span class="cstat-no" title="statement not covered" >v</span>ar c=null;<span class="cstat-no" title="statement not covered" >v</span>ar a=null;<span class="cstat-no" title="statement not covered" >v</span>ar e=null;<span class="cstat-no" title="statement not covered" >t</span>his.setRsaPrvKeyByPEMandPass=<span class="fstat-no" title="function not covered" >function(i,k){<span class="cstat-no" title="statement not covered" ></span>var h=PKCS5PKEY.getDecryptedKeyHex(i,k);<span class="cstat-no" title="statement not covered" >v</span>ar j=new RSAKey();<span class="cstat-no" title="statement not covered" >j</span>.readPrivateKeyFromASN1HexString(h);<span class="cstat-no" title="statement not covered" >t</span>his.prvKey=j}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.sign=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>this.asn1SignatureAlg=this.asn1TBSCert.asn1SignatureAlg;<span class="cstat-no" title="statement not covered" >v</span>ar i=new KJUR.crypto.Signature({alg:this.asn1SignatureAlg.nameAlg});<span class="cstat-no" title="statement not covered" >i</span>.init(this.prvKey);<span class="cstat-no" title="statement not covered" >i</span>.updateHex(this.asn1TBSCert.getEncodedHex());<span class="cstat-no" title="statement not covered" >t</span>his.hexSig=i.sign();<span class="cstat-no" title="statement not covered" >t</span>his.asn1Sig=new KJUR.asn1.DERBitString({hex:"00"+this.hexSig});<span class="cstat-no" title="statement not covered" >v</span>ar h=new KJUR.asn1.DERSequence({array:[this.asn1TBSCert,this.asn1SignatureAlg,this.asn1Sig]});<span class="cstat-no" title="statement not covered" >t</span>his.hTLV=h.getEncodedHex();<span class="cstat-no" title="statement not covered" >t</span>his.isModified=false}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setSignatureHex=<span class="fstat-no" title="function not covered" >function(h){<span class="cstat-no" title="statement not covered" ></span>this.asn1SignatureAlg=this.asn1TBSCert.asn1SignatureAlg;<span class="cstat-no" title="statement not covered" >t</span>his.hexSig=h;<span class="cstat-no" title="statement not covered" >t</span>his.asn1Sig=new KJUR.asn1.DERBitString({hex:"00"+this.hexSig});<span class="cstat-no" title="statement not covered" >v</span>ar i=new KJUR.asn1.DERSequence({array:[this.asn1TBSCert,this.asn1SignatureAlg,this.asn1Sig]});<span class="cstat-no" title="statement not covered" >t</span>his.hTLV=i.getEncodedHex();<span class="cstat-no" title="statement not covered" >t</span>his.isModified=false}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getEncodedHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>if(this.isModified==false&amp;&amp;this.hTLV!=null){<span class="cstat-no" title="statement not covered" >return this.hTLV}<span class="cstat-no" title="statement not covered" ></span>t</span>hrow"not signed yet"}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getPEMString=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var j=this.getEncodedHex();<span class="cstat-no" title="statement not covered" >v</span>ar h=CryptoJS.enc.Hex.parse(j);<span class="cstat-no" title="statement not covered" >v</span>ar i=CryptoJS.enc.Base64.stringify(h);<span class="cstat-no" title="statement not covered" >v</span>ar k=i.replace(/(.{64})/g,"$1\r\n");<span class="cstat-no" title="statement not covered" >r</span>eturn"-----BEGIN CERTIFICATE-----\r\n"+k+"\r\n-----END CERTIFICATE-----\r\n"}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(g!==undefined){<span class="cstat-no" title="statement not covered" >if(g.tbscertobj!==undefined){<span class="cstat-no" title="statement not covered" >this.asn1TBSCert=g.tbscertobj}<span class="cstat-no" title="statement not covered" ></span>i</span>f(g.prvkeyobj!==undefined){<span class="cstat-no" title="statement not covered" >this.prvKey=g.prvkeyobj}</span>else{<span class="cstat-no" title="statement not covered" >if(g.rsaprvkey!==undefined){<span class="cstat-no" title="statement not covered" >this.prvKey=g.rsaprvkey}</span>else{<span class="cstat-no" title="statement not covered" >if((g.rsaprvpem!==undefined)&amp;&amp;(g.rsaprvpas!==undefined)){<span class="cstat-no" title="statement not covered" >this.setRsaPrvKeyByPEMandPass(g.rsaprvpem,g.rsaprvpas)}</span>}</span>}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.x509.Certificate,KJUR.asn1.ASN1Object);KJUR.asn1.x509.TBSCertificate=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.x509.TBSCertificate.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >t</span>his._initialize=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>this.asn1Array=new Array();<span class="cstat-no" title="statement not covered" >t</span>his.asn1Version=new KJUR.asn1.DERTaggedObject({obj:new KJUR.asn1.DERInteger({"int":2})});<span class="cstat-no" title="statement not covered" >t</span>his.asn1SerialNumber=null;<span class="cstat-no" title="statement not covered" >t</span>his.asn1SignatureAlg=null;<span class="cstat-no" title="statement not covered" >t</span>his.asn1Issuer=null;<span class="cstat-no" title="statement not covered" >t</span>his.asn1NotBefore=null;<span class="cstat-no" title="statement not covered" >t</span>his.asn1NotAfter=null;<span class="cstat-no" title="statement not covered" >t</span>his.asn1Subject=null;<span class="cstat-no" title="statement not covered" >t</span>his.asn1SubjPKey=null;<span class="cstat-no" title="statement not covered" >t</span>his.extensionsArray=new Array()}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setSerialNumberByParam=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>this.asn1SerialNumber=new KJUR.asn1.DERInteger(b)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setSignatureAlgByParam=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>this.asn1SignatureAlg=new KJUR.asn1.x509.AlgorithmIdentifier(b)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setIssuerByParam=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>this.asn1Issuer=new KJUR.asn1.x509.X500Name(b)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setNotBeforeByParam=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>this.asn1NotBefore=new KJUR.asn1.x509.Time(b)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setNotAfterByParam=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>this.asn1NotAfter=new KJUR.asn1.x509.Time(b)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setSubjectByParam=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>this.asn1Subject=new KJUR.asn1.x509.X500Name(b)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setSubjectPublicKeyByParam=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>this.asn1SubjPKey=new KJUR.asn1.x509.SubjectPublicKeyInfo(b)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setSubjectPublicKeyByGetKey=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>var b=KEYUTIL.getKey(c);<span class="cstat-no" title="statement not covered" >t</span>his.asn1SubjPKey=new KJUR.asn1.x509.SubjectPublicKeyInfo(b)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.appendExtension=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>this.extensionsArray.push(b)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.appendExtensionByName=<span class="fstat-no" title="function not covered" >function(c,b){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.x509.Extension.appendByNameToArray(c,b,this.extensionsArray)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getEncodedHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>if(this.asn1NotBefore==null||this.asn1NotAfter==null){<span class="cstat-no" title="statement not covered" >throw"notBefore and/or notAfter not set"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar c=new KJUR.asn1.DERSequence({array:[this.asn1NotBefore,this.asn1NotAfter]});<span class="cstat-no" title="statement not covered" >t</span>his.asn1Array=new Array();<span class="cstat-no" title="statement not covered" >t</span>his.asn1Array.push(this.asn1Version);<span class="cstat-no" title="statement not covered" >t</span>his.asn1Array.push(this.asn1SerialNumber);<span class="cstat-no" title="statement not covered" >t</span>his.asn1Array.push(this.asn1SignatureAlg);<span class="cstat-no" title="statement not covered" >t</span>his.asn1Array.push(this.asn1Issuer);<span class="cstat-no" title="statement not covered" >t</span>his.asn1Array.push(c);<span class="cstat-no" title="statement not covered" >t</span>his.asn1Array.push(this.asn1Subject);<span class="cstat-no" title="statement not covered" >t</span>his.asn1Array.push(this.asn1SubjPKey);<span class="cstat-no" title="statement not covered" >i</span>f(this.extensionsArray.length&gt;0){<span class="cstat-no" title="statement not covered" >var d=new KJUR.asn1.DERSequence({array:this.extensionsArray});<span class="cstat-no" title="statement not covered" >v</span>ar b=new KJUR.asn1.DERTaggedObject({explicit:true,tag:"a3",obj:d});<span class="cstat-no" title="statement not covered" >t</span>his.asn1Array.push(b)}<span class="cstat-no" title="statement not covered" ></span>v</span>ar e=new KJUR.asn1.DERSequence({array:this.asn1Array});<span class="cstat-no" title="statement not covered" >t</span>his.hTLV=e.getEncodedHex();<span class="cstat-no" title="statement not covered" >t</span>his.isModified=false;<span class="cstat-no" title="statement not covered" >r</span>eturn this.hTLV}</span>;<span class="cstat-no" title="statement not covered" >t</span>his._initialize()}</span>;YAHOO.lang.extend(KJUR.asn1.x509.TBSCertificate,KJUR.asn1.ASN1Object);KJUR.asn1.x509.Extension=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.x509.Extension.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >v</span>ar a=null;<span class="cstat-no" title="statement not covered" >t</span>his.getEncodedHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var f=new KJUR.asn1.DERObjectIdentifier({oid:this.oid});<span class="cstat-no" title="statement not covered" >v</span>ar e=new KJUR.asn1.DEROctetString({hex:this.getExtnValueHex()});<span class="cstat-no" title="statement not covered" >v</span>ar d=new Array();<span class="cstat-no" title="statement not covered" >d</span>.push(f);<span class="cstat-no" title="statement not covered" >i</span>f(this.critical){<span class="cstat-no" title="statement not covered" >d.push(new KJUR.asn1.DERBoolean())}<span class="cstat-no" title="statement not covered" ></span>d</span>.push(e);<span class="cstat-no" title="statement not covered" >v</span>ar c=new KJUR.asn1.DERSequence({array:d});<span class="cstat-no" title="statement not covered" >r</span>eturn c.getEncodedHex()}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.critical=false;<span class="cstat-no" title="statement not covered" >i</span>f(typeof b!="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof b.critical!="undefined"){<span class="cstat-no" title="statement not covered" >this.critical=b.critical}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.x509.Extension,KJUR.asn1.ASN1Object);KJUR.asn1.x509.Extension.appendByNameToArray=<span class="fstat-no" title="function not covered" >function(e,c,b){<span class="cstat-no" title="statement not covered" ></span>if(e.toLowerCase()=="basicconstraints"){<span class="cstat-no" title="statement not covered" >var d=new KJUR.asn1.x509.BasicConstraints(c);<span class="cstat-no" title="statement not covered" >b</span>.push(d)}</span>else{<span class="cstat-no" title="statement not covered" >if(e.toLowerCase()=="keyusage"){<span class="cstat-no" title="statement not covered" >var d=new KJUR.asn1.x509.KeyUsage(c);<span class="cstat-no" title="statement not covered" >b</span>.push(d)}</span>else{<span class="cstat-no" title="statement not covered" >if(e.toLowerCase()=="crldistributionpoints"){<span class="cstat-no" title="statement not covered" >var d=new KJUR.asn1.x509.CRLDistributionPoints(c);<span class="cstat-no" title="statement not covered" >b</span>.push(d)}</span>else{<span class="cstat-no" title="statement not covered" >if(e.toLowerCase()=="extkeyusage"){<span class="cstat-no" title="statement not covered" >var d=new KJUR.asn1.x509.ExtKeyUsage(c);<span class="cstat-no" title="statement not covered" >b</span>.push(d)}</span>else{<span class="cstat-no" title="statement not covered" >if(e.toLowerCase()=="authoritykeyidentifier"){<span class="cstat-no" title="statement not covered" >var d=new KJUR.asn1.x509.AuthorityKeyIdentifier(c);<span class="cstat-no" title="statement not covered" >b</span>.push(d)}</span>else{<span class="cstat-no" title="statement not covered" >if(e.toLowerCase()=="authorityinfoaccess"){<span class="cstat-no" title="statement not covered" >var d=new KJUR.asn1.x509.AuthorityInfoAccess(c);<span class="cstat-no" title="statement not covered" >b</span>.push(d)}</span>else{<span class="cstat-no" title="statement not covered" >if(e.toLowerCase()=="subjectaltname"){<span class="cstat-no" title="statement not covered" >var d=new KJUR.asn1.x509.SubjectAltName(c);<span class="cstat-no" title="statement not covered" >b</span>.push(d)}</span>else{<span class="cstat-no" title="statement not covered" >if(e.toLowerCase()=="issueraltname"){<span class="cstat-no" title="statement not covered" >var d=new KJUR.asn1.x509.IssuerAltName(c);<span class="cstat-no" title="statement not covered" >b</span>.push(d)}</span>else{<span class="cstat-no" title="statement not covered" >throw"unsupported extension name: "+e}</span>}</span>}</span>}</span>}</span>}</span>}</span>}</span>}</span>;KJUR.asn1.x509.KeyUsage=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.x509.KeyUsage.superclass.constructor.call(this,a);<span class="cstat-no" title="statement not covered" >t</span>his.getExtnValueHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>return this.asn1ExtnValue.getEncodedHex()}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.oid="2.5.29.15";<span class="cstat-no" title="statement not covered" >i</span>f(typeof a!="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof a.bin!="undefined"){<span class="cstat-no" title="statement not covered" >this.asn1ExtnValue=new KJUR.asn1.DERBitString(a)}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.x509.KeyUsage,KJUR.asn1.x509.Extension);KJUR.asn1.x509.BasicConstraints=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.x509.BasicConstraints.superclass.constructor.call(this,c);<span class="cstat-no" title="statement not covered" >v</span>ar a=false;<span class="cstat-no" title="statement not covered" >v</span>ar b=-1;<span class="cstat-no" title="statement not covered" >t</span>his.getExtnValueHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var e=new Array();<span class="cstat-no" title="statement not covered" >i</span>f(this.cA){<span class="cstat-no" title="statement not covered" >e.push(new KJUR.asn1.DERBoolean())}<span class="cstat-no" title="statement not covered" ></span>i</span>f(this.pathLen&gt;-1){<span class="cstat-no" title="statement not covered" >e.push(new KJUR.asn1.DERInteger({"int":this.pathLen}))}<span class="cstat-no" title="statement not covered" ></span>v</span>ar d=new KJUR.asn1.DERSequence({array:e});<span class="cstat-no" title="statement not covered" >t</span>his.asn1ExtnValue=d;<span class="cstat-no" title="statement not covered" >r</span>eturn this.asn1ExtnValue.getEncodedHex()}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.oid="2.5.29.19";<span class="cstat-no" title="statement not covered" >t</span>his.cA=false;<span class="cstat-no" title="statement not covered" >t</span>his.pathLen=-1;<span class="cstat-no" title="statement not covered" >i</span>f(typeof c!="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof c.cA!="undefined"){<span class="cstat-no" title="statement not covered" >this.cA=c.cA}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof c.pathLen!="undefined"){<span class="cstat-no" title="statement not covered" >this.pathLen=c.pathLen}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.x509.BasicConstraints,KJUR.asn1.x509.Extension);KJUR.asn1.x509.CRLDistributionPoints=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.x509.CRLDistributionPoints.superclass.constructor.call(this,a);<span class="cstat-no" title="statement not covered" >t</span>his.getExtnValueHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>return this.asn1ExtnValue.getEncodedHex()}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setByDPArray=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>this.asn1ExtnValue=new KJUR.asn1.DERSequence({array:b})}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setByOneURI=<span class="fstat-no" title="function not covered" >function(e){<span class="cstat-no" title="statement not covered" ></span>var b=new KJUR.asn1.x509.GeneralNames([{uri:e}]);<span class="cstat-no" title="statement not covered" >v</span>ar d=new KJUR.asn1.x509.DistributionPointName(b);<span class="cstat-no" title="statement not covered" >v</span>ar c=new KJUR.asn1.x509.DistributionPoint({dpobj:d});<span class="cstat-no" title="statement not covered" >t</span>his.setByDPArray([c])}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.oid="2.5.29.31";<span class="cstat-no" title="statement not covered" >i</span>f(typeof a!="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof a.array!="undefined"){<span class="cstat-no" title="statement not covered" >this.setByDPArray(a.array)}</span>else{<span class="cstat-no" title="statement not covered" >if(typeof a.uri!="undefined"){<span class="cstat-no" title="statement not covered" >this.setByOneURI(a.uri)}</span>}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.x509.CRLDistributionPoints,KJUR.asn1.x509.Extension);KJUR.asn1.x509.ExtKeyUsage=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.x509.ExtKeyUsage.superclass.constructor.call(this,a);<span class="cstat-no" title="statement not covered" >t</span>his.setPurposeArray=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>this.asn1ExtnValue=new KJUR.asn1.DERSequence();<span class="cstat-no" title="statement not covered" >f</span>or(var c=0;c&lt;b.length;c++){<span class="cstat-no" title="statement not covered" >var d=new KJUR.asn1.DERObjectIdentifier(b[c]);<span class="cstat-no" title="statement not covered" >t</span>his.asn1ExtnValue.appendASN1Object(d)}</span>}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getExtnValueHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>return this.asn1ExtnValue.getEncodedHex()}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.oid="2.5.29.37";<span class="cstat-no" title="statement not covered" >i</span>f(typeof a!="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof a.array!="undefined"){<span class="cstat-no" title="statement not covered" >this.setPurposeArray(a.array)}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.x509.ExtKeyUsage,KJUR.asn1.x509.Extension);KJUR.asn1.x509.AuthorityKeyIdentifier=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.x509.AuthorityKeyIdentifier.superclass.constructor.call(this,a);<span class="cstat-no" title="statement not covered" >t</span>his.asn1KID=null;<span class="cstat-no" title="statement not covered" >t</span>his.asn1CertIssuer=null;<span class="cstat-no" title="statement not covered" >t</span>his.asn1CertSN=null;<span class="cstat-no" title="statement not covered" >t</span>his.getExtnValueHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var c=new Array();<span class="cstat-no" title="statement not covered" >i</span>f(this.asn1KID){<span class="cstat-no" title="statement not covered" >c.push(new KJUR.asn1.DERTaggedObject({explicit:false,tag:"80",obj:this.asn1KID}))}<span class="cstat-no" title="statement not covered" ></span>i</span>f(this.asn1CertIssuer){<span class="cstat-no" title="statement not covered" >c.push(new KJUR.asn1.DERTaggedObject({explicit:false,tag:"a1",obj:this.asn1CertIssuer}))}<span class="cstat-no" title="statement not covered" ></span>i</span>f(this.asn1CertSN){<span class="cstat-no" title="statement not covered" >c.push(new KJUR.asn1.DERTaggedObject({explicit:false,tag:"82",obj:this.asn1CertSN}))}<span class="cstat-no" title="statement not covered" ></span>v</span>ar b=new KJUR.asn1.DERSequence({array:c});<span class="cstat-no" title="statement not covered" >t</span>his.asn1ExtnValue=b;<span class="cstat-no" title="statement not covered" >r</span>eturn this.asn1ExtnValue.getEncodedHex()}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setKIDByParam=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>this.asn1KID=new KJUR.asn1.DEROctetString(b)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setCertIssuerByParam=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>this.asn1CertIssuer=new KJUR.asn1.x509.X500Name(b)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setCertSNByParam=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>this.asn1CertSN=new KJUR.asn1.DERInteger(b)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.oid="2.5.29.35";<span class="cstat-no" title="statement not covered" >i</span>f(typeof a!="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof a.kid!="undefined"){<span class="cstat-no" title="statement not covered" >this.setKIDByParam(a.kid)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof a.issuer!="undefined"){<span class="cstat-no" title="statement not covered" >this.setCertIssuerByParam(a.issuer)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof a.sn!="undefined"){<span class="cstat-no" title="statement not covered" >this.setCertSNByParam(a.sn)}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.x509.AuthorityKeyIdentifier,KJUR.asn1.x509.Extension);KJUR.asn1.x509.AuthorityInfoAccess=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.x509.AuthorityInfoAccess.superclass.constructor.call(this,a);<span class="cstat-no" title="statement not covered" >t</span>his.setAccessDescriptionArray=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>var g=new Array();<span class="cstat-no" title="statement not covered" >f</span>or(var b=0;b&lt;c.length;b++){<span class="cstat-no" title="statement not covered" >var e=new KJUR.asn1.DERObjectIdentifier(c[b].accessMethod);<span class="cstat-no" title="statement not covered" >v</span>ar d=new KJUR.asn1.x509.GeneralName(c[b].accessLocation);<span class="cstat-no" title="statement not covered" >v</span>ar f=new KJUR.asn1.DERSequence({array:[e,d]});<span class="cstat-no" title="statement not covered" >g</span>.push(f)}<span class="cstat-no" title="statement not covered" ></span>t</span>his.asn1ExtnValue=new KJUR.asn1.DERSequence({array:g})}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getExtnValueHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>return this.asn1ExtnValue.getEncodedHex()}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.oid="1.3.6.1.5.5.7.1.1";<span class="cstat-no" title="statement not covered" >i</span>f(typeof a!="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof a.array!="undefined"){<span class="cstat-no" title="statement not covered" >this.setAccessDescriptionArray(a.array)}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.x509.AuthorityInfoAccess,KJUR.asn1.x509.Extension);KJUR.asn1.x509.SubjectAltName=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.x509.SubjectAltName.superclass.constructor.call(this,a);<span class="cstat-no" title="statement not covered" >t</span>his.setNameArray=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>this.asn1ExtnValue=new KJUR.asn1.x509.GeneralNames(b)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getExtnValueHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>return this.asn1ExtnValue.getEncodedHex()}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.oid="2.5.29.17";<span class="cstat-no" title="statement not covered" >i</span>f(a!==undefined){<span class="cstat-no" title="statement not covered" >if(a.array!==undefined){<span class="cstat-no" title="statement not covered" >this.setNameArray(a.array)}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.x509.SubjectAltName,KJUR.asn1.x509.Extension);KJUR.asn1.x509.IssuerAltName=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.x509.IssuerAltName.superclass.constructor.call(this,a);<span class="cstat-no" title="statement not covered" >t</span>his.setNameArray=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>this.asn1ExtnValue=new KJUR.asn1.x509.GeneralNames(b)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getExtnValueHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>return this.asn1ExtnValue.getEncodedHex()}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.oid="2.5.29.18";<span class="cstat-no" title="statement not covered" >i</span>f(a!==undefined){<span class="cstat-no" title="statement not covered" >if(a.array!==undefined){<span class="cstat-no" title="statement not covered" >this.setNameArray(a.array)}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.x509.IssuerAltName,KJUR.asn1.x509.Extension);KJUR.asn1.x509.CRL=<span class="fstat-no" title="function not covered" >function(f){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.x509.CRL.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >v</span>ar a=null;<span class="cstat-no" title="statement not covered" >v</span>ar c=null;<span class="cstat-no" title="statement not covered" >v</span>ar e=null;<span class="cstat-no" title="statement not covered" >v</span>ar b=null;<span class="cstat-no" title="statement not covered" >v</span>ar d=null;<span class="cstat-no" title="statement not covered" >t</span>his.setRsaPrvKeyByPEMandPass=<span class="fstat-no" title="function not covered" >function(h,j){<span class="cstat-no" title="statement not covered" ></span>var g=PKCS5PKEY.getDecryptedKeyHex(h,j);<span class="cstat-no" title="statement not covered" >v</span>ar i=new RSAKey();<span class="cstat-no" title="statement not covered" >i</span>.readPrivateKeyFromASN1HexString(g);<span class="cstat-no" title="statement not covered" >t</span>his.rsaPrvKey=i}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.sign=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>this.asn1SignatureAlg=this.asn1TBSCertList.asn1SignatureAlg;<span class="cstat-no" title="statement not covered" >s</span>ig=new KJUR.crypto.Signature({alg:"SHA1withRSA",prov:"cryptojs/jsrsa"});<span class="cstat-no" title="statement not covered" >s</span>ig.initSign(this.rsaPrvKey);<span class="cstat-no" title="statement not covered" >s</span>ig.updateHex(this.asn1TBSCertList.getEncodedHex());<span class="cstat-no" title="statement not covered" >t</span>his.hexSig=sig.sign();<span class="cstat-no" title="statement not covered" >t</span>his.asn1Sig=new KJUR.asn1.DERBitString({hex:"00"+this.hexSig});<span class="cstat-no" title="statement not covered" >v</span>ar g=new KJUR.asn1.DERSequence({array:[this.asn1TBSCertList,this.asn1SignatureAlg,this.asn1Sig]});<span class="cstat-no" title="statement not covered" >t</span>his.hTLV=g.getEncodedHex();<span class="cstat-no" title="statement not covered" >t</span>his.isModified=false}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getEncodedHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>if(this.isModified==false&amp;&amp;this.hTLV!=null){<span class="cstat-no" title="statement not covered" >return this.hTLV}<span class="cstat-no" title="statement not covered" ></span>t</span>hrow"not signed yet"}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getPEMString=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var i=this.getEncodedHex();<span class="cstat-no" title="statement not covered" >v</span>ar g=CryptoJS.enc.Hex.parse(i);<span class="cstat-no" title="statement not covered" >v</span>ar h=CryptoJS.enc.Base64.stringify(g);<span class="cstat-no" title="statement not covered" >v</span>ar j=h.replace(/(.{64})/g,"$1\r\n");<span class="cstat-no" title="statement not covered" >r</span>eturn"-----BEGIN X509 CRL-----\r\n"+j+"\r\n-----END X509 CRL-----\r\n"}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(typeof f!="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof f.tbsobj!="undefined"){<span class="cstat-no" title="statement not covered" >this.asn1TBSCertList=f.tbsobj}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof f.rsaprvkey!="undefined"){<span class="cstat-no" title="statement not covered" >this.rsaPrvKey=f.rsaprvkey}<span class="cstat-no" title="statement not covered" ></span>i</span>f((typeof f.rsaprvpem!="undefined")&amp;&amp;(typeof f.rsaprvpas!="undefined")){<span class="cstat-no" title="statement not covered" >this.setRsaPrvKeyByPEMandPass(f.rsaprvpem,f.rsaprvpas)}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.x509.CRL,KJUR.asn1.ASN1Object);KJUR.asn1.x509.TBSCertList=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.x509.TBSCertList.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >v</span>ar a=null;<span class="cstat-no" title="statement not covered" >t</span>his.setSignatureAlgByParam=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>this.asn1SignatureAlg=new KJUR.asn1.x509.AlgorithmIdentifier(c)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setIssuerByParam=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>this.asn1Issuer=new KJUR.asn1.x509.X500Name(c)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setThisUpdateByParam=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>this.asn1ThisUpdate=new KJUR.asn1.x509.Time(c)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setNextUpdateByParam=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>this.asn1NextUpdate=new KJUR.asn1.x509.Time(c)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.addRevokedCert=<span class="fstat-no" title="function not covered" >function(c,d){<span class="cstat-no" title="statement not covered" ></span>var f={};<span class="cstat-no" title="statement not covered" >i</span>f(c!=undefined&amp;&amp;c!=null){<span class="cstat-no" title="statement not covered" >f.sn=c}<span class="cstat-no" title="statement not covered" ></span>i</span>f(d!=undefined&amp;&amp;d!=null){<span class="cstat-no" title="statement not covered" >f.time=d}<span class="cstat-no" title="statement not covered" ></span>v</span>ar e=new KJUR.asn1.x509.CRLEntry(f);<span class="cstat-no" title="statement not covered" >t</span>his.aRevokedCert.push(e)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getEncodedHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>this.asn1Array=new Array();<span class="cstat-no" title="statement not covered" >i</span>f(this.asn1Version!=null){<span class="cstat-no" title="statement not covered" >this.asn1Array.push(this.asn1Version)}<span class="cstat-no" title="statement not covered" ></span>t</span>his.asn1Array.push(this.asn1SignatureAlg);<span class="cstat-no" title="statement not covered" >t</span>his.asn1Array.push(this.asn1Issuer);<span class="cstat-no" title="statement not covered" >t</span>his.asn1Array.push(this.asn1ThisUpdate);<span class="cstat-no" title="statement not covered" >i</span>f(this.asn1NextUpdate!=null){<span class="cstat-no" title="statement not covered" >this.asn1Array.push(this.asn1NextUpdate)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(this.aRevokedCert.length&gt;0){<span class="cstat-no" title="statement not covered" >var c=new KJUR.asn1.DERSequence({array:this.aRevokedCert});<span class="cstat-no" title="statement not covered" >t</span>his.asn1Array.push(c)}<span class="cstat-no" title="statement not covered" ></span>v</span>ar d=new KJUR.asn1.DERSequence({array:this.asn1Array});<span class="cstat-no" title="statement not covered" >t</span>his.hTLV=d.getEncodedHex();<span class="cstat-no" title="statement not covered" >t</span>his.isModified=false;<span class="cstat-no" title="statement not covered" >r</span>eturn this.hTLV}</span>;<span class="cstat-no" title="statement not covered" >t</span>his._initialize=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>this.asn1Version=null;<span class="cstat-no" title="statement not covered" >t</span>his.asn1SignatureAlg=null;<span class="cstat-no" title="statement not covered" >t</span>his.asn1Issuer=null;<span class="cstat-no" title="statement not covered" >t</span>his.asn1ThisUpdate=null;<span class="cstat-no" title="statement not covered" >t</span>his.asn1NextUpdate=null;<span class="cstat-no" title="statement not covered" >t</span>his.aRevokedCert=new Array()}</span>;<span class="cstat-no" title="statement not covered" >t</span>his._initialize()}</span>;YAHOO.lang.extend(KJUR.asn1.x509.TBSCertList,KJUR.asn1.ASN1Object);KJUR.asn1.x509.CRLEntry=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.x509.CRLEntry.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >v</span>ar b=null;<span class="cstat-no" title="statement not covered" >v</span>ar a=null;<span class="cstat-no" title="statement not covered" >t</span>his.setCertSerial=<span class="fstat-no" title="function not covered" >function(d){<span class="cstat-no" title="statement not covered" ></span>this.sn=new KJUR.asn1.DERInteger(d)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setRevocationDate=<span class="fstat-no" title="function not covered" >function(d){<span class="cstat-no" title="statement not covered" ></span>this.time=new KJUR.asn1.x509.Time(d)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getEncodedHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var d=new KJUR.asn1.DERSequence({array:[this.sn,this.time]});<span class="cstat-no" title="statement not covered" >t</span>his.TLV=d.getEncodedHex();<span class="cstat-no" title="statement not covered" >r</span>eturn this.TLV}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(typeof c!="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof c.time!="undefined"){<span class="cstat-no" title="statement not covered" >this.setRevocationDate(c.time)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof c.sn!="undefined"){<span class="cstat-no" title="statement not covered" >this.setCertSerial(c.sn)}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.x509.CRLEntry,KJUR.asn1.ASN1Object);KJUR.asn1.x509.X500Name=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.x509.X500Name.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >t</span>his.asn1Array=new Array();<span class="cstat-no" title="statement not covered" >t</span>his.setByString=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>var d=c.split("/");<span class="cstat-no" title="statement not covered" >d</span>.shift();<span class="cstat-no" title="statement not covered" >f</span>or(var e=0;e&lt;d.length;e++){<span class="cstat-no" title="statement not covered" >this.asn1Array.push(new KJUR.asn1.x509.RDN({str:d[e]}))}</span>}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setByLdapString=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>var d=KJUR.asn1.x509.X500Name.ldapToOneline(c);<span class="cstat-no" title="statement not covered" >t</span>his.setByString(d)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setByObject=<span class="fstat-no" title="function not covered" >function(e){<span class="cstat-no" title="statement not covered" ></span>for(var c in e){<span class="cstat-no" title="statement not covered" >if(e.hasOwnProperty(c)){<span class="cstat-no" title="statement not covered" >var d=new KJUR.asn1.x509.RDN({str:c+"="+e[c]});<span class="cstat-no" title="statement not covered" >t</span>his.asn1Array?this.asn1Array.push(d):this.asn1Array=[d]}</span>}</span>}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getEncodedHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>if(typeof this.hTLV=="string"){<span class="cstat-no" title="statement not covered" >return this.hTLV}<span class="cstat-no" title="statement not covered" ></span>v</span>ar c=new KJUR.asn1.DERSequence({array:this.asn1Array});<span class="cstat-no" title="statement not covered" >t</span>his.hTLV=c.getEncodedHex();<span class="cstat-no" title="statement not covered" >r</span>eturn this.hTLV}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(b!==undefined){<span class="cstat-no" title="statement not covered" >if(b.str!==undefined){<span class="cstat-no" title="statement not covered" >this.setByString(b.str)}</span>else{<span class="cstat-no" title="statement not covered" >if(b.ldapstr!==undefined){<span class="cstat-no" title="statement not covered" >this.setByLdapString(b.ldapstr)}</span>else{<span class="cstat-no" title="statement not covered" >if(typeof b==="object"){<span class="cstat-no" title="statement not covered" >this.setByObject(b)}</span>}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(b.certissuer!==undefined){<span class="cstat-no" title="statement not covered" >var a=new X509();<span class="cstat-no" title="statement not covered" >a</span>.hex=ASN1HEX.pemToHex(b.certissuer);<span class="cstat-no" title="statement not covered" >t</span>his.hTLV=a.getIssuerHex()}<span class="cstat-no" title="statement not covered" ></span>i</span>f(b.certsubject!==undefined){<span class="cstat-no" title="statement not covered" >var a=new X509();<span class="cstat-no" title="statement not covered" >a</span>.hex=ASN1HEX.pemToHex(b.certsubject);<span class="cstat-no" title="statement not covered" >t</span>his.hTLV=a.getSubjectHex()}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.x509.X500Name,KJUR.asn1.ASN1Object);KJUR.asn1.x509.X500Name.onelineToLDAP=<span class="fstat-no" title="function not covered" >function(d){<span class="cstat-no" title="statement not covered" ></span>if(d.substr(0,1)!=="/"){<span class="cstat-no" title="statement not covered" >throw"malformed input"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar b="";<span class="cstat-no" title="statement not covered" >d</span>=d.substr(1);<span class="cstat-no" title="statement not covered" >v</span>ar c=d.split("/");<span class="cstat-no" title="statement not covered" >c</span>.reverse();<span class="cstat-no" title="statement not covered" >c</span>=c.map(<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>return a.replace(/,/,"\\,")}</span>);<span class="cstat-no" title="statement not covered" >r</span>eturn c.join(",")}</span>;KJUR.asn1.x509.X500Name.ldapToOneline=<span class="fstat-no" title="function not covered" >function(g){<span class="cstat-no" title="statement not covered" ></span>var c=g.split(",");<span class="cstat-no" title="statement not covered" >v</span>ar e=false;<span class="cstat-no" title="statement not covered" >v</span>ar b=[];<span class="cstat-no" title="statement not covered" >f</span>or(var f=0;c.length&gt;0;f++){<span class="cstat-no" title="statement not covered" >var h=c.shift();<span class="cstat-no" title="statement not covered" >i</span>f(e===true){<span class="cstat-no" title="statement not covered" >var d=b.pop();<span class="cstat-no" title="statement not covered" >v</span>ar j=(d+","+h).replace(/\\,/g,",");<span class="cstat-no" title="statement not covered" >b</span>.push(j);<span class="cstat-no" title="statement not covered" >e</span>=false}</span>else{<span class="cstat-no" title="statement not covered" >b.push(h)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(h.substr(-1,1)==="\\"){<span class="cstat-no" title="statement not covered" >e=true}</span>}<span class="cstat-no" title="statement not covered" ></span>b</span>=b.map(<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>return a.replace("/","\\/")}</span>);<span class="cstat-no" title="statement not covered" >b</span>.reverse();<span class="cstat-no" title="statement not covered" >r</span>eturn"/"+b.join("/")}</span>;KJUR.asn1.x509.RDN=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.x509.RDN.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >t</span>his.asn1Array=new Array();<span class="cstat-no" title="statement not covered" >t</span>his.addByString=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>this.asn1Array.push(new KJUR.asn1.x509.AttributeTypeAndValue({str:b}))}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.addByMultiValuedString=<span class="fstat-no" title="function not covered" >function(d){<span class="cstat-no" title="statement not covered" ></span>var b=KJUR.asn1.x509.RDN.parseString(d);<span class="cstat-no" title="statement not covered" >f</span>or(var c=0;c&lt;b.length;c++){<span class="cstat-no" title="statement not covered" >this.addByString(b[c])}</span>}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getEncodedHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var b=new KJUR.asn1.DERSet({array:this.asn1Array});<span class="cstat-no" title="statement not covered" >t</span>his.TLV=b.getEncodedHex();<span class="cstat-no" title="statement not covered" >r</span>eturn this.TLV}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(typeof a!="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof a.str!="undefined"){<span class="cstat-no" title="statement not covered" >this.addByMultiValuedString(a.str)}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.x509.RDN,KJUR.asn1.ASN1Object);KJUR.asn1.x509.RDN.parseString=<span class="fstat-no" title="function not covered" >function(m){<span class="cstat-no" title="statement not covered" ></span>var j=m.split(/\+/);<span class="cstat-no" title="statement not covered" >v</span>ar h=false;<span class="cstat-no" title="statement not covered" >v</span>ar c=[];<span class="cstat-no" title="statement not covered" >f</span>or(var g=0;j.length&gt;0;g++){<span class="cstat-no" title="statement not covered" >var k=j.shift();<span class="cstat-no" title="statement not covered" >i</span>f(h===true){<span class="cstat-no" title="statement not covered" >var f=c.pop();<span class="cstat-no" title="statement not covered" >v</span>ar d=(f+"+"+k).replace(/\\\+/g,"+");<span class="cstat-no" title="statement not covered" >c</span>.push(d);<span class="cstat-no" title="statement not covered" >h</span>=false}</span>else{<span class="cstat-no" title="statement not covered" >c.push(k)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(k.substr(-1,1)==="\\"){<span class="cstat-no" title="statement not covered" >h=true}</span>}<span class="cstat-no" title="statement not covered" ></span>v</span>ar l=false;<span class="cstat-no" title="statement not covered" >v</span>ar b=[];<span class="cstat-no" title="statement not covered" >f</span>or(var g=0;c.length&gt;0;g++){<span class="cstat-no" title="statement not covered" >var k=c.shift();<span class="cstat-no" title="statement not covered" >i</span>f(l===true){<span class="cstat-no" title="statement not covered" >var e=b.pop();<span class="cstat-no" title="statement not covered" >i</span>f(k.match(/"$/)){<span class="cstat-no" title="statement not covered" >var d=(e+"+"+k).replace(/^([^=]+)="(.*)"$/,"$1=$2");<span class="cstat-no" title="statement not covered" >b</span>.push(d);<span class="cstat-no" title="statement not covered" >l</span>=false}</span>else{<span class="cstat-no" title="statement not covered" >b.push(e+"+"+k)}</span>}</span>else{<span class="cstat-no" title="statement not covered" >b.push(k)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(k.match(/^[^=]+="/)){<span class="cstat-no" title="statement not covered" >l=true}</span>}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn b}</span>;KJUR.asn1.x509.AttributeTypeAndValue=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.x509.AttributeTypeAndValue.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >v</span>ar d=null;<span class="cstat-no" title="statement not covered" >v</span>ar c=null;<span class="cstat-no" title="statement not covered" >v</span>ar a="utf8";<span class="cstat-no" title="statement not covered" >t</span>his.setByString=<span class="fstat-no" title="function not covered" >function(f){<span class="cstat-no" title="statement not covered" ></span>var e=f.match(/^([^=]+)=(.+)$/);<span class="cstat-no" title="statement not covered" >i</span>f(e){<span class="cstat-no" title="statement not covered" >this.setByAttrTypeAndValueStr(e[1],e[2])}</span>else{<span class="cstat-no" title="statement not covered" >throw"malformed attrTypeAndValueStr: "+f}</span>}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setByAttrTypeAndValueStr=<span class="fstat-no" title="function not covered" >function(g,f){<span class="cstat-no" title="statement not covered" ></span>this.typeObj=KJUR.asn1.x509.OID.atype2obj(g);<span class="cstat-no" title="statement not covered" >v</span>ar e=a;<span class="cstat-no" title="statement not covered" >i</span>f(g=="C"){<span class="cstat-no" title="statement not covered" >e="prn"}<span class="cstat-no" title="statement not covered" ></span>t</span>his.valueObj=this.getValueObj(e,f)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getValueObj=<span class="fstat-no" title="function not covered" >function(f,e){<span class="cstat-no" title="statement not covered" ></span>if(f=="utf8"){<span class="cstat-no" title="statement not covered" >return new KJUR.asn1.DERUTF8String({str:e})}<span class="cstat-no" title="statement not covered" ></span>i</span>f(f=="prn"){<span class="cstat-no" title="statement not covered" >return new KJUR.asn1.DERPrintableString({str:e})}<span class="cstat-no" title="statement not covered" ></span>i</span>f(f=="tel"){<span class="cstat-no" title="statement not covered" >return new KJUR.asn1.DERTeletexString({str:e})}<span class="cstat-no" title="statement not covered" ></span>i</span>f(f=="ia5"){<span class="cstat-no" title="statement not covered" >return new KJUR.asn1.DERIA5String({str:e})}<span class="cstat-no" title="statement not covered" ></span>t</span>hrow"unsupported directory string type: type="+f+" value="+e}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getEncodedHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var e=new KJUR.asn1.DERSequence({array:[this.typeObj,this.valueObj]});<span class="cstat-no" title="statement not covered" >t</span>his.TLV=e.getEncodedHex();<span class="cstat-no" title="statement not covered" >r</span>eturn this.TLV}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(typeof b!="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof b.str!="undefined"){<span class="cstat-no" title="statement not covered" >this.setByString(b.str)}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.x509.AttributeTypeAndValue,KJUR.asn1.ASN1Object);KJUR.asn1.x509.SubjectPublicKeyInfo=<span class="fstat-no" title="function not covered" >function(d){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.x509.SubjectPublicKeyInfo.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >v</span>ar b=null;<span class="cstat-no" title="statement not covered" >v</span>ar c=null;<span class="cstat-no" title="statement not covered" >v</span>ar a=null;<span class="cstat-no" title="statement not covered" >t</span>his.setRSAKey=<span class="fstat-no" title="function not covered" >function(e){<span class="cstat-no" title="statement not covered" ></span>if(!RSAKey.prototype.isPrototypeOf(e)){<span class="cstat-no" title="statement not covered" >throw"argument is not RSAKey instance"}<span class="cstat-no" title="statement not covered" ></span>t</span>his.rsaKey=e;<span class="cstat-no" title="statement not covered" >v</span>ar g=new KJUR.asn1.DERInteger({bigint:e.n});<span class="cstat-no" title="statement not covered" >v</span>ar f=new KJUR.asn1.DERInteger({"int":e.e});<span class="cstat-no" title="statement not covered" >v</span>ar i=new KJUR.asn1.DERSequence({array:[g,f]});<span class="cstat-no" title="statement not covered" >v</span>ar h=i.getEncodedHex();<span class="cstat-no" title="statement not covered" >t</span>his.asn1AlgId=new KJUR.asn1.x509.AlgorithmIdentifier({name:"rsaEncryption"});<span class="cstat-no" title="statement not covered" >t</span>his.asn1SubjPKey=new KJUR.asn1.DERBitString({hex:"00"+h})}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setRSAPEM=<span class="fstat-no" title="function not covered" >function(g){<span class="cstat-no" title="statement not covered" ></span>if(g.match(/-----BEGIN PUBLIC KEY-----/)){<span class="cstat-no" title="statement not covered" >var n=g;<span class="cstat-no" title="statement not covered" >n</span>=n.replace(/^-----[^-]+-----/,"");<span class="cstat-no" title="statement not covered" >n</span>=n.replace(/-----[^-]+-----\s*$/,"");<span class="cstat-no" title="statement not covered" >v</span>ar m=n.replace(/\s+/g,"");<span class="cstat-no" title="statement not covered" >v</span>ar f=CryptoJS.enc.Base64.parse(m);<span class="cstat-no" title="statement not covered" >v</span>ar i=CryptoJS.enc.Hex.stringify(f);<span class="cstat-no" title="statement not covered" >v</span>ar k=RSAKey.getHexValueArrayOfChildrenFromHex(i);<span class="cstat-no" title="statement not covered" >v</span>ar h=k[1];<span class="cstat-no" title="statement not covered" >v</span>ar l=h.substr(2);<span class="cstat-no" title="statement not covered" >v</span>ar e=RSAKey.getHexValueArrayOfChildrenFromHex(l);<span class="cstat-no" title="statement not covered" >v</span>ar j=new RSAKey();<span class="cstat-no" title="statement not covered" >j</span>.setPublic(e[0],e[1]);<span class="cstat-no" title="statement not covered" >t</span>his.setRSAKey(j)}</span>else{<span class="cstat-no" title="statement not covered" >throw"key not supported"}</span>}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getASN1Object=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>if(this.asn1AlgId==null||this.asn1SubjPKey==null){<span class="cstat-no" title="statement not covered" >throw"algId and/or subjPubKey not set"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar e=new KJUR.asn1.DERSequence({array:[this.asn1AlgId,this.asn1SubjPKey]});<span class="cstat-no" title="statement not covered" >r</span>eturn e}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getEncodedHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var e=this.getASN1Object();<span class="cstat-no" title="statement not covered" >t</span>his.hTLV=e.getEncodedHex();<span class="cstat-no" title="statement not covered" >r</span>eturn this.hTLV}</span>;<span class="cstat-no" title="statement not covered" >t</span>his._setRSAKey=<span class="fstat-no" title="function not covered" >function(e){<span class="cstat-no" title="statement not covered" ></span>var g=KJUR.asn1.ASN1Util.newObject({seq:[{"int":{bigint:e.n}},{"int":{"int":e.e}}]});<span class="cstat-no" title="statement not covered" >v</span>ar f=g.getEncodedHex();<span class="cstat-no" title="statement not covered" >t</span>his.asn1AlgId=new KJUR.asn1.x509.AlgorithmIdentifier({name:"rsaEncryption"});<span class="cstat-no" title="statement not covered" >t</span>his.asn1SubjPKey=new KJUR.asn1.DERBitString({hex:"00"+f})}</span>;<span class="cstat-no" title="statement not covered" >t</span>his._setEC=<span class="fstat-no" title="function not covered" >function(e){<span class="cstat-no" title="statement not covered" ></span>var f=new KJUR.asn1.DERObjectIdentifier({name:e.curveName});<span class="cstat-no" title="statement not covered" >t</span>his.asn1AlgId=new KJUR.asn1.x509.AlgorithmIdentifier({name:"ecPublicKey",asn1params:f});<span class="cstat-no" title="statement not covered" >t</span>his.asn1SubjPKey=new KJUR.asn1.DERBitString({hex:"00"+e.pubKeyHex})}</span>;<span class="cstat-no" title="statement not covered" >t</span>his._setDSA=<span class="fstat-no" title="function not covered" >function(e){<span class="cstat-no" title="statement not covered" ></span>var f=new KJUR.asn1.ASN1Util.newObject({seq:[{"int":{bigint:e.p}},{"int":{bigint:e.q}},{"int":{bigint:e.g}}]});<span class="cstat-no" title="statement not covered" >t</span>his.asn1AlgId=new KJUR.asn1.x509.AlgorithmIdentifier({name:"dsa",asn1params:f});<span class="cstat-no" title="statement not covered" >v</span>ar g=new KJUR.asn1.DERInteger({bigint:e.y});<span class="cstat-no" title="statement not covered" >t</span>his.asn1SubjPKey=new KJUR.asn1.DERBitString({hex:"00"+g.getEncodedHex()})}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(typeof d!="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof RSAKey!="undefined"&amp;&amp;d instanceof RSAKey){<span class="cstat-no" title="statement not covered" >this._setRSAKey(d)}</span>else{<span class="cstat-no" title="statement not covered" >if(typeof KJUR.crypto.ECDSA!="undefined"&amp;&amp;d instanceof KJUR.crypto.ECDSA){<span class="cstat-no" title="statement not covered" >this._setEC(d)}</span>else{<span class="cstat-no" title="statement not covered" >if(typeof KJUR.crypto.DSA!="undefined"&amp;&amp;d instanceof KJUR.crypto.DSA){<span class="cstat-no" title="statement not covered" >this._setDSA(d)}</span>else{<span class="cstat-no" title="statement not covered" >if(typeof d.rsakey!="undefined"){<span class="cstat-no" title="statement not covered" >this.setRSAKey(d.rsakey)}</span>else{<span class="cstat-no" title="statement not covered" >if(typeof d.rsapem!="undefined"){<span class="cstat-no" title="statement not covered" >this.setRSAPEM(d.rsapem)}</span>}</span>}</span>}</span>}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.x509.SubjectPublicKeyInfo,KJUR.asn1.ASN1Object);KJUR.asn1.x509.Time=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.x509.Time.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >v</span>ar b=null;<span class="cstat-no" title="statement not covered" >v</span>ar a=null;<span class="cstat-no" title="statement not covered" >t</span>his.setTimeParams=<span class="fstat-no" title="function not covered" >function(d){<span class="cstat-no" title="statement not covered" ></span>this.timeParams=d}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getEncodedHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var d=null;<span class="cstat-no" title="statement not covered" >i</span>f(this.timeParams!=null){<span class="cstat-no" title="statement not covered" >if(this.type=="utc"){<span class="cstat-no" title="statement not covered" >d=new KJUR.asn1.DERUTCTime(this.timeParams)}</span>else{<span class="cstat-no" title="statement not covered" >d=new KJUR.asn1.DERGeneralizedTime(this.timeParams)}</span>}</span>else{<span class="cstat-no" title="statement not covered" >if(this.type=="utc"){<span class="cstat-no" title="statement not covered" >d=new KJUR.asn1.DERUTCTime()}</span>else{<span class="cstat-no" title="statement not covered" >d=new KJUR.asn1.DERGeneralizedTime()}</span>}<span class="cstat-no" title="statement not covered" ></span>t</span>his.TLV=d.getEncodedHex();<span class="cstat-no" title="statement not covered" >r</span>eturn this.TLV}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.type="utc";<span class="cstat-no" title="statement not covered" >i</span>f(typeof c!="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof c.type!="undefined"){<span class="cstat-no" title="statement not covered" >this.type=c.type}</span>else{<span class="cstat-no" title="statement not covered" >if(typeof c.str!="undefined"){<span class="cstat-no" title="statement not covered" >if(c.str.match(/^[0-9]{12}Z$/)){<span class="cstat-no" title="statement not covered" >this.type="utc"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(c.str.match(/^[0-9]{14}Z$/)){<span class="cstat-no" title="statement not covered" >this.type="gen"}</span>}</span>}<span class="cstat-no" title="statement not covered" ></span>t</span>his.timeParams=c}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.x509.Time,KJUR.asn1.ASN1Object);KJUR.asn1.x509.AlgorithmIdentifier=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.x509.AlgorithmIdentifier.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >t</span>his.nameAlg=null;<span class="cstat-no" title="statement not covered" >t</span>his.asn1Alg=null;<span class="cstat-no" title="statement not covered" >t</span>his.asn1Params=null;<span class="cstat-no" title="statement not covered" >t</span>his.paramEmpty=false;<span class="cstat-no" title="statement not covered" >t</span>his.getEncodedHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>if(this.nameAlg===null&amp;&amp;this.asn1Alg===null){<span class="cstat-no" title="statement not covered" >throw"algorithm not specified"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(this.nameAlg!==null&amp;&amp;this.asn1Alg===null){<span class="cstat-no" title="statement not covered" >this.asn1Alg=KJUR.asn1.x509.OID.name2obj(this.nameAlg)}<span class="cstat-no" title="statement not covered" ></span>v</span>ar c=[this.asn1Alg];<span class="cstat-no" title="statement not covered" >i</span>f(this.asn1Params!==null){<span class="cstat-no" title="statement not covered" >c.push(this.asn1Params)}<span class="cstat-no" title="statement not covered" ></span>v</span>ar d=new KJUR.asn1.DERSequence({array:c});<span class="cstat-no" title="statement not covered" >t</span>his.hTLV=d.getEncodedHex();<span class="cstat-no" title="statement not covered" >r</span>eturn this.hTLV}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(b!==undefined){<span class="cstat-no" title="statement not covered" >if(b.name!==undefined){<span class="cstat-no" title="statement not covered" >this.nameAlg=b.name}<span class="cstat-no" title="statement not covered" ></span>i</span>f(b.asn1params!==undefined){<span class="cstat-no" title="statement not covered" >this.asn1Params=b.asn1params}<span class="cstat-no" title="statement not covered" ></span>i</span>f(b.paramempty!==undefined){<span class="cstat-no" title="statement not covered" >this.paramEmpty=b.paramempty}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(this.asn1Params===null&amp;&amp;this.paramEmpty===false&amp;&amp;this.nameAlg!==null){<span class="cstat-no" title="statement not covered" >var a=this.nameAlg.toLowerCase();<span class="cstat-no" title="statement not covered" >i</span>f(a.substr(-7,7)!=="withdsa"&amp;&amp;a.substr(-9,9)!=="withecdsa"){<span class="cstat-no" title="statement not covered" >this.asn1Params=new KJUR.asn1.DERNull()}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.x509.AlgorithmIdentifier,KJUR.asn1.ASN1Object);KJUR.asn1.x509.GeneralName=<span class="fstat-no" title="function not covered" >function(d){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.x509.GeneralName.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >v</span>ar c=null;<span class="cstat-no" title="statement not covered" >v</span>ar b=null;<span class="cstat-no" title="statement not covered" >v</span>ar a={rfc822:"81",dns:"82",dn:"a4",uri:"86"};<span class="cstat-no" title="statement not covered" >t</span>his.explicit=false;<span class="cstat-no" title="statement not covered" >t</span>his.setByParam=<span class="fstat-no" title="function not covered" >function(k){<span class="cstat-no" title="statement not covered" ></span>var j=null;<span class="cstat-no" title="statement not covered" >v</span>ar g=null;<span class="cstat-no" title="statement not covered" >i</span>f(k===undefined){<span class="cstat-no" title="statement not covered" >return}<span class="cstat-no" title="statement not covered" ></span>i</span>f(k.rfc822!==undefined){<span class="cstat-no" title="statement not covered" >this.type="rfc822";<span class="cstat-no" title="statement not covered" >g</span>=new KJUR.asn1.DERIA5String({str:k[this.type]})}<span class="cstat-no" title="statement not covered" ></span>i</span>f(k.dns!==undefined){<span class="cstat-no" title="statement not covered" >this.type="dns";<span class="cstat-no" title="statement not covered" >g</span>=new KJUR.asn1.DERIA5String({str:k[this.type]})}<span class="cstat-no" title="statement not covered" ></span>i</span>f(k.uri!==undefined){<span class="cstat-no" title="statement not covered" >this.type="uri";<span class="cstat-no" title="statement not covered" >g</span>=new KJUR.asn1.DERIA5String({str:k[this.type]})}<span class="cstat-no" title="statement not covered" ></span>i</span>f(k.dn!==undefined){<span class="cstat-no" title="statement not covered" >this.type="dn";<span class="cstat-no" title="statement not covered" >g</span>=new KJUR.asn1.x509.X500Name({str:k.dn})}<span class="cstat-no" title="statement not covered" ></span>i</span>f(k.ldapdn!==undefined){<span class="cstat-no" title="statement not covered" >this.type="dn";<span class="cstat-no" title="statement not covered" >g</span>=new KJUR.asn1.x509.X500Name({ldapstr:k.ldapdn})}<span class="cstat-no" title="statement not covered" ></span>i</span>f(k.certissuer!==undefined){<span class="cstat-no" title="statement not covered" >this.type="dn";<span class="cstat-no" title="statement not covered" >t</span>his.explicit=true;<span class="cstat-no" title="statement not covered" >v</span>ar h=k.certissuer;<span class="cstat-no" title="statement not covered" >v</span>ar f=null;<span class="cstat-no" title="statement not covered" >i</span>f(h.match(/^[0-9A-Fa-f]+$/)){<span class="cstat-no" title="statement not covered" >f==h}<span class="cstat-no" title="statement not covered" ></span>i</span>f(h.indexOf("-----BEGIN ")!=-1){<span class="cstat-no" title="statement not covered" >f=ASN1HEX.pemToHex(h)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(f==null){<span class="cstat-no" title="statement not covered" >throw"certissuer param not cert"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar e=new X509();<span class="cstat-no" title="statement not covered" >e</span>.hex=f;<span class="cstat-no" title="statement not covered" >v</span>ar i=e.getIssuerHex();<span class="cstat-no" title="statement not covered" >g</span>=new KJUR.asn1.ASN1Object();<span class="cstat-no" title="statement not covered" >g</span>.hTLV=i}<span class="cstat-no" title="statement not covered" ></span>i</span>f(k.certsubj!==undefined){<span class="cstat-no" title="statement not covered" >this.type="dn";<span class="cstat-no" title="statement not covered" >t</span>his.explicit=true;<span class="cstat-no" title="statement not covered" >v</span>ar h=k.certsubj;<span class="cstat-no" title="statement not covered" >v</span>ar f=null;<span class="cstat-no" title="statement not covered" >i</span>f(h.match(/^[0-9A-Fa-f]+$/)){<span class="cstat-no" title="statement not covered" >f==h}<span class="cstat-no" title="statement not covered" ></span>i</span>f(h.indexOf("-----BEGIN ")!=-1){<span class="cstat-no" title="statement not covered" >f=ASN1HEX.pemToHex(h)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(f==null){<span class="cstat-no" title="statement not covered" >throw"certsubj param not cert"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar e=new X509();<span class="cstat-no" title="statement not covered" >e</span>.hex=f;<span class="cstat-no" title="statement not covered" >v</span>ar i=e.getSubjectHex();<span class="cstat-no" title="statement not covered" >g</span>=new KJUR.asn1.ASN1Object();<span class="cstat-no" title="statement not covered" >g</span>.hTLV=i}<span class="cstat-no" title="statement not covered" ></span>i</span>f(this.type==null){<span class="cstat-no" title="statement not covered" >throw"unsupported type in params="+k}<span class="cstat-no" title="statement not covered" ></span>t</span>his.asn1Obj=new KJUR.asn1.DERTaggedObject({explicit:this.explicit,tag:a[this.type],obj:g})}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getEncodedHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>return this.asn1Obj.getEncodedHex()}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(d!==undefined){<span class="cstat-no" title="statement not covered" >this.setByParam(d)}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.x509.GeneralName,KJUR.asn1.ASN1Object);KJUR.asn1.x509.GeneralNames=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.x509.GeneralNames.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >v</span>ar a=null;<span class="cstat-no" title="statement not covered" >t</span>his.setByParamArray=<span class="fstat-no" title="function not covered" >function(e){<span class="cstat-no" title="statement not covered" ></span>for(var c=0;c&lt;e.length;c++){<span class="cstat-no" title="statement not covered" >var d=new KJUR.asn1.x509.GeneralName(e[c]);<span class="cstat-no" title="statement not covered" >t</span>his.asn1Array.push(d)}</span>}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getEncodedHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var c=new KJUR.asn1.DERSequence({array:this.asn1Array});<span class="cstat-no" title="statement not covered" >r</span>eturn c.getEncodedHex()}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.asn1Array=new Array();<span class="cstat-no" title="statement not covered" >i</span>f(typeof b!="undefined"){<span class="cstat-no" title="statement not covered" >this.setByParamArray(b)}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.x509.GeneralNames,KJUR.asn1.ASN1Object);KJUR.asn1.x509.DistributionPointName=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.x509.DistributionPointName.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >v</span>ar e=null;<span class="cstat-no" title="statement not covered" >v</span>ar c=null;<span class="cstat-no" title="statement not covered" >v</span>ar a=null;<span class="cstat-no" title="statement not covered" >v</span>ar d=null;<span class="cstat-no" title="statement not covered" >t</span>his.getEncodedHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>if(this.type!="full"){<span class="cstat-no" title="statement not covered" >throw"currently type shall be 'full': "+this.type}<span class="cstat-no" title="statement not covered" ></span>t</span>his.asn1Obj=new KJUR.asn1.DERTaggedObject({explicit:false,tag:this.tag,obj:this.asn1V});<span class="cstat-no" title="statement not covered" >t</span>his.hTLV=this.asn1Obj.getEncodedHex();<span class="cstat-no" title="statement not covered" >r</span>eturn this.hTLV}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(typeof b!="undefined"){<span class="cstat-no" title="statement not covered" >if(KJUR.asn1.x509.GeneralNames.prototype.isPrototypeOf(b)){<span class="cstat-no" title="statement not covered" >this.type="full";<span class="cstat-no" title="statement not covered" >t</span>his.tag="a0";<span class="cstat-no" title="statement not covered" >t</span>his.asn1V=b}</span>else{<span class="cstat-no" title="statement not covered" >throw"This class supports GeneralNames only as argument"}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.x509.DistributionPointName,KJUR.asn1.ASN1Object);KJUR.asn1.x509.DistributionPoint=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.x509.DistributionPoint.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >v</span>ar a=null;<span class="cstat-no" title="statement not covered" >t</span>his.getEncodedHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var c=new KJUR.asn1.DERSequence();<span class="cstat-no" title="statement not covered" >i</span>f(this.asn1DP!=null){<span class="cstat-no" title="statement not covered" >var d=new KJUR.asn1.DERTaggedObject({explicit:true,tag:"a0",obj:this.asn1DP});<span class="cstat-no" title="statement not covered" >c</span>.appendASN1Object(d)}<span class="cstat-no" title="statement not covered" ></span>t</span>his.hTLV=c.getEncodedHex();<span class="cstat-no" title="statement not covered" >r</span>eturn this.hTLV}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(typeof b!="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof b.dpobj!="undefined"){<span class="cstat-no" title="statement not covered" >this.asn1DP=b.dpobj}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.x509.DistributionPoint,KJUR.asn1.ASN1Object);KJUR.asn1.x509.OID=new function(a){this.atype2oidList={CN:"2.5.4.3",L:"2.5.4.7",ST:"2.5.4.8",O:"2.5.4.10",OU:"2.5.4.11",C:"2.5.4.6",STREET:"2.5.4.9",DC:"0.9.2342.19200300.100.1.25",UID:"0.9.2342.19200300.100.1.1",SN:"2.5.4.4",DN:"2.5.4.49",E:"1.2.840.113549.1.9.1",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3"};this.name2oidList={sha1:"1.3.14.3.2.26",sha256:"2.16.840.1.101.3.4.2.1",sha384:"2.16.840.1.101.3.4.2.2",sha512:"2.16.840.1.101.3.4.2.3",sha224:"2.16.840.1.101.3.4.2.4",md5:"1.2.840.113549.2.5",md2:"1.3.14.7.2.2.1",ripemd160:"1.3.36.3.2.1",MD2withRSA:"1.2.840.113549.1.1.2",MD4withRSA:"1.2.840.113549.1.1.3",MD5withRSA:"1.2.840.113549.1.1.4",SHA1withRSA:"1.2.840.113549.1.1.5",SHA224withRSA:"1.2.840.113549.1.1.14",SHA256withRSA:"1.2.840.113549.1.1.11",SHA384withRSA:"1.2.840.113549.1.1.12",SHA512withRSA:"1.2.840.113549.1.1.13",SHA1withECDSA:"1.2.840.10045.4.1",SHA224withECDSA:"1.2.840.10045.4.3.1",SHA256withECDSA:"1.2.840.10045.4.3.2",SHA384withECDSA:"1.2.840.10045.4.3.3",SHA512withECDSA:"1.2.840.10045.4.3.4",dsa:"1.2.840.10040.4.1",SHA1withDSA:"1.2.840.10040.4.3",SHA224withDSA:"2.16.840.1.101.3.4.3.1",SHA256withDSA:"2.16.840.1.101.3.4.3.2",rsaEncryption:"1.2.840.113549.1.1.1",commonName:"2.5.4.3",localityName:"2.5.4.7",stateOrProvinceName:"2.5.4.8",organizationName:"2.5.4.10",organizationalUnitName:"2.5.4.11",countryName:"2.5.4.6",streetAddress:"2.5.4.9",domainComponent:"0.9.2342.19200300.100.1.25",userId:"0.9.2342.19200300.100.1.1",surname:"2.5.4.4",distinguishedName:"2.5.4.49",emailAddress:"1.2.840.113549.1.9.1",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3",subjectKeyIdentifier:"2.5.29.14",keyUsage:"2.5.29.15",subjectAltName:"2.5.29.17",issuerAltName:"2.5.29.18",basicConstraints:"2.5.29.19",nameConstraints:"2.5.29.30",cRLDistributionPoints:"2.5.29.31",certificatePolicies:"2.5.29.32",authorityKeyIdentifier:"2.5.29.35",policyConstraints:"2.5.29.36",extKeyUsage:"2.5.29.37",authorityInfoAccess:"1.3.6.1.5.5.7.1.1",ocsp:"1.3.6.1.5.5.7.48.1",caIssuers:"1.3.6.1.5.5.7.48.2",anyExtendedKeyUsage:"2.5.29.37.0",serverAuth:"1.3.6.1.5.5.7.3.1",clientAuth:"1.3.6.1.5.5.7.3.2",codeSigning:"1.3.6.1.5.5.7.3.3",emailProtection:"1.3.6.1.5.5.7.3.4",timeStamping:"1.3.6.1.5.5.7.3.8",ocspSigning:"1.3.6.1.5.5.7.3.9",ecPublicKey:"1.2.840.10045.2.1",secp256r1:"1.2.840.10045.3.1.7",secp256k1:"1.3.132.0.10",secp384r1:"1.3.132.0.34",pkcs5PBES2:"1.2.840.113549.1.5.13",pkcs5PBKDF2:"1.2.840.113549.1.5.12","des-EDE3-CBC":"1.2.840.113549.3.7",data:"1.2.840.113549.1.7.1","signed-data":"1.2.840.113549.1.7.2","enveloped-data":"1.2.840.113549.1.7.3","digested-data":"1.2.840.113549.1.7.5","encrypted-data":"1.2.840.113549.1.7.6","authenticated-data":"1.2.840.113549.1.9.16.1.2",tstinfo:"1.2.840.113549.1.9.16.1.4",extensionRequest:"1.2.840.113549.1.9.14",};this.objCache={};this.name2obj=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>if(typeof this.objCache[b]!="undefined"){<span class="cstat-no" title="statement not covered" >return this.objCache[b]}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof this.name2oidList[b]=="undefined"){<span class="cstat-no" title="statement not covered" >throw"Name of ObjectIdentifier not defined: "+b}<span class="cstat-no" title="statement not covered" ></span>v</span>ar c=this.name2oidList[b];<span class="cstat-no" title="statement not covered" >v</span>ar d=new KJUR.asn1.DERObjectIdentifier({oid:c});<span class="cstat-no" title="statement not covered" >t</span>his.objCache[b]=d;<span class="cstat-no" title="statement not covered" >r</span>eturn d}</span>;this.atype2obj=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>if(typeof this.objCache[b]!="undefined"){<span class="cstat-no" title="statement not covered" >return this.objCache[b]}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof this.atype2oidList[b]=="undefined"){<span class="cstat-no" title="statement not covered" >throw"AttributeType name undefined: "+b}<span class="cstat-no" title="statement not covered" ></span>v</span>ar c=this.atype2oidList[b];<span class="cstat-no" title="statement not covered" >v</span>ar d=new KJUR.asn1.DERObjectIdentifier({oid:c});<span class="cstat-no" title="statement not covered" >t</span>his.objCache[b]=d;<span class="cstat-no" title="statement not covered" >r</span>eturn d}</span>};KJUR.asn1.x509.OID.oid2name=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>var c=KJUR.asn1.x509.OID.name2oidList;<span class="cstat-no" title="statement not covered" >f</span>or(var a in c){<span class="cstat-no" title="statement not covered" >if(c[a]==b){<span class="cstat-no" title="statement not covered" >return a}</span>}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn""}</span>;KJUR.asn1.x509.OID.oid2atype=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>var c=KJUR.asn1.x509.OID.atype2oidList;<span class="cstat-no" title="statement not covered" >f</span>or(var a in c){<span class="cstat-no" title="statement not covered" >if(c[a]==b){<span class="cstat-no" title="statement not covered" >return a}</span>}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn b}</span>;KJUR.asn1.x509.OID.name2oid=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>var b=KJUR.asn1.x509.OID.name2oidList;<span class="cstat-no" title="statement not covered" >i</span>f(b[a]===undefined){<span class="cstat-no" title="statement not covered" >return""}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn b[a]}</span>;KJUR.asn1.x509.X509Util=new function(){this.getPKCS8PubKeyPEMfromRSAKey=<span class="fstat-no" title="function not covered" >function(i){<span class="cstat-no" title="statement not covered" ></span>var h=null;<span class="cstat-no" title="statement not covered" >v</span>ar f=KJUR.asn1.ASN1Util.bigIntToMinTwosComplementsHex(i.n);<span class="cstat-no" title="statement not covered" >v</span>ar j=KJUR.asn1.ASN1Util.integerToByteHex(i.e);<span class="cstat-no" title="statement not covered" >v</span>ar a=new KJUR.asn1.DERInteger({hex:f});<span class="cstat-no" title="statement not covered" >v</span>ar g=new KJUR.asn1.DERInteger({hex:j});<span class="cstat-no" title="statement not covered" >v</span>ar l=new KJUR.asn1.DERSequence({array:[a,g]});<span class="cstat-no" title="statement not covered" >v</span>ar c=l.getEncodedHex();<span class="cstat-no" title="statement not covered" >v</span>ar d=new KJUR.asn1.x509.AlgorithmIdentifier({name:"rsaEncryption"});<span class="cstat-no" title="statement not covered" >v</span>ar b=new KJUR.asn1.DERBitString({hex:"00"+c});<span class="cstat-no" title="statement not covered" >v</span>ar k=new KJUR.asn1.DERSequence({array:[d,b]});<span class="cstat-no" title="statement not covered" >v</span>ar e=k.getEncodedHex();<span class="cstat-no" title="statement not covered" >v</span>ar h=KJUR.asn1.ASN1Util.getPEMStringFromHex(e,"PUBLIC KEY");<span class="cstat-no" title="statement not covered" >r</span>eturn h}</span>};KJUR.asn1.x509.X509Util.newCertPEM=<span class="fstat-no" title="function not covered" >function(f){<span class="cstat-no" title="statement not covered" ></span>var c=KJUR.asn1.x509;<span class="cstat-no" title="statement not covered" >v</span>ar e=new c.TBSCertificate();<span class="cstat-no" title="statement not covered" >i</span>f(f.serial!==undefined){<span class="cstat-no" title="statement not covered" >e.setSerialNumberByParam(f.serial)}</span>else{<span class="cstat-no" title="statement not covered" >throw"serial number undefined."}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof f.sigalg.name==="string"){<span class="cstat-no" title="statement not covered" >e.setSignatureAlgByParam(f.sigalg)}</span>else{<span class="cstat-no" title="statement not covered" >throw"unproper signature algorithm name"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(f.issuer!==undefined){<span class="cstat-no" title="statement not covered" >e.setIssuerByParam(f.issuer)}</span>else{<span class="cstat-no" title="statement not covered" >throw"issuer name undefined."}<span class="cstat-no" title="statement not covered" ></span>i</span>f(f.notbefore!==undefined){<span class="cstat-no" title="statement not covered" >e.setNotBeforeByParam(f.notbefore)}</span>else{<span class="cstat-no" title="statement not covered" >throw"notbefore undefined."}<span class="cstat-no" title="statement not covered" ></span>i</span>f(f.notafter!==undefined){<span class="cstat-no" title="statement not covered" >e.setNotAfterByParam(f.notafter)}</span>else{<span class="cstat-no" title="statement not covered" >throw"notafter undefined."}<span class="cstat-no" title="statement not covered" ></span>i</span>f(f.subject!==undefined){<span class="cstat-no" title="statement not covered" >e.setSubjectByParam(f.subject)}</span>else{<span class="cstat-no" title="statement not covered" >throw"subject name undefined."}<span class="cstat-no" title="statement not covered" ></span>i</span>f(f.sbjpubkey!==undefined){<span class="cstat-no" title="statement not covered" >e.setSubjectPublicKeyByGetKey(f.sbjpubkey)}</span>else{<span class="cstat-no" title="statement not covered" >throw"subject public key undefined."}<span class="cstat-no" title="statement not covered" ></span>i</span>f(f.ext!==undefined&amp;&amp;f.ext.length!==undefined){<span class="cstat-no" title="statement not covered" >for(var b=0;b&lt;f.ext.length;b++){<span class="cstat-no" title="statement not covered" >for(key in f.ext[b]){<span class="cstat-no" title="statement not covered" >e.appendExtensionByName(key,f.ext[b][key])}</span>}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(f.cakey===undefined&amp;&amp;f.sighex===undefined){<span class="cstat-no" title="statement not covered" >throw"param cakey and sighex undefined."}<span class="cstat-no" title="statement not covered" ></span>v</span>ar d=null;<span class="cstat-no" title="statement not covered" >v</span>ar a=null;<span class="cstat-no" title="statement not covered" >i</span>f(f.cakey){<span class="cstat-no" title="statement not covered" >if(f.cakey.isPrivate===true){<span class="cstat-no" title="statement not covered" >d=f.cakey}</span>else{<span class="cstat-no" title="statement not covered" >d=KEYUTIL.getKey.apply(null,f.cakey)}<span class="cstat-no" title="statement not covered" ></span>a</span>=new c.Certificate({tbscertobj:e,prvkeyobj:d});<span class="cstat-no" title="statement not covered" >a</span>.sign()}<span class="cstat-no" title="statement not covered" ></span>i</span>f(f.sighex){<span class="cstat-no" title="statement not covered" >a=new c.Certificate({tbscertobj:e});<span class="cstat-no" title="statement not covered" >a</span>.setSignatureHex(f.sighex)}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn a.getPEMString()}</span>;
/*! asn1cms-1.0.3.js (c) 2013-2017 Kenji Urushima | kjur.github.com/jsrsasign/license
 */
<span class="missing-if-branch" title="if path not taken" >I</span>if(typeof KJUR=="undefined"||!KJUR){<span class="cstat-no" title="statement not covered" >KJUR={}}<span class="missing-if-branch" title="if path not taken" >I</span></span>if(typeof KJUR.asn1=="undefined"||!KJUR.asn1){<span class="cstat-no" title="statement not covered" >KJUR.asn1={}}<span class="missing-if-branch" title="else path not taken" >E</span></span>if(typeof KJUR.asn1.cms=="undefined"||<span class="branch-1 cbranch-no" title="branch not covered" >!KJUR.asn1.cms)</span>{KJUR.asn1.cms={}}KJUR.asn1.cms.Attribute=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.cms.Attribute.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >v</span>ar a=[];<span class="cstat-no" title="statement not covered" >t</span>his.getEncodedHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var f,e,c;<span class="cstat-no" title="statement not covered" >f</span>=new KJUR.asn1.DERObjectIdentifier({oid:this.attrTypeOid});<span class="cstat-no" title="statement not covered" >e</span>=new KJUR.asn1.DERSet({array:this.valueList});<span class="cstat-no" title="statement not covered" >t</span>ry{<span class="cstat-no" title="statement not covered" >e.getEncodedHex()}</span>catch(d){<span class="cstat-no" title="statement not covered" >throw"fail valueSet.getEncodedHex in Attribute(1)/"+d}<span class="cstat-no" title="statement not covered" ></span>c</span>=new KJUR.asn1.DERSequence({array:[f,e]});<span class="cstat-no" title="statement not covered" >t</span>ry{<span class="cstat-no" title="statement not covered" >this.hTLV=c.getEncodedHex()}</span>catch(d){<span class="cstat-no" title="statement not covered" >throw"failed seq.getEncodedHex in Attribute(2)/"+d}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn this.hTLV}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.cms.Attribute,KJUR.asn1.ASN1Object);KJUR.asn1.cms.ContentType=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.cms.ContentType.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >t</span>his.attrTypeOid="1.2.840.113549.1.9.3";<span class="cstat-no" title="statement not covered" >v</span>ar a=null;<span class="cstat-no" title="statement not covered" >i</span>f(typeof b!="undefined"){<span class="cstat-no" title="statement not covered" >var a=new KJUR.asn1.DERObjectIdentifier(b);<span class="cstat-no" title="statement not covered" >t</span>his.valueList=[a]}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.cms.ContentType,KJUR.asn1.cms.Attribute);KJUR.asn1.cms.MessageDigest=<span class="fstat-no" title="function not covered" >function(e){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.cms.MessageDigest.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >t</span>his.attrTypeOid="1.2.840.113549.1.9.4";<span class="cstat-no" title="statement not covered" >i</span>f(typeof e!="undefined"){<span class="cstat-no" title="statement not covered" >if(e.eciObj instanceof KJUR.asn1.cms.EncapsulatedContentInfo&amp;&amp;typeof e.hashAlg=="string"){<span class="cstat-no" title="statement not covered" >var b=e.eciObj.eContentValueHex;<span class="cstat-no" title="statement not covered" >v</span>ar a=e.hashAlg;<span class="cstat-no" title="statement not covered" >v</span>ar c=KJUR.crypto.Util.hashHex(b,a);<span class="cstat-no" title="statement not covered" >v</span>ar d=new KJUR.asn1.DEROctetString({hex:c});<span class="cstat-no" title="statement not covered" >d</span>.getEncodedHex();<span class="cstat-no" title="statement not covered" >t</span>his.valueList=[d]}</span>else{<span class="cstat-no" title="statement not covered" >var d=new KJUR.asn1.DEROctetString(e);<span class="cstat-no" title="statement not covered" >d</span>.getEncodedHex();<span class="cstat-no" title="statement not covered" >t</span>his.valueList=[d]}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.cms.MessageDigest,KJUR.asn1.cms.Attribute);KJUR.asn1.cms.SigningTime=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.cms.SigningTime.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >t</span>his.attrTypeOid="1.2.840.113549.1.9.5";<span class="cstat-no" title="statement not covered" >i</span>f(typeof c!="undefined"){<span class="cstat-no" title="statement not covered" >var a=new KJUR.asn1.x509.Time(c);<span class="cstat-no" title="statement not covered" >t</span>ry{<span class="cstat-no" title="statement not covered" >a.getEncodedHex()}</span>catch(b){<span class="cstat-no" title="statement not covered" >throw"SigningTime.getEncodedHex() failed/"+b}<span class="cstat-no" title="statement not covered" ></span>t</span>his.valueList=[a]}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.cms.SigningTime,KJUR.asn1.cms.Attribute);KJUR.asn1.cms.SigningCertificate=<span class="fstat-no" title="function not covered" >function(d){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.cms.SigningCertificate.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >t</span>his.attrTypeOid="1.2.840.113549.1.9.16.2.12";<span class="cstat-no" title="statement not covered" >v</span>ar a=KJUR.asn1;<span class="cstat-no" title="statement not covered" >v</span>ar c=KJUR.asn1.cms;<span class="cstat-no" title="statement not covered" >v</span>ar b=KJUR.crypto;<span class="cstat-no" title="statement not covered" >t</span>his.setCerts=<span class="fstat-no" title="function not covered" >function(l){<span class="cstat-no" title="statement not covered" ></span>var j=[];<span class="cstat-no" title="statement not covered" >f</span>or(var h=0;h&lt;l.length;h++){<span class="cstat-no" title="statement not covered" >var f=ASN1HEX.pemToHex(l[h]);<span class="cstat-no" title="statement not covered" >v</span>ar e=b.Util.hashHex(f,"sha1");<span class="cstat-no" title="statement not covered" >v</span>ar m=new a.DEROctetString({hex:e});<span class="cstat-no" title="statement not covered" >m</span>.getEncodedHex();<span class="cstat-no" title="statement not covered" >v</span>ar k=new c.IssuerAndSerialNumber({cert:l[h]});<span class="cstat-no" title="statement not covered" >k</span>.getEncodedHex();<span class="cstat-no" title="statement not covered" >v</span>ar n=new a.DERSequence({array:[m,k]});<span class="cstat-no" title="statement not covered" >n</span>.getEncodedHex();<span class="cstat-no" title="statement not covered" >j</span>.push(n)}<span class="cstat-no" title="statement not covered" ></span>v</span>ar g=new a.DERSequence({array:j});<span class="cstat-no" title="statement not covered" >g</span>.getEncodedHex();<span class="cstat-no" title="statement not covered" >t</span>his.valueList=[g]}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(typeof d!="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof d.array=="object"){<span class="cstat-no" title="statement not covered" >this.setCerts(d.array)}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.cms.SigningCertificate,KJUR.asn1.cms.Attribute);KJUR.asn1.cms.SigningCertificateV2=<span class="fstat-no" title="function not covered" >function(e){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.cms.SigningCertificateV2.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >t</span>his.attrTypeOid="1.2.840.113549.1.9.16.2.47";<span class="cstat-no" title="statement not covered" >v</span>ar b=KJUR.asn1;<span class="cstat-no" title="statement not covered" >v</span>ar f=KJUR.asn1.x509;<span class="cstat-no" title="statement not covered" >v</span>ar d=KJUR.asn1.cms;<span class="cstat-no" title="statement not covered" >v</span>ar c=KJUR.crypto;<span class="cstat-no" title="statement not covered" >t</span>his.setCerts=<span class="fstat-no" title="function not covered" >function(p,h){<span class="cstat-no" title="statement not covered" ></span>var n=[];<span class="cstat-no" title="statement not covered" >f</span>or(var l=0;l&lt;p.length;l++){<span class="cstat-no" title="statement not covered" >var j=ASN1HEX.pemToHex(p[l]);<span class="cstat-no" title="statement not covered" >v</span>ar r=[];<span class="cstat-no" title="statement not covered" >i</span>f(h!="sha256"){<span class="cstat-no" title="statement not covered" >r.push(new f.AlgorithmIdentifier({name:h}))}<span class="cstat-no" title="statement not covered" ></span>v</span>ar g=c.Util.hashHex(j,h);<span class="cstat-no" title="statement not covered" >v</span>ar q=new b.DEROctetString({hex:g});<span class="cstat-no" title="statement not covered" >q</span>.getEncodedHex();<span class="cstat-no" title="statement not covered" >r</span>.push(q);<span class="cstat-no" title="statement not covered" >v</span>ar m=new d.IssuerAndSerialNumber({cert:p[l]});<span class="cstat-no" title="statement not covered" >m</span>.getEncodedHex();<span class="cstat-no" title="statement not covered" >r</span>.push(m);<span class="cstat-no" title="statement not covered" >v</span>ar o=new b.DERSequence({array:r});<span class="cstat-no" title="statement not covered" >o</span>.getEncodedHex();<span class="cstat-no" title="statement not covered" >n</span>.push(o)}<span class="cstat-no" title="statement not covered" ></span>v</span>ar k=new b.DERSequence({array:n});<span class="cstat-no" title="statement not covered" >k</span>.getEncodedHex();<span class="cstat-no" title="statement not covered" >t</span>his.valueList=[k]}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(typeof e!="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof e.array=="object"){<span class="cstat-no" title="statement not covered" >var a="sha256";<span class="cstat-no" title="statement not covered" >i</span>f(typeof e.hashAlg=="string"){<span class="cstat-no" title="statement not covered" >a=e.hashAlg}<span class="cstat-no" title="statement not covered" ></span>t</span>his.setCerts(e.array,a)}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.cms.SigningCertificateV2,KJUR.asn1.cms.Attribute);KJUR.asn1.cms.IssuerAndSerialNumber=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.cms.IssuerAndSerialNumber.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >v</span>ar e=null;<span class="cstat-no" title="statement not covered" >v</span>ar b=null;<span class="cstat-no" title="statement not covered" >v</span>ar a=KJUR.asn1;<span class="cstat-no" title="statement not covered" >v</span>ar d=a.x509;<span class="cstat-no" title="statement not covered" >t</span>his.setByCertPEM=<span class="fstat-no" title="function not covered" >function(i){<span class="cstat-no" title="statement not covered" ></span>var g=ASN1HEX.pemToHex(i);<span class="cstat-no" title="statement not covered" >v</span>ar f=new X509();<span class="cstat-no" title="statement not covered" >f</span>.hex=g;<span class="cstat-no" title="statement not covered" >v</span>ar j=f.getIssuerHex();<span class="cstat-no" title="statement not covered" >t</span>his.dIssuer=new d.X500Name();<span class="cstat-no" title="statement not covered" >t</span>his.dIssuer.hTLV=j;<span class="cstat-no" title="statement not covered" >v</span>ar h=f.getSerialNumberHex();<span class="cstat-no" title="statement not covered" >t</span>his.dSerial=new a.DERInteger({hex:h})}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getEncodedHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var f=new KJUR.asn1.DERSequence({array:[this.dIssuer,this.dSerial]});<span class="cstat-no" title="statement not covered" >t</span>his.hTLV=f.getEncodedHex();<span class="cstat-no" title="statement not covered" >r</span>eturn this.hTLV}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(typeof c!="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof c=="string"&amp;&amp;c.indexOf("-----BEGIN ")!=-1){<span class="cstat-no" title="statement not covered" >this.setByCertPEM(c)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(c.issuer&amp;&amp;c.serial){<span class="cstat-no" title="statement not covered" >if(c.issuer instanceof KJUR.asn1.x509.X500Name){<span class="cstat-no" title="statement not covered" >this.dIssuer=c.issuer}</span>else{<span class="cstat-no" title="statement not covered" >this.dIssuer=new KJUR.asn1.x509.X500Name(c.issuer)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(c.serial instanceof KJUR.asn1.DERInteger){<span class="cstat-no" title="statement not covered" >this.dSerial=c.serial}</span>else{<span class="cstat-no" title="statement not covered" >this.dSerial=new KJUR.asn1.DERInteger(c.serial)}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof c.cert=="string"){<span class="cstat-no" title="statement not covered" >this.setByCertPEM(c.cert)}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.cms.IssuerAndSerialNumber,KJUR.asn1.ASN1Object);KJUR.asn1.cms.AttributeList=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.cms.AttributeList.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >t</span>his.list=new Array();<span class="cstat-no" title="statement not covered" >t</span>his.sortFlag=true;<span class="cstat-no" title="statement not covered" >t</span>his.add=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>if(b instanceof KJUR.asn1.cms.Attribute){<span class="cstat-no" title="statement not covered" >this.list.push(b)}</span>}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.length=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>return this.list.length}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.clear=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>this.list=new Array();<span class="cstat-no" title="statement not covered" >t</span>his.hTLV=null;<span class="cstat-no" title="statement not covered" >t</span>his.hV=null}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getEncodedHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>if(typeof this.hTLV=="string"){<span class="cstat-no" title="statement not covered" >return this.hTLV}<span class="cstat-no" title="statement not covered" ></span>v</span>ar b=new KJUR.asn1.DERSet({array:this.list,sortflag:this.sortFlag});<span class="cstat-no" title="statement not covered" >t</span>his.hTLV=b.getEncodedHex();<span class="cstat-no" title="statement not covered" >r</span>eturn this.hTLV}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(typeof a!="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof a.sortflag!="undefined"&amp;&amp;a.sortflag==false){<span class="cstat-no" title="statement not covered" >this.sortFlag=false}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.cms.AttributeList,KJUR.asn1.ASN1Object);KJUR.asn1.cms.SignerInfo=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.cms.SignerInfo.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >v</span>ar a=KJUR.asn1;<span class="cstat-no" title="statement not covered" >v</span>ar b=KJUR.asn1.cms;<span class="cstat-no" title="statement not covered" >v</span>ar d=KJUR.asn1.x509;<span class="cstat-no" title="statement not covered" >t</span>his.dCMSVersion=new a.DERInteger({"int":1});<span class="cstat-no" title="statement not covered" >t</span>his.dSignerIdentifier=null;<span class="cstat-no" title="statement not covered" >t</span>his.dDigestAlgorithm=null;<span class="cstat-no" title="statement not covered" >t</span>his.dSignedAttrs=new b.AttributeList();<span class="cstat-no" title="statement not covered" >t</span>his.dSigAlg=null;<span class="cstat-no" title="statement not covered" >t</span>his.dSig=null;<span class="cstat-no" title="statement not covered" >t</span>his.dUnsignedAttrs=new b.AttributeList();<span class="cstat-no" title="statement not covered" >t</span>his.setSignerIdentifier=<span class="fstat-no" title="function not covered" >function(f){<span class="cstat-no" title="statement not covered" ></span>if(typeof f=="string"&amp;&amp;f.indexOf("CERTIFICATE")!=-1&amp;&amp;f.indexOf("BEGIN")!=-1&amp;&amp;f.indexOf("END")!=-1){<span class="cstat-no" title="statement not covered" >var e=f;<span class="cstat-no" title="statement not covered" >t</span>his.dSignerIdentifier=new b.IssuerAndSerialNumber({cert:f})}</span>}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setForContentAndHash=<span class="fstat-no" title="function not covered" >function(e){<span class="cstat-no" title="statement not covered" ></span>if(typeof e!="undefined"){<span class="cstat-no" title="statement not covered" >if(e.eciObj instanceof KJUR.asn1.cms.EncapsulatedContentInfo){<span class="cstat-no" title="statement not covered" >this.dSignedAttrs.add(new b.ContentType({oid:"1.2.840.113549.1.7.1"}));<span class="cstat-no" title="statement not covered" >t</span>his.dSignedAttrs.add(new b.MessageDigest({eciObj:e.eciObj,hashAlg:e.hashAlg}))}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof e.sdObj!="undefined"&amp;&amp;e.sdObj instanceof KJUR.asn1.cms.SignedData){<span class="cstat-no" title="statement not covered" >if(e.sdObj.digestAlgNameList.join(":").indexOf(e.hashAlg)==-1){<span class="cstat-no" title="statement not covered" >e.sdObj.digestAlgNameList.push(e.hashAlg)}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof e.hashAlg=="string"){<span class="cstat-no" title="statement not covered" >this.dDigestAlgorithm=new d.AlgorithmIdentifier({name:e.hashAlg})}</span>}</span>}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.sign=<span class="fstat-no" title="function not covered" >function(j,f){<span class="cstat-no" title="statement not covered" ></span>this.dSigAlg=new d.AlgorithmIdentifier({name:f});<span class="cstat-no" title="statement not covered" >v</span>ar g=this.dSignedAttrs.getEncodedHex();<span class="cstat-no" title="statement not covered" >v</span>ar e=KEYUTIL.getKey(j);<span class="cstat-no" title="statement not covered" >v</span>ar i=new KJUR.crypto.Signature({alg:f});<span class="cstat-no" title="statement not covered" >i</span>.init(e);<span class="cstat-no" title="statement not covered" >i</span>.updateHex(g);<span class="cstat-no" title="statement not covered" >v</span>ar h=i.sign();<span class="cstat-no" title="statement not covered" >t</span>his.dSig=new a.DEROctetString({hex:h})}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.addUnsigned=<span class="fstat-no" title="function not covered" >function(e){<span class="cstat-no" title="statement not covered" ></span>this.hTLV=null;<span class="cstat-no" title="statement not covered" >t</span>his.dUnsignedAttrs.hTLV=null;<span class="cstat-no" title="statement not covered" >t</span>his.dUnsignedAttrs.add(e)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getEncodedHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>if(this.dSignedAttrs instanceof KJUR.asn1.cms.AttributeList&amp;&amp;this.dSignedAttrs.length()==0){<span class="cstat-no" title="statement not covered" >throw"SignedAttrs length = 0 (empty)"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar e=new a.DERTaggedObject({obj:this.dSignedAttrs,tag:"a0",explicit:false});<span class="cstat-no" title="statement not covered" >v</span>ar h=null;<span class="cstat-no" title="statement not covered" >i</span>f(this.dUnsignedAttrs.length()&gt;0){<span class="cstat-no" title="statement not covered" >h=new a.DERTaggedObject({obj:this.dUnsignedAttrs,tag:"a1",explicit:false})}<span class="cstat-no" title="statement not covered" ></span>v</span>ar g=[this.dCMSVersion,this.dSignerIdentifier,this.dDigestAlgorithm,e,this.dSigAlg,this.dSig,];<span class="cstat-no" title="statement not covered" >i</span>f(h!=null){<span class="cstat-no" title="statement not covered" >g.push(h)}<span class="cstat-no" title="statement not covered" ></span>v</span>ar f=new a.DERSequence({array:g});<span class="cstat-no" title="statement not covered" >t</span>his.hTLV=f.getEncodedHex();<span class="cstat-no" title="statement not covered" >r</span>eturn this.hTLV}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.cms.SignerInfo,KJUR.asn1.ASN1Object);KJUR.asn1.cms.EncapsulatedContentInfo=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.cms.EncapsulatedContentInfo.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >v</span>ar a=KJUR.asn1;<span class="cstat-no" title="statement not covered" >v</span>ar b=KJUR.asn1.cms;<span class="cstat-no" title="statement not covered" >v</span>ar d=KJUR.asn1.x509;<span class="cstat-no" title="statement not covered" >t</span>his.dEContentType=new a.DERObjectIdentifier({name:"data"});<span class="cstat-no" title="statement not covered" >t</span>his.dEContent=null;<span class="cstat-no" title="statement not covered" >t</span>his.isDetached=false;<span class="cstat-no" title="statement not covered" >t</span>his.eContentValueHex=null;<span class="cstat-no" title="statement not covered" >t</span>his.setContentType=<span class="fstat-no" title="function not covered" >function(e){<span class="cstat-no" title="statement not covered" ></span>if(e.match(/^[0-2][.][0-9.]+$/)){<span class="cstat-no" title="statement not covered" >this.dEContentType=new a.DERObjectIdentifier({oid:e})}</span>else{<span class="cstat-no" title="statement not covered" >this.dEContentType=new a.DERObjectIdentifier({name:e})}</span>}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setContentValue=<span class="fstat-no" title="function not covered" >function(e){<span class="cstat-no" title="statement not covered" ></span>if(typeof e!="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof e.hex=="string"){<span class="cstat-no" title="statement not covered" >this.eContentValueHex=e.hex}</span>else{<span class="cstat-no" title="statement not covered" >if(typeof e.str=="string"){<span class="cstat-no" title="statement not covered" >this.eContentValueHex=utf8tohex(e.str)}</span>}</span>}</span>}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setContentValueHex=<span class="fstat-no" title="function not covered" >function(e){<span class="cstat-no" title="statement not covered" ></span>this.eContentValueHex=e}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setContentValueStr=<span class="fstat-no" title="function not covered" >function(e){<span class="cstat-no" title="statement not covered" ></span>this.eContentValueHex=utf8tohex(e)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getEncodedHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>if(typeof this.eContentValueHex!="string"){<span class="cstat-no" title="statement not covered" >throw"eContentValue not yet set"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar g=new a.DEROctetString({hex:this.eContentValueHex});<span class="cstat-no" title="statement not covered" >t</span>his.dEContent=new a.DERTaggedObject({obj:g,tag:"a0",explicit:true});<span class="cstat-no" title="statement not covered" >v</span>ar e=[this.dEContentType];<span class="cstat-no" title="statement not covered" >i</span>f(!this.isDetached){<span class="cstat-no" title="statement not covered" >e.push(this.dEContent)}<span class="cstat-no" title="statement not covered" ></span>v</span>ar f=new a.DERSequence({array:e});<span class="cstat-no" title="statement not covered" >t</span>his.hTLV=f.getEncodedHex();<span class="cstat-no" title="statement not covered" >r</span>eturn this.hTLV}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.cms.EncapsulatedContentInfo,KJUR.asn1.ASN1Object);KJUR.asn1.cms.ContentInfo=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.cms.ContentInfo.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >v</span>ar a=KJUR.asn1;<span class="cstat-no" title="statement not covered" >v</span>ar b=KJUR.asn1.cms;<span class="cstat-no" title="statement not covered" >v</span>ar d=KJUR.asn1.x509;<span class="cstat-no" title="statement not covered" >t</span>his.dContentType=null;<span class="cstat-no" title="statement not covered" >t</span>his.dContent=null;<span class="cstat-no" title="statement not covered" >t</span>his.setContentType=<span class="fstat-no" title="function not covered" >function(e){<span class="cstat-no" title="statement not covered" ></span>if(typeof e=="string"){<span class="cstat-no" title="statement not covered" >this.dContentType=d.OID.name2obj(e)}</span>}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getEncodedHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var f=new a.DERTaggedObject({obj:this.dContent,tag:"a0",explicit:true});<span class="cstat-no" title="statement not covered" >v</span>ar e=new a.DERSequence({array:[this.dContentType,f]});<span class="cstat-no" title="statement not covered" >t</span>his.hTLV=e.getEncodedHex();<span class="cstat-no" title="statement not covered" >r</span>eturn this.hTLV}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(typeof c!="undefined"){<span class="cstat-no" title="statement not covered" >if(c.type){<span class="cstat-no" title="statement not covered" >this.setContentType(c.type)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(c.obj&amp;&amp;c.obj instanceof a.ASN1Object){<span class="cstat-no" title="statement not covered" >this.dContent=c.obj}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.cms.ContentInfo,KJUR.asn1.ASN1Object);KJUR.asn1.cms.SignedData=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.cms.SignedData.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >v</span>ar a=KJUR.asn1;<span class="cstat-no" title="statement not covered" >v</span>ar b=KJUR.asn1.cms;<span class="cstat-no" title="statement not covered" >v</span>ar d=KJUR.asn1.x509;<span class="cstat-no" title="statement not covered" >t</span>his.dCMSVersion=new a.DERInteger({"int":1});<span class="cstat-no" title="statement not covered" >t</span>his.dDigestAlgs=null;<span class="cstat-no" title="statement not covered" >t</span>his.digestAlgNameList=[];<span class="cstat-no" title="statement not covered" >t</span>his.dEncapContentInfo=new b.EncapsulatedContentInfo();<span class="cstat-no" title="statement not covered" >t</span>his.dCerts=null;<span class="cstat-no" title="statement not covered" >t</span>his.certificateList=[];<span class="cstat-no" title="statement not covered" >t</span>his.crlList=[];<span class="cstat-no" title="statement not covered" >t</span>his.signerInfoList=[new b.SignerInfo()];<span class="cstat-no" title="statement not covered" >t</span>his.addCertificatesByPEM=<span class="fstat-no" title="function not covered" >function(e){<span class="cstat-no" title="statement not covered" ></span>var f=ASN1HEX.pemToHex(e);<span class="cstat-no" title="statement not covered" >v</span>ar g=new a.ASN1Object();<span class="cstat-no" title="statement not covered" >g</span>.hTLV=f;<span class="cstat-no" title="statement not covered" >t</span>his.certificateList.push(g)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getEncodedHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>if(typeof this.hTLV=="string"){<span class="cstat-no" title="statement not covered" >return this.hTLV}<span class="cstat-no" title="statement not covered" ></span>i</span>f(this.dDigestAlgs==null){<span class="cstat-no" title="statement not covered" >var k=[];<span class="cstat-no" title="statement not covered" >f</span>or(var j=0;j&lt;this.digestAlgNameList.length;j++){<span class="cstat-no" title="statement not covered" >var h=this.digestAlgNameList[j];<span class="cstat-no" title="statement not covered" >v</span>ar m=new d.AlgorithmIdentifier({name:h});<span class="cstat-no" title="statement not covered" >k</span>.push(m)}<span class="cstat-no" title="statement not covered" ></span>t</span>his.dDigestAlgs=new a.DERSet({array:k})}<span class="cstat-no" title="statement not covered" ></span>v</span>ar e=[this.dCMSVersion,this.dDigestAlgs,this.dEncapContentInfo];<span class="cstat-no" title="statement not covered" >i</span>f(this.dCerts==null){<span class="cstat-no" title="statement not covered" >if(this.certificateList.length&gt;0){<span class="cstat-no" title="statement not covered" >var l=new a.DERSet({array:this.certificateList});<span class="cstat-no" title="statement not covered" >t</span>his.dCerts=new a.DERTaggedObject({obj:l,tag:"a0",explicit:false})}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(this.dCerts!=null){<span class="cstat-no" title="statement not covered" >e.push(this.dCerts)}<span class="cstat-no" title="statement not covered" ></span>v</span>ar g=new a.DERSet({array:this.signerInfoList});<span class="cstat-no" title="statement not covered" >e</span>.push(g);<span class="cstat-no" title="statement not covered" >v</span>ar f=new a.DERSequence({array:e});<span class="cstat-no" title="statement not covered" >t</span>his.hTLV=f.getEncodedHex();<span class="cstat-no" title="statement not covered" >r</span>eturn this.hTLV}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getContentInfo=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>this.getEncodedHex();<span class="cstat-no" title="statement not covered" >v</span>ar e=new b.ContentInfo({type:"signed-data",obj:this});<span class="cstat-no" title="statement not covered" >r</span>eturn e}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getContentInfoEncodedHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var e=this.getContentInfo();<span class="cstat-no" title="statement not covered" >v</span>ar f=e.getEncodedHex();<span class="cstat-no" title="statement not covered" >r</span>eturn f}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getPEM=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var e=this.getContentInfoEncodedHex();<span class="cstat-no" title="statement not covered" >v</span>ar f=a.ASN1Util.getPEMStringFromHex(e,"CMS");<span class="cstat-no" title="statement not covered" >r</span>eturn f}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.cms.SignedData,KJUR.asn1.ASN1Object);KJUR.asn1.cms.CMSUtil=new function(){};KJUR.asn1.cms.CMSUtil.newSignedData=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>var h=KJUR.asn1.cms;<span class="cstat-no" title="statement not covered" >v</span>ar g=KJUR.asn1.cades;<span class="cstat-no" title="statement not covered" >v</span>ar f=new h.SignedData();<span class="cstat-no" title="statement not covered" >f</span>.dEncapContentInfo.setContentValue(a.content);<span class="cstat-no" title="statement not covered" >i</span>f(typeof a.certs=="object"){<span class="cstat-no" title="statement not covered" >for(var b=0;b&lt;a.certs.length;b++){<span class="cstat-no" title="statement not covered" >f.addCertificatesByPEM(a.certs[b])}</span>}<span class="cstat-no" title="statement not covered" ></span>f</span>.signerInfoList=[];<span class="cstat-no" title="statement not covered" >f</span>or(var b=0;b&lt;a.signerInfos.length;b++){<span class="cstat-no" title="statement not covered" >var d=a.signerInfos[b];<span class="cstat-no" title="statement not covered" >v</span>ar c=new h.SignerInfo();<span class="cstat-no" title="statement not covered" >c</span>.setSignerIdentifier(d.signerCert);<span class="cstat-no" title="statement not covered" >c</span>.setForContentAndHash({sdObj:f,eciObj:f.dEncapContentInfo,hashAlg:d.hashAlg});<span class="cstat-no" title="statement not covered" >f</span>or(attrName in d.sAttr){<span class="cstat-no" title="statement not covered" >var j=d.sAttr[attrName];<span class="cstat-no" title="statement not covered" >i</span>f(attrName=="SigningTime"){<span class="cstat-no" title="statement not covered" >var e=new h.SigningTime(j);<span class="cstat-no" title="statement not covered" >c</span>.dSignedAttrs.add(e)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(attrName=="SigningCertificate"){<span class="cstat-no" title="statement not covered" >var e=new h.SigningCertificate(j);<span class="cstat-no" title="statement not covered" >c</span>.dSignedAttrs.add(e)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(attrName=="SigningCertificateV2"){<span class="cstat-no" title="statement not covered" >var e=new h.SigningCertificateV2(j);<span class="cstat-no" title="statement not covered" >c</span>.dSignedAttrs.add(e)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(attrName=="SignaturePolicyIdentifier"){<span class="cstat-no" title="statement not covered" >var e=new g.SignaturePolicyIdentifier(j);<span class="cstat-no" title="statement not covered" >c</span>.dSignedAttrs.add(e)}</span>}<span class="cstat-no" title="statement not covered" ></span>c</span>.sign(d.signerPrvKey,d.sigAlg);<span class="cstat-no" title="statement not covered" >f</span>.signerInfoList.push(c)}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn f}</span>;
/*! asn1tsp-1.0.1.js (c) 2014 Kenji Urushima | kjur.github.com/jsrsasign/license
 */
<span class="missing-if-branch" title="if path not taken" >I</span>if(typeof KJUR=="undefined"||!KJUR){<span class="cstat-no" title="statement not covered" >KJUR={}}<span class="missing-if-branch" title="if path not taken" >I</span></span>if(typeof KJUR.asn1=="undefined"||!KJUR.asn1){<span class="cstat-no" title="statement not covered" >KJUR.asn1={}}<span class="missing-if-branch" title="else path not taken" >E</span></span>if(typeof KJUR.asn1.tsp=="undefined"||<span class="branch-1 cbranch-no" title="branch not covered" >!KJUR.asn1.tsp)</span>{KJUR.asn1.tsp={}}KJUR.asn1.tsp.Accuracy=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.tsp.Accuracy.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >v</span>ar a=KJUR.asn1;<span class="cstat-no" title="statement not covered" >t</span>his.seconds=null;<span class="cstat-no" title="statement not covered" >t</span>his.millis=null;<span class="cstat-no" title="statement not covered" >t</span>his.micros=null;<span class="cstat-no" title="statement not covered" >t</span>his.getEncodedHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var e=null;<span class="cstat-no" title="statement not covered" >v</span>ar g=null;<span class="cstat-no" title="statement not covered" >v</span>ar i=null;<span class="cstat-no" title="statement not covered" >v</span>ar c=[];<span class="cstat-no" title="statement not covered" >i</span>f(this.seconds!=null){<span class="cstat-no" title="statement not covered" >e=new a.DERInteger({"int":this.seconds});<span class="cstat-no" title="statement not covered" >c</span>.push(e)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(this.millis!=null){<span class="cstat-no" title="statement not covered" >var h=new a.DERInteger({"int":this.millis});<span class="cstat-no" title="statement not covered" >g</span>=new a.DERTaggedObject({obj:h,tag:"80",explicit:false});<span class="cstat-no" title="statement not covered" >c</span>.push(g)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(this.micros!=null){<span class="cstat-no" title="statement not covered" >var f=new a.DERInteger({"int":this.micros});<span class="cstat-no" title="statement not covered" >i</span>=new a.DERTaggedObject({obj:f,tag:"81",explicit:false});<span class="cstat-no" title="statement not covered" >c</span>.push(i)}<span class="cstat-no" title="statement not covered" ></span>v</span>ar d=new a.DERSequence({array:c});<span class="cstat-no" title="statement not covered" >t</span>his.hTLV=d.getEncodedHex();<span class="cstat-no" title="statement not covered" >r</span>eturn this.hTLV}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(typeof b!="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof b.seconds=="number"){<span class="cstat-no" title="statement not covered" >this.seconds=b.seconds}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof b.millis=="number"){<span class="cstat-no" title="statement not covered" >this.millis=b.millis}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof b.micros=="number"){<span class="cstat-no" title="statement not covered" >this.micros=b.micros}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.tsp.Accuracy,KJUR.asn1.ASN1Object);KJUR.asn1.tsp.MessageImprint=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.tsp.MessageImprint.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >v</span>ar a=KJUR.asn1;<span class="cstat-no" title="statement not covered" >v</span>ar c=KJUR.asn1.x509;<span class="cstat-no" title="statement not covered" >t</span>his.dHashAlg=null;<span class="cstat-no" title="statement not covered" >t</span>his.dHashValue=null;<span class="cstat-no" title="statement not covered" >t</span>his.getEncodedHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>if(typeof this.hTLV=="string"){<span class="cstat-no" title="statement not covered" >return this.hTLV}<span class="cstat-no" title="statement not covered" ></span>v</span>ar d=new a.DERSequence({array:[this.dHashAlg,this.dHashValue]});<span class="cstat-no" title="statement not covered" >r</span>eturn d.getEncodedHex()}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(typeof b!="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof b.hashAlg=="string"){<span class="cstat-no" title="statement not covered" >this.dHashAlg=new c.AlgorithmIdentifier({name:b.hashAlg})}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof b.hashValue=="string"){<span class="cstat-no" title="statement not covered" >this.dHashValue=new a.DEROctetString({hex:b.hashValue})}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.tsp.MessageImprint,KJUR.asn1.ASN1Object);KJUR.asn1.tsp.TimeStampReq=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.tsp.TimeStampReq.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >v</span>ar a=KJUR.asn1;<span class="cstat-no" title="statement not covered" >v</span>ar b=KJUR.asn1.tsp;<span class="cstat-no" title="statement not covered" >t</span>his.dVersion=new a.DERInteger({"int":1});<span class="cstat-no" title="statement not covered" >t</span>his.dMessageImprint=null;<span class="cstat-no" title="statement not covered" >t</span>his.dPolicy=null;<span class="cstat-no" title="statement not covered" >t</span>his.dNonce=null;<span class="cstat-no" title="statement not covered" >t</span>his.certReq=true;<span class="cstat-no" title="statement not covered" >t</span>his.setMessageImprint=<span class="fstat-no" title="function not covered" >function(d){<span class="cstat-no" title="statement not covered" ></span>if(d instanceof KJUR.asn1.tsp.MessageImprint){<span class="cstat-no" title="statement not covered" >this.dMessageImprint=d;<span class="cstat-no" title="statement not covered" >r</span>eturn}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof d=="object"){<span class="cstat-no" title="statement not covered" >this.dMessageImprint=new b.MessageImprint(d)}</span>}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getEncodedHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>if(this.dMessageImprint==null){<span class="cstat-no" title="statement not covered" >throw"messageImprint shall be specified"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar d=[this.dVersion,this.dMessageImprint];<span class="cstat-no" title="statement not covered" >i</span>f(this.dPolicy!=null){<span class="cstat-no" title="statement not covered" >d.push(this.dPolicy)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(this.dNonce!=null){<span class="cstat-no" title="statement not covered" >d.push(this.dNonce)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(this.certReq){<span class="cstat-no" title="statement not covered" >d.push(new a.DERBoolean())}<span class="cstat-no" title="statement not covered" ></span>v</span>ar e=new a.DERSequence({array:d});<span class="cstat-no" title="statement not covered" >t</span>his.hTLV=e.getEncodedHex();<span class="cstat-no" title="statement not covered" >r</span>eturn this.hTLV}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(typeof c!="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof c.mi=="object"){<span class="cstat-no" title="statement not covered" >this.setMessageImprint(c.mi)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof c.policy=="object"){<span class="cstat-no" title="statement not covered" >this.dPolicy=new a.DERObjectIdentifier(c.policy)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof c.nonce=="object"){<span class="cstat-no" title="statement not covered" >this.dNonce=new a.DERInteger(c.nonce)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof c.certreq=="boolean"){<span class="cstat-no" title="statement not covered" >this.certReq=c.certreq}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.tsp.TimeStampReq,KJUR.asn1.ASN1Object);KJUR.asn1.tsp.TSTInfo=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.tsp.TSTInfo.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >v</span>ar a=KJUR.asn1;<span class="cstat-no" title="statement not covered" >v</span>ar d=KJUR.asn1.x509;<span class="cstat-no" title="statement not covered" >v</span>ar b=KJUR.asn1.tsp;<span class="cstat-no" title="statement not covered" >t</span>his.dVersion=new a.DERInteger({"int":1});<span class="cstat-no" title="statement not covered" >t</span>his.dPolicy=null;<span class="cstat-no" title="statement not covered" >t</span>his.dMessageImprint=null;<span class="cstat-no" title="statement not covered" >t</span>his.dSerialNumber=null;<span class="cstat-no" title="statement not covered" >t</span>his.dGenTime=null;<span class="cstat-no" title="statement not covered" >t</span>his.dAccuracy=null;<span class="cstat-no" title="statement not covered" >t</span>his.dOrdering=null;<span class="cstat-no" title="statement not covered" >t</span>his.dNonce=null;<span class="cstat-no" title="statement not covered" >t</span>his.dTsa=null;<span class="cstat-no" title="statement not covered" >t</span>his.getEncodedHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var e=[this.dVersion];<span class="cstat-no" title="statement not covered" >i</span>f(this.dPolicy==null){<span class="cstat-no" title="statement not covered" >throw"policy shall be specified."}<span class="cstat-no" title="statement not covered" ></span>e</span>.push(this.dPolicy);<span class="cstat-no" title="statement not covered" >i</span>f(this.dMessageImprint==null){<span class="cstat-no" title="statement not covered" >throw"messageImprint shall be specified."}<span class="cstat-no" title="statement not covered" ></span>e</span>.push(this.dMessageImprint);<span class="cstat-no" title="statement not covered" >i</span>f(this.dSerialNumber==null){<span class="cstat-no" title="statement not covered" >throw"serialNumber shall be specified."}<span class="cstat-no" title="statement not covered" ></span>e</span>.push(this.dSerialNumber);<span class="cstat-no" title="statement not covered" >i</span>f(this.dGenTime==null){<span class="cstat-no" title="statement not covered" >throw"genTime shall be specified."}<span class="cstat-no" title="statement not covered" ></span>e</span>.push(this.dGenTime);<span class="cstat-no" title="statement not covered" >i</span>f(this.dAccuracy!=null){<span class="cstat-no" title="statement not covered" >e.push(this.dAccuracy)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(this.dOrdering!=null){<span class="cstat-no" title="statement not covered" >e.push(this.dOrdering)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(this.dNonce!=null){<span class="cstat-no" title="statement not covered" >e.push(this.dNonce)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(this.dTsa!=null){<span class="cstat-no" title="statement not covered" >e.push(this.dTsa)}<span class="cstat-no" title="statement not covered" ></span>v</span>ar f=new a.DERSequence({array:e});<span class="cstat-no" title="statement not covered" >t</span>his.hTLV=f.getEncodedHex();<span class="cstat-no" title="statement not covered" >r</span>eturn this.hTLV}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(typeof c!="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof c.policy=="string"){<span class="cstat-no" title="statement not covered" >if(!c.policy.match(/^[0-9.]+$/)){<span class="cstat-no" title="statement not covered" >throw"policy shall be oid like 0.1.4.134"}<span class="cstat-no" title="statement not covered" ></span>t</span>his.dPolicy=new a.DERObjectIdentifier({oid:c.policy})}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof c.messageImprint!="undefined"){<span class="cstat-no" title="statement not covered" >this.dMessageImprint=new b.MessageImprint(c.messageImprint)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof c.serialNumber!="undefined"){<span class="cstat-no" title="statement not covered" >this.dSerialNumber=new a.DERInteger(c.serialNumber)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof c.genTime!="undefined"){<span class="cstat-no" title="statement not covered" >this.dGenTime=new a.DERGeneralizedTime(c.genTime)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof c.accuracy!="undefind"){<span class="cstat-no" title="statement not covered" >this.dAccuracy=new b.Accuracy(c.accuracy)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof c.ordering!="undefined"&amp;&amp;c.ordering==true){<span class="cstat-no" title="statement not covered" >this.dOrdering=new a.DERBoolean()}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof c.nonce!="undefined"){<span class="cstat-no" title="statement not covered" >this.dNonce=new a.DERInteger(c.nonce)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof c.tsa!="undefined"){<span class="cstat-no" title="statement not covered" >this.dTsa=new d.X500Name(c.tsa)}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.tsp.TSTInfo,KJUR.asn1.ASN1Object);KJUR.asn1.tsp.TimeStampResp=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.tsp.TimeStampResp.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >v</span>ar a=KJUR.asn1;<span class="cstat-no" title="statement not covered" >v</span>ar b=KJUR.asn1.tsp;<span class="cstat-no" title="statement not covered" >t</span>his.dStatus=null;<span class="cstat-no" title="statement not covered" >t</span>his.dTST=null;<span class="cstat-no" title="statement not covered" >t</span>his.getEncodedHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>if(this.dStatus==null){<span class="cstat-no" title="statement not covered" >throw"status shall be specified"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar d=[this.dStatus];<span class="cstat-no" title="statement not covered" >i</span>f(this.dTST!=null){<span class="cstat-no" title="statement not covered" >d.push(this.dTST)}<span class="cstat-no" title="statement not covered" ></span>v</span>ar e=new a.DERSequence({array:d});<span class="cstat-no" title="statement not covered" >t</span>his.hTLV=e.getEncodedHex();<span class="cstat-no" title="statement not covered" >r</span>eturn this.hTLV}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(typeof c!="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof c.status=="object"){<span class="cstat-no" title="statement not covered" >this.dStatus=new b.PKIStatusInfo(c.status)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof c.tst!="undefined"&amp;&amp;c.tst instanceof KJUR.asn1.ASN1Object){<span class="cstat-no" title="statement not covered" >this.dTST=c.tst.getContentInfo()}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.tsp.TimeStampResp,KJUR.asn1.ASN1Object);KJUR.asn1.tsp.PKIStatusInfo=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.tsp.PKIStatusInfo.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >v</span>ar a=KJUR.asn1;<span class="cstat-no" title="statement not covered" >v</span>ar b=KJUR.asn1.tsp;<span class="cstat-no" title="statement not covered" >t</span>his.dStatus=null;<span class="cstat-no" title="statement not covered" >t</span>his.dStatusString=null;<span class="cstat-no" title="statement not covered" >t</span>his.dFailureInfo=null;<span class="cstat-no" title="statement not covered" >t</span>his.getEncodedHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>if(this.dStatus==null){<span class="cstat-no" title="statement not covered" >throw"status shall be specified"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar d=[this.dStatus];<span class="cstat-no" title="statement not covered" >i</span>f(this.dStatusString!=null){<span class="cstat-no" title="statement not covered" >d.push(this.dStatusString)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(this.dFailureInfo!=null){<span class="cstat-no" title="statement not covered" >d.push(this.dFailureInfo)}<span class="cstat-no" title="statement not covered" ></span>v</span>ar e=new a.DERSequence({array:d});<span class="cstat-no" title="statement not covered" >t</span>his.hTLV=e.getEncodedHex();<span class="cstat-no" title="statement not covered" >r</span>eturn this.hTLV}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(typeof c!="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof c.status=="object"){<span class="cstat-no" title="statement not covered" >this.dStatus=new b.PKIStatus(c.status)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof c.statstr=="object"){<span class="cstat-no" title="statement not covered" >this.dStatusString=new b.PKIFreeText({array:c.statstr})}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof c.failinfo=="object"){<span class="cstat-no" title="statement not covered" >this.dFailureInfo=new b.PKIFailureInfo(c.failinfo)}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.tsp.PKIStatusInfo,KJUR.asn1.ASN1Object);KJUR.asn1.tsp.PKIStatus=<span class="fstat-no" title="function not covered" >function(e){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.tsp.PKIStatus.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >v</span>ar a=KJUR.asn1;<span class="cstat-no" title="statement not covered" >v</span>ar b=KJUR.asn1.tsp;<span class="cstat-no" title="statement not covered" >v</span>ar d=null;<span class="cstat-no" title="statement not covered" >t</span>his.getEncodedHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>this.hTLV=this.dStatus.getEncodedHex();<span class="cstat-no" title="statement not covered" >r</span>eturn this.hTLV}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(typeof e!="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof e.name!="undefined"){<span class="cstat-no" title="statement not covered" >var c=b.PKIStatus.valueList;<span class="cstat-no" title="statement not covered" >i</span>f(typeof c[e.name]=="undefined"){<span class="cstat-no" title="statement not covered" >throw"name undefined: "+e.name}<span class="cstat-no" title="statement not covered" ></span>t</span>his.dStatus=new a.DERInteger({"int":c[e.name]})}</span>else{<span class="cstat-no" title="statement not covered" >this.dStatus=new a.DERInteger(e)}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.tsp.PKIStatus,KJUR.asn1.ASN1Object);KJUR.asn1.tsp.PKIStatus.valueList={granted:0,grantedWithMods:1,rejection:2,waiting:3,revocationWarning:4,revocationNotification:5};KJUR.asn1.tsp.PKIFreeText=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.tsp.PKIFreeText.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >v</span>ar a=KJUR.asn1;<span class="cstat-no" title="statement not covered" >t</span>his.textList=[];<span class="cstat-no" title="statement not covered" >t</span>his.getEncodedHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var c=[];<span class="cstat-no" title="statement not covered" >f</span>or(var e=0;e&lt;this.textList.length;e++){<span class="cstat-no" title="statement not covered" >c.push(new a.DERUTF8String({str:this.textList[e]}))}<span class="cstat-no" title="statement not covered" ></span>v</span>ar d=new a.DERSequence({array:c});<span class="cstat-no" title="statement not covered" >t</span>his.hTLV=d.getEncodedHex();<span class="cstat-no" title="statement not covered" >r</span>eturn this.hTLV}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(typeof b!="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof b.array=="object"){<span class="cstat-no" title="statement not covered" >this.textList=b.array}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.tsp.PKIFreeText,KJUR.asn1.ASN1Object);KJUR.asn1.tsp.PKIFailureInfo=<span class="fstat-no" title="function not covered" >function(d){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.tsp.PKIFailureInfo.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >v</span>ar a=KJUR.asn1;<span class="cstat-no" title="statement not covered" >v</span>ar b=KJUR.asn1.tsp;<span class="cstat-no" title="statement not covered" >t</span>his.value=null;<span class="cstat-no" title="statement not covered" >t</span>his.getEncodedHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>if(this.value==null){<span class="cstat-no" title="statement not covered" >throw"value shall be specified"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar e=new Number(this.value).toString(2);<span class="cstat-no" title="statement not covered" >v</span>ar f=new a.DERBitString();<span class="cstat-no" title="statement not covered" >f</span>.setByBinaryString(e);<span class="cstat-no" title="statement not covered" >t</span>his.hTLV=f.getEncodedHex();<span class="cstat-no" title="statement not covered" >r</span>eturn this.hTLV}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(typeof d!="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof d.name=="string"){<span class="cstat-no" title="statement not covered" >var c=b.PKIFailureInfo.valueList;<span class="cstat-no" title="statement not covered" >i</span>f(typeof c[d.name]=="undefined"){<span class="cstat-no" title="statement not covered" >throw"name undefined: "+d.name}<span class="cstat-no" title="statement not covered" ></span>t</span>his.value=c[d.name]}</span>else{<span class="cstat-no" title="statement not covered" >if(typeof d["int"]=="number"){<span class="cstat-no" title="statement not covered" >this.value=d["int"]}</span>}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.tsp.PKIFailureInfo,KJUR.asn1.ASN1Object);KJUR.asn1.tsp.PKIFailureInfo.valueList={badAlg:0,badRequest:2,badDataFormat:5,timeNotAvailable:14,unacceptedPolicy:15,unacceptedExtension:16,addInfoNotAvailable:17,systemFailure:25};KJUR.asn1.tsp.AbstractTSAAdapter=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>this.getTSTHex=<span class="fstat-no" title="function not covered" >function(c,b){<span class="cstat-no" title="statement not covered" ></span>throw"not implemented yet"}</span>}</span>;KJUR.asn1.tsp.SimpleTSAAdapter=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.tsp.SimpleTSAAdapter.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >t</span>his.params=null;<span class="cstat-no" title="statement not covered" >t</span>his.serial=0;<span class="cstat-no" title="statement not covered" >t</span>his.getTSTHex=<span class="fstat-no" title="function not covered" >function(c,b){<span class="cstat-no" title="statement not covered" ></span>var e=KJUR.crypto.Util.hashHex(c,b);<span class="cstat-no" title="statement not covered" >t</span>his.params.tstInfo.messageImprint={hashAlg:b,hashValue:e};<span class="cstat-no" title="statement not covered" >t</span>his.params.tstInfo.serialNumber={"int":this.serial++};<span class="cstat-no" title="statement not covered" >v</span>ar d=Math.floor(Math.random()*1000000000);<span class="cstat-no" title="statement not covered" >t</span>his.params.tstInfo.nonce={"int":d};<span class="cstat-no" title="statement not covered" >v</span>ar f=KJUR.asn1.tsp.TSPUtil.newTimeStampToken(this.params);<span class="cstat-no" title="statement not covered" >r</span>eturn f.getContentInfoEncodedHex()}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(typeof a!="undefined"){<span class="cstat-no" title="statement not covered" >this.params=a}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.tsp.SimpleTSAAdapter,KJUR.asn1.tsp.AbstractTSAAdapter);KJUR.asn1.tsp.FixedTSAAdapter=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.tsp.FixedTSAAdapter.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >t</span>his.params=null;<span class="cstat-no" title="statement not covered" >t</span>his.getTSTHex=<span class="fstat-no" title="function not covered" >function(c,b){<span class="cstat-no" title="statement not covered" ></span>var d=KJUR.crypto.Util.hashHex(c,b);<span class="cstat-no" title="statement not covered" >t</span>his.params.tstInfo.messageImprint={hashAlg:b,hashValue:d};<span class="cstat-no" title="statement not covered" >v</span>ar e=KJUR.asn1.tsp.TSPUtil.newTimeStampToken(this.params);<span class="cstat-no" title="statement not covered" >r</span>eturn e.getContentInfoEncodedHex()}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(typeof a!="undefined"){<span class="cstat-no" title="statement not covered" >this.params=a}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.tsp.FixedTSAAdapter,KJUR.asn1.tsp.AbstractTSAAdapter);KJUR.asn1.tsp.TSPUtil=new function(){};KJUR.asn1.tsp.TSPUtil.newTimeStampToken=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>var j=KJUR.asn1.cms;<span class="cstat-no" title="statement not covered" >v</span>ar a=KJUR.asn1.tsp;<span class="cstat-no" title="statement not covered" >v</span>ar g=new j.SignedData();<span class="cstat-no" title="statement not covered" >v</span>ar e=new a.TSTInfo(b.tstInfo);<span class="cstat-no" title="statement not covered" >v</span>ar f=e.getEncodedHex();<span class="cstat-no" title="statement not covered" >g</span>.dEncapContentInfo.setContentValue({hex:f});<span class="cstat-no" title="statement not covered" >g</span>.dEncapContentInfo.setContentType("tstinfo");<span class="cstat-no" title="statement not covered" >i</span>f(typeof b.certs=="object"){<span class="cstat-no" title="statement not covered" >for(var c=0;c&lt;b.certs.length;c++){<span class="cstat-no" title="statement not covered" >g.addCertificatesByPEM(b.certs[c])}</span>}<span class="cstat-no" title="statement not covered" ></span>v</span>ar d=g.signerInfoList[0];<span class="cstat-no" title="statement not covered" >d</span>.setSignerIdentifier(b.signerCert);<span class="cstat-no" title="statement not covered" >d</span>.setForContentAndHash({sdObj:g,eciObj:g.dEncapContentInfo,hashAlg:b.hashAlg});<span class="cstat-no" title="statement not covered" >v</span>ar h=new j.SigningCertificate({array:[b.signerCert]});<span class="cstat-no" title="statement not covered" >d</span>.dSignedAttrs.add(h);<span class="cstat-no" title="statement not covered" >d</span>.sign(b.signerPrvKey,b.sigAlg);<span class="cstat-no" title="statement not covered" >r</span>eturn g}</span>;KJUR.asn1.tsp.TSPUtil.parseTimeStampReq=<span class="fstat-no" title="function not covered" >function(d){<span class="cstat-no" title="statement not covered" ></span>var f={};<span class="cstat-no" title="statement not covered" >f</span>.certreq=false;<span class="cstat-no" title="statement not covered" >v</span>ar h=ASN1HEX.getPosArrayOfChildren_AtObj(d,0);<span class="cstat-no" title="statement not covered" >i</span>f(h.length&lt;2){<span class="cstat-no" title="statement not covered" >throw"TimeStampReq must have at least 2 items"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar c=ASN1HEX.getHexOfTLV_AtObj(d,h[1]);<span class="cstat-no" title="statement not covered" >f</span>.mi=KJUR.asn1.tsp.TSPUtil.parseMessageImprint(c);<span class="cstat-no" title="statement not covered" >f</span>or(var e=2;e&lt;h.length;e++){<span class="cstat-no" title="statement not covered" >var b=h[e];<span class="cstat-no" title="statement not covered" >v</span>ar a=d.substr(b,2);<span class="cstat-no" title="statement not covered" >i</span>f(a=="06"){<span class="cstat-no" title="statement not covered" >var g=ASN1HEX.getHexOfV_AtObj(d,b);<span class="cstat-no" title="statement not covered" >f</span>.policy=ASN1HEX.hextooidstr(g)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(a=="02"){<span class="cstat-no" title="statement not covered" >f.nonce=ASN1HEX.getHexOfV_AtObj(d,b)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(a=="01"){<span class="cstat-no" title="statement not covered" >f.certreq=true}</span>}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn f}</span>;KJUR.asn1.tsp.TSPUtil.parseMessageImprint=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>var h={};<span class="cstat-no" title="statement not covered" >i</span>f(c.substr(0,2)!="30"){<span class="cstat-no" title="statement not covered" >throw"head of messageImprint hex shall be '30'"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar a=ASN1HEX.getPosArrayOfChildren_AtObj(c,0);<span class="cstat-no" title="statement not covered" >v</span>ar i=ASN1HEX.getDecendantIndexByNthList(c,0,[0,0]);<span class="cstat-no" title="statement not covered" >v</span>ar d=ASN1HEX.getHexOfV_AtObj(c,i);<span class="cstat-no" title="statement not covered" >v</span>ar e=ASN1HEX.hextooidstr(d);<span class="cstat-no" title="statement not covered" >v</span>ar g=KJUR.asn1.x509.OID.oid2name(e);<span class="cstat-no" title="statement not covered" >i</span>f(g==""){<span class="cstat-no" title="statement not covered" >throw"hashAlg name undefined: "+e}<span class="cstat-no" title="statement not covered" ></span>v</span>ar b=g;<span class="cstat-no" title="statement not covered" >v</span>ar f=ASN1HEX.getDecendantIndexByNthList(c,0,[1]);<span class="cstat-no" title="statement not covered" >h</span>.hashAlg=b;<span class="cstat-no" title="statement not covered" >h</span>.hashValue=ASN1HEX.getHexOfV_AtObj(c,f);<span class="cstat-no" title="statement not covered" >r</span>eturn h}</span>;
/*! asn1cades-1.0.1.js (c) 2014-2017 Kenji Urushima | kjur.github.com/jsrsasign/license
 */
<span class="missing-if-branch" title="if path not taken" >I</span>if(typeof KJUR=="undefined"||!KJUR){<span class="cstat-no" title="statement not covered" >KJUR={}}<span class="missing-if-branch" title="if path not taken" >I</span></span>if(typeof KJUR.asn1=="undefined"||!KJUR.asn1){<span class="cstat-no" title="statement not covered" >KJUR.asn1={}}<span class="missing-if-branch" title="else path not taken" >E</span></span>if(typeof KJUR.asn1.cades=="undefined"||<span class="branch-1 cbranch-no" title="branch not covered" >!KJUR.asn1.cades)</span>{KJUR.asn1.cades={}}KJUR.asn1.cades.SignaturePolicyIdentifier=<span class="fstat-no" title="function not covered" >function(e){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.cades.SignaturePolicyIdentifier.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >t</span>his.attrTypeOid="1.2.840.113549.1.9.16.2.15";<span class="cstat-no" title="statement not covered" >v</span>ar b=KJUR.asn1;<span class="cstat-no" title="statement not covered" >v</span>ar d=KJUR.asn1.cades;<span class="cstat-no" title="statement not covered" >i</span>f(typeof e!="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof e.oid=="string"&amp;&amp;typeof e.hash=="object"){<span class="cstat-no" title="statement not covered" >var f=new b.DERObjectIdentifier({oid:e.oid});<span class="cstat-no" title="statement not covered" >v</span>ar a=new d.OtherHashAlgAndValue(e.hash);<span class="cstat-no" title="statement not covered" >v</span>ar c=new b.DERSequence({array:[f,a]});<span class="cstat-no" title="statement not covered" >t</span>his.valueList=[c]}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.cades.SignaturePolicyIdentifier,KJUR.asn1.cms.Attribute);KJUR.asn1.cades.OtherHashAlgAndValue=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.cades.OtherHashAlgAndValue.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >v</span>ar a=KJUR.asn1;<span class="cstat-no" title="statement not covered" >v</span>ar c=KJUR.asn1.x509;<span class="cstat-no" title="statement not covered" >t</span>his.dAlg=null;<span class="cstat-no" title="statement not covered" >t</span>his.dHash=null;<span class="cstat-no" title="statement not covered" >t</span>his.getEncodedHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var d=new a.DERSequence({array:[this.dAlg,this.dHash]});<span class="cstat-no" title="statement not covered" >t</span>his.hTLV=d.getEncodedHex();<span class="cstat-no" title="statement not covered" >r</span>eturn this.hTLV}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(typeof b!="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof b.alg=="string"&amp;&amp;typeof b.hash=="string"){<span class="cstat-no" title="statement not covered" >this.dAlg=new c.AlgorithmIdentifier({name:b.alg});<span class="cstat-no" title="statement not covered" >t</span>his.dHash=new a.DEROctetString({hex:b.hash})}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.cades.OtherHashAlgAndValue,KJUR.asn1.ASN1Object);KJUR.asn1.cades.SignatureTimeStamp=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.cades.SignatureTimeStamp.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >t</span>his.attrTypeOid="1.2.840.113549.1.9.16.2.14";<span class="cstat-no" title="statement not covered" >t</span>his.tstHex=null;<span class="cstat-no" title="statement not covered" >v</span>ar a=KJUR.asn1;<span class="cstat-no" title="statement not covered" >i</span>f(typeof c!="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof c.res!="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof c.res=="string"&amp;&amp;c.res.match(/^[0-9A-Fa-f]+$/)){}else{<span class="cstat-no" title="statement not covered" >if(c.res instanceof KJUR.asn1.ASN1Object){}else{<span class="cstat-no" title="statement not covered" >throw"res param shall be ASN1Object or hex string"}</span>}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof c.tst!="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof c.tst=="string"&amp;&amp;c.tst.match(/^[0-9A-Fa-f]+$/)){<span class="cstat-no" title="statement not covered" >var b=new a.ASN1Object();<span class="cstat-no" title="statement not covered" >t</span>his.tstHex=c.tst;<span class="cstat-no" title="statement not covered" >b</span>.hTLV=this.tstHex;<span class="cstat-no" title="statement not covered" >b</span>.getEncodedHex();<span class="cstat-no" title="statement not covered" >t</span>his.valueList=[b]}</span>else{<span class="cstat-no" title="statement not covered" >if(c.tst instanceof KJUR.asn1.ASN1Object){}else{<span class="cstat-no" title="statement not covered" >throw"tst param shall be ASN1Object or hex string"}</span>}</span>}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.cades.SignatureTimeStamp,KJUR.asn1.cms.Attribute);KJUR.asn1.cades.CompleteCertificateRefs=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.cades.CompleteCertificateRefs.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >t</span>his.attrTypeOid="1.2.840.113549.1.9.16.2.21";<span class="cstat-no" title="statement not covered" >v</span>ar a=KJUR.asn1;<span class="cstat-no" title="statement not covered" >v</span>ar b=KJUR.asn1.cades;<span class="cstat-no" title="statement not covered" >t</span>his.setByArray=<span class="fstat-no" title="function not covered" >function(d){<span class="cstat-no" title="statement not covered" ></span>this.valueList=[];<span class="cstat-no" title="statement not covered" >f</span>or(var e=0;e&lt;d.length;e++){<span class="cstat-no" title="statement not covered" >var f=new b.OtherCertID(d[e]);<span class="cstat-no" title="statement not covered" >t</span>his.valueList.push(f)}</span>}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(typeof c!="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof c=="object"&amp;&amp;typeof c.length=="number"){<span class="cstat-no" title="statement not covered" >this.setByArray(c)}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.cades.CompleteCertificateRefs,KJUR.asn1.cms.Attribute);KJUR.asn1.cades.OtherCertID=<span class="fstat-no" title="function not covered" >function(d){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.cades.OtherCertID.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >v</span>ar a=KJUR.asn1;<span class="cstat-no" title="statement not covered" >v</span>ar c=KJUR.asn1.cms;<span class="cstat-no" title="statement not covered" >v</span>ar b=KJUR.asn1.cades;<span class="cstat-no" title="statement not covered" >t</span>his.hasIssuerSerial=true;<span class="cstat-no" title="statement not covered" >t</span>his.dOtherCertHash=null;<span class="cstat-no" title="statement not covered" >t</span>his.dIssuerSerial=null;<span class="cstat-no" title="statement not covered" >t</span>his.setByCertPEM=<span class="fstat-no" title="function not covered" >function(e){<span class="cstat-no" title="statement not covered" ></span>this.dOtherCertHash=new b.OtherHash(e);<span class="cstat-no" title="statement not covered" >i</span>f(this.hasIssuerSerial){<span class="cstat-no" title="statement not covered" >this.dIssuerSerial=new c.IssuerAndSerialNumber(e)}</span>}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getEncodedHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>if(this.hTLV!=null){<span class="cstat-no" title="statement not covered" >return this.hTLV}<span class="cstat-no" title="statement not covered" ></span>i</span>f(this.dOtherCertHash==null){<span class="cstat-no" title="statement not covered" >throw"otherCertHash not set"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar e=[this.dOtherCertHash];<span class="cstat-no" title="statement not covered" >i</span>f(this.dIssuerSerial!=null){<span class="cstat-no" title="statement not covered" >e.push(this.dIssuerSerial)}<span class="cstat-no" title="statement not covered" ></span>v</span>ar f=new a.DERSequence({array:e});<span class="cstat-no" title="statement not covered" >t</span>his.hTLV=f.getEncodedHex();<span class="cstat-no" title="statement not covered" >r</span>eturn this.hTLV}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(typeof d!="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof d=="string"&amp;&amp;d.indexOf("-----BEGIN ")!=-1){<span class="cstat-no" title="statement not covered" >this.setByCertPEM(d)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof d=="object"){<span class="cstat-no" title="statement not covered" >if(d.hasis===false){<span class="cstat-no" title="statement not covered" >this.hasIssuerSerial=false}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof d.cert=="string"){<span class="cstat-no" title="statement not covered" >this.setByCertPEM(d.cert)}</span>}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.cades.OtherCertID,KJUR.asn1.ASN1Object);KJUR.asn1.cades.OtherHash=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.cades.OtherHash.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >v</span>ar a=KJUR.asn1;<span class="cstat-no" title="statement not covered" >v</span>ar b=KJUR.asn1.cades;<span class="cstat-no" title="statement not covered" >t</span>his.alg="sha256";<span class="cstat-no" title="statement not covered" >t</span>his.dOtherHash=null;<span class="cstat-no" title="statement not covered" >t</span>his.setByCertPEM=<span class="fstat-no" title="function not covered" >function(d){<span class="cstat-no" title="statement not covered" ></span>if(d.indexOf("-----BEGIN ")==-1){<span class="cstat-no" title="statement not covered" >throw"certPEM not to seem PEM format"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar e=ASN1HEX.pemToHex(d);<span class="cstat-no" title="statement not covered" >v</span>ar f=KJUR.crypto.Util.hashHex(e,this.alg);<span class="cstat-no" title="statement not covered" >t</span>his.dOtherHash=new b.OtherHashAlgAndValue({alg:this.alg,hash:f})}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getEncodedHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>if(this.dOtherHash==null){<span class="cstat-no" title="statement not covered" >throw"OtherHash not set"}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn this.dOtherHash.getEncodedHex()}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(typeof c!="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof c=="string"){<span class="cstat-no" title="statement not covered" >if(c.indexOf("-----BEGIN ")!=-1){<span class="cstat-no" title="statement not covered" >this.setByCertPEM(c)}</span>else{<span class="cstat-no" title="statement not covered" >if(c.match(/^[0-9A-Fa-f]+$/)){<span class="cstat-no" title="statement not covered" >this.dOtherHash=new a.DEROctetString({hex:c})}</span>else{<span class="cstat-no" title="statement not covered" >throw"unsupported string value for params"}</span>}</span>}</span>else{<span class="cstat-no" title="statement not covered" >if(typeof c=="object"){<span class="cstat-no" title="statement not covered" >if(typeof c.cert=="string"){<span class="cstat-no" title="statement not covered" >if(typeof c.alg=="string"){<span class="cstat-no" title="statement not covered" >this.alg=c.alg}<span class="cstat-no" title="statement not covered" ></span>t</span>his.setByCertPEM(c.cert)}</span>else{<span class="cstat-no" title="statement not covered" >this.dOtherHash=new b.OtherHashAlgAndValue(c)}</span>}</span>}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.cades.OtherHash,KJUR.asn1.ASN1Object);KJUR.asn1.cades.CAdESUtil=new function(){};KJUR.asn1.cades.CAdESUtil.addSigTS=<span class="fstat-no" title="function not covered" >function(c,b,a){</span>};KJUR.asn1.cades.CAdESUtil.parseSignedDataForAddingUnsigned=<span class="fstat-no" title="function not covered" >function(d){<span class="cstat-no" title="statement not covered" ></span>var q=KJUR.asn1;<span class="cstat-no" title="statement not covered" >v</span>ar p=KJUR.asn1.cms;<span class="cstat-no" title="statement not covered" >v</span>ar c=KJUR.asn1.cades.CAdESUtil;<span class="cstat-no" title="statement not covered" >v</span>ar a={};<span class="cstat-no" title="statement not covered" >i</span>f(ASN1HEX.getDecendantHexTLVByNthList(d,0,[0])!="06092a864886f70d010702"){<span class="cstat-no" title="statement not covered" >throw"hex is not CMS SignedData"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar s=ASN1HEX.getDecendantIndexByNthList(d,0,[1,0]);<span class="cstat-no" title="statement not covered" >v</span>ar b=ASN1HEX.getPosArrayOfChildren_AtObj(d,s);<span class="cstat-no" title="statement not covered" >i</span>f(b.length&lt;4){<span class="cstat-no" title="statement not covered" >throw"num of SignedData elem shall be 4 at least"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar f=b.shift();<span class="cstat-no" title="statement not covered" >a</span>.version=ASN1HEX.getHexOfTLV_AtObj(d,f);<span class="cstat-no" title="statement not covered" >v</span>ar l=b.shift();<span class="cstat-no" title="statement not covered" >a</span>.algs=ASN1HEX.getHexOfTLV_AtObj(d,l);<span class="cstat-no" title="statement not covered" >v</span>ar m=b.shift();<span class="cstat-no" title="statement not covered" >a</span>.encapcontent=ASN1HEX.getHexOfTLV_AtObj(d,m);<span class="cstat-no" title="statement not covered" >a</span>.certs=null;<span class="cstat-no" title="statement not covered" >a</span>.revs=null;<span class="cstat-no" title="statement not covered" >a</span>.si=[];<span class="cstat-no" title="statement not covered" >v</span>ar n=b.shift();<span class="cstat-no" title="statement not covered" >i</span>f(d.substr(n,2)=="a0"){<span class="cstat-no" title="statement not covered" >a.certs=ASN1HEX.getHexOfTLV_AtObj(d,n);<span class="cstat-no" title="statement not covered" >n</span>=b.shift()}<span class="cstat-no" title="statement not covered" ></span>i</span>f(d.substr(n,2)=="a1"){<span class="cstat-no" title="statement not covered" >a.revs=ASN1HEX.getHexOfTLV_AtObj(d,n);<span class="cstat-no" title="statement not covered" >n</span>=b.shift()}<span class="cstat-no" title="statement not covered" ></span>v</span>ar k=n;<span class="cstat-no" title="statement not covered" >i</span>f(d.substr(k,2)!="31"){<span class="cstat-no" title="statement not covered" >throw"Can't find signerInfos"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar j=ASN1HEX.getPosArrayOfChildren_AtObj(d,k);<span class="cstat-no" title="statement not covered" >f</span>or(var h=0;h&lt;j.length;h++){<span class="cstat-no" title="statement not covered" >var o=j[h];<span class="cstat-no" title="statement not covered" >v</span>ar e=c.parseSignerInfoForAddingUnsigned(d,o,h);<span class="cstat-no" title="statement not covered" >a</span>.si[h]=e}<span class="cstat-no" title="statement not covered" ></span>v</span>ar g=null;<span class="cstat-no" title="statement not covered" >a</span>.obj=new p.SignedData();<span class="cstat-no" title="statement not covered" >g</span>=new q.ASN1Object();<span class="cstat-no" title="statement not covered" >g</span>.hTLV=a.version;<span class="cstat-no" title="statement not covered" >a</span>.obj.dCMSVersion=g;<span class="cstat-no" title="statement not covered" >g</span>=new q.ASN1Object();<span class="cstat-no" title="statement not covered" >g</span>.hTLV=a.algs;<span class="cstat-no" title="statement not covered" >a</span>.obj.dDigestAlgs=g;<span class="cstat-no" title="statement not covered" >g</span>=new q.ASN1Object();<span class="cstat-no" title="statement not covered" >g</span>.hTLV=a.encapcontent;<span class="cstat-no" title="statement not covered" >a</span>.obj.dEncapContentInfo=g;<span class="cstat-no" title="statement not covered" >g</span>=new q.ASN1Object();<span class="cstat-no" title="statement not covered" >g</span>.hTLV=a.certs;<span class="cstat-no" title="statement not covered" >a</span>.obj.dCerts=g;<span class="cstat-no" title="statement not covered" >a</span>.obj.signerInfoList=[];<span class="cstat-no" title="statement not covered" >f</span>or(var h=0;h&lt;a.si.length;h++){<span class="cstat-no" title="statement not covered" >a.obj.signerInfoList.push(a.si[h].obj)}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn a}</span>;KJUR.asn1.cades.CAdESUtil.parseSignerInfoForAddingUnsigned=<span class="fstat-no" title="function not covered" >function(d,k,a){<span class="cstat-no" title="statement not covered" ></span>var m=KJUR.asn1;<span class="cstat-no" title="statement not covered" >v</span>ar l=KJUR.asn1.cms;<span class="cstat-no" title="statement not covered" >v</span>ar b={};<span class="cstat-no" title="statement not covered" >v</span>ar e=ASN1HEX.getPosArrayOfChildren_AtObj(d,k);<span class="cstat-no" title="statement not covered" >i</span>f(e.length!=6){<span class="cstat-no" title="statement not covered" >throw"not supported items for SignerInfo (!=6)"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar f=e.shift();<span class="cstat-no" title="statement not covered" >b</span>.version=ASN1HEX.getHexOfTLV_AtObj(d,f);<span class="cstat-no" title="statement not covered" >v</span>ar n=e.shift();<span class="cstat-no" title="statement not covered" >b</span>.si=ASN1HEX.getHexOfTLV_AtObj(d,n);<span class="cstat-no" title="statement not covered" >v</span>ar h=e.shift();<span class="cstat-no" title="statement not covered" >b</span>.digalg=ASN1HEX.getHexOfTLV_AtObj(d,h);<span class="cstat-no" title="statement not covered" >v</span>ar c=e.shift();<span class="cstat-no" title="statement not covered" >b</span>.sattrs=ASN1HEX.getHexOfTLV_AtObj(d,c);<span class="cstat-no" title="statement not covered" >v</span>ar i=e.shift();<span class="cstat-no" title="statement not covered" >b</span>.sigalg=ASN1HEX.getHexOfTLV_AtObj(d,i);<span class="cstat-no" title="statement not covered" >v</span>ar j=e.shift();<span class="cstat-no" title="statement not covered" >b</span>.sig=ASN1HEX.getHexOfTLV_AtObj(d,j);<span class="cstat-no" title="statement not covered" >b</span>.sigval=ASN1HEX.getHexOfV_AtObj(d,j);<span class="cstat-no" title="statement not covered" >v</span>ar g=null;<span class="cstat-no" title="statement not covered" >b</span>.obj=new l.SignerInfo();<span class="cstat-no" title="statement not covered" >g</span>=new m.ASN1Object();<span class="cstat-no" title="statement not covered" >g</span>.hTLV=b.version;<span class="cstat-no" title="statement not covered" >b</span>.obj.dCMSVersion=g;<span class="cstat-no" title="statement not covered" >g</span>=new m.ASN1Object();<span class="cstat-no" title="statement not covered" >g</span>.hTLV=b.si;<span class="cstat-no" title="statement not covered" >b</span>.obj.dSignerIdentifier=g;<span class="cstat-no" title="statement not covered" >g</span>=new m.ASN1Object();<span class="cstat-no" title="statement not covered" >g</span>.hTLV=b.digalg;<span class="cstat-no" title="statement not covered" >b</span>.obj.dDigestAlgorithm=g;<span class="cstat-no" title="statement not covered" >g</span>=new m.ASN1Object();<span class="cstat-no" title="statement not covered" >g</span>.hTLV=b.sattrs;<span class="cstat-no" title="statement not covered" >b</span>.obj.dSignedAttrs=g;<span class="cstat-no" title="statement not covered" >g</span>=new m.ASN1Object();<span class="cstat-no" title="statement not covered" >g</span>.hTLV=b.sigalg;<span class="cstat-no" title="statement not covered" >b</span>.obj.dSigAlg=g;<span class="cstat-no" title="statement not covered" >g</span>=new m.ASN1Object();<span class="cstat-no" title="statement not covered" >g</span>.hTLV=b.sig;<span class="cstat-no" title="statement not covered" >b</span>.obj.dSig=g;<span class="cstat-no" title="statement not covered" >b</span>.obj.dUnsignedAttrs=new l.AttributeList();<span class="cstat-no" title="statement not covered" >r</span>eturn b}</span>;
/*! asn1csr-1.0.3.js (c) 2015-2017 Kenji Urushima | kjur.github.com/jsrsasign/license
 */
<span class="missing-if-branch" title="else path not taken" >E</span>if(typeof KJUR.asn1.csr=="undefined"||<span class="branch-1 cbranch-no" title="branch not covered" >!KJUR.asn1.csr)</span>{KJUR.asn1.csr={}}KJUR.asn1.csr.CertificationRequest=<span class="fstat-no" title="function not covered" >function(f){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.csr.CertificationRequest.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >v</span>ar b=null;<span class="cstat-no" title="statement not covered" >v</span>ar d=null;<span class="cstat-no" title="statement not covered" >v</span>ar e=null;<span class="cstat-no" title="statement not covered" >v</span>ar c=null;<span class="cstat-no" title="statement not covered" >v</span>ar a=null;<span class="cstat-no" title="statement not covered" >t</span>his.sign=<span class="fstat-no" title="function not covered" >function(i,h){<span class="cstat-no" title="statement not covered" ></span>if(this.prvKey==null){<span class="cstat-no" title="statement not covered" >this.prvKey=h}<span class="cstat-no" title="statement not covered" ></span>t</span>his.asn1SignatureAlg=new KJUR.asn1.x509.AlgorithmIdentifier({name:i});<span class="cstat-no" title="statement not covered" >s</span>ig=new KJUR.crypto.Signature({alg:i});<span class="cstat-no" title="statement not covered" >s</span>ig.initSign(this.prvKey);<span class="cstat-no" title="statement not covered" >s</span>ig.updateHex(this.asn1CSRInfo.getEncodedHex());<span class="cstat-no" title="statement not covered" >t</span>his.hexSig=sig.sign();<span class="cstat-no" title="statement not covered" >t</span>his.asn1Sig=new KJUR.asn1.DERBitString({hex:"00"+this.hexSig});<span class="cstat-no" title="statement not covered" >v</span>ar g=new KJUR.asn1.DERSequence({array:[this.asn1CSRInfo,this.asn1SignatureAlg,this.asn1Sig]});<span class="cstat-no" title="statement not covered" >t</span>his.hTLV=g.getEncodedHex();<span class="cstat-no" title="statement not covered" >t</span>his.isModified=false}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getPEMString=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var g=KJUR.asn1.ASN1Util.getPEMStringFromHex(this.getEncodedHex(),"CERTIFICATE REQUEST");<span class="cstat-no" title="statement not covered" >r</span>eturn g}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getEncodedHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>if(this.isModified==false&amp;&amp;this.hTLV!=null){<span class="cstat-no" title="statement not covered" >return this.hTLV}<span class="cstat-no" title="statement not covered" ></span>t</span>hrow"not signed yet"}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(typeof f!="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof f.csrinfo!="undefined"){<span class="cstat-no" title="statement not covered" >this.asn1CSRInfo=f.csrinfo}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.csr.CertificationRequest,KJUR.asn1.ASN1Object);KJUR.asn1.csr.CertificationRequestInfo=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.csr.CertificationRequestInfo.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >t</span>his._initialize=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>this.asn1Array=new Array();<span class="cstat-no" title="statement not covered" >t</span>his.asn1Version=new KJUR.asn1.DERInteger({"int":0});<span class="cstat-no" title="statement not covered" >t</span>his.asn1Subject=null;<span class="cstat-no" title="statement not covered" >t</span>his.asn1SubjPKey=null;<span class="cstat-no" title="statement not covered" >t</span>his.extensionsArray=new Array()}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setSubjectByParam=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>this.asn1Subject=new KJUR.asn1.x509.X500Name(b)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setSubjectPublicKeyByGetKey=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>var b=KEYUTIL.getKey(c);<span class="cstat-no" title="statement not covered" >t</span>his.asn1SubjPKey=new KJUR.asn1.x509.SubjectPublicKeyInfo(b)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.appendExtensionByName=<span class="fstat-no" title="function not covered" >function(c,b){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.x509.Extension.appendByNameToArray(c,b,this.extensionsArray)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getEncodedHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>this.asn1Array=new Array();<span class="cstat-no" title="statement not covered" >t</span>his.asn1Array.push(this.asn1Version);<span class="cstat-no" title="statement not covered" >t</span>his.asn1Array.push(this.asn1Subject);<span class="cstat-no" title="statement not covered" >t</span>his.asn1Array.push(this.asn1SubjPKey);<span class="cstat-no" title="statement not covered" >i</span>f(this.extensionsArray.length&gt;0){<span class="cstat-no" title="statement not covered" >var e=new KJUR.asn1.DERSequence({array:this.extensionsArray});<span class="cstat-no" title="statement not covered" >v</span>ar d=new KJUR.asn1.DERSet({array:[e]});<span class="cstat-no" title="statement not covered" >v</span>ar c=new KJUR.asn1.DERSequence({array:[new KJUR.asn1.DERObjectIdentifier({oid:"1.2.840.113549.1.9.14"}),d]});<span class="cstat-no" title="statement not covered" >v</span>ar b=new KJUR.asn1.DERTaggedObject({explicit:true,tag:"a0",obj:c});<span class="cstat-no" title="statement not covered" >t</span>his.asn1Array.push(b)}</span>else{<span class="cstat-no" title="statement not covered" >var b=new KJUR.asn1.DERTaggedObject({explicit:false,tag:"a0",obj:new KJUR.asn1.DERNull()});<span class="cstat-no" title="statement not covered" >t</span>his.asn1Array.push(b)}<span class="cstat-no" title="statement not covered" ></span>v</span>ar f=new KJUR.asn1.DERSequence({array:this.asn1Array});<span class="cstat-no" title="statement not covered" >t</span>his.hTLV=f.getEncodedHex();<span class="cstat-no" title="statement not covered" >t</span>his.isModified=false;<span class="cstat-no" title="statement not covered" >r</span>eturn this.hTLV}</span>;<span class="cstat-no" title="statement not covered" >t</span>his._initialize()}</span>;YAHOO.lang.extend(KJUR.asn1.csr.CertificationRequestInfo,KJUR.asn1.ASN1Object);KJUR.asn1.csr.CSRUtil=new function(){};KJUR.asn1.csr.CSRUtil.newCSRPEM=<span class="fstat-no" title="function not covered" >function(g){<span class="cstat-no" title="statement not covered" ></span>var d=KJUR.asn1.csr;<span class="cstat-no" title="statement not covered" >i</span>f(g.subject===undefined){<span class="cstat-no" title="statement not covered" >throw"parameter subject undefined"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(g.sbjpubkey===undefined){<span class="cstat-no" title="statement not covered" >throw"parameter sbjpubkey undefined"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(g.sigalg===undefined){<span class="cstat-no" title="statement not covered" >throw"parameter sigalg undefined"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(g.sbjprvkey===undefined){<span class="cstat-no" title="statement not covered" >throw"parameter sbjpubkey undefined"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar b=new d.CertificationRequestInfo();<span class="cstat-no" title="statement not covered" >b</span>.setSubjectByParam(g.subject);<span class="cstat-no" title="statement not covered" >b</span>.setSubjectPublicKeyByGetKey(g.sbjpubkey);<span class="cstat-no" title="statement not covered" >i</span>f(g.ext!==undefined&amp;&amp;g.ext.length!==undefined){<span class="cstat-no" title="statement not covered" >for(var c=0;c&lt;g.ext.length;c++){<span class="cstat-no" title="statement not covered" >for(key in g.ext[c]){<span class="cstat-no" title="statement not covered" >b.appendExtensionByName(key,g.ext[c][key])}</span>}</span>}<span class="cstat-no" title="statement not covered" ></span>v</span>ar e=new d.CertificationRequest({csrinfo:b});<span class="cstat-no" title="statement not covered" >v</span>ar a=KEYUTIL.getKey(g.sbjprvkey);<span class="cstat-no" title="statement not covered" >e</span>.sign(g.sigalg,a);<span class="cstat-no" title="statement not covered" >v</span>ar f=e.getPEMString();<span class="cstat-no" title="statement not covered" >r</span>eturn f}</span>;KJUR.asn1.csr.CSRUtil.getInfo=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>var a={};<span class="cstat-no" title="statement not covered" >a</span>.subject={};<span class="cstat-no" title="statement not covered" >a</span>.pubkey={};<span class="cstat-no" title="statement not covered" >i</span>f(b.indexOf("-----BEGIN CERTIFICATE REQUEST")==-1){<span class="cstat-no" title="statement not covered" >throw"argument is not PEM file"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar c=ASN1HEX.pemToHex(b,"CERTIFICATE REQUEST");<span class="cstat-no" title="statement not covered" >a</span>.subject.hex=ASN1HEX.getDecendantHexTLVByNthList(c,0,[0,1]);<span class="cstat-no" title="statement not covered" >a</span>.subject.name=X509.hex2dn(a.subject.hex);<span class="cstat-no" title="statement not covered" >a</span>.pubkey.hex=ASN1HEX.getDecendantHexTLVByNthList(c,0,[0,2]);<span class="cstat-no" title="statement not covered" >a</span>.pubkey.obj=KEYUTIL.getKey(a.pubkey.hex,null,"pkcs8pub");<span class="cstat-no" title="statement not covered" >r</span>eturn a}</span>;
/*! asn1ocsp-1.0.1.js (c) 2016 Kenji Urushima | kjur.github.com/jsrsasign/license
 */
<span class="missing-if-branch" title="if path not taken" >I</span>if(typeof KJUR=="undefined"||!KJUR){<span class="cstat-no" title="statement not covered" >KJUR={}}<span class="missing-if-branch" title="if path not taken" >I</span></span>if(typeof KJUR.asn1=="undefined"||!KJUR.asn1){<span class="cstat-no" title="statement not covered" >KJUR.asn1={}}<span class="missing-if-branch" title="else path not taken" >E</span></span>if(typeof KJUR.asn1.ocsp=="undefined"||<span class="branch-1 cbranch-no" title="branch not covered" >!KJUR.asn1.ocsp)</span>{KJUR.asn1.ocsp={}}KJUR.asn1.ocsp.DEFAULT_HASH="sha1";KJUR.asn1.ocsp.CertID=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.ocsp.CertID.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >v</span>ar a=KJUR.asn1;<span class="cstat-no" title="statement not covered" >v</span>ar e=KJUR.asn1.x509;<span class="cstat-no" title="statement not covered" >t</span>his.dHashAlg=null;<span class="cstat-no" title="statement not covered" >t</span>his.dIssuerNameHash=null;<span class="cstat-no" title="statement not covered" >t</span>his.dIssuerKeyHash=null;<span class="cstat-no" title="statement not covered" >t</span>his.dSerialNumber=null;<span class="cstat-no" title="statement not covered" >t</span>his.setByValue=<span class="fstat-no" title="function not covered" >function(i,h,f,g){<span class="cstat-no" title="statement not covered" ></span>if(g===undefined){<span class="cstat-no" title="statement not covered" >g=KJUR.asn1.ocsp.DEFAULT_HASH}<span class="cstat-no" title="statement not covered" ></span>t</span>his.dHashAlg=new e.AlgorithmIdentifier({name:g});<span class="cstat-no" title="statement not covered" >t</span>his.dIssuerNameHash=new a.DEROctetString({hex:i});<span class="cstat-no" title="statement not covered" >t</span>his.dIssuerKeyHash=new a.DEROctetString({hex:h});<span class="cstat-no" title="statement not covered" >t</span>his.dSerialNumber=new a.DERInteger({hex:f})}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setByCert=<span class="fstat-no" title="function not covered" >function(m,i,k){<span class="cstat-no" title="statement not covered" ></span>if(k===undefined){<span class="cstat-no" title="statement not covered" >k=KJUR.asn1.ocsp.DEFAULT_HASH}<span class="cstat-no" title="statement not covered" ></span>v</span>ar f=new X509();<span class="cstat-no" title="statement not covered" >f</span>.readCertPEM(i);<span class="cstat-no" title="statement not covered" >v</span>ar n=new X509();<span class="cstat-no" title="statement not covered" >n</span>.readCertPEM(m);<span class="cstat-no" title="statement not covered" >v</span>ar o=X509.getPublicKeyInfoPropOfCertPEM(m);<span class="cstat-no" title="statement not covered" >v</span>ar l=o.keyhex;<span class="cstat-no" title="statement not covered" >v</span>ar g=f.getSerialNumberHex();<span class="cstat-no" title="statement not covered" >v</span>ar h=KJUR.crypto.Util.hashHex(n.getSubjectHex(),k);<span class="cstat-no" title="statement not covered" >v</span>ar j=KJUR.crypto.Util.hashHex(l,k);<span class="cstat-no" title="statement not covered" >t</span>his.setByValue(h,j,g,k);<span class="cstat-no" title="statement not covered" >t</span>his.hoge=f.getSerialNumberHex()}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getEncodedHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>if(this.dHashAlg===null&amp;&amp;this.dIssuerNameHash===null&amp;&amp;this.dIssuerKeyHash===null&amp;&amp;this.dSerialNumber===null){<span class="cstat-no" title="statement not covered" >throw"not yet set values"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar f=[this.dHashAlg,this.dIssuerNameHash,this.dIssuerKeyHash,this.dSerialNumber];<span class="cstat-no" title="statement not covered" >v</span>ar g=new a.DERSequence({array:f});<span class="cstat-no" title="statement not covered" >t</span>his.hTLV=g.getEncodedHex();<span class="cstat-no" title="statement not covered" >r</span>eturn this.hTLV}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(typeof c!=="undefined"){<span class="cstat-no" title="statement not covered" >var b=c;<span class="cstat-no" title="statement not covered" >i</span>f(typeof b.issuerCert!=="undefined"&amp;&amp;typeof b.subjectCert!=="undefined"){<span class="cstat-no" title="statement not covered" >var d=KJUR.asn1.ocsp.DEFAULT_HASH;<span class="cstat-no" title="statement not covered" >i</span>f(typeof b.alg==="undefined"){<span class="cstat-no" title="statement not covered" >d=undefined}<span class="cstat-no" title="statement not covered" ></span>t</span>his.setByCert(b.issuerCert,b.subjectCert,d)}</span>else{<span class="cstat-no" title="statement not covered" >if(typeof b.namehash!=="undefined"&amp;&amp;typeof b.keyhash!=="undefined"&amp;&amp;typeof b.serial!=="undefined"){<span class="cstat-no" title="statement not covered" >var d=KJUR.asn1.ocsp.DEFAULT_HASH;<span class="cstat-no" title="statement not covered" >i</span>f(typeof b.alg==="undefined"){<span class="cstat-no" title="statement not covered" >d=undefined}<span class="cstat-no" title="statement not covered" ></span>t</span>his.setByValue(b.namehash,b.keyhash,b.serial,d)}</span>else{<span class="cstat-no" title="statement not covered" >throw"invalid constructor arguments"}</span>}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.ocsp.CertID,KJUR.asn1.ASN1Object);KJUR.asn1.ocsp.Request=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.ocsp.Request.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >t</span>his.dReqCert=null;<span class="cstat-no" title="statement not covered" >t</span>his.dExt=null;<span class="cstat-no" title="statement not covered" >t</span>his.getEncodedHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var c=[];<span class="cstat-no" title="statement not covered" >i</span>f(this.dReqCert===null){<span class="cstat-no" title="statement not covered" >throw"reqCert not set"}<span class="cstat-no" title="statement not covered" ></span>c</span>.push(this.dReqCert);<span class="cstat-no" title="statement not covered" >v</span>ar d=new KJUR.asn1.DERSequence({array:c});<span class="cstat-no" title="statement not covered" >t</span>his.hTLV=d.getEncodedHex();<span class="cstat-no" title="statement not covered" >r</span>eturn this.hTLV}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(typeof b!=="undefined"){<span class="cstat-no" title="statement not covered" >var a=new KJUR.asn1.ocsp.CertID(b);<span class="cstat-no" title="statement not covered" >t</span>his.dReqCert=a}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.ocsp.Request,KJUR.asn1.ASN1Object);KJUR.asn1.ocsp.TBSRequest=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.ocsp.TBSRequest.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >t</span>his.version=0;<span class="cstat-no" title="statement not covered" >t</span>his.dRequestorName=null;<span class="cstat-no" title="statement not covered" >t</span>his.dRequestList=[];<span class="cstat-no" title="statement not covered" >t</span>his.dRequestExt=null;<span class="cstat-no" title="statement not covered" >t</span>his.setRequestListByParam=<span class="fstat-no" title="function not covered" >function(d){<span class="cstat-no" title="statement not covered" ></span>var b=[];<span class="cstat-no" title="statement not covered" >f</span>or(var c=0;c&lt;d.length;c++){<span class="cstat-no" title="statement not covered" >var e=new KJUR.asn1.ocsp.Request(d[0]);<span class="cstat-no" title="statement not covered" >b</span>.push(e)}<span class="cstat-no" title="statement not covered" ></span>t</span>his.dRequestList=b}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getEncodedHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var b=[];<span class="cstat-no" title="statement not covered" >i</span>f(this.version!==0){<span class="cstat-no" title="statement not covered" >throw"not supported version: "+this.version}<span class="cstat-no" title="statement not covered" ></span>i</span>f(this.dRequestorName!==null){<span class="cstat-no" title="statement not covered" >throw"requestorName not supported"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar d=new KJUR.asn1.DERSequence({array:this.dRequestList});<span class="cstat-no" title="statement not covered" >b</span>.push(d);<span class="cstat-no" title="statement not covered" >i</span>f(this.dRequestExt!==null){<span class="cstat-no" title="statement not covered" >throw"requestExtensions not supported"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar c=new KJUR.asn1.DERSequence({array:b});<span class="cstat-no" title="statement not covered" >t</span>his.hTLV=c.getEncodedHex();<span class="cstat-no" title="statement not covered" >r</span>eturn this.hTLV}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(typeof a!=="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof a.reqList!=="undefined"){<span class="cstat-no" title="statement not covered" >this.setRequestListByParam(a.reqList)}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.ocsp.TBSRequest,KJUR.asn1.ASN1Object);KJUR.asn1.ocsp.OCSPRequest=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>KJUR.asn1.ocsp.OCSPRequest.superclass.constructor.call(this);<span class="cstat-no" title="statement not covered" >t</span>his.dTbsRequest=null;<span class="cstat-no" title="statement not covered" >t</span>his.dOptionalSignature=null;<span class="cstat-no" title="statement not covered" >t</span>his.getEncodedHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var c=[];<span class="cstat-no" title="statement not covered" >i</span>f(this.dTbsRequest!==null){<span class="cstat-no" title="statement not covered" >c.push(this.dTbsRequest)}</span>else{<span class="cstat-no" title="statement not covered" >throw"tbsRequest not set"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(this.dOptionalSignature!==null){<span class="cstat-no" title="statement not covered" >throw"optionalSignature not supported"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar d=new KJUR.asn1.DERSequence({array:c});<span class="cstat-no" title="statement not covered" >t</span>his.hTLV=d.getEncodedHex();<span class="cstat-no" title="statement not covered" >r</span>eturn this.hTLV}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(typeof b!=="undefined"){<span class="cstat-no" title="statement not covered" >if(typeof b.reqList!=="undefined"){<span class="cstat-no" title="statement not covered" >var a=new KJUR.asn1.ocsp.TBSRequest(b);<span class="cstat-no" title="statement not covered" >t</span>his.dTbsRequest=a}</span>}</span>}</span>;YAHOO.lang.extend(KJUR.asn1.ocsp.OCSPRequest,KJUR.asn1.ASN1Object);KJUR.asn1.ocsp.OCSPUtil={};KJUR.asn1.ocsp.OCSPUtil.getRequestHex=<span class="fstat-no" title="function not covered" >function(a,b,e){<span class="cstat-no" title="statement not covered" ></span>if(e===undefined){<span class="cstat-no" title="statement not covered" >e=KJUR.asn1.ocsp.DEFAULT_HASH}<span class="cstat-no" title="statement not covered" ></span>v</span>ar d={alg:e,issuerCert:a,subjectCert:b};<span class="cstat-no" title="statement not covered" >v</span>ar c=new KJUR.asn1.ocsp.OCSPRequest({reqList:[d]});<span class="cstat-no" title="statement not covered" >r</span>eturn c.getEncodedHex()}</span>;KJUR.asn1.ocsp.OCSPUtil.getOCSPResponseInfo=<span class="fstat-no" title="function not covered" >function(f){<span class="cstat-no" title="statement not covered" ></span>var a={};<span class="cstat-no" title="statement not covered" >t</span>ry{<span class="cstat-no" title="statement not covered" >var b=ASN1HEX.getVbyList(f,0,[0],"0a");<span class="cstat-no" title="statement not covered" >a</span>.responseStatus=parseInt(b,16)}</span>catch(d){}<span class="cstat-no" title="statement not covered" >i</span>f(a.responseStatus!==0){<span class="cstat-no" title="statement not covered" >return a}<span class="cstat-no" title="statement not covered" ></span>t</span>ry{<span class="cstat-no" title="statement not covered" >var e=ASN1HEX.getDecendantIndexByNthList(f,0,[1,0,1,0,0,2,0,1]);<span class="cstat-no" title="statement not covered" >i</span>f(f.substr(e,2)==="80"){<span class="cstat-no" title="statement not covered" >a.certStatus="good"}</span>else{<span class="cstat-no" title="statement not covered" >if(f.substr(e,2)==="a1"){<span class="cstat-no" title="statement not covered" >a.certStatus="revoked";<span class="cstat-no" title="statement not covered" >a</span>.revocationTime=hextoutf8(ASN1HEX.getDecendantHexVByNthList(f,e,[0]))}</span>else{<span class="cstat-no" title="statement not covered" >if(f.substr(e,2)==="82"){<span class="cstat-no" title="statement not covered" >a.certStatus="unknown"}</span>}</span>}</span>}</span>catch(d){}<span class="cstat-no" title="statement not covered" >t</span>ry{<span class="cstat-no" title="statement not covered" >var c=ASN1HEX.getDecendantIndexByNthList(f,0,[1,0,1,0,0,2,0,2]);<span class="cstat-no" title="statement not covered" >a</span>.thisUpdate=hextoutf8(ASN1HEX.getHexOfV_AtObj(f,c))}</span>catch(d){}<span class="cstat-no" title="statement not covered" >t</span>ry{<span class="cstat-no" title="statement not covered" >var g=ASN1HEX.getDecendantIndexByNthList(f,0,[1,0,1,0,0,2,0,3]);<span class="cstat-no" title="statement not covered" >i</span>f(f.substr(g,2)==="a0"){<span class="cstat-no" title="statement not covered" >a.nextUpdate=hextoutf8(ASN1HEX.getDecendantHexVByNthList(f,g,[0]))}</span>}</span>catch(d){}<span class="cstat-no" title="statement not covered" >r</span>eturn a}</span>;
/*! base64x-1.1.9 (c) 2012-2017 Kenji Urushima | kjur.github.com/jsrsasign/license
 */
var KJUR;<span class="missing-if-branch" title="if path not taken" >I</span>if(typeof KJUR=="undefined"||!KJUR){<span class="cstat-no" title="statement not covered" >KJUR={}}<span class="missing-if-branch" title="else path not taken" >E</span></span>if(typeof KJUR.lang=="undefined"||<span class="branch-1 cbranch-no" title="branch not covered" >!KJUR.lang)</span>{KJUR.lang={}}KJUR.lang.String=<span class="fstat-no" title="function not covered" >function(){</span>};<span class="fstat-no" title="function not covered" >function Base64x(){</span>}<span class="fstat-no" title="function not covered" >function stoBA(d){<span class="cstat-no" title="statement not covered" ></span>var b=new Array();<span class="cstat-no" title="statement not covered" >f</span>or(var c=0;c&lt;d.length;c++){<span class="cstat-no" title="statement not covered" >b[c]=d.charCodeAt(c)}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn b}<span class="fstat-no" title="function not covered" ></span>function BAtos(b){<span class="cstat-no" title="statement not covered" ></span>var d="";<span class="cstat-no" title="statement not covered" >f</span>or(var c=0;c&lt;b.length;c++){<span class="cstat-no" title="statement not covered" >d=d+String.fromCharCode(b[c])}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn d}<span class="fstat-no" title="function not covered" ></span>function BAtohex(b){<span class="cstat-no" title="statement not covered" ></span>var e="";<span class="cstat-no" title="statement not covered" >f</span>or(var d=0;d&lt;b.length;d++){<span class="cstat-no" title="statement not covered" >var c=b[d].toString(16);<span class="cstat-no" title="statement not covered" >i</span>f(c.length==1){<span class="cstat-no" title="statement not covered" >c="0"+c}<span class="cstat-no" title="statement not covered" ></span>e</span>=e+c}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn e}<span class="fstat-no" title="function not covered" ></span>function stohex(a){<span class="cstat-no" title="statement not covered" ></span>return BAtohex(stoBA(a))}<span class="fstat-no" title="function not covered" ></span>function stob64(a){<span class="cstat-no" title="statement not covered" ></span>return hex2b64(stohex(a))}<span class="fstat-no" title="function not covered" ></span>function stob64u(a){<span class="cstat-no" title="statement not covered" ></span>return b64tob64u(hex2b64(stohex(a)))}<span class="fstat-no" title="function not covered" ></span>function b64utos(a){<span class="cstat-no" title="statement not covered" ></span>return BAtos(b64toBA(b64utob64(a)))}<span class="fstat-no" title="function not covered" ></span>function b64tob64u(a){<span class="cstat-no" title="statement not covered" ></span>a=a.replace(/\=/g,"");<span class="cstat-no" title="statement not covered" >a</span>=a.replace(/\+/g,"-");<span class="cstat-no" title="statement not covered" >a</span>=a.replace(/\//g,"_");<span class="cstat-no" title="statement not covered" >r</span>eturn a}<span class="fstat-no" title="function not covered" ></span>function b64utob64(a){<span class="cstat-no" title="statement not covered" ></span>if(a.length%4==2){<span class="cstat-no" title="statement not covered" >a=a+"=="}</span>else{<span class="cstat-no" title="statement not covered" >if(a.length%4==3){<span class="cstat-no" title="statement not covered" >a=a+"="}</span>}<span class="cstat-no" title="statement not covered" ></span>a</span>=a.replace(/-/g,"+");<span class="cstat-no" title="statement not covered" >a</span>=a.replace(/_/g,"/");<span class="cstat-no" title="statement not covered" >r</span>eturn a}<span class="fstat-no" title="function not covered" ></span>function hextob64u(a){<span class="cstat-no" title="statement not covered" ></span>if(a.length%2==1){<span class="cstat-no" title="statement not covered" >a="0"+a}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn b64tob64u(hex2b64(a))}<span class="fstat-no" title="function not covered" ></span>function b64utohex(a){<span class="cstat-no" title="statement not covered" ></span>return b64tohex(b64utob64(a))}</span>var utf8tob64u,b64utoutf8;<span class="missing-if-branch" title="else path not taken" >E</span>if(typeof Buffer==="function"){utf8tob64u=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>return b64tob64u(new Buffer(a,"utf8").toString("base64"))}</span>;b64utoutf8=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>return new Buffer(b64utob64(a),"base64").toString("utf8")}</span>}else{<span class="cstat-no" title="statement not covered" >utf8tob64u=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>return hextob64u(uricmptohex(encodeURIComponentAll(a)))}</span>;<span class="cstat-no" title="statement not covered" >b</span>64utoutf8=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>return decodeURIComponent(hextouricmp(b64utohex(a)))}</span>}<span class="fstat-no" title="function not covered" ></span>function utf8tob64(a){<span class="cstat-no" title="statement not covered" ></span>return hex2b64(uricmptohex(encodeURIComponentAll(a)))}<span class="fstat-no" title="function not covered" ></span>function b64toutf8(a){<span class="cstat-no" title="statement not covered" ></span>return decodeURIComponent(hextouricmp(b64tohex(a)))}<span class="fstat-no" title="function not covered" ></span>function utf8tohex(a){<span class="cstat-no" title="statement not covered" ></span>return uricmptohex(encodeURIComponentAll(a))}<span class="fstat-no" title="function not covered" ></span>function hextoutf8(a){<span class="cstat-no" title="statement not covered" ></span>return decodeURIComponent(hextouricmp(a))}<span class="fstat-no" title="function not covered" ></span>function hextorstr(c){<span class="cstat-no" title="statement not covered" ></span>var b="";<span class="cstat-no" title="statement not covered" >f</span>or(var a=0;a&lt;c.length-1;a+=2){<span class="cstat-no" title="statement not covered" >b+=String.fromCharCode(parseInt(c.substr(a,2),16))}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn b}<span class="fstat-no" title="function not covered" ></span>function rstrtohex(c){<span class="cstat-no" title="statement not covered" ></span>var a="";<span class="cstat-no" title="statement not covered" >f</span>or(var b=0;b&lt;c.length;b++){<span class="cstat-no" title="statement not covered" >a+=("0"+c.charCodeAt(b).toString(16)).slice(-2)}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn a}<span class="fstat-no" title="function not covered" ></span>function hextob64(a){<span class="cstat-no" title="statement not covered" ></span>return hex2b64(a)}<span class="fstat-no" title="function not covered" ></span>function hextob64nl(b){<span class="cstat-no" title="statement not covered" ></span>var a=hextob64(b);<span class="cstat-no" title="statement not covered" >v</span>ar c=a.replace(/(.{64})/g,"$1\r\n");<span class="cstat-no" title="statement not covered" >c</span>=c.replace(/\r\n$/,"");<span class="cstat-no" title="statement not covered" >r</span>eturn c}<span class="fstat-no" title="function not covered" ></span>function b64nltohex(b){<span class="cstat-no" title="statement not covered" ></span>var a=b.replace(/[^0-9A-Za-z\/+=]*/g,"");<span class="cstat-no" title="statement not covered" >v</span>ar c=b64tohex(a);<span class="cstat-no" title="statement not covered" >r</span>eturn c}<span class="fstat-no" title="function not covered" ></span>function hextoArrayBuffer(d){<span class="cstat-no" title="statement not covered" ></span>if(d.length%2!=0){<span class="cstat-no" title="statement not covered" >throw"input is not even length"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(d.match(/^[0-9A-Fa-f]+$/)==null){<span class="cstat-no" title="statement not covered" >throw"input is not hexadecimal"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar b=new ArrayBuffer(d.length/2);<span class="cstat-no" title="statement not covered" >v</span>ar a=new DataView(b);<span class="cstat-no" title="statement not covered" >f</span>or(var c=0;c&lt;d.length/2;c++){<span class="cstat-no" title="statement not covered" >a.setUint8(c,parseInt(d.substr(c*2,2),16))}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn b}<span class="fstat-no" title="function not covered" ></span>function ArrayBuffertohex(b){<span class="cstat-no" title="statement not covered" ></span>var d="";<span class="cstat-no" title="statement not covered" >v</span>ar a=new DataView(b);<span class="cstat-no" title="statement not covered" >f</span>or(var c=0;c&lt;b.byteLength;c++){<span class="cstat-no" title="statement not covered" >d+=("00"+a.getUint8(c).toString(16)).slice(-2)}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn d}<span class="fstat-no" title="function not covered" ></span>function zulutomsec(n){<span class="cstat-no" title="statement not covered" ></span>var l,j,m,e,f,i,b,k;<span class="cstat-no" title="statement not covered" >v</span>ar a,h,g,c;<span class="cstat-no" title="statement not covered" >c</span>=n.match(/^(\d{2}|\d{4})(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(|\.\d+)Z$/);<span class="cstat-no" title="statement not covered" >i</span>f(c){<span class="cstat-no" title="statement not covered" >a=c[1];<span class="cstat-no" title="statement not covered" >l</span>=parseInt(a);<span class="cstat-no" title="statement not covered" >i</span>f(a.length===2){<span class="cstat-no" title="statement not covered" >if(50&lt;=l&amp;&amp;l&lt;100){<span class="cstat-no" title="statement not covered" >l=1900+l}</span>else{<span class="cstat-no" title="statement not covered" >if(0&lt;=l&amp;&amp;l&lt;50){<span class="cstat-no" title="statement not covered" >l=2000+l}</span>}</span>}<span class="cstat-no" title="statement not covered" ></span>j</span>=parseInt(c[2])-1;<span class="cstat-no" title="statement not covered" >m</span>=parseInt(c[3]);<span class="cstat-no" title="statement not covered" >e</span>=parseInt(c[4]);<span class="cstat-no" title="statement not covered" >f</span>=parseInt(c[5]);<span class="cstat-no" title="statement not covered" >i</span>=parseInt(c[6]);<span class="cstat-no" title="statement not covered" >b</span>=0;<span class="cstat-no" title="statement not covered" >h</span>=c[7];<span class="cstat-no" title="statement not covered" >i</span>f(h!==""){<span class="cstat-no" title="statement not covered" >g=(h.substr(1)+"00").substr(0,3);<span class="cstat-no" title="statement not covered" >b</span>=parseInt(g)}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn Date.UTC(l,j,m,e,f,i,b)}<span class="cstat-no" title="statement not covered" ></span>t</span>hrow"unsupported zulu format: "+n}<span class="fstat-no" title="function not covered" ></span>function zulutosec(a){<span class="cstat-no" title="statement not covered" ></span>var b=zulutomsec(a);<span class="cstat-no" title="statement not covered" >r</span>eturn ~~(b/1000)}<span class="fstat-no" title="function not covered" ></span>function zulutodate(a){<span class="cstat-no" title="statement not covered" ></span>return new Date(zulutomsec(a))}<span class="fstat-no" title="function not covered" ></span>function uricmptohex(a){<span class="cstat-no" title="statement not covered" ></span>return a.replace(/%/g,"")}<span class="fstat-no" title="function not covered" ></span>function hextouricmp(a){<span class="cstat-no" title="statement not covered" ></span>return a.replace(/(..)/g,"%$1")}<span class="fstat-no" title="function not covered" ></span>function encodeURIComponentAll(a){<span class="cstat-no" title="statement not covered" ></span>var d=encodeURIComponent(a);<span class="cstat-no" title="statement not covered" >v</span>ar b="";<span class="cstat-no" title="statement not covered" >f</span>or(var c=0;c&lt;d.length;c++){<span class="cstat-no" title="statement not covered" >if(d[c]=="%"){<span class="cstat-no" title="statement not covered" >b=b+d.substr(c,3);<span class="cstat-no" title="statement not covered" >c</span>=c+2}</span>else{<span class="cstat-no" title="statement not covered" >b=b+"%"+stohex(d[c])}</span>}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn b}<span class="fstat-no" title="function not covered" ></span>function newline_toUnix(a){<span class="cstat-no" title="statement not covered" ></span>a=a.replace(/\r\n/mg,"\n");<span class="cstat-no" title="statement not covered" >r</span>eturn a}<span class="fstat-no" title="function not covered" ></span>function newline_toDos(a){<span class="cstat-no" title="statement not covered" ></span>a=a.replace(/\r\n/mg,"\n");<span class="cstat-no" title="statement not covered" >a</span>=a.replace(/\n/mg,"\r\n");<span class="cstat-no" title="statement not covered" >r</span>eturn a}</span>KJUR.lang.String.isInteger=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>if(a.match(/^[0-9]+$/)){<span class="cstat-no" title="statement not covered" >return true}</span>else{<span class="cstat-no" title="statement not covered" >if(a.match(/^-[0-9]+$/)){<span class="cstat-no" title="statement not covered" >return true}</span>else{<span class="cstat-no" title="statement not covered" >return false}</span>}</span>}</span>;KJUR.lang.String.isHex=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>if(a.length%2==0&amp;&amp;(a.match(/^[0-9a-f]+$/)||a.match(/^[0-9A-F]+$/))){<span class="cstat-no" title="statement not covered" >return true}</span>else{<span class="cstat-no" title="statement not covered" >return false}</span>}</span>;KJUR.lang.String.isBase64=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>a=a.replace(/\s+/g,"");<span class="cstat-no" title="statement not covered" >i</span>f(a.match(/^[0-9A-Za-z+\/]+={0,3}$/)&amp;&amp;a.length%4==0){<span class="cstat-no" title="statement not covered" >return true}</span>else{<span class="cstat-no" title="statement not covered" >return false}</span>}</span>;KJUR.lang.String.isBase64URL=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>if(a.match(/[+/=]/)){<span class="cstat-no" title="statement not covered" >return false}<span class="cstat-no" title="statement not covered" ></span>a</span>=b64utob64(a);<span class="cstat-no" title="statement not covered" >r</span>eturn KJUR.lang.String.isBase64(a)}</span>;KJUR.lang.String.isIntegerArray=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>a=a.replace(/\s+/g,"");<span class="cstat-no" title="statement not covered" >i</span>f(a.match(/^\[[0-9,]+\]$/)){<span class="cstat-no" title="statement not covered" >return true}</span>else{<span class="cstat-no" title="statement not covered" >return false}</span>}</span>;<span class="fstat-no" title="function not covered" >function intarystrtohex(b){<span class="cstat-no" title="statement not covered" ></span>b=b.replace(/^\s*\[\s*/,"");<span class="cstat-no" title="statement not covered" >b</span>=b.replace(/\s*\]\s*$/,"");<span class="cstat-no" title="statement not covered" >b</span>=b.replace(/\s*/g,"");<span class="cstat-no" title="statement not covered" >t</span>ry{<span class="cstat-no" title="statement not covered" >var c=b.split(/,/).map(<span class="fstat-no" title="function not covered" >function(g,e,h){<span class="cstat-no" title="statement not covered" ></span>var f=parseInt(g);<span class="cstat-no" title="statement not covered" >i</span>f(f&lt;0||255&lt;f){<span class="cstat-no" title="statement not covered" >throw"integer not in range 0-255"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar d=("00"+f.toString(16)).slice(-2);<span class="cstat-no" title="statement not covered" >r</span>eturn d}</span>).join("");<span class="cstat-no" title="statement not covered" >r</span>eturn c}</span>catch(a){<span class="cstat-no" title="statement not covered" >throw"malformed integer array string: "+a}</span>}</span>var strdiffidx=<span class="fstat-no" title="function not covered" >function(c,a){<span class="cstat-no" title="statement not covered" ></span>var d=c.length;<span class="cstat-no" title="statement not covered" >i</span>f(c.length&gt;a.length){<span class="cstat-no" title="statement not covered" >d=a.length}<span class="cstat-no" title="statement not covered" ></span>f</span>or(var b=0;b&lt;d;b++){<span class="cstat-no" title="statement not covered" >if(c.charCodeAt(b)!=a.charCodeAt(b)){<span class="cstat-no" title="statement not covered" >return b}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(c.length!=a.length){<span class="cstat-no" title="statement not covered" >return d}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn -1}</span>;
/*! crypto-1.1.12.js (c) 2013-2017 Kenji Urushima | kjur.github.com/jsrsasign/license
 */
<span class="missing-if-branch" title="if path not taken" >I</span>if(typeof KJUR=="undefined"||!KJUR){<span class="cstat-no" title="statement not covered" >KJUR={}}<span class="missing-if-branch" title="else path not taken" >E</span></span>if(typeof KJUR.crypto=="undefined"||<span class="branch-1 cbranch-no" title="branch not covered" >!KJUR.crypto)</span>{KJUR.crypto={}}KJUR.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414",};this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa",};this.CRYPTOJSMESSAGEDIGESTNAME={md5:CryptoJS.algo.MD5,sha1:CryptoJS.algo.SHA1,sha224:CryptoJS.algo.SHA224,sha256:CryptoJS.algo.SHA256,sha384:CryptoJS.algo.SHA384,sha512:CryptoJS.algo.SHA512,ripemd160:CryptoJS.algo.RIPEMD160};this.getDigestInfoHex=<span class="fstat-no" title="function not covered" >function(a,b){<span class="cstat-no" title="statement not covered" ></span>if(typeof this.DIGESTINFOHEAD[b]=="undefined"){<span class="cstat-no" title="statement not covered" >throw"alg not supported in Util.DIGESTINFOHEAD: "+b}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn this.DIGESTINFOHEAD[b]+a}</span>;this.getPaddedDigestInfoHex=<span class="fstat-no" title="function not covered" >function(h,a,j){<span class="cstat-no" title="statement not covered" ></span>var c=this.getDigestInfoHex(h,a);<span class="cstat-no" title="statement not covered" >v</span>ar d=j/4;<span class="cstat-no" title="statement not covered" >i</span>f(c.length+22&gt;d){<span class="cstat-no" title="statement not covered" >throw"key is too short for SigAlg: keylen="+j+","+a}<span class="cstat-no" title="statement not covered" ></span>v</span>ar b="0001";<span class="cstat-no" title="statement not covered" >v</span>ar k="00"+c;<span class="cstat-no" title="statement not covered" >v</span>ar g="";<span class="cstat-no" title="statement not covered" >v</span>ar l=d-b.length-k.length;<span class="cstat-no" title="statement not covered" >f</span>or(var f=0;f&lt;l;f+=2){<span class="cstat-no" title="statement not covered" >g+="ff"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar e=b+g+k;<span class="cstat-no" title="statement not covered" >r</span>eturn e}</span>;this.hashString=<span class="fstat-no" title="function not covered" >function(a,c){<span class="cstat-no" title="statement not covered" ></span>var b=new KJUR.crypto.MessageDigest({alg:c});<span class="cstat-no" title="statement not covered" >r</span>eturn b.digestString(a)}</span>;this.hashHex=<span class="fstat-no" title="function not covered" >function(b,c){<span class="cstat-no" title="statement not covered" ></span>var a=new KJUR.crypto.MessageDigest({alg:c});<span class="cstat-no" title="statement not covered" >r</span>eturn a.digestHex(b)}</span>;this.sha1=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>var b=new KJUR.crypto.MessageDigest({alg:"sha1",prov:"cryptojs"});<span class="cstat-no" title="statement not covered" >r</span>eturn b.digestString(a)}</span>;this.sha256=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>var b=new KJUR.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"});<span class="cstat-no" title="statement not covered" >r</span>eturn b.digestString(a)}</span>;this.sha256Hex=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>var b=new KJUR.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"});<span class="cstat-no" title="statement not covered" >r</span>eturn b.digestHex(a)}</span>;this.sha512=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>var b=new KJUR.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"});<span class="cstat-no" title="statement not covered" >r</span>eturn b.digestString(a)}</span>;this.sha512Hex=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>var b=new KJUR.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"});<span class="cstat-no" title="statement not covered" >r</span>eturn b.digestHex(a)}</span>};KJUR.crypto.Util.md5=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>var b=new KJUR.crypto.MessageDigest({alg:"md5",prov:"cryptojs"});<span class="cstat-no" title="statement not covered" >r</span>eturn b.digestString(a)}</span>;KJUR.crypto.Util.ripemd160=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>var b=new KJUR.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"});<span class="cstat-no" title="statement not covered" >r</span>eturn b.digestString(a)}</span>;KJUR.crypto.Util.SECURERANDOMGEN=new SecureRandom();KJUR.crypto.Util.getRandomHexOfNbytes=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>var a=new Array(b);<span class="cstat-no" title="statement not covered" >K</span>JUR.crypto.Util.SECURERANDOMGEN.nextBytes(a);<span class="cstat-no" title="statement not covered" >r</span>eturn BAtohex(a)}</span>;KJUR.crypto.Util.getRandomBigIntegerOfNbytes=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>return new BigInteger(KJUR.crypto.Util.getRandomHexOfNbytes(a),16)}</span>;KJUR.crypto.Util.getRandomHexOfNbits=<span class="fstat-no" title="function not covered" >function(d){<span class="cstat-no" title="statement not covered" ></span>var c=d%8;<span class="cstat-no" title="statement not covered" >v</span>ar a=(d-c)/8;<span class="cstat-no" title="statement not covered" >v</span>ar b=new Array(a+1);<span class="cstat-no" title="statement not covered" >K</span>JUR.crypto.Util.SECURERANDOMGEN.nextBytes(b);<span class="cstat-no" title="statement not covered" >b</span>[0]=(((255&lt;&lt;c)&amp;255)^255)&amp;b[0];<span class="cstat-no" title="statement not covered" >r</span>eturn BAtohex(b)}</span>;KJUR.crypto.Util.getRandomBigIntegerOfNbits=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>return new BigInteger(KJUR.crypto.Util.getRandomHexOfNbits(a),16)}</span>;KJUR.crypto.Util.getRandomBigIntegerZeroToMax=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>var a=b.bitLength();<span class="cstat-no" title="statement not covered" >w</span>hile(1){<span class="cstat-no" title="statement not covered" >var c=KJUR.crypto.Util.getRandomBigIntegerOfNbits(a);<span class="cstat-no" title="statement not covered" >i</span>f(b.compareTo(c)!=-1){<span class="cstat-no" title="statement not covered" >return c}</span>}</span>}</span>;KJUR.crypto.Util.getRandomBigIntegerMinToMax=<span class="fstat-no" title="function not covered" >function(e,b){<span class="cstat-no" title="statement not covered" ></span>var c=e.compareTo(b);<span class="cstat-no" title="statement not covered" >i</span>f(c==1){<span class="cstat-no" title="statement not covered" >throw"biMin is greater than biMax"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(c==0){<span class="cstat-no" title="statement not covered" >return e}<span class="cstat-no" title="statement not covered" ></span>v</span>ar a=b.subtract(e);<span class="cstat-no" title="statement not covered" >v</span>ar d=KJUR.crypto.Util.getRandomBigIntegerZeroToMax(a);<span class="cstat-no" title="statement not covered" >r</span>eturn d.add(e)}</span>;KJUR.crypto.MessageDigest=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>var b=null;<span class="cstat-no" title="statement not covered" >v</span>ar a=null;<span class="cstat-no" title="statement not covered" >v</span>ar d=null;<span class="cstat-no" title="statement not covered" >t</span>his.setAlgAndProvider=<span class="fstat-no" title="function not covered" >function(g,f){<span class="cstat-no" title="statement not covered" ></span>g=KJUR.crypto.MessageDigest.getCanonicalAlgName(g);<span class="cstat-no" title="statement not covered" >i</span>f(g!==null&amp;&amp;f===undefined){<span class="cstat-no" title="statement not covered" >f=KJUR.crypto.Util.DEFAULTPROVIDER[g]}<span class="cstat-no" title="statement not covered" ></span>i</span>f(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(g)!=-1&amp;&amp;f=="cryptojs"){<span class="cstat-no" title="statement not covered" >try{<span class="cstat-no" title="statement not covered" >this.md=KJUR.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[g].create()}</span>catch(e){<span class="cstat-no" title="statement not covered" >throw"setAlgAndProvider hash alg set fail alg="+g+"/"+e}<span class="cstat-no" title="statement not covered" ></span>t</span>his.updateString=<span class="fstat-no" title="function not covered" >function(h){<span class="cstat-no" title="statement not covered" ></span>this.md.update(h)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.updateHex=<span class="fstat-no" title="function not covered" >function(h){<span class="cstat-no" title="statement not covered" ></span>var i=CryptoJS.enc.Hex.parse(h);<span class="cstat-no" title="statement not covered" >t</span>his.md.update(i)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.digest=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var h=this.md.finalize();<span class="cstat-no" title="statement not covered" >r</span>eturn h.toString(CryptoJS.enc.Hex)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.digestString=<span class="fstat-no" title="function not covered" >function(h){<span class="cstat-no" title="statement not covered" ></span>this.updateString(h);<span class="cstat-no" title="statement not covered" >r</span>eturn this.digest()}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.digestHex=<span class="fstat-no" title="function not covered" >function(h){<span class="cstat-no" title="statement not covered" ></span>this.updateHex(h);<span class="cstat-no" title="statement not covered" >r</span>eturn this.digest()}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(":sha256:".indexOf(g)!=-1&amp;&amp;f=="sjcl"){<span class="cstat-no" title="statement not covered" >try{<span class="cstat-no" title="statement not covered" >this.md=new sjcl.hash.sha256()}</span>catch(e){<span class="cstat-no" title="statement not covered" >throw"setAlgAndProvider hash alg set fail alg="+g+"/"+e}<span class="cstat-no" title="statement not covered" ></span>t</span>his.updateString=<span class="fstat-no" title="function not covered" >function(h){<span class="cstat-no" title="statement not covered" ></span>this.md.update(h)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.updateHex=<span class="fstat-no" title="function not covered" >function(i){<span class="cstat-no" title="statement not covered" ></span>var h=sjcl.codec.hex.toBits(i);<span class="cstat-no" title="statement not covered" >t</span>his.md.update(h)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.digest=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var h=this.md.finalize();<span class="cstat-no" title="statement not covered" >r</span>eturn sjcl.codec.hex.fromBits(h)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.digestString=<span class="fstat-no" title="function not covered" >function(h){<span class="cstat-no" title="statement not covered" ></span>this.updateString(h);<span class="cstat-no" title="statement not covered" >r</span>eturn this.digest()}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.digestHex=<span class="fstat-no" title="function not covered" >function(h){<span class="cstat-no" title="statement not covered" ></span>this.updateHex(h);<span class="cstat-no" title="statement not covered" >r</span>eturn this.digest()}</span>}</span>}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.updateString=<span class="fstat-no" title="function not covered" >function(e){<span class="cstat-no" title="statement not covered" ></span>throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.updateHex=<span class="fstat-no" title="function not covered" >function(e){<span class="cstat-no" title="statement not covered" ></span>throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.digest=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.digestString=<span class="fstat-no" title="function not covered" >function(e){<span class="cstat-no" title="statement not covered" ></span>throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.digestHex=<span class="fstat-no" title="function not covered" >function(e){<span class="cstat-no" title="statement not covered" ></span>throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(c!==undefined){<span class="cstat-no" title="statement not covered" >if(c.alg!==undefined){<span class="cstat-no" title="statement not covered" >this.algName=c.alg;<span class="cstat-no" title="statement not covered" >i</span>f(c.prov===undefined){<span class="cstat-no" title="statement not covered" >this.provName=KJUR.crypto.Util.DEFAULTPROVIDER[this.algName]}<span class="cstat-no" title="statement not covered" ></span>t</span>his.setAlgAndProvider(this.algName,this.provName)}</span>}</span>}</span>;KJUR.crypto.MessageDigest.getCanonicalAlgName=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>if(typeof a==="string"){<span class="cstat-no" title="statement not covered" >a=a.toLowerCase();<span class="cstat-no" title="statement not covered" >a</span>=a.replace(/-/,"")}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn a}</span>;KJUR.crypto.MessageDigest.getHashLength=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>var b=KJUR.crypto.MessageDigest;<span class="cstat-no" title="statement not covered" >v</span>ar a=b.getCanonicalAlgName(c);<span class="cstat-no" title="statement not covered" >i</span>f(b.HASHLENGTH[a]===undefined){<span class="cstat-no" title="statement not covered" >throw"not supported algorithm: "+c}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn b.HASHLENGTH[a]}</span>;KJUR.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20};KJUR.crypto.Mac=<span class="fstat-no" title="function not covered" >function(d){<span class="cstat-no" title="statement not covered" ></span>var f=null;<span class="cstat-no" title="statement not covered" >v</span>ar c=null;<span class="cstat-no" title="statement not covered" >v</span>ar a=null;<span class="cstat-no" title="statement not covered" >v</span>ar e=null;<span class="cstat-no" title="statement not covered" >v</span>ar b=null;<span class="cstat-no" title="statement not covered" >t</span>his.setAlgAndProvider=<span class="fstat-no" title="function not covered" >function(k,i){<span class="cstat-no" title="statement not covered" ></span>k=k.toLowerCase();<span class="cstat-no" title="statement not covered" >i</span>f(k==null){<span class="cstat-no" title="statement not covered" >k="hmacsha1"}<span class="cstat-no" title="statement not covered" ></span>k</span>=k.toLowerCase();<span class="cstat-no" title="statement not covered" >i</span>f(k.substr(0,4)!="hmac"){<span class="cstat-no" title="statement not covered" >throw"setAlgAndProvider unsupported HMAC alg: "+k}<span class="cstat-no" title="statement not covered" ></span>i</span>f(i===undefined){<span class="cstat-no" title="statement not covered" >i=KJUR.crypto.Util.DEFAULTPROVIDER[k]}<span class="cstat-no" title="statement not covered" ></span>t</span>his.algProv=k+"/"+i;<span class="cstat-no" title="statement not covered" >v</span>ar g=k.substr(4);<span class="cstat-no" title="statement not covered" >i</span>f(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(g)!=-1&amp;&amp;i=="cryptojs"){<span class="cstat-no" title="statement not covered" >try{<span class="cstat-no" title="statement not covered" >var j=KJUR.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[g];<span class="cstat-no" title="statement not covered" >t</span>his.mac=CryptoJS.algo.HMAC.create(j,this.pass)}</span>catch(h){<span class="cstat-no" title="statement not covered" >throw"setAlgAndProvider hash alg set fail hashAlg="+g+"/"+h}<span class="cstat-no" title="statement not covered" ></span>t</span>his.updateString=<span class="fstat-no" title="function not covered" >function(l){<span class="cstat-no" title="statement not covered" ></span>this.mac.update(l)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.updateHex=<span class="fstat-no" title="function not covered" >function(l){<span class="cstat-no" title="statement not covered" ></span>var m=CryptoJS.enc.Hex.parse(l);<span class="cstat-no" title="statement not covered" >t</span>his.mac.update(m)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.doFinal=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var l=this.mac.finalize();<span class="cstat-no" title="statement not covered" >r</span>eturn l.toString(CryptoJS.enc.Hex)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.doFinalString=<span class="fstat-no" title="function not covered" >function(l){<span class="cstat-no" title="statement not covered" ></span>this.updateString(l);<span class="cstat-no" title="statement not covered" >r</span>eturn this.doFinal()}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.doFinalHex=<span class="fstat-no" title="function not covered" >function(l){<span class="cstat-no" title="statement not covered" ></span>this.updateHex(l);<span class="cstat-no" title="statement not covered" >r</span>eturn this.doFinal()}</span>}</span>}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.updateString=<span class="fstat-no" title="function not covered" >function(g){<span class="cstat-no" title="statement not covered" ></span>throw"updateString(str) not supported for this alg/prov: "+this.algProv}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.updateHex=<span class="fstat-no" title="function not covered" >function(g){<span class="cstat-no" title="statement not covered" ></span>throw"updateHex(hex) not supported for this alg/prov: "+this.algProv}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.doFinal=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>throw"digest() not supported for this alg/prov: "+this.algProv}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.doFinalString=<span class="fstat-no" title="function not covered" >function(g){<span class="cstat-no" title="statement not covered" ></span>throw"digestString(str) not supported for this alg/prov: "+this.algProv}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.doFinalHex=<span class="fstat-no" title="function not covered" >function(g){<span class="cstat-no" title="statement not covered" ></span>throw"digestHex(hex) not supported for this alg/prov: "+this.algProv}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setPassword=<span class="fstat-no" title="function not covered" >function(h){<span class="cstat-no" title="statement not covered" ></span>if(typeof h=="string"){<span class="cstat-no" title="statement not covered" >var g=h;<span class="cstat-no" title="statement not covered" >i</span>f(h.length%2==1||!h.match(/^[0-9A-Fa-f]+$/)){<span class="cstat-no" title="statement not covered" >g=rstrtohex(h)}<span class="cstat-no" title="statement not covered" ></span>t</span>his.pass=CryptoJS.enc.Hex.parse(g);<span class="cstat-no" title="statement not covered" >r</span>eturn}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof h!="object"){<span class="cstat-no" title="statement not covered" >throw"KJUR.crypto.Mac unsupported password type: "+h}<span class="cstat-no" title="statement not covered" ></span>v</span>ar g=null;<span class="cstat-no" title="statement not covered" >i</span>f(h.hex!==undefined){<span class="cstat-no" title="statement not covered" >if(h.hex.length%2!=0||!h.hex.match(/^[0-9A-Fa-f]+$/)){<span class="cstat-no" title="statement not covered" >throw"Mac: wrong hex password: "+h.hex}<span class="cstat-no" title="statement not covered" ></span>g</span>=h.hex}<span class="cstat-no" title="statement not covered" ></span>i</span>f(h.utf8!==undefined){<span class="cstat-no" title="statement not covered" >g=utf8tohex(h.utf8)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(h.rstr!==undefined){<span class="cstat-no" title="statement not covered" >g=rstrtohex(h.rstr)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(h.b64!==undefined){<span class="cstat-no" title="statement not covered" >g=b64tohex(h.b64)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(h.b64u!==undefined){<span class="cstat-no" title="statement not covered" >g=b64utohex(h.b64u)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(g==null){<span class="cstat-no" title="statement not covered" >throw"KJUR.crypto.Mac unsupported password type: "+h}<span class="cstat-no" title="statement not covered" ></span>t</span>his.pass=CryptoJS.enc.Hex.parse(g)}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(d!==undefined){<span class="cstat-no" title="statement not covered" >if(d.pass!==undefined){<span class="cstat-no" title="statement not covered" >this.setPassword(d.pass)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(d.alg!==undefined){<span class="cstat-no" title="statement not covered" >this.algName=d.alg;<span class="cstat-no" title="statement not covered" >i</span>f(d.prov===undefined){<span class="cstat-no" title="statement not covered" >this.provName=KJUR.crypto.Util.DEFAULTPROVIDER[this.algName]}<span class="cstat-no" title="statement not covered" ></span>t</span>his.setAlgAndProvider(this.algName,this.provName)}</span>}</span>}</span>;KJUR.crypto.Signature=<span class="fstat-no" title="function not covered" >function(o){<span class="cstat-no" title="statement not covered" ></span>var q=null;<span class="cstat-no" title="statement not covered" >v</span>ar n=null;<span class="cstat-no" title="statement not covered" >v</span>ar r=null;<span class="cstat-no" title="statement not covered" >v</span>ar c=null;<span class="cstat-no" title="statement not covered" >v</span>ar l=null;<span class="cstat-no" title="statement not covered" >v</span>ar d=null;<span class="cstat-no" title="statement not covered" >v</span>ar k=null;<span class="cstat-no" title="statement not covered" >v</span>ar h=null;<span class="cstat-no" title="statement not covered" >v</span>ar p=null;<span class="cstat-no" title="statement not covered" >v</span>ar e=null;<span class="cstat-no" title="statement not covered" >v</span>ar b=-1;<span class="cstat-no" title="statement not covered" >v</span>ar g=null;<span class="cstat-no" title="statement not covered" >v</span>ar j=null;<span class="cstat-no" title="statement not covered" >v</span>ar a=null;<span class="cstat-no" title="statement not covered" >v</span>ar i=null;<span class="cstat-no" title="statement not covered" >v</span>ar f=null;<span class="cstat-no" title="statement not covered" >t</span>his._setAlgNames=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var s=this.algName.match(/^(.+)with(.+)$/);<span class="cstat-no" title="statement not covered" >i</span>f(s){<span class="cstat-no" title="statement not covered" >this.mdAlgName=s[1].toLowerCase();<span class="cstat-no" title="statement not covered" >t</span>his.pubkeyAlgName=s[2].toLowerCase()}</span>}</span>;<span class="cstat-no" title="statement not covered" >t</span>his._zeroPaddingOfSignature=<span class="fstat-no" title="function not covered" >function(x,w){<span class="cstat-no" title="statement not covered" ></span>var v="";<span class="cstat-no" title="statement not covered" >v</span>ar t=w/4-x.length;<span class="cstat-no" title="statement not covered" >f</span>or(var u=0;u&lt;t;u++){<span class="cstat-no" title="statement not covered" >v=v+"0"}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn v+x}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setAlgAndProvider=<span class="fstat-no" title="function not covered" >function(u,t){<span class="cstat-no" title="statement not covered" ></span>this._setAlgNames();<span class="cstat-no" title="statement not covered" >i</span>f(t!="cryptojs/jsrsa"){<span class="cstat-no" title="statement not covered" >throw"provider not supported: "+t}<span class="cstat-no" title="statement not covered" ></span>i</span>f(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)!=-1){<span class="cstat-no" title="statement not covered" >try{<span class="cstat-no" title="statement not covered" >this.md=new KJUR.crypto.MessageDigest({alg:this.mdAlgName})}</span>catch(s){<span class="cstat-no" title="statement not covered" >throw"setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+s}<span class="cstat-no" title="statement not covered" ></span>t</span>his.init=<span class="fstat-no" title="function not covered" >function(w,x){<span class="cstat-no" title="statement not covered" ></span>var y=null;<span class="cstat-no" title="statement not covered" >t</span>ry{<span class="cstat-no" title="statement not covered" >if(x===undefined){<span class="cstat-no" title="statement not covered" >y=KEYUTIL.getKey(w)}</span>else{<span class="cstat-no" title="statement not covered" >y=KEYUTIL.getKey(w,x)}</span>}</span>catch(v){<span class="cstat-no" title="statement not covered" >throw"init failed:"+v}<span class="cstat-no" title="statement not covered" ></span>i</span>f(y.isPrivate===true){<span class="cstat-no" title="statement not covered" >this.prvKey=y;<span class="cstat-no" title="statement not covered" >t</span>his.state="SIGN"}</span>else{<span class="cstat-no" title="statement not covered" >if(y.isPublic===true){<span class="cstat-no" title="statement not covered" >this.pubKey=y;<span class="cstat-no" title="statement not covered" >t</span>his.state="VERIFY"}</span>else{<span class="cstat-no" title="statement not covered" >throw"init failed.:"+y}</span>}</span>}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.initSign=<span class="fstat-no" title="function not covered" >function(v){<span class="cstat-no" title="statement not covered" ></span>if(typeof v.ecprvhex=="string"&amp;&amp;typeof v.eccurvename=="string"){<span class="cstat-no" title="statement not covered" >this.ecprvhex=v.ecprvhex;<span class="cstat-no" title="statement not covered" >t</span>his.eccurvename=v.eccurvename}</span>else{<span class="cstat-no" title="statement not covered" >this.prvKey=v}<span class="cstat-no" title="statement not covered" ></span>t</span>his.state="SIGN"}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.initVerifyByPublicKey=<span class="fstat-no" title="function not covered" >function(v){<span class="cstat-no" title="statement not covered" ></span>if(typeof v.ecpubhex=="string"&amp;&amp;typeof v.eccurvename=="string"){<span class="cstat-no" title="statement not covered" >this.ecpubhex=v.ecpubhex;<span class="cstat-no" title="statement not covered" >t</span>his.eccurvename=v.eccurvename}</span>else{<span class="cstat-no" title="statement not covered" >if(v instanceof KJUR.crypto.ECDSA){<span class="cstat-no" title="statement not covered" >this.pubKey=v}</span>else{<span class="cstat-no" title="statement not covered" >if(v instanceof RSAKey){<span class="cstat-no" title="statement not covered" >this.pubKey=v}</span>}</span>}<span class="cstat-no" title="statement not covered" ></span>t</span>his.state="VERIFY"}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.initVerifyByCertificatePEM=<span class="fstat-no" title="function not covered" >function(v){<span class="cstat-no" title="statement not covered" ></span>var w=new X509();<span class="cstat-no" title="statement not covered" >w</span>.readCertPEM(v);<span class="cstat-no" title="statement not covered" >t</span>his.pubKey=w.subjectPublicKeyRSA;<span class="cstat-no" title="statement not covered" >t</span>his.state="VERIFY"}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.updateString=<span class="fstat-no" title="function not covered" >function(v){<span class="cstat-no" title="statement not covered" ></span>this.md.updateString(v)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.updateHex=<span class="fstat-no" title="function not covered" >function(v){<span class="cstat-no" title="statement not covered" ></span>this.md.updateHex(v)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.sign=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>this.sHashHex=this.md.digest();<span class="cstat-no" title="statement not covered" >i</span>f(typeof this.ecprvhex!="undefined"&amp;&amp;typeof this.eccurvename!="undefined"){<span class="cstat-no" title="statement not covered" >var v=new KJUR.crypto.ECDSA({curve:this.eccurvename});<span class="cstat-no" title="statement not covered" >t</span>his.hSign=v.signHex(this.sHashHex,this.ecprvhex)}</span>else{<span class="cstat-no" title="statement not covered" >if(this.prvKey instanceof RSAKey&amp;&amp;this.pubkeyAlgName=="rsaandmgf1"){<span class="cstat-no" title="statement not covered" >this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen)}</span>else{<span class="cstat-no" title="statement not covered" >if(this.prvKey instanceof RSAKey&amp;&amp;this.pubkeyAlgName=="rsa"){<span class="cstat-no" title="statement not covered" >this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName)}</span>else{<span class="cstat-no" title="statement not covered" >if(this.prvKey instanceof KJUR.crypto.ECDSA){<span class="cstat-no" title="statement not covered" >this.hSign=this.prvKey.signWithMessageHash(this.sHashHex)}</span>else{<span class="cstat-no" title="statement not covered" >if(this.prvKey instanceof KJUR.crypto.DSA){<span class="cstat-no" title="statement not covered" >this.hSign=this.prvKey.signWithMessageHash(this.sHashHex)}</span>else{<span class="cstat-no" title="statement not covered" >throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}</span>}</span>}</span>}</span>}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn this.hSign}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.signString=<span class="fstat-no" title="function not covered" >function(v){<span class="cstat-no" title="statement not covered" ></span>this.updateString(v);<span class="cstat-no" title="statement not covered" >r</span>eturn this.sign()}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.signHex=<span class="fstat-no" title="function not covered" >function(v){<span class="cstat-no" title="statement not covered" ></span>this.updateHex(v);<span class="cstat-no" title="statement not covered" >r</span>eturn this.sign()}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.verify=<span class="fstat-no" title="function not covered" >function(v){<span class="cstat-no" title="statement not covered" ></span>this.sHashHex=this.md.digest();<span class="cstat-no" title="statement not covered" >i</span>f(typeof this.ecpubhex!="undefined"&amp;&amp;typeof this.eccurvename!="undefined"){<span class="cstat-no" title="statement not covered" >var w=new KJUR.crypto.ECDSA({curve:this.eccurvename});<span class="cstat-no" title="statement not covered" >r</span>eturn w.verifyHex(this.sHashHex,v,this.ecpubhex)}</span>else{<span class="cstat-no" title="statement not covered" >if(this.pubKey instanceof RSAKey&amp;&amp;this.pubkeyAlgName=="rsaandmgf1"){<span class="cstat-no" title="statement not covered" >return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,v,this.mdAlgName,this.pssSaltLen)}</span>else{<span class="cstat-no" title="statement not covered" >if(this.pubKey instanceof RSAKey&amp;&amp;this.pubkeyAlgName=="rsa"){<span class="cstat-no" title="statement not covered" >return this.pubKey.verifyWithMessageHash(this.sHashHex,v)}</span>else{<span class="cstat-no" title="statement not covered" >if(this.pubKey instanceof KJUR.crypto.ECDSA){<span class="cstat-no" title="statement not covered" >return this.pubKey.verifyWithMessageHash(this.sHashHex,v)}</span>else{<span class="cstat-no" title="statement not covered" >if(this.pubKey instanceof KJUR.crypto.DSA){<span class="cstat-no" title="statement not covered" >return this.pubKey.verifyWithMessageHash(this.sHashHex,v)}</span>else{<span class="cstat-no" title="statement not covered" >throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}</span>}</span>}</span>}</span>}</span>}</span>}</span>}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.init=<span class="fstat-no" title="function not covered" >function(s,t){<span class="cstat-no" title="statement not covered" ></span>throw"init(key, pass) not supported for this alg:prov="+this.algProvName}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.initVerifyByPublicKey=<span class="fstat-no" title="function not covered" >function(s){<span class="cstat-no" title="statement not covered" ></span>throw"initVerifyByPublicKey(rsaPubKeyy) not supported for this alg:prov="+this.algProvName}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.initVerifyByCertificatePEM=<span class="fstat-no" title="function not covered" >function(s){<span class="cstat-no" title="statement not covered" ></span>throw"initVerifyByCertificatePEM(certPEM) not supported for this alg:prov="+this.algProvName}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.initSign=<span class="fstat-no" title="function not covered" >function(s){<span class="cstat-no" title="statement not covered" ></span>throw"initSign(prvKey) not supported for this alg:prov="+this.algProvName}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.updateString=<span class="fstat-no" title="function not covered" >function(s){<span class="cstat-no" title="statement not covered" ></span>throw"updateString(str) not supported for this alg:prov="+this.algProvName}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.updateHex=<span class="fstat-no" title="function not covered" >function(s){<span class="cstat-no" title="statement not covered" ></span>throw"updateHex(hex) not supported for this alg:prov="+this.algProvName}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.sign=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>throw"sign() not supported for this alg:prov="+this.algProvName}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.signString=<span class="fstat-no" title="function not covered" >function(s){<span class="cstat-no" title="statement not covered" ></span>throw"digestString(str) not supported for this alg:prov="+this.algProvName}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.signHex=<span class="fstat-no" title="function not covered" >function(s){<span class="cstat-no" title="statement not covered" ></span>throw"digestHex(hex) not supported for this alg:prov="+this.algProvName}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.verify=<span class="fstat-no" title="function not covered" >function(s){<span class="cstat-no" title="statement not covered" ></span>throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.initParams=o;<span class="cstat-no" title="statement not covered" >i</span>f(o!==undefined){<span class="cstat-no" title="statement not covered" >if(o.alg!==undefined){<span class="cstat-no" title="statement not covered" >this.algName=o.alg;<span class="cstat-no" title="statement not covered" >i</span>f(o.prov===undefined){<span class="cstat-no" title="statement not covered" >this.provName=KJUR.crypto.Util.DEFAULTPROVIDER[this.algName]}</span>else{<span class="cstat-no" title="statement not covered" >this.provName=o.prov}<span class="cstat-no" title="statement not covered" ></span>t</span>his.algProvName=this.algName+":"+this.provName;<span class="cstat-no" title="statement not covered" >t</span>his.setAlgAndProvider(this.algName,this.provName);<span class="cstat-no" title="statement not covered" >t</span>his._setAlgNames()}<span class="cstat-no" title="statement not covered" ></span>i</span>f(o.psssaltlen!==undefined){<span class="cstat-no" title="statement not covered" >this.pssSaltLen=o.psssaltlen}<span class="cstat-no" title="statement not covered" ></span>i</span>f(o.prvkeypem!==undefined){<span class="cstat-no" title="statement not covered" >if(o.prvkeypas!==undefined){<span class="cstat-no" title="statement not covered" >throw"both prvkeypem and prvkeypas parameters not supported"}</span>else{<span class="cstat-no" title="statement not covered" >try{<span class="cstat-no" title="statement not covered" >var q=new RSAKey();<span class="cstat-no" title="statement not covered" >q</span>.readPrivateKeyFromPEMString(o.prvkeypem);<span class="cstat-no" title="statement not covered" >t</span>his.initSign(q)}</span>catch(m){<span class="cstat-no" title="statement not covered" >throw"fatal error to load pem private key: "+m}</span>}</span>}</span>}</span>}</span>;KJUR.crypto.Cipher=<span class="fstat-no" title="function not covered" >function(a){</span>};KJUR.crypto.Cipher.encrypt=<span class="fstat-no" title="function not covered" >function(e,f,d){<span class="cstat-no" title="statement not covered" ></span>if(f instanceof RSAKey&amp;&amp;f.isPublic){<span class="cstat-no" title="statement not covered" >var c=KJUR.crypto.Cipher.getAlgByKeyAndName(f,d);<span class="cstat-no" title="statement not covered" >i</span>f(c==="RSA"){<span class="cstat-no" title="statement not covered" >return f.encrypt(e)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(c==="RSAOAEP"){<span class="cstat-no" title="statement not covered" >return f.encryptOAEP(e,"sha1")}<span class="cstat-no" title="statement not covered" ></span>v</span>ar b=c.match(/^RSAOAEP(\d+)$/);<span class="cstat-no" title="statement not covered" >i</span>f(b!==null){<span class="cstat-no" title="statement not covered" >return f.encryptOAEP(e,"sha"+b[1])}<span class="cstat-no" title="statement not covered" ></span>t</span>hrow"Cipher.encrypt: unsupported algorithm for RSAKey: "+d}</span>else{<span class="cstat-no" title="statement not covered" >throw"Cipher.encrypt: unsupported key or algorithm"}</span>}</span>;KJUR.crypto.Cipher.decrypt=<span class="fstat-no" title="function not covered" >function(e,f,d){<span class="cstat-no" title="statement not covered" ></span>if(f instanceof RSAKey&amp;&amp;f.isPrivate){<span class="cstat-no" title="statement not covered" >var c=KJUR.crypto.Cipher.getAlgByKeyAndName(f,d);<span class="cstat-no" title="statement not covered" >i</span>f(c==="RSA"){<span class="cstat-no" title="statement not covered" >return f.decrypt(e)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(c==="RSAOAEP"){<span class="cstat-no" title="statement not covered" >return f.decryptOAEP(e,"sha1")}<span class="cstat-no" title="statement not covered" ></span>v</span>ar b=c.match(/^RSAOAEP(\d+)$/);<span class="cstat-no" title="statement not covered" >i</span>f(b!==null){<span class="cstat-no" title="statement not covered" >return f.decryptOAEP(e,"sha"+b[1])}<span class="cstat-no" title="statement not covered" ></span>t</span>hrow"Cipher.decrypt: unsupported algorithm for RSAKey: "+d}</span>else{<span class="cstat-no" title="statement not covered" >throw"Cipher.decrypt: unsupported key or algorithm"}</span>}</span>;KJUR.crypto.Cipher.getAlgByKeyAndName=<span class="fstat-no" title="function not covered" >function(b,a){<span class="cstat-no" title="statement not covered" ></span>if(b instanceof RSAKey){<span class="cstat-no" title="statement not covered" >if(":RSA:RSAOAEP:RSAOAEP224:RSAOAEP256:RSAOAEP384:RSAOAEP512:".indexOf(a)!=-1){<span class="cstat-no" title="statement not covered" >return a}<span class="cstat-no" title="statement not covered" ></span>i</span>f(a===null||a===undefined){<span class="cstat-no" title="statement not covered" >return"RSA"}<span class="cstat-no" title="statement not covered" ></span>t</span>hrow"getAlgByKeyAndName: not supported algorithm name for RSAKey: "+a}<span class="cstat-no" title="statement not covered" ></span>t</span>hrow"getAlgByKeyAndName: not supported algorithm name: "+a}</span>;KJUR.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040023":"secp521r1","2b81040022":"secp384r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA",}};
/*! ecdsa-modified-1.1.0.js (c) Stephan Thomas, Kenji Urushima | github.com/bitcoinjs/bitcoinjs-lib/blob/master/LICENSE
 */
<span class="missing-if-branch" title="if path not taken" >I</span>if(typeof KJUR=="undefined"||!KJUR){<span class="cstat-no" title="statement not covered" >KJUR={}}<span class="missing-if-branch" title="if path not taken" >I</span></span>if(typeof KJUR.crypto=="undefined"||!KJUR.crypto){<span class="cstat-no" title="statement not covered" >KJUR.crypto={}}</span>KJUR.crypto.ECDSA=<span class="fstat-no" title="function not covered" >function(h){<span class="cstat-no" title="statement not covered" ></span>var e="secp256r1";<span class="cstat-no" title="statement not covered" >v</span>ar g=null;<span class="cstat-no" title="statement not covered" >v</span>ar b=null;<span class="cstat-no" title="statement not covered" >v</span>ar f=null;<span class="cstat-no" title="statement not covered" >v</span>ar a=new SecureRandom();<span class="cstat-no" title="statement not covered" >v</span>ar d=null;<span class="cstat-no" title="statement not covered" >t</span>his.type="EC";<span class="cstat-no" title="statement not covered" >t</span>his.isPrivate=false;<span class="cstat-no" title="statement not covered" >t</span>his.isPublic=false;<span class="fstat-no" title="function not covered" >f</span>unction c(s,o,r,n){<span class="cstat-no" title="statement not covered" ></span>var j=Math.max(o.bitLength(),n.bitLength());<span class="cstat-no" title="statement not covered" >v</span>ar t=s.add2D(r);<span class="cstat-no" title="statement not covered" >v</span>ar q=s.curve.getInfinity();<span class="cstat-no" title="statement not covered" >f</span>or(var p=j-1;p&gt;=0;--p){<span class="cstat-no" title="statement not covered" >q=q.twice2D();<span class="cstat-no" title="statement not covered" >q</span>.z=BigInteger.ONE;<span class="cstat-no" title="statement not covered" >i</span>f(o.testBit(p)){<span class="cstat-no" title="statement not covered" >if(n.testBit(p)){<span class="cstat-no" title="statement not covered" >q=q.add2D(t)}</span>else{<span class="cstat-no" title="statement not covered" >q=q.add2D(s)}</span>}</span>else{<span class="cstat-no" title="statement not covered" >if(n.testBit(p)){<span class="cstat-no" title="statement not covered" >q=q.add2D(r)}</span>}</span>}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn q}<span class="cstat-no" title="statement not covered" ></span>this.getBigRandom=<span class="fstat-no" title="function not covered" >function(i){<span class="cstat-no" title="statement not covered" ></span>return new BigInteger(i.bitLength(),a).mod(i.subtract(BigInteger.ONE)).add(BigInteger.ONE)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setNamedCurve=<span class="fstat-no" title="function not covered" >function(i){<span class="cstat-no" title="statement not covered" ></span>this.ecparams=KJUR.crypto.ECParameterDB.getByName(i);<span class="cstat-no" title="statement not covered" >t</span>his.prvKeyHex=null;<span class="cstat-no" title="statement not covered" >t</span>his.pubKeyHex=null;<span class="cstat-no" title="statement not covered" >t</span>his.curveName=i}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setPrivateKeyHex=<span class="fstat-no" title="function not covered" >function(i){<span class="cstat-no" title="statement not covered" ></span>this.isPrivate=true;<span class="cstat-no" title="statement not covered" >t</span>his.prvKeyHex=i}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setPublicKeyHex=<span class="fstat-no" title="function not covered" >function(i){<span class="cstat-no" title="statement not covered" ></span>this.isPublic=true;<span class="cstat-no" title="statement not covered" >t</span>his.pubKeyHex=i}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getPublicKeyXYHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var k=this.pubKeyHex;<span class="cstat-no" title="statement not covered" >i</span>f(k.substr(0,2)!=="04"){<span class="cstat-no" title="statement not covered" >throw"this method supports uncompressed format(04) only"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar j=this.ecparams.keylen/4;<span class="cstat-no" title="statement not covered" >i</span>f(k.length!==2+j*2){<span class="cstat-no" title="statement not covered" >throw"malformed public key hex length"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar i={};<span class="cstat-no" title="statement not covered" >i</span>.x=k.substr(2,j);<span class="cstat-no" title="statement not covered" >i</span>.y=k.substr(2+j);<span class="cstat-no" title="statement not covered" >r</span>eturn i}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getShortNISTPCurveName=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var i=this.curveName;<span class="cstat-no" title="statement not covered" >i</span>f(i==="secp256r1"||i==="NIST P-256"||i==="P-256"||i==="prime256v1"){<span class="cstat-no" title="statement not covered" >return"P-256"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(i==="secp384r1"||i==="NIST P-384"||i==="P-384"){<span class="cstat-no" title="statement not covered" >return"P-384"}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn null}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.generateKeyPairHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var k=this.ecparams.n;<span class="cstat-no" title="statement not covered" >v</span>ar n=this.getBigRandom(k);<span class="cstat-no" title="statement not covered" >v</span>ar l=this.ecparams.G.multiply(n);<span class="cstat-no" title="statement not covered" >v</span>ar q=l.getX().toBigInteger();<span class="cstat-no" title="statement not covered" >v</span>ar o=l.getY().toBigInteger();<span class="cstat-no" title="statement not covered" >v</span>ar i=this.ecparams.keylen/4;<span class="cstat-no" title="statement not covered" >v</span>ar m=("0000000000"+n.toString(16)).slice(-i);<span class="cstat-no" title="statement not covered" >v</span>ar r=("0000000000"+q.toString(16)).slice(-i);<span class="cstat-no" title="statement not covered" >v</span>ar p=("0000000000"+o.toString(16)).slice(-i);<span class="cstat-no" title="statement not covered" >v</span>ar j="04"+r+p;<span class="cstat-no" title="statement not covered" >t</span>his.setPrivateKeyHex(m);<span class="cstat-no" title="statement not covered" >t</span>his.setPublicKeyHex(j);<span class="cstat-no" title="statement not covered" >r</span>eturn{ecprvhex:m,ecpubhex:j}}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.signWithMessageHash=<span class="fstat-no" title="function not covered" >function(i){<span class="cstat-no" title="statement not covered" ></span>return this.signHex(i,this.prvKeyHex)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.signHex=<span class="fstat-no" title="function not covered" >function(o,j){<span class="cstat-no" title="statement not covered" ></span>var t=new BigInteger(j,16);<span class="cstat-no" title="statement not covered" >v</span>ar l=this.ecparams.n;<span class="cstat-no" title="statement not covered" >v</span>ar q=new BigInteger(o,16);<span class="cstat-no" title="statement not covered" >d</span>o{<span class="cstat-no" title="statement not covered" >var m=this.getBigRandom(l);<span class="cstat-no" title="statement not covered" >v</span>ar u=this.ecparams.G;<span class="cstat-no" title="statement not covered" >v</span>ar p=u.multiply(m);<span class="cstat-no" title="statement not covered" >v</span>ar i=p.getX().toBigInteger().mod(l)}</span>while(i.compareTo(BigInteger.ZERO)&lt;=0);<span class="cstat-no" title="statement not covered" >v</span>ar v=m.modInverse(l).multiply(q.add(t.multiply(i))).mod(l);<span class="cstat-no" title="statement not covered" >r</span>eturn KJUR.crypto.ECDSA.biRSSigToASN1Sig(i,v)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.sign=<span class="fstat-no" title="function not covered" >function(m,u){<span class="cstat-no" title="statement not covered" ></span>var q=u;<span class="cstat-no" title="statement not covered" >v</span>ar j=this.ecparams.n;<span class="cstat-no" title="statement not covered" >v</span>ar p=BigInteger.fromByteArrayUnsigned(m);<span class="cstat-no" title="statement not covered" >d</span>o{<span class="cstat-no" title="statement not covered" >var l=this.getBigRandom(j);<span class="cstat-no" title="statement not covered" >v</span>ar t=this.ecparams.G;<span class="cstat-no" title="statement not covered" >v</span>ar o=t.multiply(l);<span class="cstat-no" title="statement not covered" >v</span>ar i=o.getX().toBigInteger().mod(j)}</span>while(i.compareTo(BigInteger.ZERO)&lt;=0);<span class="cstat-no" title="statement not covered" >v</span>ar v=l.modInverse(j).multiply(p.add(q.multiply(i))).mod(j);<span class="cstat-no" title="statement not covered" >r</span>eturn this.serializeSig(i,v)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.verifyWithMessageHash=<span class="fstat-no" title="function not covered" >function(j,i){<span class="cstat-no" title="statement not covered" ></span>return this.verifyHex(j,i,this.pubKeyHex)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.verifyHex=<span class="fstat-no" title="function not covered" >function(m,i,p){<span class="cstat-no" title="statement not covered" ></span>var l,j;<span class="cstat-no" title="statement not covered" >v</span>ar o=KJUR.crypto.ECDSA.parseSigHex(i);<span class="cstat-no" title="statement not covered" >l</span>=o.r;<span class="cstat-no" title="statement not covered" >j</span>=o.s;<span class="cstat-no" title="statement not covered" >v</span>ar k;<span class="cstat-no" title="statement not covered" >k</span>=ECPointFp.decodeFromHex(this.ecparams.curve,p);<span class="cstat-no" title="statement not covered" >v</span>ar n=new BigInteger(m,16);<span class="cstat-no" title="statement not covered" >r</span>eturn this.verifyRaw(n,l,j,k)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.verify=<span class="fstat-no" title="function not covered" >function(o,p,j){<span class="cstat-no" title="statement not covered" ></span>var l,i;<span class="cstat-no" title="statement not covered" >i</span>f(Bitcoin.Util.isArray(p)){<span class="cstat-no" title="statement not covered" >var n=this.parseSig(p);<span class="cstat-no" title="statement not covered" >l</span>=n.r;<span class="cstat-no" title="statement not covered" >i</span>=n.s}</span>else{<span class="cstat-no" title="statement not covered" >if("object"===typeof p&amp;&amp;p.r&amp;&amp;p.s){<span class="cstat-no" title="statement not covered" >l=p.r;<span class="cstat-no" title="statement not covered" >i</span>=p.s}</span>else{<span class="cstat-no" title="statement not covered" >throw"Invalid value for signature"}</span>}<span class="cstat-no" title="statement not covered" ></span>v</span>ar k;<span class="cstat-no" title="statement not covered" >i</span>f(j instanceof ECPointFp){<span class="cstat-no" title="statement not covered" >k=j}</span>else{<span class="cstat-no" title="statement not covered" >if(Bitcoin.Util.isArray(j)){<span class="cstat-no" title="statement not covered" >k=ECPointFp.decodeFrom(this.ecparams.curve,j)}</span>else{<span class="cstat-no" title="statement not covered" >throw"Invalid format for pubkey value, must be byte array or ECPointFp"}</span>}<span class="cstat-no" title="statement not covered" ></span>v</span>ar m=BigInteger.fromByteArrayUnsigned(o);<span class="cstat-no" title="statement not covered" >r</span>eturn this.verifyRaw(m,l,i,k)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.verifyRaw=<span class="fstat-no" title="function not covered" >function(o,i,w,m){<span class="cstat-no" title="statement not covered" ></span>var l=this.ecparams.n;<span class="cstat-no" title="statement not covered" >v</span>ar u=this.ecparams.G;<span class="cstat-no" title="statement not covered" >i</span>f(i.compareTo(BigInteger.ONE)&lt;0||i.compareTo(l)&gt;=0){<span class="cstat-no" title="statement not covered" >return false}<span class="cstat-no" title="statement not covered" ></span>i</span>f(w.compareTo(BigInteger.ONE)&lt;0||w.compareTo(l)&gt;=0){<span class="cstat-no" title="statement not covered" >return false}<span class="cstat-no" title="statement not covered" ></span>v</span>ar p=w.modInverse(l);<span class="cstat-no" title="statement not covered" >v</span>ar k=o.multiply(p).mod(l);<span class="cstat-no" title="statement not covered" >v</span>ar j=i.multiply(p).mod(l);<span class="cstat-no" title="statement not covered" >v</span>ar q=u.multiply(k).add(m.multiply(j));<span class="cstat-no" title="statement not covered" >v</span>ar t=q.getX().toBigInteger().mod(l);<span class="cstat-no" title="statement not covered" >r</span>eturn t.equals(i)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.serializeSig=<span class="fstat-no" title="function not covered" >function(k,j){<span class="cstat-no" title="statement not covered" ></span>var l=k.toByteArraySigned();<span class="cstat-no" title="statement not covered" >v</span>ar i=j.toByteArraySigned();<span class="cstat-no" title="statement not covered" >v</span>ar m=[];<span class="cstat-no" title="statement not covered" >m</span>.push(2);<span class="cstat-no" title="statement not covered" >m</span>.push(l.length);<span class="cstat-no" title="statement not covered" >m</span>=m.concat(l);<span class="cstat-no" title="statement not covered" >m</span>.push(2);<span class="cstat-no" title="statement not covered" >m</span>.push(i.length);<span class="cstat-no" title="statement not covered" >m</span>=m.concat(i);<span class="cstat-no" title="statement not covered" >m</span>.unshift(m.length);<span class="cstat-no" title="statement not covered" >m</span>.unshift(48);<span class="cstat-no" title="statement not covered" >r</span>eturn m}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.parseSig=<span class="fstat-no" title="function not covered" >function(n){<span class="cstat-no" title="statement not covered" ></span>var m;<span class="cstat-no" title="statement not covered" >i</span>f(n[0]!=48){<span class="cstat-no" title="statement not covered" >throw new Error("Signature not a valid DERSequence")}<span class="cstat-no" title="statement not covered" ></span>m</span>=2;<span class="cstat-no" title="statement not covered" >i</span>f(n[m]!=2){<span class="cstat-no" title="statement not covered" >throw new Error("First element in signature must be a DERInteger")}<span class="cstat-no" title="statement not covered" ></span>v</span>ar l=n.slice(m+2,m+2+n[m+1]);<span class="cstat-no" title="statement not covered" >m</span>+=2+n[m+1];<span class="cstat-no" title="statement not covered" >i</span>f(n[m]!=2){<span class="cstat-no" title="statement not covered" >throw new Error("Second element in signature must be a DERInteger")}<span class="cstat-no" title="statement not covered" ></span>v</span>ar i=n.slice(m+2,m+2+n[m+1]);<span class="cstat-no" title="statement not covered" >m</span>+=2+n[m+1];<span class="cstat-no" title="statement not covered" >v</span>ar k=BigInteger.fromByteArrayUnsigned(l);<span class="cstat-no" title="statement not covered" >v</span>ar j=BigInteger.fromByteArrayUnsigned(i);<span class="cstat-no" title="statement not covered" >r</span>eturn{r:k,s:j}}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.parseSigCompact=<span class="fstat-no" title="function not covered" >function(m){<span class="cstat-no" title="statement not covered" ></span>if(m.length!==65){<span class="cstat-no" title="statement not covered" >throw"Signature has the wrong length"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar j=m[0]-27;<span class="cstat-no" title="statement not covered" >i</span>f(j&lt;0||j&gt;7){<span class="cstat-no" title="statement not covered" >throw"Invalid signature type"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar o=this.ecparams.n;<span class="cstat-no" title="statement not covered" >v</span>ar l=BigInteger.fromByteArrayUnsigned(m.slice(1,33)).mod(o);<span class="cstat-no" title="statement not covered" >v</span>ar k=BigInteger.fromByteArrayUnsigned(m.slice(33,65)).mod(o);<span class="cstat-no" title="statement not covered" >r</span>eturn{r:l,s:k,i:j}}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.readPKCS5PrvKeyHex=<span class="fstat-no" title="function not covered" >function(l){<span class="cstat-no" title="statement not covered" ></span>var n=ASN1HEX;<span class="cstat-no" title="statement not covered" >v</span>ar m=KJUR.crypto.ECDSA.getName;<span class="cstat-no" title="statement not covered" >v</span>ar p=n.getVbyList;<span class="cstat-no" title="statement not covered" >i</span>f(n.isASN1HEX(l)===false){<span class="cstat-no" title="statement not covered" >throw"not ASN.1 hex string"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar i,k,o;<span class="cstat-no" title="statement not covered" >t</span>ry{<span class="cstat-no" title="statement not covered" >i=p(l,0,[2,0],"06");<span class="cstat-no" title="statement not covered" >k</span>=p(l,0,[1],"04");<span class="cstat-no" title="statement not covered" >t</span>ry{<span class="cstat-no" title="statement not covered" >o=p(l,0,[3,0],"03").substr(2)}</span>catch(j){}}</span>catch(j){<span class="cstat-no" title="statement not covered" >throw"malformed PKCS#1/5 plain ECC private key"}<span class="cstat-no" title="statement not covered" ></span>t</span>his.curveName=m(i);<span class="cstat-no" title="statement not covered" >i</span>f(this.curveName===undefined){<span class="cstat-no" title="statement not covered" >throw"unsupported curve name"}<span class="cstat-no" title="statement not covered" ></span>t</span>his.setNamedCurve(this.curveName);<span class="cstat-no" title="statement not covered" >t</span>his.setPublicKeyHex(o);<span class="cstat-no" title="statement not covered" >t</span>his.setPrivateKeyHex(k);<span class="cstat-no" title="statement not covered" >t</span>his.isPublic=false}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.readPKCS8PrvKeyHex=<span class="fstat-no" title="function not covered" >function(l){<span class="cstat-no" title="statement not covered" ></span>var q=ASN1HEX;<span class="cstat-no" title="statement not covered" >v</span>ar i=KJUR.crypto.ECDSA.getName;<span class="cstat-no" title="statement not covered" >v</span>ar n=q.getVbyList;<span class="cstat-no" title="statement not covered" >i</span>f(q.isASN1HEX(l)===false){<span class="cstat-no" title="statement not covered" >throw"not ASN.1 hex string"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar j,p,m,k;<span class="cstat-no" title="statement not covered" >t</span>ry{<span class="cstat-no" title="statement not covered" >j=n(l,0,[1,0],"06");<span class="cstat-no" title="statement not covered" >p</span>=n(l,0,[1,1],"06");<span class="cstat-no" title="statement not covered" >m</span>=n(l,0,[2,0,1],"04");<span class="cstat-no" title="statement not covered" >t</span>ry{<span class="cstat-no" title="statement not covered" >k=n(l,0,[2,0,2,0],"03").substr(2)}</span>catch(o){}}</span>catch(o){<span class="cstat-no" title="statement not covered" >throw"malformed PKCS#8 plain ECC private key"}<span class="cstat-no" title="statement not covered" ></span>t</span>his.curveName=i(p);<span class="cstat-no" title="statement not covered" >i</span>f(this.curveName===undefined){<span class="cstat-no" title="statement not covered" >throw"unsupported curve name"}<span class="cstat-no" title="statement not covered" ></span>t</span>his.setNamedCurve(this.curveName);<span class="cstat-no" title="statement not covered" >t</span>his.setPublicKeyHex(k);<span class="cstat-no" title="statement not covered" >t</span>his.setPrivateKeyHex(m);<span class="cstat-no" title="statement not covered" >t</span>his.isPublic=false}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.readPKCS8PubKeyHex=<span class="fstat-no" title="function not covered" >function(l){<span class="cstat-no" title="statement not covered" ></span>var n=ASN1HEX;<span class="cstat-no" title="statement not covered" >v</span>ar m=KJUR.crypto.ECDSA.getName;<span class="cstat-no" title="statement not covered" >v</span>ar p=n.getVbyList;<span class="cstat-no" title="statement not covered" >i</span>f(n.isASN1HEX(l)===false){<span class="cstat-no" title="statement not covered" >throw"not ASN.1 hex string"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar k,i,o;<span class="cstat-no" title="statement not covered" >t</span>ry{<span class="cstat-no" title="statement not covered" >k=p(l,0,[0,0],"06");<span class="cstat-no" title="statement not covered" >i</span>=p(l,0,[0,1],"06");<span class="cstat-no" title="statement not covered" >o</span>=p(l,0,[1],"03").substr(2)}</span>catch(j){<span class="cstat-no" title="statement not covered" >throw"malformed PKCS#8 ECC public key"}<span class="cstat-no" title="statement not covered" ></span>t</span>his.curveName=m(i);<span class="cstat-no" title="statement not covered" >i</span>f(this.curveName===null){<span class="cstat-no" title="statement not covered" >throw"unsupported curve name"}<span class="cstat-no" title="statement not covered" ></span>t</span>his.setNamedCurve(this.curveName);<span class="cstat-no" title="statement not covered" >t</span>his.setPublicKeyHex(o)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.readCertPubKeyHex=<span class="fstat-no" title="function not covered" >function(k,p){<span class="cstat-no" title="statement not covered" ></span>if(p!==5){<span class="cstat-no" title="statement not covered" >p=6}<span class="cstat-no" title="statement not covered" ></span>v</span>ar m=ASN1HEX;<span class="cstat-no" title="statement not covered" >v</span>ar l=KJUR.crypto.ECDSA.getName;<span class="cstat-no" title="statement not covered" >v</span>ar o=m.getVbyList;<span class="cstat-no" title="statement not covered" >i</span>f(m.isASN1HEX(k)===false){<span class="cstat-no" title="statement not covered" >throw"not ASN.1 hex string"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar i,n;<span class="cstat-no" title="statement not covered" >t</span>ry{<span class="cstat-no" title="statement not covered" >i=o(k,0,[0,p,0,1],"06");<span class="cstat-no" title="statement not covered" >n</span>=o(k,0,[0,p,1],"03").substr(2)}</span>catch(j){<span class="cstat-no" title="statement not covered" >throw"malformed X.509 certificate ECC public key"}<span class="cstat-no" title="statement not covered" ></span>t</span>his.curveName=l(i);<span class="cstat-no" title="statement not covered" >i</span>f(this.curveName===null){<span class="cstat-no" title="statement not covered" >throw"unsupported curve name"}<span class="cstat-no" title="statement not covered" ></span>t</span>his.setNamedCurve(this.curveName);<span class="cstat-no" title="statement not covered" >t</span>his.setPublicKeyHex(n)}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(h!==undefined){<span class="cstat-no" title="statement not covered" >if(h.curve!==undefined){<span class="cstat-no" title="statement not covered" >this.curveName=h.curve}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(this.curveName===undefined){<span class="cstat-no" title="statement not covered" >this.curveName=e}<span class="cstat-no" title="statement not covered" ></span>t</span>his.setNamedCurve(this.curveName);<span class="cstat-no" title="statement not covered" >i</span>f(h!==undefined){<span class="cstat-no" title="statement not covered" >if(h.prv!==undefined){<span class="cstat-no" title="statement not covered" >this.setPrivateKeyHex(h.prv)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(h.pub!==undefined){<span class="cstat-no" title="statement not covered" >this.setPublicKeyHex(h.pub)}</span>}</span>}</span>;KJUR.crypto.ECDSA.parseSigHex=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>var b=KJUR.crypto.ECDSA.parseSigHexInHexRS(a);<span class="cstat-no" title="statement not covered" >v</span>ar d=new BigInteger(b.r,16);<span class="cstat-no" title="statement not covered" >v</span>ar c=new BigInteger(b.s,16);<span class="cstat-no" title="statement not covered" >r</span>eturn{r:d,s:c}}</span>;KJUR.crypto.ECDSA.parseSigHexInHexRS=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>if(c.substr(0,2)!="30"){<span class="cstat-no" title="statement not covered" >throw"signature is not a ASN.1 sequence"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar b=ASN1HEX.getPosArrayOfChildren_AtObj(c,0);<span class="cstat-no" title="statement not covered" >i</span>f(b.length!=2){<span class="cstat-no" title="statement not covered" >throw"number of signature ASN.1 sequence elements seem wrong"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar g=b[0];<span class="cstat-no" title="statement not covered" >v</span>ar f=b[1];<span class="cstat-no" title="statement not covered" >i</span>f(c.substr(g,2)!="02"){<span class="cstat-no" title="statement not covered" >throw"1st item of sequene of signature is not ASN.1 integer"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(c.substr(f,2)!="02"){<span class="cstat-no" title="statement not covered" >throw"2nd item of sequene of signature is not ASN.1 integer"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar e=ASN1HEX.getHexOfV_AtObj(c,g);<span class="cstat-no" title="statement not covered" >v</span>ar d=ASN1HEX.getHexOfV_AtObj(c,f);<span class="cstat-no" title="statement not covered" >r</span>eturn{r:e,s:d}}</span>;KJUR.crypto.ECDSA.asn1SigToConcatSig=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>var d=KJUR.crypto.ECDSA.parseSigHexInHexRS(c);<span class="cstat-no" title="statement not covered" >v</span>ar b=d.r;<span class="cstat-no" title="statement not covered" >v</span>ar a=d.s;<span class="cstat-no" title="statement not covered" >i</span>f(b.substr(0,2)=="00"&amp;&amp;(((b.length/2)*8)%(16*8))==8){<span class="cstat-no" title="statement not covered" >b=b.substr(2)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(a.substr(0,2)=="00"&amp;&amp;(((a.length/2)*8)%(16*8))==8){<span class="cstat-no" title="statement not covered" >a=a.substr(2)}<span class="cstat-no" title="statement not covered" ></span>i</span>f((((b.length/2)*8)%(16*8))!=0){<span class="cstat-no" title="statement not covered" >throw"unknown ECDSA sig r length error"}<span class="cstat-no" title="statement not covered" ></span>i</span>f((((a.length/2)*8)%(16*8))!=0){<span class="cstat-no" title="statement not covered" >throw"unknown ECDSA sig s length error"}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn b+a}</span>;KJUR.crypto.ECDSA.concatSigToASN1Sig=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>if((((a.length/2)*8)%(16*8))!=0){<span class="cstat-no" title="statement not covered" >throw"unknown ECDSA concatinated r-s sig  length error"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar c=a.substr(0,a.length/2);<span class="cstat-no" title="statement not covered" >v</span>ar b=a.substr(a.length/2);<span class="cstat-no" title="statement not covered" >r</span>eturn KJUR.crypto.ECDSA.hexRSSigToASN1Sig(c,b)}</span>;KJUR.crypto.ECDSA.hexRSSigToASN1Sig=<span class="fstat-no" title="function not covered" >function(b,a){<span class="cstat-no" title="statement not covered" ></span>var d=new BigInteger(b,16);<span class="cstat-no" title="statement not covered" >v</span>ar c=new BigInteger(a,16);<span class="cstat-no" title="statement not covered" >r</span>eturn KJUR.crypto.ECDSA.biRSSigToASN1Sig(d,c)}</span>;KJUR.crypto.ECDSA.biRSSigToASN1Sig=<span class="fstat-no" title="function not covered" >function(e,c){<span class="cstat-no" title="statement not covered" ></span>var b=new KJUR.asn1.DERInteger({bigint:e});<span class="cstat-no" title="statement not covered" >v</span>ar a=new KJUR.asn1.DERInteger({bigint:c});<span class="cstat-no" title="statement not covered" >v</span>ar d=new KJUR.asn1.DERSequence({array:[b,a]});<span class="cstat-no" title="statement not covered" >r</span>eturn d.getEncodedHex()}</span>;KJUR.crypto.ECDSA.getName=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>if(a==="2a8648ce3d030107"){<span class="cstat-no" title="statement not covered" >return"secp256r1"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(a==="2b8104000a"){<span class="cstat-no" title="statement not covered" >return"secp256k1"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(a==="2b81040022"){<span class="cstat-no" title="statement not covered" >return"secp384r1"}<span class="cstat-no" title="statement not covered" ></span>i</span>f("|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(a)!==-1){<span class="cstat-no" title="statement not covered" >return"secp256r1"}<span class="cstat-no" title="statement not covered" ></span>i</span>f("|secp256k1|".indexOf(a)!==-1){<span class="cstat-no" title="statement not covered" >return"secp256k1"}<span class="cstat-no" title="statement not covered" ></span>i</span>f("|secp384r1|NIST P-384|P-384|".indexOf(a)!==-1){<span class="cstat-no" title="statement not covered" >return"secp384r1"}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn null}</span>;
/*! ecparam-1.0.0.js (c) 2013 Kenji Urushima | kjur.github.com/jsrsasign/license
 */
<span class="missing-if-branch" title="if path not taken" >I</span>if(typeof KJUR=="undefined"||!KJUR){<span class="cstat-no" title="statement not covered" >KJUR={}}<span class="missing-if-branch" title="if path not taken" >I</span></span>if(typeof KJUR.crypto=="undefined"||!KJUR.crypto){<span class="cstat-no" title="statement not covered" >KJUR.crypto={}}</span>KJUR.crypto.ECParameterDB=new function(){var b={};var c={};function a(d){return new BigInteger(d,16)}this.getByName=<span class="fstat-no" title="function not covered" >function(e){<span class="cstat-no" title="statement not covered" ></span>var d=e;<span class="cstat-no" title="statement not covered" >i</span>f(typeof c[d]!="undefined"){<span class="cstat-no" title="statement not covered" >d=c[e]}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof b[d]!="undefined"){<span class="cstat-no" title="statement not covered" >return b[d]}<span class="cstat-no" title="statement not covered" ></span>t</span>hrow"unregistered EC curve name: "+d}</span>;this.regist=function(A,l,o,g,m,e,j,f,k,u,d,x){b[A]={};var s=a(o);var z=a(g);var y=a(m);var t=a(e);var w=a(j);var r=new ECCurveFp(s,z,y);var q=r.decodePointHex("04"+f+k);b[A]["name"]=A;b[A]["keylen"]=l;b[A]["curve"]=r;b[A]["G"]=q;b[A]["n"]=t;b[A]["h"]=w;b[A]["oid"]=d;b[A]["info"]=x;for(var v=0;v&lt;u.length;v++){c[u[v]]=A}}};KJUR.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field");KJUR.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field");KJUR.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field");KJUR.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]);KJUR.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]);KJUR.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]);KJUR.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]);KJUR.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]);KJUR.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]);KJUR.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]);
/*! dsa-2.1.0.js (c) 2016-2017 Kenji Urushimma | kjur.github.com/jsrsasign/license
 */
<span class="missing-if-branch" title="if path not taken" >I</span>if(typeof KJUR=="undefined"||!KJUR){<span class="cstat-no" title="statement not covered" >KJUR={}}<span class="missing-if-branch" title="if path not taken" >I</span></span>if(typeof KJUR.crypto=="undefined"||!KJUR.crypto){<span class="cstat-no" title="statement not covered" >KJUR.crypto={}}</span>KJUR.crypto.DSA=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>this.p=null;<span class="cstat-no" title="statement not covered" >t</span>his.q=null;<span class="cstat-no" title="statement not covered" >t</span>his.g=null;<span class="cstat-no" title="statement not covered" >t</span>his.y=null;<span class="cstat-no" title="statement not covered" >t</span>his.x=null;<span class="cstat-no" title="statement not covered" >t</span>his.type="DSA";<span class="cstat-no" title="statement not covered" >t</span>his.isPrivate=false;<span class="cstat-no" title="statement not covered" >t</span>his.isPublic=false;<span class="cstat-no" title="statement not covered" >t</span>his.setPrivate=<span class="fstat-no" title="function not covered" >function(d,c,b,e,a){<span class="cstat-no" title="statement not covered" ></span>this.isPrivate=true;<span class="cstat-no" title="statement not covered" >t</span>his.p=d;<span class="cstat-no" title="statement not covered" >t</span>his.q=c;<span class="cstat-no" title="statement not covered" >t</span>his.g=b;<span class="cstat-no" title="statement not covered" >t</span>his.y=e;<span class="cstat-no" title="statement not covered" >t</span>his.x=a}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setPrivateHex=<span class="fstat-no" title="function not covered" >function(d,b,f,i,j){<span class="cstat-no" title="statement not covered" ></span>var c,a,e,g,h;<span class="cstat-no" title="statement not covered" >c</span>=new BigInteger(d,16);<span class="cstat-no" title="statement not covered" >a</span>=new BigInteger(b,16);<span class="cstat-no" title="statement not covered" >e</span>=new BigInteger(f,16);<span class="cstat-no" title="statement not covered" >i</span>f(typeof i==="string"&amp;&amp;i.length&gt;1){<span class="cstat-no" title="statement not covered" >g=new BigInteger(i,16)}</span>else{<span class="cstat-no" title="statement not covered" >g=null}<span class="cstat-no" title="statement not covered" ></span>h</span>=new BigInteger(j,16);<span class="cstat-no" title="statement not covered" >t</span>his.setPrivate(c,a,e,g,h)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setPublic=<span class="fstat-no" title="function not covered" >function(c,b,a,d){<span class="cstat-no" title="statement not covered" ></span>this.isPublic=true;<span class="cstat-no" title="statement not covered" >t</span>his.p=c;<span class="cstat-no" title="statement not covered" >t</span>his.q=b;<span class="cstat-no" title="statement not covered" >t</span>his.g=a;<span class="cstat-no" title="statement not covered" >t</span>his.y=d;<span class="cstat-no" title="statement not covered" >t</span>his.x=null}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.setPublicHex=<span class="fstat-no" title="function not covered" >function(f,e,d,g){<span class="cstat-no" title="statement not covered" ></span>var b,a,h,c;<span class="cstat-no" title="statement not covered" >b</span>=new BigInteger(f,16);<span class="cstat-no" title="statement not covered" >a</span>=new BigInteger(e,16);<span class="cstat-no" title="statement not covered" >h</span>=new BigInteger(d,16);<span class="cstat-no" title="statement not covered" >c</span>=new BigInteger(g,16);<span class="cstat-no" title="statement not covered" >t</span>his.setPublic(b,a,h,c)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.signWithMessageHash=<span class="fstat-no" title="function not covered" >function(d){<span class="cstat-no" title="statement not covered" ></span>var c=this.p;<span class="cstat-no" title="statement not covered" >v</span>ar b=this.q;<span class="cstat-no" title="statement not covered" >v</span>ar f=this.g;<span class="cstat-no" title="statement not covered" >v</span>ar i=this.y;<span class="cstat-no" title="statement not covered" >v</span>ar j=this.x;<span class="cstat-no" title="statement not covered" >v</span>ar e=KJUR.crypto.Util.getRandomBigIntegerMinToMax(BigInteger.ONE.add(BigInteger.ONE),b.subtract(BigInteger.ONE));<span class="cstat-no" title="statement not covered" >v</span>ar l=d.substr(0,b.bitLength()/4);<span class="cstat-no" title="statement not covered" >v</span>ar h=new BigInteger(l,16);<span class="cstat-no" title="statement not covered" >v</span>ar a=(f.modPow(e,c)).mod(b);<span class="cstat-no" title="statement not covered" >v</span>ar n=(e.modInverse(b).multiply(h.add(j.multiply(a)))).mod(b);<span class="cstat-no" title="statement not covered" >v</span>ar m=KJUR.asn1.ASN1Util.jsonToASN1HEX({seq:[{"int":{bigint:a}},{"int":{bigint:n}}]});<span class="cstat-no" title="statement not covered" >r</span>eturn m}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.verifyWithMessageHash=<span class="fstat-no" title="function not covered" >function(h,f){<span class="cstat-no" title="statement not covered" ></span>var d=this.p;<span class="cstat-no" title="statement not covered" >v</span>ar b=this.q;<span class="cstat-no" title="statement not covered" >v</span>ar j=this.g;<span class="cstat-no" title="statement not covered" >v</span>ar l=this.y;<span class="cstat-no" title="statement not covered" >v</span>ar i=this.parseASN1Signature(f);<span class="cstat-no" title="statement not covered" >v</span>ar a=i[0];<span class="cstat-no" title="statement not covered" >v</span>ar t=i[1];<span class="cstat-no" title="statement not covered" >v</span>ar o=h.substr(0,b.bitLength()/4);<span class="cstat-no" title="statement not covered" >v</span>ar k=new BigInteger(o,16);<span class="cstat-no" title="statement not covered" >i</span>f(BigInteger.ZERO.compareTo(a)&gt;0||a.compareTo(b)&gt;0){<span class="cstat-no" title="statement not covered" >throw"invalid DSA signature"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(BigInteger.ZERO.compareTo(t)&gt;0||t.compareTo(b)&gt;0){<span class="cstat-no" title="statement not covered" >throw"invalid DSA signature"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar m=t.modInverse(b);<span class="cstat-no" title="statement not covered" >v</span>ar e=k.multiply(m).mod(b);<span class="cstat-no" title="statement not covered" >v</span>ar c=a.multiply(m).mod(b);<span class="cstat-no" title="statement not covered" >v</span>ar n=j.modPow(e,d).multiply(l.modPow(c,d)).mod(d).mod(b);<span class="cstat-no" title="statement not covered" >r</span>eturn n.compareTo(a)==0}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.parseASN1Signature=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>try{<span class="cstat-no" title="statement not covered" >var d=new BigInteger(ASN1HEX.getVbyList(a,0,[0],"02"),16);<span class="cstat-no" title="statement not covered" >v</span>ar c=new BigInteger(ASN1HEX.getVbyList(a,0,[1],"02"),16);<span class="cstat-no" title="statement not covered" >r</span>eturn[d,c]}</span>catch(b){<span class="cstat-no" title="statement not covered" >throw"malformed ASN.1 DSA signature"}</span>}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.readPKCS5PrvKeyHex=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>var b,a,f,g,i;<span class="cstat-no" title="statement not covered" >v</span>ar j=ASN1HEX;<span class="cstat-no" title="statement not covered" >v</span>ar d=j.getVbyList;<span class="cstat-no" title="statement not covered" >i</span>f(j.isASN1HEX(c)===false){<span class="cstat-no" title="statement not covered" >throw"not ASN.1 hex string"}<span class="cstat-no" title="statement not covered" ></span>t</span>ry{<span class="cstat-no" title="statement not covered" >b=d(c,0,[1],"02");<span class="cstat-no" title="statement not covered" >a</span>=d(c,0,[2],"02");<span class="cstat-no" title="statement not covered" >f</span>=d(c,0,[3],"02");<span class="cstat-no" title="statement not covered" >g</span>=d(c,0,[4],"02");<span class="cstat-no" title="statement not covered" >i</span>=d(c,0,[5],"02")}</span>catch(e){<span class="cstat-no" title="statement not covered" >console.log("EXCEPTION:"+e);<span class="cstat-no" title="statement not covered" >t</span>hrow"malformed PKCS#1/5 plain DSA private key"}<span class="cstat-no" title="statement not covered" ></span>t</span>his.setPrivateHex(b,a,f,g,i)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.readPKCS8PrvKeyHex=<span class="fstat-no" title="function not covered" >function(d){<span class="cstat-no" title="statement not covered" ></span>var f,c,b,g;<span class="cstat-no" title="statement not covered" >v</span>ar e=ASN1HEX;<span class="cstat-no" title="statement not covered" >v</span>ar i=e.getVbyList;<span class="cstat-no" title="statement not covered" >i</span>f(e.isASN1HEX(d)===false){<span class="cstat-no" title="statement not covered" >throw"not ASN.1 hex string"}<span class="cstat-no" title="statement not covered" ></span>t</span>ry{<span class="cstat-no" title="statement not covered" >f=i(d,0,[1,1,0],"02");<span class="cstat-no" title="statement not covered" >c</span>=i(d,0,[1,1,1],"02");<span class="cstat-no" title="statement not covered" >b</span>=i(d,0,[1,1,2],"02");<span class="cstat-no" title="statement not covered" >g</span>=i(d,0,[2,0],"02")}</span>catch(a){<span class="cstat-no" title="statement not covered" >console.log("EXCEPTION:"+a);<span class="cstat-no" title="statement not covered" >t</span>hrow"malformed PKCS#8 plain DSA private key"}<span class="cstat-no" title="statement not covered" ></span>t</span>his.setPrivateHex(f,c,b,null,g)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.readPKCS8PubKeyHex=<span class="fstat-no" title="function not covered" >function(d){<span class="cstat-no" title="statement not covered" ></span>var f,c,b,g;<span class="cstat-no" title="statement not covered" >v</span>ar e=ASN1HEX;<span class="cstat-no" title="statement not covered" >v</span>ar i=e.getVbyList;<span class="cstat-no" title="statement not covered" >i</span>f(e.isASN1HEX(d)===false){<span class="cstat-no" title="statement not covered" >throw"not ASN.1 hex string"}<span class="cstat-no" title="statement not covered" ></span>t</span>ry{<span class="cstat-no" title="statement not covered" >f=i(d,0,[0,1,0],"02");<span class="cstat-no" title="statement not covered" >c</span>=i(d,0,[0,1,1],"02");<span class="cstat-no" title="statement not covered" >b</span>=i(d,0,[0,1,2],"02");<span class="cstat-no" title="statement not covered" >g</span>=i(d,0,[1,0],"02")}</span>catch(a){<span class="cstat-no" title="statement not covered" >console.log("EXCEPTION:"+a);<span class="cstat-no" title="statement not covered" >t</span>hrow"malformed PKCS#8 DSA public key"}<span class="cstat-no" title="statement not covered" ></span>t</span>his.setPublicHex(f,c,b,g)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.readCertPubKeyHex=<span class="fstat-no" title="function not covered" >function(c,f){<span class="cstat-no" title="statement not covered" ></span>if(f!==5){<span class="cstat-no" title="statement not covered" >f=6}<span class="cstat-no" title="statement not covered" ></span>v</span>ar b,a,g,i;<span class="cstat-no" title="statement not covered" >v</span>ar j=ASN1HEX;<span class="cstat-no" title="statement not covered" >v</span>ar d=j.getVbyList;<span class="cstat-no" title="statement not covered" >i</span>f(j.isASN1HEX(c)===false){<span class="cstat-no" title="statement not covered" >throw"not ASN.1 hex string"}<span class="cstat-no" title="statement not covered" ></span>t</span>ry{<span class="cstat-no" title="statement not covered" >b=d(c,0,[0,f,0,1,0],"02");<span class="cstat-no" title="statement not covered" >a</span>=d(c,0,[0,f,0,1,1],"02");<span class="cstat-no" title="statement not covered" >g</span>=d(c,0,[0,f,0,1,2],"02");<span class="cstat-no" title="statement not covered" >i</span>=d(c,0,[0,f,1,0],"02")}</span>catch(e){<span class="cstat-no" title="statement not covered" >console.log("EXCEPTION:"+e);<span class="cstat-no" title="statement not covered" >t</span>hrow"malformed X.509 certificate DSA public key"}<span class="cstat-no" title="statement not covered" ></span>t</span>his.setPublicHex(b,a,g,i)}</span>}</span>;
/*! pkcs5pkey-1.1.0.js (c) 2013-2017 Kenji Urushima | kjur.github.com/jsrsasign/license
 */
var PKCS5PKEY=function(){var c=<span class="fstat-no" title="function not covered" >function(o,q,p){<span class="cstat-no" title="statement not covered" ></span>return j(CryptoJS.AES,o,q,p)}</span>;var d=<span class="fstat-no" title="function not covered" >function(o,q,p){<span class="cstat-no" title="statement not covered" ></span>return j(CryptoJS.TripleDES,o,q,p)}</span>;var j=<span class="fstat-no" title="function not covered" >function(r,w,t,p){<span class="cstat-no" title="statement not covered" ></span>var q=CryptoJS.enc.Hex.parse(w);<span class="cstat-no" title="statement not covered" >v</span>ar v=CryptoJS.enc.Hex.parse(t);<span class="cstat-no" title="statement not covered" >v</span>ar o=CryptoJS.enc.Hex.parse(p);<span class="cstat-no" title="statement not covered" >v</span>ar s={};<span class="cstat-no" title="statement not covered" >s</span>.key=v;<span class="cstat-no" title="statement not covered" >s</span>.iv=o;<span class="cstat-no" title="statement not covered" >s</span>.ciphertext=q;<span class="cstat-no" title="statement not covered" >v</span>ar u=r.decrypt(s,v,{iv:o});<span class="cstat-no" title="statement not covered" >r</span>eturn CryptoJS.enc.Hex.stringify(u)}</span>;var k=<span class="fstat-no" title="function not covered" >function(o,q,p){<span class="cstat-no" title="statement not covered" ></span>return e(CryptoJS.AES,o,q,p)}</span>;var n=<span class="fstat-no" title="function not covered" >function(o,q,p){<span class="cstat-no" title="statement not covered" ></span>return e(CryptoJS.TripleDES,o,q,p)}</span>;var e=<span class="fstat-no" title="function not covered" >function(t,y,w,q){<span class="cstat-no" title="statement not covered" ></span>var s=CryptoJS.enc.Hex.parse(y);<span class="cstat-no" title="statement not covered" >v</span>ar x=CryptoJS.enc.Hex.parse(w);<span class="cstat-no" title="statement not covered" >v</span>ar p=CryptoJS.enc.Hex.parse(q);<span class="cstat-no" title="statement not covered" >v</span>ar o={};<span class="cstat-no" title="statement not covered" >v</span>ar v=t.encrypt(s,x,{iv:p});<span class="cstat-no" title="statement not covered" >v</span>ar r=CryptoJS.enc.Hex.parse(v.toString());<span class="cstat-no" title="statement not covered" >v</span>ar u=CryptoJS.enc.Base64.stringify(r);<span class="cstat-no" title="statement not covered" >r</span>eturn u}</span>;var g={"AES-256-CBC":{proc:c,eproc:k,keylen:32,ivlen:16},"AES-192-CBC":{proc:c,eproc:k,keylen:24,ivlen:16},"AES-128-CBC":{proc:c,eproc:k,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:d,eproc:n,keylen:24,ivlen:8}};var b=<span class="fstat-no" title="function not covered" >function(o){<span class="cstat-no" title="statement not covered" ></span>return g[o]["proc"]}</span>;var l=<span class="fstat-no" title="function not covered" >function(o){<span class="cstat-no" title="statement not covered" ></span>var q=CryptoJS.lib.WordArray.random(o);<span class="cstat-no" title="statement not covered" >v</span>ar p=CryptoJS.enc.Hex.stringify(q);<span class="cstat-no" title="statement not covered" >r</span>eturn p}</span>;var m=<span class="fstat-no" title="function not covered" >function(u){<span class="cstat-no" title="statement not covered" ></span>var v={};<span class="cstat-no" title="statement not covered" >v</span>ar p=u.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));<span class="cstat-no" title="statement not covered" >i</span>f(p){<span class="cstat-no" title="statement not covered" >v.cipher=p[1];<span class="cstat-no" title="statement not covered" >v</span>.ivsalt=p[2]}<span class="cstat-no" title="statement not covered" ></span>v</span>ar o=u.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));<span class="cstat-no" title="statement not covered" >i</span>f(o){<span class="cstat-no" title="statement not covered" >v.type=o[1]}<span class="cstat-no" title="statement not covered" ></span>v</span>ar t=-1;<span class="cstat-no" title="statement not covered" >v</span>ar w=0;<span class="cstat-no" title="statement not covered" >i</span>f(u.indexOf("\r\n\r\n")!=-1){<span class="cstat-no" title="statement not covered" >t=u.indexOf("\r\n\r\n");<span class="cstat-no" title="statement not covered" >w</span>=2}<span class="cstat-no" title="statement not covered" ></span>i</span>f(u.indexOf("\n\n")!=-1){<span class="cstat-no" title="statement not covered" >t=u.indexOf("\n\n");<span class="cstat-no" title="statement not covered" >w</span>=1}<span class="cstat-no" title="statement not covered" ></span>v</span>ar r=u.indexOf("-----END");<span class="cstat-no" title="statement not covered" >i</span>f(t!=-1&amp;&amp;r!=-1){<span class="cstat-no" title="statement not covered" >var q=u.substring(t+w*2,r-w);<span class="cstat-no" title="statement not covered" >q</span>=q.replace(/\s+/g,"");<span class="cstat-no" title="statement not covered" >v</span>.data=q}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn v}</span>;var i=<span class="fstat-no" title="function not covered" >function(p,x,o){<span class="cstat-no" title="statement not covered" ></span>var u=o.substring(0,16);<span class="cstat-no" title="statement not covered" >v</span>ar s=CryptoJS.enc.Hex.parse(u);<span class="cstat-no" title="statement not covered" >v</span>ar q=CryptoJS.enc.Utf8.parse(x);<span class="cstat-no" title="statement not covered" >v</span>ar t=g[p]["keylen"]+g[p]["ivlen"];<span class="cstat-no" title="statement not covered" >v</span>ar w="";<span class="cstat-no" title="statement not covered" >v</span>ar v=null;<span class="cstat-no" title="statement not covered" >f</span>or(;;){<span class="cstat-no" title="statement not covered" >var r=CryptoJS.algo.MD5.create();<span class="cstat-no" title="statement not covered" >i</span>f(v!=null){<span class="cstat-no" title="statement not covered" >r.update(v)}<span class="cstat-no" title="statement not covered" ></span>r</span>.update(q);<span class="cstat-no" title="statement not covered" >r</span>.update(s);<span class="cstat-no" title="statement not covered" >v</span>=r.finalize();<span class="cstat-no" title="statement not covered" >w</span>=w+CryptoJS.enc.Hex.stringify(v);<span class="cstat-no" title="statement not covered" >i</span>f(w.length&gt;=t*2){<span class="cstat-no" title="statement not covered" >break}</span>}<span class="cstat-no" title="statement not covered" ></span>v</span>ar y={};<span class="cstat-no" title="statement not covered" >y</span>.keyhex=w.substr(0,g[p]["keylen"]*2);<span class="cstat-no" title="statement not covered" >y</span>.ivhex=w.substr(g[p]["keylen"]*2,g[p]["ivlen"]*2);<span class="cstat-no" title="statement not covered" >r</span>eturn y}</span>;var a=<span class="fstat-no" title="function not covered" >function(o,u,q,v){<span class="cstat-no" title="statement not covered" ></span>var r=CryptoJS.enc.Base64.parse(o);<span class="cstat-no" title="statement not covered" >v</span>ar p=CryptoJS.enc.Hex.stringify(r);<span class="cstat-no" title="statement not covered" >v</span>ar t=g[u]["proc"];<span class="cstat-no" title="statement not covered" >v</span>ar s=t(p,q,v);<span class="cstat-no" title="statement not covered" >r</span>eturn s}</span>;var f=<span class="fstat-no" title="function not covered" >function(o,r,p,t){<span class="cstat-no" title="statement not covered" ></span>var q=g[r]["eproc"];<span class="cstat-no" title="statement not covered" >v</span>ar s=q(o,p,t);<span class="cstat-no" title="statement not covered" >r</span>eturn s}</span>;return{version:"1.0.5",getHexFromPEM:<span class="fstat-no" title="function not covered" >function(o,p){<span class="cstat-no" title="statement not covered" ></span>return ASN1HEX.pemToHex(o,p)}</span>,getDecryptedKeyHexByKeyIV:<span class="fstat-no" title="function not covered" >function(p,s,r,q){<span class="cstat-no" title="statement not covered" ></span>var o=b(s);<span class="cstat-no" title="statement not covered" >r</span>eturn o(p,r,q)}</span>,parsePKCS5PEM:<span class="fstat-no" title="function not covered" >function(o){<span class="cstat-no" title="statement not covered" ></span>return m(o)}</span>,getKeyAndUnusedIvByPasscodeAndIvsalt:<span class="fstat-no" title="function not covered" >function(p,o,q){<span class="cstat-no" title="statement not covered" ></span>return i(p,o,q)}</span>,decryptKeyB64:<span class="fstat-no" title="function not covered" >function(o,q,p,r){<span class="cstat-no" title="statement not covered" ></span>return a(o,q,p,r)}</span>,getDecryptedKeyHex:<span class="fstat-no" title="function not covered" >function(x,w){<span class="cstat-no" title="statement not covered" ></span>var p=m(x);<span class="cstat-no" title="statement not covered" >v</span>ar s=p.type;<span class="cstat-no" title="statement not covered" >v</span>ar q=p.cipher;<span class="cstat-no" title="statement not covered" >v</span>ar o=p.ivsalt;<span class="cstat-no" title="statement not covered" >v</span>ar r=p.data;<span class="cstat-no" title="statement not covered" >v</span>ar v=i(q,w,o);<span class="cstat-no" title="statement not covered" >v</span>ar u=v.keyhex;<span class="cstat-no" title="statement not covered" >v</span>ar t=a(r,q,u,o);<span class="cstat-no" title="statement not covered" >r</span>eturn t}</span>,getRSAKeyFromEncryptedPKCS5PEM:<span class="fstat-no" title="function not covered" >function(q,p){<span class="cstat-no" title="statement not covered" ></span>var r=this.getDecryptedKeyHex(q,p);<span class="cstat-no" title="statement not covered" >v</span>ar o=new RSAKey();<span class="cstat-no" title="statement not covered" >o</span>.readPrivateKeyFromASN1HexString(r);<span class="cstat-no" title="statement not covered" >r</span>eturn o}</span>,getEncryptedPKCS5PEMFromPrvKeyHex:<span class="fstat-no" title="function not covered" >function(r,y,s,q){<span class="cstat-no" title="statement not covered" ></span>if(typeof s=="undefined"||s==null){<span class="cstat-no" title="statement not covered" >s="AES-256-CBC"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof g[s]=="undefined"){<span class="cstat-no" title="statement not covered" >throw"PKCS5PKEY unsupported algorithm: "+s}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof q=="undefined"||q==null){<span class="cstat-no" title="statement not covered" >var u=g[s]["ivlen"];<span class="cstat-no" title="statement not covered" >v</span>ar t=l(u);<span class="cstat-no" title="statement not covered" >q</span>=t.toUpperCase()}<span class="cstat-no" title="statement not covered" ></span>v</span>ar x=i(s,y,q);<span class="cstat-no" title="statement not covered" >v</span>ar w=x.keyhex;<span class="cstat-no" title="statement not covered" >v</span>ar v=f(r,s,w,q);<span class="cstat-no" title="statement not covered" >v</span>ar p=v.replace(/(.{64})/g,"$1\r\n");<span class="cstat-no" title="statement not covered" >v</span>ar o="-----BEGIN RSA PRIVATE KEY-----\r\n";<span class="cstat-no" title="statement not covered" >o</span>+="Proc-Type: 4,ENCRYPTED\r\n";<span class="cstat-no" title="statement not covered" >o</span>+="DEK-Info: "+s+","+q+"\r\n";<span class="cstat-no" title="statement not covered" >o</span>+="\r\n";<span class="cstat-no" title="statement not covered" >o</span>+=p;<span class="cstat-no" title="statement not covered" >o</span>+="\r\n-----END RSA PRIVATE KEY-----\r\n";<span class="cstat-no" title="statement not covered" >r</span>eturn o}</span>,getEncryptedPKCS5PEMFromRSAKey:<span class="fstat-no" title="function not covered" >function(C,D,o,s){<span class="cstat-no" title="statement not covered" ></span>var A=new KJUR.asn1.DERInteger({"int":0});<span class="cstat-no" title="statement not covered" >v</span>ar v=new KJUR.asn1.DERInteger({bigint:C.n});<span class="cstat-no" title="statement not covered" >v</span>ar z=new KJUR.asn1.DERInteger({"int":C.e});<span class="cstat-no" title="statement not covered" >v</span>ar B=new KJUR.asn1.DERInteger({bigint:C.d});<span class="cstat-no" title="statement not covered" >v</span>ar t=new KJUR.asn1.DERInteger({bigint:C.p});<span class="cstat-no" title="statement not covered" >v</span>ar r=new KJUR.asn1.DERInteger({bigint:C.q});<span class="cstat-no" title="statement not covered" >v</span>ar y=new KJUR.asn1.DERInteger({bigint:C.dmp1});<span class="cstat-no" title="statement not covered" >v</span>ar u=new KJUR.asn1.DERInteger({bigint:C.dmq1});<span class="cstat-no" title="statement not covered" >v</span>ar x=new KJUR.asn1.DERInteger({bigint:C.coeff});<span class="cstat-no" title="statement not covered" >v</span>ar E=new KJUR.asn1.DERSequence({array:[A,v,z,B,t,r,y,u,x]});<span class="cstat-no" title="statement not covered" >v</span>ar w=E.getEncodedHex();<span class="cstat-no" title="statement not covered" >r</span>eturn this.getEncryptedPKCS5PEMFromPrvKeyHex(w,D,o,s)}</span>,newEncryptedPKCS5PEM:<span class="fstat-no" title="function not covered" >function(o,p,s,t){<span class="cstat-no" title="statement not covered" ></span>if(typeof p=="undefined"||p==null){<span class="cstat-no" title="statement not covered" >p=1024}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof s=="undefined"||s==null){<span class="cstat-no" title="statement not covered" >s="10001"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar q=new RSAKey();<span class="cstat-no" title="statement not covered" >q</span>.generate(p,s);<span class="cstat-no" title="statement not covered" >v</span>ar r=null;<span class="cstat-no" title="statement not covered" >i</span>f(typeof t=="undefined"||t==null){<span class="cstat-no" title="statement not covered" >r=this.getEncryptedPKCS5PEMFromRSAKey(pkey,o)}</span>else{<span class="cstat-no" title="statement not covered" >r=this.getEncryptedPKCS5PEMFromRSAKey(pkey,o,t)}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn r}</span>,getRSAKeyFromPlainPKCS8PEM:<span class="fstat-no" title="function not covered" >function(q){<span class="cstat-no" title="statement not covered" ></span>if(q.match(/ENCRYPTED/)){<span class="cstat-no" title="statement not covered" >throw"pem shall be not ENCRYPTED"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar p=ASN1HEX.pemToHex(q,"PRIVATE KEY");<span class="cstat-no" title="statement not covered" >v</span>ar o=this.getRSAKeyFromPlainPKCS8Hex(p);<span class="cstat-no" title="statement not covered" >r</span>eturn o}</span>,getRSAKeyFromPlainPKCS8Hex:<span class="fstat-no" title="function not covered" >function(p){<span class="cstat-no" title="statement not covered" ></span>var o=new RSAKey();<span class="cstat-no" title="statement not covered" >o</span>.readPKCS8PrvKeyHex(p);<span class="cstat-no" title="statement not covered" >r</span>eturn o}</span>,parseHexOfEncryptedPKCS8:<span class="fstat-no" title="function not covered" >function(v){<span class="cstat-no" title="statement not covered" ></span>var r={};<span class="cstat-no" title="statement not covered" >v</span>ar q=ASN1HEX.getPosArrayOfChildren_AtObj(v,0);<span class="cstat-no" title="statement not covered" >i</span>f(q.length!=2){<span class="cstat-no" title="statement not covered" >throw"malformed format: SEQUENCE(0).items != 2: "+q.length}<span class="cstat-no" title="statement not covered" ></span>r</span>.ciphertext=ASN1HEX.getHexOfV_AtObj(v,q[1]);<span class="cstat-no" title="statement not covered" >v</span>ar x=ASN1HEX.getPosArrayOfChildren_AtObj(v,q[0]);<span class="cstat-no" title="statement not covered" >i</span>f(x.length!=2){<span class="cstat-no" title="statement not covered" >throw"malformed format: SEQUENCE(0.0).items != 2: "+x.length}<span class="cstat-no" title="statement not covered" ></span>i</span>f(ASN1HEX.getHexOfV_AtObj(v,x[0])!="2a864886f70d01050d"){<span class="cstat-no" title="statement not covered" >throw"this only supports pkcs5PBES2"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar o=ASN1HEX.getPosArrayOfChildren_AtObj(v,x[1]);<span class="cstat-no" title="statement not covered" >i</span>f(x.length!=2){<span class="cstat-no" title="statement not covered" >throw"malformed format: SEQUENCE(0.0.1).items != 2: "+o.length}<span class="cstat-no" title="statement not covered" ></span>v</span>ar p=ASN1HEX.getPosArrayOfChildren_AtObj(v,o[1]);<span class="cstat-no" title="statement not covered" >i</span>f(p.length!=2){<span class="cstat-no" title="statement not covered" >throw"malformed format: SEQUENCE(0.0.1.1).items != 2: "+p.length}<span class="cstat-no" title="statement not covered" ></span>i</span>f(ASN1HEX.getHexOfV_AtObj(v,p[0])!="2a864886f70d0307"){<span class="cstat-no" title="statement not covered" >throw"this only supports TripleDES"}<span class="cstat-no" title="statement not covered" ></span>r</span>.encryptionSchemeAlg="TripleDES";<span class="cstat-no" title="statement not covered" >r</span>.encryptionSchemeIV=ASN1HEX.getHexOfV_AtObj(v,p[1]);<span class="cstat-no" title="statement not covered" >v</span>ar s=ASN1HEX.getPosArrayOfChildren_AtObj(v,o[0]);<span class="cstat-no" title="statement not covered" >i</span>f(s.length!=2){<span class="cstat-no" title="statement not covered" >throw"malformed format: SEQUENCE(0.0.1.0).items != 2: "+s.length}<span class="cstat-no" title="statement not covered" ></span>i</span>f(ASN1HEX.getHexOfV_AtObj(v,s[0])!="2a864886f70d01050c"){<span class="cstat-no" title="statement not covered" >throw"this only supports pkcs5PBKDF2"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar w=ASN1HEX.getPosArrayOfChildren_AtObj(v,s[1]);<span class="cstat-no" title="statement not covered" >i</span>f(w.length&lt;2){<span class="cstat-no" title="statement not covered" >throw"malformed format: SEQUENCE(0.0.1.0.1).items &lt; 2: "+w.length}<span class="cstat-no" title="statement not covered" ></span>r</span>.pbkdf2Salt=ASN1HEX.getHexOfV_AtObj(v,w[0]);<span class="cstat-no" title="statement not covered" >v</span>ar t=ASN1HEX.getHexOfV_AtObj(v,w[1]);<span class="cstat-no" title="statement not covered" >t</span>ry{<span class="cstat-no" title="statement not covered" >r.pbkdf2Iter=parseInt(t,16)}</span>catch(u){<span class="cstat-no" title="statement not covered" >throw"malformed format pbkdf2Iter: "+t}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn r}</span>,getPBKDF2KeyHexFromParam:<span class="fstat-no" title="function not covered" >function(t,o){<span class="cstat-no" title="statement not covered" ></span>var s=CryptoJS.enc.Hex.parse(t.pbkdf2Salt);<span class="cstat-no" title="statement not covered" >v</span>ar p=t.pbkdf2Iter;<span class="cstat-no" title="statement not covered" >v</span>ar r=CryptoJS.PBKDF2(o,s,{keySize:192/32,iterations:p});<span class="cstat-no" title="statement not covered" >v</span>ar q=CryptoJS.enc.Hex.stringify(r);<span class="cstat-no" title="statement not covered" >r</span>eturn q}</span>,getPlainPKCS8HexFromEncryptedPKCS8PEM:<span class="fstat-no" title="function not covered" >function(w,x){<span class="cstat-no" title="statement not covered" ></span>var q=ASN1HEX.pemToHex(w,"ENCRYPTED PRIVATE KEY");<span class="cstat-no" title="statement not covered" >v</span>ar o=this.parseHexOfEncryptedPKCS8(q);<span class="cstat-no" title="statement not covered" >v</span>ar t=PKCS5PKEY.getPBKDF2KeyHexFromParam(o,x);<span class="cstat-no" title="statement not covered" >v</span>ar u={};<span class="cstat-no" title="statement not covered" >u</span>.ciphertext=CryptoJS.enc.Hex.parse(o.ciphertext);<span class="cstat-no" title="statement not covered" >v</span>ar s=CryptoJS.enc.Hex.parse(t);<span class="cstat-no" title="statement not covered" >v</span>ar r=CryptoJS.enc.Hex.parse(o.encryptionSchemeIV);<span class="cstat-no" title="statement not covered" >v</span>ar v=CryptoJS.TripleDES.decrypt(u,s,{iv:r});<span class="cstat-no" title="statement not covered" >v</span>ar p=CryptoJS.enc.Hex.stringify(v);<span class="cstat-no" title="statement not covered" >r</span>eturn p}</span>,getRSAKeyFromEncryptedPKCS8PEM:<span class="fstat-no" title="function not covered" >function(r,q){<span class="cstat-no" title="statement not covered" ></span>var p=this.getPlainPKCS8HexFromEncryptedPKCS8PEM(r,q);<span class="cstat-no" title="statement not covered" >v</span>ar o=this.getRSAKeyFromPlainPKCS8Hex(p);<span class="cstat-no" title="statement not covered" >r</span>eturn o}</span>,getKeyFromEncryptedPKCS8PEM:<span class="fstat-no" title="function not covered" >function(r,p){<span class="cstat-no" title="statement not covered" ></span>var o=this.getPlainPKCS8HexFromEncryptedPKCS8PEM(r,p);<span class="cstat-no" title="statement not covered" >v</span>ar q=this.getKeyFromPlainPrivatePKCS8Hex(o);<span class="cstat-no" title="statement not covered" >r</span>eturn q}</span>,parsePlainPrivatePKCS8Hex:<span class="fstat-no" title="function not covered" >function(r){<span class="cstat-no" title="statement not covered" ></span>var p={};<span class="cstat-no" title="statement not covered" >p</span>.algparam=null;<span class="cstat-no" title="statement not covered" >i</span>f(r.substr(0,2)!="30"){<span class="cstat-no" title="statement not covered" >throw"malformed plain PKCS8 private key(code:001)"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar q=ASN1HEX.getPosArrayOfChildren_AtObj(r,0);<span class="cstat-no" title="statement not covered" >i</span>f(q.length!=3){<span class="cstat-no" title="statement not covered" >throw"malformed plain PKCS8 private key(code:002)"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(r.substr(q[1],2)!="30"){<span class="cstat-no" title="statement not covered" >throw"malformed PKCS8 private key(code:003)"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar o=ASN1HEX.getPosArrayOfChildren_AtObj(r,q[1]);<span class="cstat-no" title="statement not covered" >i</span>f(o.length!=2){<span class="cstat-no" title="statement not covered" >throw"malformed PKCS8 private key(code:004)"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(r.substr(o[0],2)!="06"){<span class="cstat-no" title="statement not covered" >throw"malformed PKCS8 private key(code:005)"}<span class="cstat-no" title="statement not covered" ></span>p</span>.algoid=ASN1HEX.getHexOfV_AtObj(r,o[0]);<span class="cstat-no" title="statement not covered" >i</span>f(r.substr(o[1],2)=="06"){<span class="cstat-no" title="statement not covered" >p.algparam=ASN1HEX.getHexOfV_AtObj(r,o[1])}<span class="cstat-no" title="statement not covered" ></span>i</span>f(r.substr(q[2],2)!="04"){<span class="cstat-no" title="statement not covered" >throw"malformed PKCS8 private key(code:006)"}<span class="cstat-no" title="statement not covered" ></span>p</span>.keyidx=ASN1HEX.getStartPosOfV_AtObj(r,q[2]);<span class="cstat-no" title="statement not covered" >r</span>eturn p}</span>,getKeyFromPlainPrivatePKCS8PEM:<span class="fstat-no" title="function not covered" >function(p){<span class="cstat-no" title="statement not covered" ></span>var o=ASN1HEX.pemToHex(p,"PRIVATE KEY");<span class="cstat-no" title="statement not covered" >v</span>ar q=this.getKeyFromPlainPrivatePKCS8Hex(o);<span class="cstat-no" title="statement not covered" >r</span>eturn q}</span>,getKeyFromPlainPrivatePKCS8Hex:<span class="fstat-no" title="function not covered" >function(o){<span class="cstat-no" title="statement not covered" ></span>var p=this.parsePlainPrivatePKCS8Hex(o);<span class="cstat-no" title="statement not covered" >v</span>ar q;<span class="cstat-no" title="statement not covered" >i</span>f(p.algoid=="2a864886f70d010101"){<span class="cstat-no" title="statement not covered" >q=new RSAKey()}</span>else{<span class="cstat-no" title="statement not covered" >if(p.algoid=="2a8648ce380401"){<span class="cstat-no" title="statement not covered" >q=new KJUR.crypto.DSA()}</span>else{<span class="cstat-no" title="statement not covered" >if(p.algoid=="2a8648ce3d0201"){<span class="cstat-no" title="statement not covered" >q=new KJUR.crypto.ECDSA()}</span>else{<span class="cstat-no" title="statement not covered" >throw"unsupported private key algorithm"}</span>}</span>}<span class="cstat-no" title="statement not covered" ></span>q</span>.readPKCS8PrvKeyHex(o);<span class="cstat-no" title="statement not covered" >r</span>eturn q}</span>,getRSAKeyFromPublicPKCS8PEM:<span class="fstat-no" title="function not covered" >function(p){<span class="cstat-no" title="statement not covered" ></span>var q=ASN1HEX.pemToHex(p,"PUBLIC KEY");<span class="cstat-no" title="statement not covered" >v</span>ar o=this.getRSAKeyFromPublicPKCS8Hex(q);<span class="cstat-no" title="statement not covered" >r</span>eturn o}</span>,getKeyFromPublicPKCS8PEM:<span class="fstat-no" title="function not covered" >function(p){<span class="cstat-no" title="statement not covered" ></span>var q=ASN1HEX.pemToHex(p,"PUBLIC KEY");<span class="cstat-no" title="statement not covered" >v</span>ar o=this.getKeyFromPublicPKCS8Hex(q);<span class="cstat-no" title="statement not covered" >r</span>eturn o}</span>,getKeyFromPublicPKCS8Hex:<span class="fstat-no" title="function not covered" >function(o){<span class="cstat-no" title="statement not covered" ></span>var p;<span class="cstat-no" title="statement not covered" >v</span>ar q=ASN1HEX.getVbyList(h,0,[0,0],"06");<span class="cstat-no" title="statement not covered" >i</span>f(q==="2a864886f70d010101"){<span class="cstat-no" title="statement not covered" >p=new RSAKey()}</span>else{<span class="cstat-no" title="statement not covered" >if(q==="2a8648ce380401"){<span class="cstat-no" title="statement not covered" >p=new KJUR.crypto.DSA()}</span>else{<span class="cstat-no" title="statement not covered" >if(q==="2a8648ce3d0201"){<span class="cstat-no" title="statement not covered" >p=new KJUR.crypto.ECDSA()}</span>else{<span class="cstat-no" title="statement not covered" >throw"unsupported PKCS#8 public key hex"}</span>}</span>}<span class="cstat-no" title="statement not covered" ></span>p</span>.readPKCS8PubKeyHex(h);<span class="cstat-no" title="statement not covered" >r</span>eturn p}</span>,parsePublicRawRSAKeyHex:<span class="fstat-no" title="function not covered" >function(q){<span class="cstat-no" title="statement not covered" ></span>var o={};<span class="cstat-no" title="statement not covered" >i</span>f(q.substr(0,2)!="30"){<span class="cstat-no" title="statement not covered" >throw"malformed RSA key(code:001)"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar p=ASN1HEX.getPosArrayOfChildren_AtObj(q,0);<span class="cstat-no" title="statement not covered" >i</span>f(p.length!=2){<span class="cstat-no" title="statement not covered" >throw"malformed RSA key(code:002)"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(q.substr(p[0],2)!="02"){<span class="cstat-no" title="statement not covered" >throw"malformed RSA key(code:003)"}<span class="cstat-no" title="statement not covered" ></span>o</span>.n=ASN1HEX.getHexOfV_AtObj(q,p[0]);<span class="cstat-no" title="statement not covered" >i</span>f(q.substr(p[1],2)!="02"){<span class="cstat-no" title="statement not covered" >throw"malformed RSA key(code:004)"}<span class="cstat-no" title="statement not covered" ></span>o</span>.e=ASN1HEX.getHexOfV_AtObj(q,p[1]);<span class="cstat-no" title="statement not covered" >r</span>eturn o}</span>,parsePrivateRawRSAKeyHexAtObj:<span class="fstat-no" title="function not covered" >function(p,r){<span class="cstat-no" title="statement not covered" ></span>var q=r.keyidx;<span class="cstat-no" title="statement not covered" >i</span>f(p.substr(q,2)!="30"){<span class="cstat-no" title="statement not covered" >throw"malformed RSA private key(code:001)"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar o=ASN1HEX.getPosArrayOfChildren_AtObj(p,q);<span class="cstat-no" title="statement not covered" >i</span>f(o.length!=9){<span class="cstat-no" title="statement not covered" >throw"malformed RSA private key(code:002)"}<span class="cstat-no" title="statement not covered" ></span>r</span>.key={};<span class="cstat-no" title="statement not covered" >r</span>.key.n=ASN1HEX.getHexOfV_AtObj(p,o[1]);<span class="cstat-no" title="statement not covered" >r</span>.key.e=ASN1HEX.getHexOfV_AtObj(p,o[2]);<span class="cstat-no" title="statement not covered" >r</span>.key.d=ASN1HEX.getHexOfV_AtObj(p,o[3]);<span class="cstat-no" title="statement not covered" >r</span>.key.p=ASN1HEX.getHexOfV_AtObj(p,o[4]);<span class="cstat-no" title="statement not covered" >r</span>.key.q=ASN1HEX.getHexOfV_AtObj(p,o[5]);<span class="cstat-no" title="statement not covered" >r</span>.key.dp=ASN1HEX.getHexOfV_AtObj(p,o[6]);<span class="cstat-no" title="statement not covered" >r</span>.key.dq=ASN1HEX.getHexOfV_AtObj(p,o[7]);<span class="cstat-no" title="statement not covered" >r</span>.key.co=ASN1HEX.getHexOfV_AtObj(p,o[8])}</span>,parsePrivateRawECKeyHexAtObj:<span class="fstat-no" title="function not covered" >function(p,r){<span class="cstat-no" title="statement not covered" ></span>var q=r.keyidx;<span class="cstat-no" title="statement not covered" >i</span>f(p.substr(q,2)!="30"){<span class="cstat-no" title="statement not covered" >throw"malformed ECC private key(code:001)"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar o=ASN1HEX.getPosArrayOfChildren_AtObj(p,q);<span class="cstat-no" title="statement not covered" >i</span>f(o.length!=3){<span class="cstat-no" title="statement not covered" >throw"malformed ECC private key(code:002)"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(p.substr(o[1],2)!="04"){<span class="cstat-no" title="statement not covered" >throw"malformed ECC private key(code:003)"}<span class="cstat-no" title="statement not covered" ></span>r</span>.key=ASN1HEX.getHexOfV_AtObj(p,o[1])}</span>,parsePublicPKCS8Hex:<span class="fstat-no" title="function not covered" >function(r){<span class="cstat-no" title="statement not covered" ></span>var p={};<span class="cstat-no" title="statement not covered" >p</span>.algparam=null;<span class="cstat-no" title="statement not covered" >v</span>ar q=ASN1HEX.getPosArrayOfChildren_AtObj(r,0);<span class="cstat-no" title="statement not covered" >i</span>f(q.length!=2){<span class="cstat-no" title="statement not covered" >throw"outer DERSequence shall have 2 elements: "+q.length}<span class="cstat-no" title="statement not covered" ></span>v</span>ar s=q[0];<span class="cstat-no" title="statement not covered" >i</span>f(r.substr(s,2)!="30"){<span class="cstat-no" title="statement not covered" >throw"malformed PKCS8 public key(code:001)"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar o=ASN1HEX.getPosArrayOfChildren_AtObj(r,s);<span class="cstat-no" title="statement not covered" >i</span>f(o.length!=2){<span class="cstat-no" title="statement not covered" >throw"malformed PKCS8 public key(code:002)"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(r.substr(o[0],2)!="06"){<span class="cstat-no" title="statement not covered" >throw"malformed PKCS8 public key(code:003)"}<span class="cstat-no" title="statement not covered" ></span>p</span>.algoid=ASN1HEX.getHexOfV_AtObj(r,o[0]);<span class="cstat-no" title="statement not covered" >i</span>f(r.substr(o[1],2)=="06"){<span class="cstat-no" title="statement not covered" >p.algparam=ASN1HEX.getHexOfV_AtObj(r,o[1])}<span class="cstat-no" title="statement not covered" ></span>i</span>f(r.substr(q[1],2)!="03"){<span class="cstat-no" title="statement not covered" >throw"malformed PKCS8 public key(code:004)"}<span class="cstat-no" title="statement not covered" ></span>p</span>.key=ASN1HEX.getHexOfV_AtObj(r,q[1]).substr(2);<span class="cstat-no" title="statement not covered" >r</span>eturn p}</span>,getRSAKeyFromPublicPKCS8Hex:<span class="fstat-no" title="function not covered" >function(o){<span class="cstat-no" title="statement not covered" ></span>var p=new RSAKey();<span class="cstat-no" title="statement not covered" >p</span>.readPKCS8PubKeyHex(o);<span class="cstat-no" title="statement not covered" >r</span>eturn p}</span>,}}();
/*! keyutil-1.0.15.js (c) 2013-2017 Kenji Urushima | kjur.github.com/jsrsasign/license
 */
var KEYUTIL=function(){var d=<span class="fstat-no" title="function not covered" >function(p,r,q){<span class="cstat-no" title="statement not covered" ></span>return k(CryptoJS.AES,p,r,q)}</span>;var e=<span class="fstat-no" title="function not covered" >function(p,r,q){<span class="cstat-no" title="statement not covered" ></span>return k(CryptoJS.TripleDES,p,r,q)}</span>;var a=<span class="fstat-no" title="function not covered" >function(p,r,q){<span class="cstat-no" title="statement not covered" ></span>return k(CryptoJS.DES,p,r,q)}</span>;var k=<span class="fstat-no" title="function not covered" >function(s,x,u,q){<span class="cstat-no" title="statement not covered" ></span>var r=CryptoJS.enc.Hex.parse(x);<span class="cstat-no" title="statement not covered" >v</span>ar w=CryptoJS.enc.Hex.parse(u);<span class="cstat-no" title="statement not covered" >v</span>ar p=CryptoJS.enc.Hex.parse(q);<span class="cstat-no" title="statement not covered" >v</span>ar t={};<span class="cstat-no" title="statement not covered" >t</span>.key=w;<span class="cstat-no" title="statement not covered" >t</span>.iv=p;<span class="cstat-no" title="statement not covered" >t</span>.ciphertext=r;<span class="cstat-no" title="statement not covered" >v</span>ar v=s.decrypt(t,w,{iv:p});<span class="cstat-no" title="statement not covered" >r</span>eturn CryptoJS.enc.Hex.stringify(v)}</span>;var l=<span class="fstat-no" title="function not covered" >function(p,r,q){<span class="cstat-no" title="statement not covered" ></span>return g(CryptoJS.AES,p,r,q)}</span>;var o=<span class="fstat-no" title="function not covered" >function(p,r,q){<span class="cstat-no" title="statement not covered" ></span>return g(CryptoJS.TripleDES,p,r,q)}</span>;var f=<span class="fstat-no" title="function not covered" >function(p,r,q){<span class="cstat-no" title="statement not covered" ></span>return g(CryptoJS.DES,p,r,q)}</span>;var g=<span class="fstat-no" title="function not covered" >function(t,y,v,q){<span class="cstat-no" title="statement not covered" ></span>var s=CryptoJS.enc.Hex.parse(y);<span class="cstat-no" title="statement not covered" >v</span>ar x=CryptoJS.enc.Hex.parse(v);<span class="cstat-no" title="statement not covered" >v</span>ar p=CryptoJS.enc.Hex.parse(q);<span class="cstat-no" title="statement not covered" >v</span>ar w=t.encrypt(s,x,{iv:p});<span class="cstat-no" title="statement not covered" >v</span>ar r=CryptoJS.enc.Hex.parse(w.toString());<span class="cstat-no" title="statement not covered" >v</span>ar u=CryptoJS.enc.Base64.stringify(r);<span class="cstat-no" title="statement not covered" >r</span>eturn u}</span>;var i={"AES-256-CBC":{proc:d,eproc:l,keylen:32,ivlen:16},"AES-192-CBC":{proc:d,eproc:l,keylen:24,ivlen:16},"AES-128-CBC":{proc:d,eproc:l,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:e,eproc:o,keylen:24,ivlen:8},"DES-CBC":{proc:a,eproc:f,keylen:8,ivlen:8}};var c=<span class="fstat-no" title="function not covered" >function(p){<span class="cstat-no" title="statement not covered" ></span>return i[p]["proc"]}</span>;var m=<span class="fstat-no" title="function not covered" >function(p){<span class="cstat-no" title="statement not covered" ></span>var r=CryptoJS.lib.WordArray.random(p);<span class="cstat-no" title="statement not covered" >v</span>ar q=CryptoJS.enc.Hex.stringify(r);<span class="cstat-no" title="statement not covered" >r</span>eturn q}</span>;var n=<span class="fstat-no" title="function not covered" >function(v){<span class="cstat-no" title="statement not covered" ></span>var w={};<span class="cstat-no" title="statement not covered" >v</span>ar q=v.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));<span class="cstat-no" title="statement not covered" >i</span>f(q){<span class="cstat-no" title="statement not covered" >w.cipher=q[1];<span class="cstat-no" title="statement not covered" >w</span>.ivsalt=q[2]}<span class="cstat-no" title="statement not covered" ></span>v</span>ar p=v.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));<span class="cstat-no" title="statement not covered" >i</span>f(p){<span class="cstat-no" title="statement not covered" >w.type=p[1]}<span class="cstat-no" title="statement not covered" ></span>v</span>ar u=-1;<span class="cstat-no" title="statement not covered" >v</span>ar x=0;<span class="cstat-no" title="statement not covered" >i</span>f(v.indexOf("\r\n\r\n")!=-1){<span class="cstat-no" title="statement not covered" >u=v.indexOf("\r\n\r\n");<span class="cstat-no" title="statement not covered" >x</span>=2}<span class="cstat-no" title="statement not covered" ></span>i</span>f(v.indexOf("\n\n")!=-1){<span class="cstat-no" title="statement not covered" >u=v.indexOf("\n\n");<span class="cstat-no" title="statement not covered" >x</span>=1}<span class="cstat-no" title="statement not covered" ></span>v</span>ar t=v.indexOf("-----END");<span class="cstat-no" title="statement not covered" >i</span>f(u!=-1&amp;&amp;t!=-1){<span class="cstat-no" title="statement not covered" >var r=v.substring(u+x*2,t-x);<span class="cstat-no" title="statement not covered" >r</span>=r.replace(/\s+/g,"");<span class="cstat-no" title="statement not covered" >w</span>.data=r}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn w}</span>;var j=<span class="fstat-no" title="function not covered" >function(q,y,p){<span class="cstat-no" title="statement not covered" ></span>var v=p.substring(0,16);<span class="cstat-no" title="statement not covered" >v</span>ar t=CryptoJS.enc.Hex.parse(v);<span class="cstat-no" title="statement not covered" >v</span>ar r=CryptoJS.enc.Utf8.parse(y);<span class="cstat-no" title="statement not covered" >v</span>ar u=i[q]["keylen"]+i[q]["ivlen"];<span class="cstat-no" title="statement not covered" >v</span>ar x="";<span class="cstat-no" title="statement not covered" >v</span>ar w=null;<span class="cstat-no" title="statement not covered" >f</span>or(;;){<span class="cstat-no" title="statement not covered" >var s=CryptoJS.algo.MD5.create();<span class="cstat-no" title="statement not covered" >i</span>f(w!=null){<span class="cstat-no" title="statement not covered" >s.update(w)}<span class="cstat-no" title="statement not covered" ></span>s</span>.update(r);<span class="cstat-no" title="statement not covered" >s</span>.update(t);<span class="cstat-no" title="statement not covered" >w</span>=s.finalize();<span class="cstat-no" title="statement not covered" >x</span>=x+CryptoJS.enc.Hex.stringify(w);<span class="cstat-no" title="statement not covered" >i</span>f(x.length&gt;=u*2){<span class="cstat-no" title="statement not covered" >break}</span>}<span class="cstat-no" title="statement not covered" ></span>v</span>ar z={};<span class="cstat-no" title="statement not covered" >z</span>.keyhex=x.substr(0,i[q]["keylen"]*2);<span class="cstat-no" title="statement not covered" >z</span>.ivhex=x.substr(i[q]["keylen"]*2,i[q]["ivlen"]*2);<span class="cstat-no" title="statement not covered" >r</span>eturn z}</span>;var b=<span class="fstat-no" title="function not covered" >function(p,v,r,w){<span class="cstat-no" title="statement not covered" ></span>var s=CryptoJS.enc.Base64.parse(p);<span class="cstat-no" title="statement not covered" >v</span>ar q=CryptoJS.enc.Hex.stringify(s);<span class="cstat-no" title="statement not covered" >v</span>ar u=i[v]["proc"];<span class="cstat-no" title="statement not covered" >v</span>ar t=u(q,r,w);<span class="cstat-no" title="statement not covered" >r</span>eturn t}</span>;var h=<span class="fstat-no" title="function not covered" >function(p,s,q,u){<span class="cstat-no" title="statement not covered" ></span>var r=i[s]["eproc"];<span class="cstat-no" title="statement not covered" >v</span>ar t=r(p,q,u);<span class="cstat-no" title="statement not covered" >r</span>eturn t}</span>;return{version:"1.0.0",getHexFromPEM:<span class="fstat-no" title="function not covered" >function(p,q){<span class="cstat-no" title="statement not covered" ></span>return ASN1HEX.pemToHex(p,q)}</span>,getDecryptedKeyHexByKeyIV:<span class="fstat-no" title="function not covered" >function(q,t,s,r){<span class="cstat-no" title="statement not covered" ></span>var p=c(t);<span class="cstat-no" title="statement not covered" >r</span>eturn p(q,s,r)}</span>,parsePKCS5PEM:<span class="fstat-no" title="function not covered" >function(p){<span class="cstat-no" title="statement not covered" ></span>return n(p)}</span>,getKeyAndUnusedIvByPasscodeAndIvsalt:<span class="fstat-no" title="function not covered" >function(q,p,r){<span class="cstat-no" title="statement not covered" ></span>return j(q,p,r)}</span>,decryptKeyB64:<span class="fstat-no" title="function not covered" >function(p,r,q,s){<span class="cstat-no" title="statement not covered" ></span>return b(p,r,q,s)}</span>,getDecryptedKeyHex:<span class="fstat-no" title="function not covered" >function(y,x){<span class="cstat-no" title="statement not covered" ></span>var q=n(y);<span class="cstat-no" title="statement not covered" >v</span>ar t=q.type;<span class="cstat-no" title="statement not covered" >v</span>ar r=q.cipher;<span class="cstat-no" title="statement not covered" >v</span>ar p=q.ivsalt;<span class="cstat-no" title="statement not covered" >v</span>ar s=q.data;<span class="cstat-no" title="statement not covered" >v</span>ar w=j(r,x,p);<span class="cstat-no" title="statement not covered" >v</span>ar v=w.keyhex;<span class="cstat-no" title="statement not covered" >v</span>ar u=b(s,r,v,p);<span class="cstat-no" title="statement not covered" >r</span>eturn u}</span>,getRSAKeyFromEncryptedPKCS5PEM:<span class="fstat-no" title="function not covered" >function(r,q){<span class="cstat-no" title="statement not covered" ></span>var s=this.getDecryptedKeyHex(r,q);<span class="cstat-no" title="statement not covered" >v</span>ar p=new RSAKey();<span class="cstat-no" title="statement not covered" >p</span>.readPrivateKeyFromASN1HexString(s);<span class="cstat-no" title="statement not covered" >r</span>eturn p}</span>,getEncryptedPKCS5PEMFromPrvKeyHex:<span class="fstat-no" title="function not covered" >function(x,s,A,t,r){<span class="cstat-no" title="statement not covered" ></span>var p="";<span class="cstat-no" title="statement not covered" >i</span>f(typeof t=="undefined"||t==null){<span class="cstat-no" title="statement not covered" >t="AES-256-CBC"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof i[t]=="undefined"){<span class="cstat-no" title="statement not covered" >throw"KEYUTIL unsupported algorithm: "+t}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof r=="undefined"||r==null){<span class="cstat-no" title="statement not covered" >var v=i[t]["ivlen"];<span class="cstat-no" title="statement not covered" >v</span>ar u=m(v);<span class="cstat-no" title="statement not covered" >r</span>=u.toUpperCase()}<span class="cstat-no" title="statement not covered" ></span>v</span>ar z=j(t,A,r);<span class="cstat-no" title="statement not covered" >v</span>ar y=z.keyhex;<span class="cstat-no" title="statement not covered" >v</span>ar w=h(s,t,y,r);<span class="cstat-no" title="statement not covered" >v</span>ar q=w.replace(/(.{64})/g,"$1\r\n");<span class="cstat-no" title="statement not covered" >v</span>ar p="-----BEGIN "+x+" PRIVATE KEY-----\r\n";<span class="cstat-no" title="statement not covered" >p</span>+="Proc-Type: 4,ENCRYPTED\r\n";<span class="cstat-no" title="statement not covered" >p</span>+="DEK-Info: "+t+","+r+"\r\n";<span class="cstat-no" title="statement not covered" >p</span>+="\r\n";<span class="cstat-no" title="statement not covered" >p</span>+=q;<span class="cstat-no" title="statement not covered" >p</span>+="\r\n-----END "+x+" PRIVATE KEY-----\r\n";<span class="cstat-no" title="statement not covered" >r</span>eturn p}</span>,getEncryptedPKCS5PEMFromRSAKey:<span class="fstat-no" title="function not covered" >function(D,E,r,t){<span class="cstat-no" title="statement not covered" ></span>var B=new KJUR.asn1.DERInteger({"int":0});<span class="cstat-no" title="statement not covered" >v</span>ar w=new KJUR.asn1.DERInteger({bigint:D.n});<span class="cstat-no" title="statement not covered" >v</span>ar A=new KJUR.asn1.DERInteger({"int":D.e});<span class="cstat-no" title="statement not covered" >v</span>ar C=new KJUR.asn1.DERInteger({bigint:D.d});<span class="cstat-no" title="statement not covered" >v</span>ar u=new KJUR.asn1.DERInteger({bigint:D.p});<span class="cstat-no" title="statement not covered" >v</span>ar s=new KJUR.asn1.DERInteger({bigint:D.q});<span class="cstat-no" title="statement not covered" >v</span>ar z=new KJUR.asn1.DERInteger({bigint:D.dmp1});<span class="cstat-no" title="statement not covered" >v</span>ar v=new KJUR.asn1.DERInteger({bigint:D.dmq1});<span class="cstat-no" title="statement not covered" >v</span>ar y=new KJUR.asn1.DERInteger({bigint:D.coeff});<span class="cstat-no" title="statement not covered" >v</span>ar F=new KJUR.asn1.DERSequence({array:[B,w,A,C,u,s,z,v,y]});<span class="cstat-no" title="statement not covered" >v</span>ar x=F.getEncodedHex();<span class="cstat-no" title="statement not covered" >r</span>eturn this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",x,E,r,t)}</span>,newEncryptedPKCS5PEM:<span class="fstat-no" title="function not covered" >function(p,q,t,u){<span class="cstat-no" title="statement not covered" ></span>if(typeof q=="undefined"||q==null){<span class="cstat-no" title="statement not covered" >q=1024}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof t=="undefined"||t==null){<span class="cstat-no" title="statement not covered" >t="10001"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar r=new RSAKey();<span class="cstat-no" title="statement not covered" >r</span>.generate(q,t);<span class="cstat-no" title="statement not covered" >v</span>ar s=null;<span class="cstat-no" title="statement not covered" >i</span>f(typeof u=="undefined"||u==null){<span class="cstat-no" title="statement not covered" >s=this.getEncryptedPKCS5PEMFromRSAKey(r,p)}</span>else{<span class="cstat-no" title="statement not covered" >s=this.getEncryptedPKCS5PEMFromRSAKey(r,p,u)}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn s}</span>,getRSAKeyFromPlainPKCS8PEM:<span class="fstat-no" title="function not covered" >function(r){<span class="cstat-no" title="statement not covered" ></span>if(r.match(/ENCRYPTED/)){<span class="cstat-no" title="statement not covered" >throw"pem shall be not ENCRYPTED"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar q=ASN1HEX.pemToHex(r,"PRIVATE KEY");<span class="cstat-no" title="statement not covered" >v</span>ar p=this.getRSAKeyFromPlainPKCS8Hex(q);<span class="cstat-no" title="statement not covered" >r</span>eturn p}</span>,getRSAKeyFromPlainPKCS8Hex:<span class="fstat-no" title="function not covered" >function(q){<span class="cstat-no" title="statement not covered" ></span>var p=new RSAKey();<span class="cstat-no" title="statement not covered" >p</span>.readPKCS8PrvKeyHex(q);<span class="cstat-no" title="statement not covered" >r</span>eturn p}</span>,parseHexOfEncryptedPKCS8:<span class="fstat-no" title="function not covered" >function(w){<span class="cstat-no" title="statement not covered" ></span>var s={};<span class="cstat-no" title="statement not covered" >v</span>ar r=ASN1HEX.getPosArrayOfChildren_AtObj(w,0);<span class="cstat-no" title="statement not covered" >i</span>f(r.length!=2){<span class="cstat-no" title="statement not covered" >throw"malformed format: SEQUENCE(0).items != 2: "+r.length}<span class="cstat-no" title="statement not covered" ></span>s</span>.ciphertext=ASN1HEX.getHexOfV_AtObj(w,r[1]);<span class="cstat-no" title="statement not covered" >v</span>ar y=ASN1HEX.getPosArrayOfChildren_AtObj(w,r[0]);<span class="cstat-no" title="statement not covered" >i</span>f(y.length!=2){<span class="cstat-no" title="statement not covered" >throw"malformed format: SEQUENCE(0.0).items != 2: "+y.length}<span class="cstat-no" title="statement not covered" ></span>i</span>f(ASN1HEX.getHexOfV_AtObj(w,y[0])!="2a864886f70d01050d"){<span class="cstat-no" title="statement not covered" >throw"this only supports pkcs5PBES2"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar p=ASN1HEX.getPosArrayOfChildren_AtObj(w,y[1]);<span class="cstat-no" title="statement not covered" >i</span>f(y.length!=2){<span class="cstat-no" title="statement not covered" >throw"malformed format: SEQUENCE(0.0.1).items != 2: "+p.length}<span class="cstat-no" title="statement not covered" ></span>v</span>ar q=ASN1HEX.getPosArrayOfChildren_AtObj(w,p[1]);<span class="cstat-no" title="statement not covered" >i</span>f(q.length!=2){<span class="cstat-no" title="statement not covered" >throw"malformed format: SEQUENCE(0.0.1.1).items != 2: "+q.length}<span class="cstat-no" title="statement not covered" ></span>i</span>f(ASN1HEX.getHexOfV_AtObj(w,q[0])!="2a864886f70d0307"){<span class="cstat-no" title="statement not covered" >throw"this only supports TripleDES"}<span class="cstat-no" title="statement not covered" ></span>s</span>.encryptionSchemeAlg="TripleDES";<span class="cstat-no" title="statement not covered" >s</span>.encryptionSchemeIV=ASN1HEX.getHexOfV_AtObj(w,q[1]);<span class="cstat-no" title="statement not covered" >v</span>ar t=ASN1HEX.getPosArrayOfChildren_AtObj(w,p[0]);<span class="cstat-no" title="statement not covered" >i</span>f(t.length!=2){<span class="cstat-no" title="statement not covered" >throw"malformed format: SEQUENCE(0.0.1.0).items != 2: "+t.length}<span class="cstat-no" title="statement not covered" ></span>i</span>f(ASN1HEX.getHexOfV_AtObj(w,t[0])!="2a864886f70d01050c"){<span class="cstat-no" title="statement not covered" >throw"this only supports pkcs5PBKDF2"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar x=ASN1HEX.getPosArrayOfChildren_AtObj(w,t[1]);<span class="cstat-no" title="statement not covered" >i</span>f(x.length&lt;2){<span class="cstat-no" title="statement not covered" >throw"malformed format: SEQUENCE(0.0.1.0.1).items &lt; 2: "+x.length}<span class="cstat-no" title="statement not covered" ></span>s</span>.pbkdf2Salt=ASN1HEX.getHexOfV_AtObj(w,x[0]);<span class="cstat-no" title="statement not covered" >v</span>ar u=ASN1HEX.getHexOfV_AtObj(w,x[1]);<span class="cstat-no" title="statement not covered" >t</span>ry{<span class="cstat-no" title="statement not covered" >s.pbkdf2Iter=parseInt(u,16)}</span>catch(v){<span class="cstat-no" title="statement not covered" >throw"malformed format pbkdf2Iter: "+u}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn s}</span>,getPBKDF2KeyHexFromParam:<span class="fstat-no" title="function not covered" >function(u,p){<span class="cstat-no" title="statement not covered" ></span>var t=CryptoJS.enc.Hex.parse(u.pbkdf2Salt);<span class="cstat-no" title="statement not covered" >v</span>ar q=u.pbkdf2Iter;<span class="cstat-no" title="statement not covered" >v</span>ar s=CryptoJS.PBKDF2(p,t,{keySize:192/32,iterations:q});<span class="cstat-no" title="statement not covered" >v</span>ar r=CryptoJS.enc.Hex.stringify(s);<span class="cstat-no" title="statement not covered" >r</span>eturn r}</span>,getPlainPKCS8HexFromEncryptedPKCS8PEM:<span class="fstat-no" title="function not covered" >function(x,y){<span class="cstat-no" title="statement not covered" ></span>var r=ASN1HEX.pemToHex(x,"ENCRYPTED PRIVATE KEY");<span class="cstat-no" title="statement not covered" >v</span>ar p=this.parseHexOfEncryptedPKCS8(r);<span class="cstat-no" title="statement not covered" >v</span>ar u=KEYUTIL.getPBKDF2KeyHexFromParam(p,y);<span class="cstat-no" title="statement not covered" >v</span>ar v={};<span class="cstat-no" title="statement not covered" >v</span>.ciphertext=CryptoJS.enc.Hex.parse(p.ciphertext);<span class="cstat-no" title="statement not covered" >v</span>ar t=CryptoJS.enc.Hex.parse(u);<span class="cstat-no" title="statement not covered" >v</span>ar s=CryptoJS.enc.Hex.parse(p.encryptionSchemeIV);<span class="cstat-no" title="statement not covered" >v</span>ar w=CryptoJS.TripleDES.decrypt(v,t,{iv:s});<span class="cstat-no" title="statement not covered" >v</span>ar q=CryptoJS.enc.Hex.stringify(w);<span class="cstat-no" title="statement not covered" >r</span>eturn q}</span>,getRSAKeyFromEncryptedPKCS8PEM:<span class="fstat-no" title="function not covered" >function(s,r){<span class="cstat-no" title="statement not covered" ></span>var q=this.getPlainPKCS8HexFromEncryptedPKCS8PEM(s,r);<span class="cstat-no" title="statement not covered" >v</span>ar p=this.getRSAKeyFromPlainPKCS8Hex(q);<span class="cstat-no" title="statement not covered" >r</span>eturn p}</span>,getKeyFromEncryptedPKCS8PEM:<span class="fstat-no" title="function not covered" >function(s,q){<span class="cstat-no" title="statement not covered" ></span>var p=this.getPlainPKCS8HexFromEncryptedPKCS8PEM(s,q);<span class="cstat-no" title="statement not covered" >v</span>ar r=this.getKeyFromPlainPrivatePKCS8Hex(p);<span class="cstat-no" title="statement not covered" >r</span>eturn r}</span>,parsePlainPrivatePKCS8Hex:<span class="fstat-no" title="function not covered" >function(s){<span class="cstat-no" title="statement not covered" ></span>var q={};<span class="cstat-no" title="statement not covered" >q</span>.algparam=null;<span class="cstat-no" title="statement not covered" >i</span>f(s.substr(0,2)!="30"){<span class="cstat-no" title="statement not covered" >throw"malformed plain PKCS8 private key(code:001)"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar r=ASN1HEX.getPosArrayOfChildren_AtObj(s,0);<span class="cstat-no" title="statement not covered" >i</span>f(r.length!=3){<span class="cstat-no" title="statement not covered" >throw"malformed plain PKCS8 private key(code:002)"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(s.substr(r[1],2)!="30"){<span class="cstat-no" title="statement not covered" >throw"malformed PKCS8 private key(code:003)"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar p=ASN1HEX.getPosArrayOfChildren_AtObj(s,r[1]);<span class="cstat-no" title="statement not covered" >i</span>f(p.length!=2){<span class="cstat-no" title="statement not covered" >throw"malformed PKCS8 private key(code:004)"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(s.substr(p[0],2)!="06"){<span class="cstat-no" title="statement not covered" >throw"malformed PKCS8 private key(code:005)"}<span class="cstat-no" title="statement not covered" ></span>q</span>.algoid=ASN1HEX.getHexOfV_AtObj(s,p[0]);<span class="cstat-no" title="statement not covered" >i</span>f(s.substr(p[1],2)=="06"){<span class="cstat-no" title="statement not covered" >q.algparam=ASN1HEX.getHexOfV_AtObj(s,p[1])}<span class="cstat-no" title="statement not covered" ></span>i</span>f(s.substr(r[2],2)!="04"){<span class="cstat-no" title="statement not covered" >throw"malformed PKCS8 private key(code:006)"}<span class="cstat-no" title="statement not covered" ></span>q</span>.keyidx=ASN1HEX.getStartPosOfV_AtObj(s,r[2]);<span class="cstat-no" title="statement not covered" >r</span>eturn q}</span>,getKeyFromPlainPrivatePKCS8PEM:<span class="fstat-no" title="function not covered" >function(q){<span class="cstat-no" title="statement not covered" ></span>var p=ASN1HEX.pemToHex(q,"PRIVATE KEY");<span class="cstat-no" title="statement not covered" >v</span>ar r=this.getKeyFromPlainPrivatePKCS8Hex(p);<span class="cstat-no" title="statement not covered" >r</span>eturn r}</span>,getKeyFromPlainPrivatePKCS8Hex:<span class="fstat-no" title="function not covered" >function(p){<span class="cstat-no" title="statement not covered" ></span>var q=this.parsePlainPrivatePKCS8Hex(p);<span class="cstat-no" title="statement not covered" >v</span>ar r;<span class="cstat-no" title="statement not covered" >i</span>f(q.algoid=="2a864886f70d010101"){<span class="cstat-no" title="statement not covered" >r=new RSAKey()}</span>else{<span class="cstat-no" title="statement not covered" >if(q.algoid=="2a8648ce380401"){<span class="cstat-no" title="statement not covered" >r=new KJUR.crypto.DSA()}</span>else{<span class="cstat-no" title="statement not covered" >if(q.algoid=="2a8648ce3d0201"){<span class="cstat-no" title="statement not covered" >r=new KJUR.crypto.ECDSA()}</span>else{<span class="cstat-no" title="statement not covered" >throw"unsupported private key algorithm"}</span>}</span>}<span class="cstat-no" title="statement not covered" ></span>r</span>.readPKCS8PrvKeyHex(p);<span class="cstat-no" title="statement not covered" >r</span>eturn r}</span>,getRSAKeyFromPublicPKCS8PEM:<span class="fstat-no" title="function not covered" >function(q){<span class="cstat-no" title="statement not covered" ></span>var r=ASN1HEX.pemToHex(q,"PUBLIC KEY");<span class="cstat-no" title="statement not covered" >v</span>ar p=this.getRSAKeyFromPublicPKCS8Hex(r);<span class="cstat-no" title="statement not covered" >r</span>eturn p}</span>,getKeyFromPublicPKCS8PEM:<span class="fstat-no" title="function not covered" >function(q){<span class="cstat-no" title="statement not covered" ></span>var r=ASN1HEX.pemToHex(q,"PUBLIC KEY");<span class="cstat-no" title="statement not covered" >v</span>ar p=this.getKeyFromPublicPKCS8Hex(r);<span class="cstat-no" title="statement not covered" >r</span>eturn p}</span>,getKeyFromPublicPKCS8Hex:<span class="fstat-no" title="function not covered" >function(q){<span class="cstat-no" title="statement not covered" ></span>var p;<span class="cstat-no" title="statement not covered" >v</span>ar r=ASN1HEX.getVbyList(q,0,[0,0],"06");<span class="cstat-no" title="statement not covered" >i</span>f(r==="2a864886f70d010101"){<span class="cstat-no" title="statement not covered" >p=new RSAKey()}</span>else{<span class="cstat-no" title="statement not covered" >if(r==="2a8648ce380401"){<span class="cstat-no" title="statement not covered" >p=new KJUR.crypto.DSA()}</span>else{<span class="cstat-no" title="statement not covered" >if(r==="2a8648ce3d0201"){<span class="cstat-no" title="statement not covered" >p=new KJUR.crypto.ECDSA()}</span>else{<span class="cstat-no" title="statement not covered" >throw"unsupported PKCS#8 public key hex"}</span>}</span>}<span class="cstat-no" title="statement not covered" ></span>p</span>.readPKCS8PubKeyHex(q);<span class="cstat-no" title="statement not covered" >r</span>eturn p}</span>,parsePublicRawRSAKeyHex:<span class="fstat-no" title="function not covered" >function(r){<span class="cstat-no" title="statement not covered" ></span>var p={};<span class="cstat-no" title="statement not covered" >i</span>f(r.substr(0,2)!="30"){<span class="cstat-no" title="statement not covered" >throw"malformed RSA key(code:001)"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar q=ASN1HEX.getPosArrayOfChildren_AtObj(r,0);<span class="cstat-no" title="statement not covered" >i</span>f(q.length!=2){<span class="cstat-no" title="statement not covered" >throw"malformed RSA key(code:002)"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(r.substr(q[0],2)!="02"){<span class="cstat-no" title="statement not covered" >throw"malformed RSA key(code:003)"}<span class="cstat-no" title="statement not covered" ></span>p</span>.n=ASN1HEX.getHexOfV_AtObj(r,q[0]);<span class="cstat-no" title="statement not covered" >i</span>f(r.substr(q[1],2)!="02"){<span class="cstat-no" title="statement not covered" >throw"malformed RSA key(code:004)"}<span class="cstat-no" title="statement not covered" ></span>p</span>.e=ASN1HEX.getHexOfV_AtObj(r,q[1]);<span class="cstat-no" title="statement not covered" >r</span>eturn p}</span>,parsePrivateRawRSAKeyHexAtObj:<span class="fstat-no" title="function not covered" >function(q,u){<span class="cstat-no" title="statement not covered" ></span>var t=ASN1HEX;<span class="cstat-no" title="statement not covered" >v</span>ar r=t.getHexOfV_AtObj;<span class="cstat-no" title="statement not covered" >v</span>ar s=t.getDecendantIndexByNthList(q,0,[2,0]);<span class="cstat-no" title="statement not covered" >v</span>ar p=t.getPosArrayOfChildren_AtObj(q,s);<span class="cstat-no" title="statement not covered" >i</span>f(p.length!==9){<span class="cstat-no" title="statement not covered" >throw"malformed PKCS#8 plain RSA private key"}<span class="cstat-no" title="statement not covered" ></span>u</span>.key={};<span class="cstat-no" title="statement not covered" >u</span>.key.n=r(q,p[1]);<span class="cstat-no" title="statement not covered" >u</span>.key.e=r(q,p[2]);<span class="cstat-no" title="statement not covered" >u</span>.key.d=r(q,p[3]);<span class="cstat-no" title="statement not covered" >u</span>.key.p=r(q,p[4]);<span class="cstat-no" title="statement not covered" >u</span>.key.q=r(q,p[5]);<span class="cstat-no" title="statement not covered" >u</span>.key.dp=r(q,p[6]);<span class="cstat-no" title="statement not covered" >u</span>.key.dq=r(q,p[7]);<span class="cstat-no" title="statement not covered" >u</span>.key.co=r(q,p[8])}</span>,parsePrivateRawECKeyHexAtObj:<span class="fstat-no" title="function not covered" >function(p,t){<span class="cstat-no" title="statement not covered" ></span>var s=ASN1HEX;<span class="cstat-no" title="statement not covered" >v</span>ar q=t.keyidx;<span class="cstat-no" title="statement not covered" >v</span>ar r=new KJUR.crypto.ECDSA();<span class="cstat-no" title="statement not covered" >r</span>.readPKCS8PrvKeyHex(p);<span class="cstat-no" title="statement not covered" >t</span>.key=r.prvKeyHex;<span class="cstat-no" title="statement not covered" >t</span>.pubkey=r.pubKeyHex}</span>,parsePublicPKCS8Hex:<span class="fstat-no" title="function not covered" >function(s){<span class="cstat-no" title="statement not covered" ></span>var q={};<span class="cstat-no" title="statement not covered" >q</span>.algparam=null;<span class="cstat-no" title="statement not covered" >v</span>ar r=ASN1HEX.getPosArrayOfChildren_AtObj(s,0);<span class="cstat-no" title="statement not covered" >i</span>f(r.length!=2){<span class="cstat-no" title="statement not covered" >throw"outer DERSequence shall have 2 elements: "+r.length}<span class="cstat-no" title="statement not covered" ></span>v</span>ar t=r[0];<span class="cstat-no" title="statement not covered" >i</span>f(s.substr(t,2)!="30"){<span class="cstat-no" title="statement not covered" >throw"malformed PKCS8 public key(code:001)"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar p=ASN1HEX.getPosArrayOfChildren_AtObj(s,t);<span class="cstat-no" title="statement not covered" >i</span>f(p.length!=2){<span class="cstat-no" title="statement not covered" >throw"malformed PKCS8 public key(code:002)"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(s.substr(p[0],2)!="06"){<span class="cstat-no" title="statement not covered" >throw"malformed PKCS8 public key(code:003)"}<span class="cstat-no" title="statement not covered" ></span>q</span>.algoid=ASN1HEX.getHexOfV_AtObj(s,p[0]);<span class="cstat-no" title="statement not covered" >i</span>f(s.substr(p[1],2)=="06"){<span class="cstat-no" title="statement not covered" >q.algparam=ASN1HEX.getHexOfV_AtObj(s,p[1])}</span>else{<span class="cstat-no" title="statement not covered" >if(s.substr(p[1],2)=="30"){<span class="cstat-no" title="statement not covered" >q.algparam={};<span class="cstat-no" title="statement not covered" >q</span>.algparam.p=ASN1HEX.getVbyList(s,p[1],[0],"02");<span class="cstat-no" title="statement not covered" >q</span>.algparam.q=ASN1HEX.getVbyList(s,p[1],[1],"02");<span class="cstat-no" title="statement not covered" >q</span>.algparam.g=ASN1HEX.getVbyList(s,p[1],[2],"02")}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(s.substr(r[1],2)!="03"){<span class="cstat-no" title="statement not covered" >throw"malformed PKCS8 public key(code:004)"}<span class="cstat-no" title="statement not covered" ></span>q</span>.key=ASN1HEX.getHexOfV_AtObj(s,r[1]).substr(2);<span class="cstat-no" title="statement not covered" >r</span>eturn q}</span>,getRSAKeyFromPublicPKCS8Hex:<span class="fstat-no" title="function not covered" >function(p){<span class="cstat-no" title="statement not covered" ></span>var q=new RSAKey();<span class="cstat-no" title="statement not covered" >q</span>.readPKCS8PubKeyHex(p);<span class="cstat-no" title="statement not covered" >r</span>eturn q}</span>,}}();KEYUTIL.getKey=<span class="fstat-no" title="function not covered" >function(i,f,j){<span class="cstat-no" title="statement not covered" ></span>if(typeof RSAKey!="undefined"&amp;&amp;i instanceof RSAKey){<span class="cstat-no" title="statement not covered" >return i}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof KJUR.crypto.ECDSA!="undefined"&amp;&amp;i instanceof KJUR.crypto.ECDSA){<span class="cstat-no" title="statement not covered" >return i}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof KJUR.crypto.DSA!="undefined"&amp;&amp;i instanceof KJUR.crypto.DSA){<span class="cstat-no" title="statement not covered" >return i}<span class="cstat-no" title="statement not covered" ></span>i</span>f(i.curve!==undefined&amp;&amp;i.xy!==undefined&amp;&amp;i.d===undefined){<span class="cstat-no" title="statement not covered" >return new KJUR.crypto.ECDSA({pub:i.xy,curve:i.curve})}<span class="cstat-no" title="statement not covered" ></span>i</span>f(i.curve!==undefined&amp;&amp;i.d!==undefined){<span class="cstat-no" title="statement not covered" >return new KJUR.crypto.ECDSA({prv:i.d,curve:i.curve})}<span class="cstat-no" title="statement not covered" ></span>i</span>f(i.kty===undefined&amp;&amp;i.n!==undefined&amp;&amp;i.e!==undefined&amp;&amp;i.d===undefined){<span class="cstat-no" title="statement not covered" >var D=new RSAKey();<span class="cstat-no" title="statement not covered" >D</span>.setPublic(i.n,i.e);<span class="cstat-no" title="statement not covered" >r</span>eturn D}<span class="cstat-no" title="statement not covered" ></span>i</span>f(i.kty===undefined&amp;&amp;i.n!==undefined&amp;&amp;i.e!==undefined&amp;&amp;i.d!==undefined&amp;&amp;i.p!==undefined&amp;&amp;i.q!==undefined&amp;&amp;i.dp!==undefined&amp;&amp;i.dq!==undefined&amp;&amp;i.co!==undefined&amp;&amp;i.qi===undefined){<span class="cstat-no" title="statement not covered" >var D=new RSAKey();<span class="cstat-no" title="statement not covered" >D</span>.setPrivateEx(i.n,i.e,i.d,i.p,i.q,i.dp,i.dq,i.co);<span class="cstat-no" title="statement not covered" >r</span>eturn D}<span class="cstat-no" title="statement not covered" ></span>i</span>f(i.kty===undefined&amp;&amp;i.n!==undefined&amp;&amp;i.e!==undefined&amp;&amp;i.d!==undefined&amp;&amp;i.p===undefined){<span class="cstat-no" title="statement not covered" >var D=new RSAKey();<span class="cstat-no" title="statement not covered" >D</span>.setPrivate(i.n,i.e,i.d);<span class="cstat-no" title="statement not covered" >r</span>eturn D}<span class="cstat-no" title="statement not covered" ></span>i</span>f(i.p!==undefined&amp;&amp;i.q!==undefined&amp;&amp;i.g!==undefined&amp;&amp;i.y!==undefined&amp;&amp;i.x===undefined){<span class="cstat-no" title="statement not covered" >var D=new KJUR.crypto.DSA();<span class="cstat-no" title="statement not covered" >D</span>.setPublic(i.p,i.q,i.g,i.y);<span class="cstat-no" title="statement not covered" >r</span>eturn D}<span class="cstat-no" title="statement not covered" ></span>i</span>f(i.p!==undefined&amp;&amp;i.q!==undefined&amp;&amp;i.g!==undefined&amp;&amp;i.y!==undefined&amp;&amp;i.x!==undefined){<span class="cstat-no" title="statement not covered" >var D=new KJUR.crypto.DSA();<span class="cstat-no" title="statement not covered" >D</span>.setPrivate(i.p,i.q,i.g,i.y,i.x);<span class="cstat-no" title="statement not covered" >r</span>eturn D}<span class="cstat-no" title="statement not covered" ></span>i</span>f(i.kty==="RSA"&amp;&amp;i.n!==undefined&amp;&amp;i.e!==undefined&amp;&amp;i.d===undefined){<span class="cstat-no" title="statement not covered" >var D=new RSAKey();<span class="cstat-no" title="statement not covered" >D</span>.setPublic(b64utohex(i.n),b64utohex(i.e));<span class="cstat-no" title="statement not covered" >r</span>eturn D}<span class="cstat-no" title="statement not covered" ></span>i</span>f(i.kty==="RSA"&amp;&amp;i.n!==undefined&amp;&amp;i.e!==undefined&amp;&amp;i.d!==undefined&amp;&amp;i.p!==undefined&amp;&amp;i.q!==undefined&amp;&amp;i.dp!==undefined&amp;&amp;i.dq!==undefined&amp;&amp;i.qi!==undefined){<span class="cstat-no" title="statement not covered" >var D=new RSAKey();<span class="cstat-no" title="statement not covered" >D</span>.setPrivateEx(b64utohex(i.n),b64utohex(i.e),b64utohex(i.d),b64utohex(i.p),b64utohex(i.q),b64utohex(i.dp),b64utohex(i.dq),b64utohex(i.qi));<span class="cstat-no" title="statement not covered" >r</span>eturn D}<span class="cstat-no" title="statement not covered" ></span>i</span>f(i.kty==="RSA"&amp;&amp;i.n!==undefined&amp;&amp;i.e!==undefined&amp;&amp;i.d!==undefined){<span class="cstat-no" title="statement not covered" >var D=new RSAKey();<span class="cstat-no" title="statement not covered" >D</span>.setPrivate(b64utohex(i.n),b64utohex(i.e),b64utohex(i.d));<span class="cstat-no" title="statement not covered" >r</span>eturn D}<span class="cstat-no" title="statement not covered" ></span>i</span>f(i.kty==="EC"&amp;&amp;i.crv!==undefined&amp;&amp;i.x!==undefined&amp;&amp;i.y!==undefined&amp;&amp;i.d===undefined){<span class="cstat-no" title="statement not covered" >var e=new KJUR.crypto.ECDSA({curve:i.crv});<span class="cstat-no" title="statement not covered" >v</span>ar n=e.ecparams.keylen/4;<span class="cstat-no" title="statement not covered" >v</span>ar t=("0000000000"+b64utohex(i.x)).slice(-n);<span class="cstat-no" title="statement not covered" >v</span>ar r=("0000000000"+b64utohex(i.y)).slice(-n);<span class="cstat-no" title="statement not covered" >v</span>ar o="04"+t+r;<span class="cstat-no" title="statement not covered" >e</span>.setPublicKeyHex(o);<span class="cstat-no" title="statement not covered" >r</span>eturn e}<span class="cstat-no" title="statement not covered" ></span>i</span>f(i.kty==="EC"&amp;&amp;i.crv!==undefined&amp;&amp;i.x!==undefined&amp;&amp;i.y!==undefined&amp;&amp;i.d!==undefined){<span class="cstat-no" title="statement not covered" >var e=new KJUR.crypto.ECDSA({curve:i.crv});<span class="cstat-no" title="statement not covered" >v</span>ar n=e.ecparams.keylen/4;<span class="cstat-no" title="statement not covered" >v</span>ar t=("0000000000"+b64utohex(i.x)).slice(-n);<span class="cstat-no" title="statement not covered" >v</span>ar r=("0000000000"+b64utohex(i.y)).slice(-n);<span class="cstat-no" title="statement not covered" >v</span>ar o="04"+t+r;<span class="cstat-no" title="statement not covered" >v</span>ar b=("0000000000"+b64utohex(i.d)).slice(-n);<span class="cstat-no" title="statement not covered" >e</span>.setPublicKeyHex(o);<span class="cstat-no" title="statement not covered" >e</span>.setPrivateKeyHex(b);<span class="cstat-no" title="statement not covered" >r</span>eturn e}<span class="cstat-no" title="statement not covered" ></span>i</span>f(j==="pkcs5prv"){<span class="cstat-no" title="statement not covered" >var A=i,w=ASN1HEX,C,D;<span class="cstat-no" title="statement not covered" >C</span>=w.getPosArrayOfChildren_AtObj(A,0);<span class="cstat-no" title="statement not covered" >i</span>f(C.length===9){<span class="cstat-no" title="statement not covered" >D=new RSAKey();<span class="cstat-no" title="statement not covered" >D</span>.readPrivateKeyFromASN1HexString(i)}</span>else{<span class="cstat-no" title="statement not covered" >if(C.length===6){<span class="cstat-no" title="statement not covered" >D=new KJUR.crypto.DSA();<span class="cstat-no" title="statement not covered" >D</span>.readPKCS5PrvKeyHex(A)}</span>else{<span class="cstat-no" title="statement not covered" >if(C.length&gt;2&amp;&amp;A.substr(C[1],2)==="04"){<span class="cstat-no" title="statement not covered" >D=new KJUR.crypto.ECDSA();<span class="cstat-no" title="statement not covered" >D</span>.readPKCS5PrvKeyHex(A)}</span>else{<span class="cstat-no" title="statement not covered" >throw"unsupported PKCS#1/5 hexadecimal key"}</span>}</span>}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn D}<span class="cstat-no" title="statement not covered" ></span>i</span>f(j==="pkcs8prv"){<span class="cstat-no" title="statement not covered" >var D=KEYUTIL.getKeyFromPlainPrivatePKCS8Hex(i);<span class="cstat-no" title="statement not covered" >r</span>eturn D}<span class="cstat-no" title="statement not covered" ></span>i</span>f(j==="pkcs8pub"){<span class="cstat-no" title="statement not covered" >return KEYUTIL.getKeyFromPublicPKCS8Hex(i)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(j==="x509pub"){<span class="cstat-no" title="statement not covered" >return X509.getPublicKeyFromCertHex(i)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(i.indexOf("-END CERTIFICATE-",0)!=-1||i.indexOf("-END X509 CERTIFICATE-",0)!=-1||i.indexOf("-END TRUSTED CERTIFICATE-",0)!=-1){<span class="cstat-no" title="statement not covered" >return X509.getPublicKeyFromCertPEM(i)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(i.indexOf("-END PUBLIC KEY-")!=-1){<span class="cstat-no" title="statement not covered" >return KEYUTIL.getKeyFromPublicPKCS8PEM(i)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(i.indexOf("-END RSA PRIVATE KEY-")!=-1&amp;&amp;i.indexOf("4,ENCRYPTED")==-1){<span class="cstat-no" title="statement not covered" >var k=ASN1HEX.pemToHex(i,"RSA PRIVATE KEY");<span class="cstat-no" title="statement not covered" >r</span>eturn KEYUTIL.getKey(k,null,"pkcs5prv")}<span class="cstat-no" title="statement not covered" ></span>i</span>f(i.indexOf("-END DSA PRIVATE KEY-")!=-1&amp;&amp;i.indexOf("4,ENCRYPTED")==-1){<span class="cstat-no" title="statement not covered" >var z=ASN1HEX.pemToHex(i,"DSA PRIVATE KEY");<span class="cstat-no" title="statement not covered" >v</span>ar v=ASN1HEX.getVbyList(z,0,[1],"02");<span class="cstat-no" title="statement not covered" >v</span>ar u=ASN1HEX.getVbyList(z,0,[2],"02");<span class="cstat-no" title="statement not covered" >v</span>ar B=ASN1HEX.getVbyList(z,0,[3],"02");<span class="cstat-no" title="statement not covered" >v</span>ar l=ASN1HEX.getVbyList(z,0,[4],"02");<span class="cstat-no" title="statement not covered" >v</span>ar m=ASN1HEX.getVbyList(z,0,[5],"02");<span class="cstat-no" title="statement not covered" >v</span>ar D=new KJUR.crypto.DSA();<span class="cstat-no" title="statement not covered" >D</span>.setPrivate(new BigInteger(v,16),new BigInteger(u,16),new BigInteger(B,16),new BigInteger(l,16),new BigInteger(m,16));<span class="cstat-no" title="statement not covered" >r</span>eturn D}<span class="cstat-no" title="statement not covered" ></span>i</span>f(i.indexOf("-END PRIVATE KEY-")!=-1){<span class="cstat-no" title="statement not covered" >return KEYUTIL.getKeyFromPlainPrivatePKCS8PEM(i)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(i.indexOf("-END RSA PRIVATE KEY-")!=-1&amp;&amp;i.indexOf("4,ENCRYPTED")!=-1){<span class="cstat-no" title="statement not covered" >return KEYUTIL.getRSAKeyFromEncryptedPKCS5PEM(i,f)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(i.indexOf("-END EC PRIVATE KEY-")!=-1&amp;&amp;i.indexOf("4,ENCRYPTED")!=-1){<span class="cstat-no" title="statement not covered" >var z=KEYUTIL.getDecryptedKeyHex(i,f);<span class="cstat-no" title="statement not covered" >v</span>ar D=ASN1HEX.getVbyList(z,0,[1],"04");<span class="cstat-no" title="statement not covered" >v</span>ar d=ASN1HEX.getVbyList(z,0,[2,0],"06");<span class="cstat-no" title="statement not covered" >v</span>ar s=ASN1HEX.getVbyList(z,0,[3,0],"03").substr(2);<span class="cstat-no" title="statement not covered" >v</span>ar c="";<span class="cstat-no" title="statement not covered" >i</span>f(KJUR.crypto.OID.oidhex2name[d]!==undefined){<span class="cstat-no" title="statement not covered" >c=KJUR.crypto.OID.oidhex2name[d]}</span>else{<span class="cstat-no" title="statement not covered" >throw"undefined OID(hex) in KJUR.crypto.OID: "+d}<span class="cstat-no" title="statement not covered" ></span>v</span>ar e=new KJUR.crypto.ECDSA({curve:c});<span class="cstat-no" title="statement not covered" >e</span>.setPublicKeyHex(s);<span class="cstat-no" title="statement not covered" >e</span>.setPrivateKeyHex(D);<span class="cstat-no" title="statement not covered" >e</span>.isPublic=false;<span class="cstat-no" title="statement not covered" >r</span>eturn e}<span class="cstat-no" title="statement not covered" ></span>i</span>f(i.indexOf("-END DSA PRIVATE KEY-")!=-1&amp;&amp;i.indexOf("4,ENCRYPTED")!=-1){<span class="cstat-no" title="statement not covered" >var z=KEYUTIL.getDecryptedKeyHex(i,f);<span class="cstat-no" title="statement not covered" >v</span>ar v=ASN1HEX.getVbyList(z,0,[1],"02");<span class="cstat-no" title="statement not covered" >v</span>ar u=ASN1HEX.getVbyList(z,0,[2],"02");<span class="cstat-no" title="statement not covered" >v</span>ar B=ASN1HEX.getVbyList(z,0,[3],"02");<span class="cstat-no" title="statement not covered" >v</span>ar l=ASN1HEX.getVbyList(z,0,[4],"02");<span class="cstat-no" title="statement not covered" >v</span>ar m=ASN1HEX.getVbyList(z,0,[5],"02");<span class="cstat-no" title="statement not covered" >v</span>ar D=new KJUR.crypto.DSA();<span class="cstat-no" title="statement not covered" >D</span>.setPrivate(new BigInteger(v,16),new BigInteger(u,16),new BigInteger(B,16),new BigInteger(l,16),new BigInteger(m,16));<span class="cstat-no" title="statement not covered" >r</span>eturn D}<span class="cstat-no" title="statement not covered" ></span>i</span>f(i.indexOf("-END ENCRYPTED PRIVATE KEY-")!=-1){<span class="cstat-no" title="statement not covered" >return KEYUTIL.getKeyFromEncryptedPKCS8PEM(i,f)}<span class="cstat-no" title="statement not covered" ></span>t</span>hrow"not supported argument"}</span>;KEYUTIL.generateKeypair=<span class="fstat-no" title="function not covered" >function(a,c){<span class="cstat-no" title="statement not covered" ></span>if(a=="RSA"){<span class="cstat-no" title="statement not covered" >var b=c;<span class="cstat-no" title="statement not covered" >v</span>ar h=new RSAKey();<span class="cstat-no" title="statement not covered" >h</span>.generate(b,"10001");<span class="cstat-no" title="statement not covered" >h</span>.isPrivate=true;<span class="cstat-no" title="statement not covered" >h</span>.isPublic=true;<span class="cstat-no" title="statement not covered" >v</span>ar f=new RSAKey();<span class="cstat-no" title="statement not covered" >v</span>ar e=h.n.toString(16);<span class="cstat-no" title="statement not covered" >v</span>ar i=h.e.toString(16);<span class="cstat-no" title="statement not covered" >f</span>.setPublic(e,i);<span class="cstat-no" title="statement not covered" >f</span>.isPrivate=false;<span class="cstat-no" title="statement not covered" >f</span>.isPublic=true;<span class="cstat-no" title="statement not covered" >v</span>ar k={};<span class="cstat-no" title="statement not covered" >k</span>.prvKeyObj=h;<span class="cstat-no" title="statement not covered" >k</span>.pubKeyObj=f;<span class="cstat-no" title="statement not covered" >r</span>eturn k}</span>else{<span class="cstat-no" title="statement not covered" >if(a=="EC"){<span class="cstat-no" title="statement not covered" >var d=c;<span class="cstat-no" title="statement not covered" >v</span>ar g=new KJUR.crypto.ECDSA({curve:d});<span class="cstat-no" title="statement not covered" >v</span>ar j=g.generateKeyPairHex();<span class="cstat-no" title="statement not covered" >v</span>ar h=new KJUR.crypto.ECDSA({curve:d});<span class="cstat-no" title="statement not covered" >h</span>.setPublicKeyHex(j.ecpubhex);<span class="cstat-no" title="statement not covered" >h</span>.setPrivateKeyHex(j.ecprvhex);<span class="cstat-no" title="statement not covered" >h</span>.isPrivate=true;<span class="cstat-no" title="statement not covered" >h</span>.isPublic=false;<span class="cstat-no" title="statement not covered" >v</span>ar f=new KJUR.crypto.ECDSA({curve:d});<span class="cstat-no" title="statement not covered" >f</span>.setPublicKeyHex(j.ecpubhex);<span class="cstat-no" title="statement not covered" >f</span>.isPrivate=false;<span class="cstat-no" title="statement not covered" >f</span>.isPublic=true;<span class="cstat-no" title="statement not covered" >v</span>ar k={};<span class="cstat-no" title="statement not covered" >k</span>.prvKeyObj=h;<span class="cstat-no" title="statement not covered" >k</span>.pubKeyObj=f;<span class="cstat-no" title="statement not covered" >r</span>eturn k}</span>else{<span class="cstat-no" title="statement not covered" >throw"unknown algorithm: "+a}</span>}</span>}</span>;KEYUTIL.getPEM=<span class="fstat-no" title="function not covered" >function(a,r,o,g,j){<span class="cstat-no" title="statement not covered" ></span>var v=KJUR.asn1;<span class="cstat-no" title="statement not covered" >v</span>ar u=KJUR.crypto;<span class="fstat-no" title="function not covered" >f</span>unction p(s){<span class="cstat-no" title="statement not covered" ></span>var w=KJUR.asn1.ASN1Util.newObject({seq:[{"int":0},{"int":{bigint:s.n}},{"int":s.e},{"int":{bigint:s.d}},{"int":{bigint:s.p}},{"int":{bigint:s.q}},{"int":{bigint:s.dmp1}},{"int":{bigint:s.dmq1}},{"int":{bigint:s.coeff}}]});<span class="cstat-no" title="statement not covered" >r</span>eturn w}<span class="fstat-no" title="function not covered" ></span>function q(w){<span class="cstat-no" title="statement not covered" ></span>var s=KJUR.asn1.ASN1Util.newObject({seq:[{"int":1},{octstr:{hex:w.prvKeyHex}},{tag:["a0",true,{oid:{name:w.curveName}}]},{tag:["a1",true,{bitstr:{hex:"00"+w.pubKeyHex}}]}]});<span class="cstat-no" title="statement not covered" >r</span>eturn s}<span class="fstat-no" title="function not covered" ></span>function n(s){<span class="cstat-no" title="statement not covered" ></span>var w=KJUR.asn1.ASN1Util.newObject({seq:[{"int":0},{"int":{bigint:s.p}},{"int":{bigint:s.q}},{"int":{bigint:s.g}},{"int":{bigint:s.y}},{"int":{bigint:s.x}}]});<span class="cstat-no" title="statement not covered" >r</span>eturn w}<span class="cstat-no" title="statement not covered" ></span>if(((typeof RSAKey!="undefined"&amp;&amp;a instanceof RSAKey)||(typeof u.DSA!="undefined"&amp;&amp;a instanceof u.DSA)||(typeof u.ECDSA!="undefined"&amp;&amp;a instanceof u.ECDSA))&amp;&amp;a.isPublic==true&amp;&amp;(r===undefined||r=="PKCS8PUB")){<span class="cstat-no" title="statement not covered" >var t=new KJUR.asn1.x509.SubjectPublicKeyInfo(a);<span class="cstat-no" title="statement not covered" >v</span>ar m=t.getEncodedHex();<span class="cstat-no" title="statement not covered" >r</span>eturn v.ASN1Util.getPEMStringFromHex(m,"PUBLIC KEY")}<span class="cstat-no" title="statement not covered" ></span>i</span>f(r=="PKCS1PRV"&amp;&amp;typeof RSAKey!="undefined"&amp;&amp;a instanceof RSAKey&amp;&amp;(o===undefined||o==null)&amp;&amp;a.isPrivate==true){<span class="cstat-no" title="statement not covered" >var t=p(a);<span class="cstat-no" title="statement not covered" >v</span>ar m=t.getEncodedHex();<span class="cstat-no" title="statement not covered" >r</span>eturn v.ASN1Util.getPEMStringFromHex(m,"RSA PRIVATE KEY")}<span class="cstat-no" title="statement not covered" ></span>i</span>f(r=="PKCS1PRV"&amp;&amp;typeof RSAKey!="undefined"&amp;&amp;a instanceof KJUR.crypto.ECDSA&amp;&amp;(o===undefined||o==null)&amp;&amp;a.isPrivate==true){<span class="cstat-no" title="statement not covered" >var f=new KJUR.asn1.DERObjectIdentifier({name:a.curveName});<span class="cstat-no" title="statement not covered" >v</span>ar l=f.getEncodedHex();<span class="cstat-no" title="statement not covered" >v</span>ar e=q(a);<span class="cstat-no" title="statement not covered" >v</span>ar k=e.getEncodedHex();<span class="cstat-no" title="statement not covered" >v</span>ar i="";<span class="cstat-no" title="statement not covered" >i</span>+=v.ASN1Util.getPEMStringFromHex(l,"EC PARAMETERS");<span class="cstat-no" title="statement not covered" >i</span>+=v.ASN1Util.getPEMStringFromHex(k,"EC PRIVATE KEY");<span class="cstat-no" title="statement not covered" >r</span>eturn i}<span class="cstat-no" title="statement not covered" ></span>i</span>f(r=="PKCS1PRV"&amp;&amp;typeof KJUR.crypto.DSA!="undefined"&amp;&amp;a instanceof KJUR.crypto.DSA&amp;&amp;(o===undefined||o==null)&amp;&amp;a.isPrivate==true){<span class="cstat-no" title="statement not covered" >var t=n(a);<span class="cstat-no" title="statement not covered" >v</span>ar m=t.getEncodedHex();<span class="cstat-no" title="statement not covered" >r</span>eturn v.ASN1Util.getPEMStringFromHex(m,"DSA PRIVATE KEY")}<span class="cstat-no" title="statement not covered" ></span>i</span>f(r=="PKCS5PRV"&amp;&amp;typeof RSAKey!="undefined"&amp;&amp;a instanceof RSAKey&amp;&amp;(o!==undefined&amp;&amp;o!=null)&amp;&amp;a.isPrivate==true){<span class="cstat-no" title="statement not covered" >var t=p(a);<span class="cstat-no" title="statement not covered" >v</span>ar m=t.getEncodedHex();<span class="cstat-no" title="statement not covered" >i</span>f(g===undefined){<span class="cstat-no" title="statement not covered" >g="DES-EDE3-CBC"}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",m,o,g)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(r=="PKCS5PRV"&amp;&amp;typeof KJUR.crypto.ECDSA!="undefined"&amp;&amp;a instanceof KJUR.crypto.ECDSA&amp;&amp;(o!==undefined&amp;&amp;o!=null)&amp;&amp;a.isPrivate==true){<span class="cstat-no" title="statement not covered" >var t=q(a);<span class="cstat-no" title="statement not covered" >v</span>ar m=t.getEncodedHex();<span class="cstat-no" title="statement not covered" >i</span>f(g===undefined){<span class="cstat-no" title="statement not covered" >g="DES-EDE3-CBC"}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",m,o,g)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(r=="PKCS5PRV"&amp;&amp;typeof KJUR.crypto.DSA!="undefined"&amp;&amp;a instanceof KJUR.crypto.DSA&amp;&amp;(o!==undefined&amp;&amp;o!=null)&amp;&amp;a.isPrivate==true){<span class="cstat-no" title="statement not covered" >var t=n(a);<span class="cstat-no" title="statement not covered" >v</span>ar m=t.getEncodedHex();<span class="cstat-no" title="statement not covered" >i</span>f(g===undefined){<span class="cstat-no" title="statement not covered" >g="DES-EDE3-CBC"}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",m,o,g)}<span class="cstat-no" title="statement not covered" ></span>v</span>ar h=<span class="fstat-no" title="function not covered" >function(w,s){<span class="cstat-no" title="statement not covered" ></span>var y=b(w,s);<span class="cstat-no" title="statement not covered" >v</span>ar x=new KJUR.asn1.ASN1Util.newObject({seq:[{seq:[{oid:{name:"pkcs5PBES2"}},{seq:[{seq:[{oid:{name:"pkcs5PBKDF2"}},{seq:[{octstr:{hex:y.pbkdf2Salt}},{"int":y.pbkdf2Iter}]}]},{seq:[{oid:{name:"des-EDE3-CBC"}},{octstr:{hex:y.encryptionSchemeIV}}]}]}]},{octstr:{hex:y.ciphertext}}]});<span class="cstat-no" title="statement not covered" >r</span>eturn x.getEncodedHex()}</span>;<span class="cstat-no" title="statement not covered" >v</span>ar b=<span class="fstat-no" title="function not covered" >function(D,E){<span class="cstat-no" title="statement not covered" ></span>var x=100;<span class="cstat-no" title="statement not covered" >v</span>ar C=CryptoJS.lib.WordArray.random(8);<span class="cstat-no" title="statement not covered" >v</span>ar B="DES-EDE3-CBC";<span class="cstat-no" title="statement not covered" >v</span>ar s=CryptoJS.lib.WordArray.random(8);<span class="cstat-no" title="statement not covered" >v</span>ar y=CryptoJS.PBKDF2(E,C,{keySize:192/32,iterations:x});<span class="cstat-no" title="statement not covered" >v</span>ar z=CryptoJS.enc.Hex.parse(D);<span class="cstat-no" title="statement not covered" >v</span>ar A=CryptoJS.TripleDES.encrypt(z,y,{iv:s})+"";<span class="cstat-no" title="statement not covered" >v</span>ar w={};<span class="cstat-no" title="statement not covered" >w</span>.ciphertext=A;<span class="cstat-no" title="statement not covered" >w</span>.pbkdf2Salt=CryptoJS.enc.Hex.stringify(C);<span class="cstat-no" title="statement not covered" >w</span>.pbkdf2Iter=x;<span class="cstat-no" title="statement not covered" >w</span>.encryptionSchemeAlg=B;<span class="cstat-no" title="statement not covered" >w</span>.encryptionSchemeIV=CryptoJS.enc.Hex.stringify(s);<span class="cstat-no" title="statement not covered" >r</span>eturn w}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(r=="PKCS8PRV"&amp;&amp;typeof RSAKey!="undefined"&amp;&amp;a instanceof RSAKey&amp;&amp;a.isPrivate==true){<span class="cstat-no" title="statement not covered" >var d=p(a);<span class="cstat-no" title="statement not covered" >v</span>ar c=d.getEncodedHex();<span class="cstat-no" title="statement not covered" >v</span>ar t=KJUR.asn1.ASN1Util.newObject({seq:[{"int":0},{seq:[{oid:{name:"rsaEncryption"}},{"null":true}]},{octstr:{hex:c}}]});<span class="cstat-no" title="statement not covered" >v</span>ar m=t.getEncodedHex();<span class="cstat-no" title="statement not covered" >i</span>f(o===undefined||o==null){<span class="cstat-no" title="statement not covered" >return v.ASN1Util.getPEMStringFromHex(m,"PRIVATE KEY")}</span>else{<span class="cstat-no" title="statement not covered" >var k=h(m,o);<span class="cstat-no" title="statement not covered" >r</span>eturn v.ASN1Util.getPEMStringFromHex(k,"ENCRYPTED PRIVATE KEY")}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(r=="PKCS8PRV"&amp;&amp;typeof KJUR.crypto.ECDSA!="undefined"&amp;&amp;a instanceof KJUR.crypto.ECDSA&amp;&amp;a.isPrivate==true){<span class="cstat-no" title="statement not covered" >var d=new KJUR.asn1.ASN1Util.newObject({seq:[{"int":1},{octstr:{hex:a.prvKeyHex}},{tag:["a1",true,{bitstr:{hex:"00"+a.pubKeyHex}}]}]});<span class="cstat-no" title="statement not covered" >v</span>ar c=d.getEncodedHex();<span class="cstat-no" title="statement not covered" >v</span>ar t=KJUR.asn1.ASN1Util.newObject({seq:[{"int":0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:a.curveName}}]},{octstr:{hex:c}}]});<span class="cstat-no" title="statement not covered" >v</span>ar m=t.getEncodedHex();<span class="cstat-no" title="statement not covered" >i</span>f(o===undefined||o==null){<span class="cstat-no" title="statement not covered" >return v.ASN1Util.getPEMStringFromHex(m,"PRIVATE KEY")}</span>else{<span class="cstat-no" title="statement not covered" >var k=h(m,o);<span class="cstat-no" title="statement not covered" >r</span>eturn v.ASN1Util.getPEMStringFromHex(k,"ENCRYPTED PRIVATE KEY")}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(r=="PKCS8PRV"&amp;&amp;typeof KJUR.crypto.DSA!="undefined"&amp;&amp;a instanceof KJUR.crypto.DSA&amp;&amp;a.isPrivate==true){<span class="cstat-no" title="statement not covered" >var d=new KJUR.asn1.DERInteger({bigint:a.x});<span class="cstat-no" title="statement not covered" >v</span>ar c=d.getEncodedHex();<span class="cstat-no" title="statement not covered" >v</span>ar t=KJUR.asn1.ASN1Util.newObject({seq:[{"int":0},{seq:[{oid:{name:"dsa"}},{seq:[{"int":{bigint:a.p}},{"int":{bigint:a.q}},{"int":{bigint:a.g}}]}]},{octstr:{hex:c}}]});<span class="cstat-no" title="statement not covered" >v</span>ar m=t.getEncodedHex();<span class="cstat-no" title="statement not covered" >i</span>f(o===undefined||o==null){<span class="cstat-no" title="statement not covered" >return v.ASN1Util.getPEMStringFromHex(m,"PRIVATE KEY")}</span>else{<span class="cstat-no" title="statement not covered" >var k=h(m,o);<span class="cstat-no" title="statement not covered" >r</span>eturn v.ASN1Util.getPEMStringFromHex(k,"ENCRYPTED PRIVATE KEY")}</span>}<span class="cstat-no" title="statement not covered" ></span>t</span>hrow"unsupported object nor format"}</span>;KEYUTIL.getKeyFromCSRPEM=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>var a=ASN1HEX.pemToHex(b,"CERTIFICATE REQUEST");<span class="cstat-no" title="statement not covered" >v</span>ar c=KEYUTIL.getKeyFromCSRHex(a);<span class="cstat-no" title="statement not covered" >r</span>eturn c}</span>;KEYUTIL.getKeyFromCSRHex=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>var c=KEYUTIL.parseCSRHex(a);<span class="cstat-no" title="statement not covered" >v</span>ar b=KEYUTIL.getKey(c.p8pubkeyhex,null,"pkcs8pub");<span class="cstat-no" title="statement not covered" >r</span>eturn b}</span>;KEYUTIL.parseCSRHex=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>var b={};<span class="cstat-no" title="statement not covered" >v</span>ar e=c;<span class="cstat-no" title="statement not covered" >i</span>f(e.substr(0,2)!="30"){<span class="cstat-no" title="statement not covered" >throw"malformed CSR(code:001)"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar d=ASN1HEX.getPosArrayOfChildren_AtObj(e,0);<span class="cstat-no" title="statement not covered" >i</span>f(d.length&lt;1){<span class="cstat-no" title="statement not covered" >throw"malformed CSR(code:002)"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(e.substr(d[0],2)!="30"){<span class="cstat-no" title="statement not covered" >throw"malformed CSR(code:003)"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar a=ASN1HEX.getPosArrayOfChildren_AtObj(e,d[0]);<span class="cstat-no" title="statement not covered" >i</span>f(a.length&lt;3){<span class="cstat-no" title="statement not covered" >throw"malformed CSR(code:004)"}<span class="cstat-no" title="statement not covered" ></span>b</span>.p8pubkeyhex=ASN1HEX.getHexOfTLV_AtObj(e,a[2]);<span class="cstat-no" title="statement not covered" >r</span>eturn b}</span>;KEYUTIL.getJWKFromKey=<span class="fstat-no" title="function not covered" >function(d){<span class="cstat-no" title="statement not covered" ></span>var b={};<span class="cstat-no" title="statement not covered" >i</span>f(d instanceof RSAKey&amp;&amp;d.isPrivate){<span class="cstat-no" title="statement not covered" >b.kty="RSA";<span class="cstat-no" title="statement not covered" >b</span>.n=hextob64u(d.n.toString(16));<span class="cstat-no" title="statement not covered" >b</span>.e=hextob64u(d.e.toString(16));<span class="cstat-no" title="statement not covered" >b</span>.d=hextob64u(d.d.toString(16));<span class="cstat-no" title="statement not covered" >b</span>.p=hextob64u(d.p.toString(16));<span class="cstat-no" title="statement not covered" >b</span>.q=hextob64u(d.q.toString(16));<span class="cstat-no" title="statement not covered" >b</span>.dp=hextob64u(d.dmp1.toString(16));<span class="cstat-no" title="statement not covered" >b</span>.dq=hextob64u(d.dmq1.toString(16));<span class="cstat-no" title="statement not covered" >b</span>.qi=hextob64u(d.coeff.toString(16));<span class="cstat-no" title="statement not covered" >r</span>eturn b}</span>else{<span class="cstat-no" title="statement not covered" >if(d instanceof RSAKey&amp;&amp;d.isPublic){<span class="cstat-no" title="statement not covered" >b.kty="RSA";<span class="cstat-no" title="statement not covered" >b</span>.n=hextob64u(d.n.toString(16));<span class="cstat-no" title="statement not covered" >b</span>.e=hextob64u(d.e.toString(16));<span class="cstat-no" title="statement not covered" >r</span>eturn b}</span>else{<span class="cstat-no" title="statement not covered" >if(d instanceof KJUR.crypto.ECDSA&amp;&amp;d.isPrivate){<span class="cstat-no" title="statement not covered" >var a=d.getShortNISTPCurveName();<span class="cstat-no" title="statement not covered" >i</span>f(a!=="P-256"&amp;&amp;a!=="P-384"){<span class="cstat-no" title="statement not covered" >throw"unsupported curve name for JWT: "+a}<span class="cstat-no" title="statement not covered" ></span>v</span>ar c=d.getPublicKeyXYHex();<span class="cstat-no" title="statement not covered" >b</span>.kty="EC";<span class="cstat-no" title="statement not covered" >b</span>.crv=a;<span class="cstat-no" title="statement not covered" >b</span>.x=hextob64u(c.x);<span class="cstat-no" title="statement not covered" >b</span>.y=hextob64u(c.y);<span class="cstat-no" title="statement not covered" >b</span>.d=hextob64u(d.prvKeyHex);<span class="cstat-no" title="statement not covered" >r</span>eturn b}</span>else{<span class="cstat-no" title="statement not covered" >if(d instanceof KJUR.crypto.ECDSA&amp;&amp;d.isPublic){<span class="cstat-no" title="statement not covered" >var a=d.getShortNISTPCurveName();<span class="cstat-no" title="statement not covered" >i</span>f(a!=="P-256"&amp;&amp;a!=="P-384"){<span class="cstat-no" title="statement not covered" >throw"unsupported curve name for JWT: "+a}<span class="cstat-no" title="statement not covered" ></span>v</span>ar c=d.getPublicKeyXYHex();<span class="cstat-no" title="statement not covered" >b</span>.kty="EC";<span class="cstat-no" title="statement not covered" >b</span>.crv=a;<span class="cstat-no" title="statement not covered" >b</span>.x=hextob64u(c.x);<span class="cstat-no" title="statement not covered" >b</span>.y=hextob64u(c.y);<span class="cstat-no" title="statement not covered" >r</span>eturn b}</span>}</span>}</span>}<span class="cstat-no" title="statement not covered" ></span>t</span>hrow"not supported key object"}</span>;
/*! rsapem-1.2.0.js (c) 2012-2017 Kenji Urushima | kjur.github.com/jsrsasign/license
 */
RSAKey.pemToBase64=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>var a=b;<span class="cstat-no" title="statement not covered" >a</span>=a.replace("-----BEGIN RSA PRIVATE KEY-----","");<span class="cstat-no" title="statement not covered" >a</span>=a.replace("-----END RSA PRIVATE KEY-----","");<span class="cstat-no" title="statement not covered" >a</span>=a.replace(/[ \n]+/g,"");<span class="cstat-no" title="statement not covered" >r</span>eturn a}</span>;RSAKey.getPosArrayOfChildrenFromHex=<span class="fstat-no" title="function not covered" >function(g){<span class="cstat-no" title="statement not covered" ></span>var j=new Array();<span class="cstat-no" title="statement not covered" >v</span>ar i=ASN1HEX.getStartPosOfV_AtObj(g,0);<span class="cstat-no" title="statement not covered" >v</span>ar b=ASN1HEX.getPosOfNextSibling_AtObj(g,i);<span class="cstat-no" title="statement not covered" >v</span>ar e=ASN1HEX.getPosOfNextSibling_AtObj(g,b);<span class="cstat-no" title="statement not covered" >v</span>ar f=ASN1HEX.getPosOfNextSibling_AtObj(g,e);<span class="cstat-no" title="statement not covered" >v</span>ar l=ASN1HEX.getPosOfNextSibling_AtObj(g,f);<span class="cstat-no" title="statement not covered" >v</span>ar k=ASN1HEX.getPosOfNextSibling_AtObj(g,l);<span class="cstat-no" title="statement not covered" >v</span>ar d=ASN1HEX.getPosOfNextSibling_AtObj(g,k);<span class="cstat-no" title="statement not covered" >v</span>ar c=ASN1HEX.getPosOfNextSibling_AtObj(g,d);<span class="cstat-no" title="statement not covered" >v</span>ar h=ASN1HEX.getPosOfNextSibling_AtObj(g,c);<span class="cstat-no" title="statement not covered" >j</span>.push(i,b,e,f,l,k,d,c,h);<span class="cstat-no" title="statement not covered" >r</span>eturn j}</span>;RSAKey.getHexValueArrayOfChildrenFromHex=<span class="fstat-no" title="function not covered" >function(f){<span class="cstat-no" title="statement not covered" ></span>var l=RSAKey.getPosArrayOfChildrenFromHex(f);<span class="cstat-no" title="statement not covered" >v</span>ar e=ASN1HEX.getHexOfV_AtObj(f,l[0]);<span class="cstat-no" title="statement not covered" >v</span>ar j=ASN1HEX.getHexOfV_AtObj(f,l[1]);<span class="cstat-no" title="statement not covered" >v</span>ar b=ASN1HEX.getHexOfV_AtObj(f,l[2]);<span class="cstat-no" title="statement not covered" >v</span>ar c=ASN1HEX.getHexOfV_AtObj(f,l[3]);<span class="cstat-no" title="statement not covered" >v</span>ar h=ASN1HEX.getHexOfV_AtObj(f,l[4]);<span class="cstat-no" title="statement not covered" >v</span>ar g=ASN1HEX.getHexOfV_AtObj(f,l[5]);<span class="cstat-no" title="statement not covered" >v</span>ar m=ASN1HEX.getHexOfV_AtObj(f,l[6]);<span class="cstat-no" title="statement not covered" >v</span>ar k=ASN1HEX.getHexOfV_AtObj(f,l[7]);<span class="cstat-no" title="statement not covered" >v</span>ar d=ASN1HEX.getHexOfV_AtObj(f,l[8]);<span class="cstat-no" title="statement not covered" >v</span>ar i=new Array();<span class="cstat-no" title="statement not covered" >i</span>.push(e,j,b,c,h,g,m,k,d);<span class="cstat-no" title="statement not covered" >r</span>eturn i}</span>;RSAKey.prototype.readPrivateKeyFromPEMString=<span class="fstat-no" title="function not covered" >function(e){<span class="cstat-no" title="statement not covered" ></span>var c=RSAKey.pemToBase64(e);<span class="cstat-no" title="statement not covered" >v</span>ar d=b64tohex(c);<span class="cstat-no" title="statement not covered" >v</span>ar b=RSAKey.getHexValueArrayOfChildrenFromHex(d);<span class="cstat-no" title="statement not covered" >t</span>his.setPrivateEx(b[1],b[2],b[3],b[4],b[5],b[6],b[7],b[8])}</span>;RSAKey.prototype.readPrivateKeyFromASN1HexString=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>this.readPKCS5PrvKeyHex(a)}</span>;RSAKey.prototype.readPKCS5PrvKeyHex=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>var b=RSAKey.getHexValueArrayOfChildrenFromHex(c);<span class="cstat-no" title="statement not covered" >t</span>his.setPrivateEx(b[1],b[2],b[3],b[4],b[5],b[6],b[7],b[8])}</span>;RSAKey.prototype.readPKCS8PrvKeyHex=<span class="fstat-no" title="function not covered" >function(e){<span class="cstat-no" title="statement not covered" ></span>var c,j,l,b,a,f,d,k;<span class="cstat-no" title="statement not covered" >v</span>ar m=ASN1HEX;<span class="cstat-no" title="statement not covered" >v</span>ar g=m.getVbyList;<span class="cstat-no" title="statement not covered" >i</span>f(m.isASN1HEX(e)===false){<span class="cstat-no" title="statement not covered" >throw"not ASN.1 hex string"}<span class="cstat-no" title="statement not covered" ></span>t</span>ry{<span class="cstat-no" title="statement not covered" >c=g(e,0,[2,0,1],"02");<span class="cstat-no" title="statement not covered" >j</span>=g(e,0,[2,0,2],"02");<span class="cstat-no" title="statement not covered" >l</span>=g(e,0,[2,0,3],"02");<span class="cstat-no" title="statement not covered" >b</span>=g(e,0,[2,0,4],"02");<span class="cstat-no" title="statement not covered" >a</span>=g(e,0,[2,0,5],"02");<span class="cstat-no" title="statement not covered" >f</span>=g(e,0,[2,0,6],"02");<span class="cstat-no" title="statement not covered" >d</span>=g(e,0,[2,0,7],"02");<span class="cstat-no" title="statement not covered" >k</span>=g(e,0,[2,0,8],"02")}</span>catch(i){<span class="cstat-no" title="statement not covered" >throw"malformed PKCS#8 plain RSA private key"}<span class="cstat-no" title="statement not covered" ></span>t</span>his.setPrivateEx(c,j,l,b,a,f,d,k)}</span>;RSAKey.prototype.readPKCS5PubKeyHex=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>if(ASN1HEX.isASN1HEX(b)===false){<span class="cstat-no" title="statement not covered" >throw"keyHex is not ASN.1 hex string"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar a=ASN1HEX.getPosArrayOfChildren_AtObj(b,0);<span class="cstat-no" title="statement not covered" >i</span>f(a.length!==2||b.substr(a[0],2)!=="02"||b.substr(a[1],2)!=="02"){<span class="cstat-no" title="statement not covered" >throw"wrong hex for PKCS#5 public key"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar d=ASN1HEX.getHexOfV_AtObj(b,a[0]);<span class="cstat-no" title="statement not covered" >v</span>ar c=ASN1HEX.getHexOfV_AtObj(b,a[1]);<span class="cstat-no" title="statement not covered" >t</span>his.setPublic(d,c)}</span>;RSAKey.prototype.readPKCS8PubKeyHex=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>if(ASN1HEX.isASN1HEX(b)===false){<span class="cstat-no" title="statement not covered" >throw"not ASN.1 hex string"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(ASN1HEX.getDecendantHexTLVByNthList(b,0,[0,0])!=="06092a864886f70d010101"){<span class="cstat-no" title="statement not covered" >throw"not PKCS8 RSA public key"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar a=ASN1HEX.getDecendantHexTLVByNthList(b,0,[1,0]);<span class="cstat-no" title="statement not covered" >t</span>his.readPKCS5PubKeyHex(a)}</span>;RSAKey.prototype.readCertPubKeyHex=<span class="fstat-no" title="function not covered" >function(b,c){<span class="cstat-no" title="statement not covered" ></span>if(c!==5){<span class="cstat-no" title="statement not covered" >c=6}<span class="cstat-no" title="statement not covered" ></span>i</span>f(ASN1HEX.isASN1HEX(b)===false){<span class="cstat-no" title="statement not covered" >throw"not ASN.1 hex string"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar a=ASN1HEX.getDecendantHexTLVByNthList(b,0,[0,c]);<span class="cstat-no" title="statement not covered" >t</span>his.readPKCS8PubKeyHex(a)}</span>;
/*! rsasign-1.2.7.js (c) 2012 Kenji Urushima | kjur.github.com/jsrsasign/license
 */
var _RE_HEXDECONLY=new RegExp("");_RE_HEXDECONLY.compile("[^0-9a-f]","gi");<span class="fstat-no" title="function not covered" >function _rsasign_getHexPaddedDigestInfoForString(d,e,a){<span class="cstat-no" title="statement not covered" ></span>var b=<span class="fstat-no" title="function not covered" >function(f){<span class="cstat-no" title="statement not covered" ></span>return KJUR.crypto.Util.hashString(f,a)}</span>;<span class="cstat-no" title="statement not covered" >v</span>ar c=b(d);<span class="cstat-no" title="statement not covered" >r</span>eturn KJUR.crypto.Util.getPaddedDigestInfoHex(c,a,e)}<span class="fstat-no" title="function not covered" ></span>function _zeroPaddingOfSignature(e,d){<span class="cstat-no" title="statement not covered" ></span>var c="";<span class="cstat-no" title="statement not covered" >v</span>ar a=d/4-e.length;<span class="cstat-no" title="statement not covered" >f</span>or(var b=0;b&lt;a;b++){<span class="cstat-no" title="statement not covered" >c=c+"0"}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn c+e}<span class="fstat-no" title="function not covered" ></span>function _rsasign_signString(d,a){<span class="cstat-no" title="statement not covered" ></span>var b=<span class="fstat-no" title="function not covered" >function(e){<span class="cstat-no" title="statement not covered" ></span>return KJUR.crypto.Util.hashString(e,a)}</span>;<span class="cstat-no" title="statement not covered" >v</span>ar c=b(d);<span class="cstat-no" title="statement not covered" >r</span>eturn this.signWithMessageHash(c,a)}<span class="fstat-no" title="function not covered" ></span>function _rsasign_signWithMessageHash(e,c){<span class="cstat-no" title="statement not covered" ></span>var f=KJUR.crypto.Util.getPaddedDigestInfoHex(e,c,this.n.bitLength());<span class="cstat-no" title="statement not covered" >v</span>ar b=parseBigInt(f,16);<span class="cstat-no" title="statement not covered" >v</span>ar d=this.doPrivate(b);<span class="cstat-no" title="statement not covered" >v</span>ar a=d.toString(16);<span class="cstat-no" title="statement not covered" >r</span>eturn _zeroPaddingOfSignature(a,this.n.bitLength())}<span class="fstat-no" title="function not covered" ></span>function _rsasign_signStringWithSHA1(a){<span class="cstat-no" title="statement not covered" ></span>return _rsasign_signString.call(this,a,"sha1")}<span class="fstat-no" title="function not covered" ></span>function _rsasign_signStringWithSHA256(a){<span class="cstat-no" title="statement not covered" ></span>return _rsasign_signString.call(this,a,"sha256")}<span class="fstat-no" title="function not covered" ></span>function pss_mgf1_str(c,a,e){<span class="cstat-no" title="statement not covered" ></span>var b="",d=0;<span class="cstat-no" title="statement not covered" >w</span>hile(b.length&lt;a){<span class="cstat-no" title="statement not covered" >b+=hextorstr(e(rstrtohex(c+String.fromCharCode.apply(String,[(d&amp;4278190080)&gt;&gt;24,(d&amp;16711680)&gt;&gt;16,(d&amp;65280)&gt;&gt;8,d&amp;255]))));<span class="cstat-no" title="statement not covered" >d</span>+=1}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn b}<span class="fstat-no" title="function not covered" ></span>function _rsasign_signStringPSS(e,a,d){<span class="cstat-no" title="statement not covered" ></span>var c=<span class="fstat-no" title="function not covered" >function(f){<span class="cstat-no" title="statement not covered" ></span>return KJUR.crypto.Util.hashHex(f,a)}</span>;<span class="cstat-no" title="statement not covered" >v</span>ar b=c(rstrtohex(e));<span class="cstat-no" title="statement not covered" >i</span>f(d===undefined){<span class="cstat-no" title="statement not covered" >d=-1}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn this.signWithMessageHashPSS(b,a,d)}<span class="fstat-no" title="function not covered" ></span>function _rsasign_signWithMessageHashPSS(l,a,k){<span class="cstat-no" title="statement not covered" ></span>var b=hextorstr(l);<span class="cstat-no" title="statement not covered" >v</span>ar g=b.length;<span class="cstat-no" title="statement not covered" >v</span>ar m=this.n.bitLength()-1;<span class="cstat-no" title="statement not covered" >v</span>ar c=Math.ceil(m/8);<span class="cstat-no" title="statement not covered" >v</span>ar d;<span class="cstat-no" title="statement not covered" >v</span>ar o=<span class="fstat-no" title="function not covered" >function(i){<span class="cstat-no" title="statement not covered" ></span>return KJUR.crypto.Util.hashHex(i,a)}</span>;<span class="cstat-no" title="statement not covered" >i</span>f(k===-1||k===undefined){<span class="cstat-no" title="statement not covered" >k=g}</span>else{<span class="cstat-no" title="statement not covered" >if(k===-2){<span class="cstat-no" title="statement not covered" >k=c-g-2}</span>else{<span class="cstat-no" title="statement not covered" >if(k&lt;-2){<span class="cstat-no" title="statement not covered" >throw"invalid salt length"}</span>}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(c&lt;(g+k+2)){<span class="cstat-no" title="statement not covered" >throw"data too long"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar f="";<span class="cstat-no" title="statement not covered" >i</span>f(k&gt;0){<span class="cstat-no" title="statement not covered" >f=new Array(k);<span class="cstat-no" title="statement not covered" >n</span>ew SecureRandom().nextBytes(f);<span class="cstat-no" title="statement not covered" >f</span>=String.fromCharCode.apply(String,f)}<span class="cstat-no" title="statement not covered" ></span>v</span>ar n=hextorstr(o(rstrtohex("\x00\x00\x00\x00\x00\x00\x00\x00"+b+f)));<span class="cstat-no" title="statement not covered" >v</span>ar j=[];<span class="cstat-no" title="statement not covered" >f</span>or(d=0;d&lt;c-k-g-2;d+=1){<span class="cstat-no" title="statement not covered" >j[d]=0}<span class="cstat-no" title="statement not covered" ></span>v</span>ar e=String.fromCharCode.apply(String,j)+"\x01"+f;<span class="cstat-no" title="statement not covered" >v</span>ar h=pss_mgf1_str(n,e.length,o);<span class="cstat-no" title="statement not covered" >v</span>ar q=[];<span class="cstat-no" title="statement not covered" >f</span>or(d=0;d&lt;e.length;d+=1){<span class="cstat-no" title="statement not covered" >q[d]=e.charCodeAt(d)^h.charCodeAt(d)}<span class="cstat-no" title="statement not covered" ></span>v</span>ar p=(65280&gt;&gt;(8*c-m))&amp;255;<span class="cstat-no" title="statement not covered" >q</span>[0]&amp;=~p;<span class="cstat-no" title="statement not covered" >f</span>or(d=0;d&lt;g;d++){<span class="cstat-no" title="statement not covered" >q.push(n.charCodeAt(d))}<span class="cstat-no" title="statement not covered" ></span>q</span>.push(188);<span class="cstat-no" title="statement not covered" >r</span>eturn _zeroPaddingOfSignature(this.doPrivate(new BigInteger(q)).toString(16),this.n.bitLength())}<span class="fstat-no" title="function not covered" ></span>function _rsasign_getDecryptSignatureBI(a,d,c){<span class="cstat-no" title="statement not covered" ></span>var b=new RSAKey();<span class="cstat-no" title="statement not covered" >b</span>.setPublic(d,c);<span class="cstat-no" title="statement not covered" >v</span>ar e=b.doPublic(a);<span class="cstat-no" title="statement not covered" >r</span>eturn e}<span class="fstat-no" title="function not covered" ></span>function _rsasign_getHexDigestInfoFromSig(a,c,b){<span class="cstat-no" title="statement not covered" ></span>var e=_rsasign_getDecryptSignatureBI(a,c,b);<span class="cstat-no" title="statement not covered" >v</span>ar d=e.toString(16).replace(/^1f+00/,"");<span class="cstat-no" title="statement not covered" >r</span>eturn d}<span class="fstat-no" title="function not covered" ></span>function _rsasign_getAlgNameAndHashFromHexDisgestInfo(f){<span class="cstat-no" title="statement not covered" ></span>for(var e in KJUR.crypto.Util.DIGESTINFOHEAD){<span class="cstat-no" title="statement not covered" >var d=KJUR.crypto.Util.DIGESTINFOHEAD[e];<span class="cstat-no" title="statement not covered" >v</span>ar b=d.length;<span class="cstat-no" title="statement not covered" >i</span>f(f.substring(0,b)==d){<span class="cstat-no" title="statement not covered" >var c=[e,f.substring(b)];<span class="cstat-no" title="statement not covered" >r</span>eturn c}</span>}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn[]}<span class="fstat-no" title="function not covered" ></span>function _rsasign_verifySignatureWithArgs(f,b,g,j){<span class="cstat-no" title="statement not covered" ></span>var e=_rsasign_getHexDigestInfoFromSig(b,g,j);<span class="cstat-no" title="statement not covered" >v</span>ar h=_rsasign_getAlgNameAndHashFromHexDisgestInfo(e);<span class="cstat-no" title="statement not covered" >i</span>f(h.length==0){<span class="cstat-no" title="statement not covered" >return false}<span class="cstat-no" title="statement not covered" ></span>v</span>ar d=h[0];<span class="cstat-no" title="statement not covered" >v</span>ar i=h[1];<span class="cstat-no" title="statement not covered" >v</span>ar a=<span class="fstat-no" title="function not covered" >function(k){<span class="cstat-no" title="statement not covered" ></span>return KJUR.crypto.Util.hashString(k,d)}</span>;<span class="cstat-no" title="statement not covered" >v</span>ar c=a(f);<span class="cstat-no" title="statement not covered" >r</span>eturn(i==c)}<span class="fstat-no" title="function not covered" ></span>function _rsasign_verifyHexSignatureForMessage(c,b){<span class="cstat-no" title="statement not covered" ></span>var d=parseBigInt(c,16);<span class="cstat-no" title="statement not covered" >v</span>ar a=_rsasign_verifySignatureWithArgs(b,d,this.n.toString(16),this.e.toString(16));<span class="cstat-no" title="statement not covered" >r</span>eturn a}<span class="fstat-no" title="function not covered" ></span>function _rsasign_verifyString(f,j){<span class="cstat-no" title="statement not covered" ></span>j=j.replace(_RE_HEXDECONLY,"");<span class="cstat-no" title="statement not covered" >j</span>=j.replace(/[ \n]+/g,"");<span class="cstat-no" title="statement not covered" >v</span>ar b=parseBigInt(j,16);<span class="cstat-no" title="statement not covered" >i</span>f(b.bitLength()&gt;this.n.bitLength()){<span class="cstat-no" title="statement not covered" >return 0}<span class="cstat-no" title="statement not covered" ></span>v</span>ar i=this.doPublic(b);<span class="cstat-no" title="statement not covered" >v</span>ar e=i.toString(16).replace(/^1f+00/,"");<span class="cstat-no" title="statement not covered" >v</span>ar g=_rsasign_getAlgNameAndHashFromHexDisgestInfo(e);<span class="cstat-no" title="statement not covered" >i</span>f(g.length==0){<span class="cstat-no" title="statement not covered" >return false}<span class="cstat-no" title="statement not covered" ></span>v</span>ar d=g[0];<span class="cstat-no" title="statement not covered" >v</span>ar h=g[1];<span class="cstat-no" title="statement not covered" >v</span>ar a=<span class="fstat-no" title="function not covered" >function(k){<span class="cstat-no" title="statement not covered" ></span>return KJUR.crypto.Util.hashString(k,d)}</span>;<span class="cstat-no" title="statement not covered" >v</span>ar c=a(f);<span class="cstat-no" title="statement not covered" >r</span>eturn(h==c)}<span class="fstat-no" title="function not covered" ></span>function _rsasign_verifyWithMessageHash(e,a){<span class="cstat-no" title="statement not covered" ></span>a=a.replace(_RE_HEXDECONLY,"");<span class="cstat-no" title="statement not covered" >a</span>=a.replace(/[ \n]+/g,"");<span class="cstat-no" title="statement not covered" >v</span>ar b=parseBigInt(a,16);<span class="cstat-no" title="statement not covered" >i</span>f(b.bitLength()&gt;this.n.bitLength()){<span class="cstat-no" title="statement not covered" >return 0}<span class="cstat-no" title="statement not covered" ></span>v</span>ar h=this.doPublic(b);<span class="cstat-no" title="statement not covered" >v</span>ar g=h.toString(16).replace(/^1f+00/,"");<span class="cstat-no" title="statement not covered" >v</span>ar c=_rsasign_getAlgNameAndHashFromHexDisgestInfo(g);<span class="cstat-no" title="statement not covered" >i</span>f(c.length==0){<span class="cstat-no" title="statement not covered" >return false}<span class="cstat-no" title="statement not covered" ></span>v</span>ar d=c[0];<span class="cstat-no" title="statement not covered" >v</span>ar f=c[1];<span class="cstat-no" title="statement not covered" >r</span>eturn(f==e)}<span class="fstat-no" title="function not covered" ></span>function _rsasign_verifyStringPSS(c,b,a,f){<span class="cstat-no" title="statement not covered" ></span>var e=<span class="fstat-no" title="function not covered" >function(g){<span class="cstat-no" title="statement not covered" ></span>return KJUR.crypto.Util.hashHex(g,a)}</span>;<span class="cstat-no" title="statement not covered" >v</span>ar d=e(rstrtohex(c));<span class="cstat-no" title="statement not covered" >i</span>f(f===undefined){<span class="cstat-no" title="statement not covered" >f=-1}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn this.verifyWithMessageHashPSS(d,b,a,f)}<span class="fstat-no" title="function not covered" ></span>function _rsasign_verifyWithMessageHashPSS(f,s,l,c){<span class="cstat-no" title="statement not covered" ></span>var k=new BigInteger(s,16);<span class="cstat-no" title="statement not covered" >i</span>f(k.bitLength()&gt;this.n.bitLength()){<span class="cstat-no" title="statement not covered" >return false}<span class="cstat-no" title="statement not covered" ></span>v</span>ar r=<span class="fstat-no" title="function not covered" >function(i){<span class="cstat-no" title="statement not covered" ></span>return KJUR.crypto.Util.hashHex(i,l)}</span>;<span class="cstat-no" title="statement not covered" >v</span>ar j=hextorstr(f);<span class="cstat-no" title="statement not covered" >v</span>ar h=j.length;<span class="cstat-no" title="statement not covered" >v</span>ar g=this.n.bitLength()-1;<span class="cstat-no" title="statement not covered" >v</span>ar m=Math.ceil(g/8);<span class="cstat-no" title="statement not covered" >v</span>ar q;<span class="cstat-no" title="statement not covered" >i</span>f(c===-1||c===undefined){<span class="cstat-no" title="statement not covered" >c=h}</span>else{<span class="cstat-no" title="statement not covered" >if(c===-2){<span class="cstat-no" title="statement not covered" >c=m-h-2}</span>else{<span class="cstat-no" title="statement not covered" >if(c&lt;-2){<span class="cstat-no" title="statement not covered" >throw"invalid salt length"}</span>}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(m&lt;(h+c+2)){<span class="cstat-no" title="statement not covered" >throw"data too long"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar a=this.doPublic(k).toByteArray();<span class="cstat-no" title="statement not covered" >f</span>or(q=0;q&lt;a.length;q+=1){<span class="cstat-no" title="statement not covered" >a[q]&amp;=255}<span class="cstat-no" title="statement not covered" ></span>w</span>hile(a.length&lt;m){<span class="cstat-no" title="statement not covered" >a.unshift(0)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(a[m-1]!==188){<span class="cstat-no" title="statement not covered" >throw"encoded message does not end in 0xbc"}<span class="cstat-no" title="statement not covered" ></span>a</span>=String.fromCharCode.apply(String,a);<span class="cstat-no" title="statement not covered" >v</span>ar d=a.substr(0,m-h-1);<span class="cstat-no" title="statement not covered" >v</span>ar e=a.substr(d.length,h);<span class="cstat-no" title="statement not covered" >v</span>ar p=(65280&gt;&gt;(8*m-g))&amp;255;<span class="cstat-no" title="statement not covered" >i</span>f((d.charCodeAt(0)&amp;p)!==0){<span class="cstat-no" title="statement not covered" >throw"bits beyond keysize not zero"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar n=pss_mgf1_str(e,d.length,r);<span class="cstat-no" title="statement not covered" >v</span>ar o=[];<span class="cstat-no" title="statement not covered" >f</span>or(q=0;q&lt;d.length;q+=1){<span class="cstat-no" title="statement not covered" >o[q]=d.charCodeAt(q)^n.charCodeAt(q)}<span class="cstat-no" title="statement not covered" ></span>o</span>[0]&amp;=~p;<span class="cstat-no" title="statement not covered" >v</span>ar b=m-h-c-2;<span class="cstat-no" title="statement not covered" >f</span>or(q=0;q&lt;b;q+=1){<span class="cstat-no" title="statement not covered" >if(o[q]!==0){<span class="cstat-no" title="statement not covered" >throw"leftmost octets not zero"}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(o[b]!==1){<span class="cstat-no" title="statement not covered" >throw"0x01 marker not found"}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn e===hextorstr(r(rstrtohex("\x00\x00\x00\x00\x00\x00\x00\x00"+j+String.fromCharCode.apply(String,o.slice(-c)))))}</span>RSAKey.prototype.signWithMessageHash=_rsasign_signWithMessageHash;RSAKey.prototype.signString=_rsasign_signString;RSAKey.prototype.signStringWithSHA1=_rsasign_signStringWithSHA1;RSAKey.prototype.signStringWithSHA256=_rsasign_signStringWithSHA256;RSAKey.prototype.sign=_rsasign_signString;RSAKey.prototype.signWithSHA1=_rsasign_signStringWithSHA1;RSAKey.prototype.signWithSHA256=_rsasign_signStringWithSHA256;RSAKey.prototype.signWithMessageHashPSS=_rsasign_signWithMessageHashPSS;RSAKey.prototype.signStringPSS=_rsasign_signStringPSS;RSAKey.prototype.signPSS=_rsasign_signStringPSS;RSAKey.SALT_LEN_HLEN=-1;RSAKey.SALT_LEN_MAX=-2;RSAKey.prototype.verifyWithMessageHash=_rsasign_verifyWithMessageHash;RSAKey.prototype.verifyString=_rsasign_verifyString;RSAKey.prototype.verifyHexSignatureForMessage=_rsasign_verifyHexSignatureForMessage;RSAKey.prototype.verify=_rsasign_verifyString;RSAKey.prototype.verifyHexSignatureForByteArrayMessage=_rsasign_verifyHexSignatureForMessage;RSAKey.prototype.verifyWithMessageHashPSS=_rsasign_verifyWithMessageHashPSS;RSAKey.prototype.verifyStringPSS=_rsasign_verifyStringPSS;RSAKey.prototype.verifyPSS=_rsasign_verifyStringPSS;RSAKey.SALT_LEN_RECOVER=-2;
/*! x509-1.1.12.js (c) 2012-2017 Kenji Urushima | kjur.github.com/jsrsasign/license
 */
<span class="fstat-no" title="function not covered" >function X509(){<span class="cstat-no" title="statement not covered" ></span>this.subjectPublicKeyRSA=null;<span class="cstat-no" title="statement not covered" >t</span>his.subjectPublicKeyRSA_hN=null;<span class="cstat-no" title="statement not covered" >t</span>his.subjectPublicKeyRSA_hE=null;<span class="cstat-no" title="statement not covered" >t</span>his.hex=null;<span class="cstat-no" title="statement not covered" >t</span>his.getSerialNumberHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>return ASN1HEX.getDecendantHexVByNthList(this.hex,0,[0,1])}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getSignatureAlgorithmField=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var b=ASN1HEX.getDecendantHexVByNthList(this.hex,0,[0,2,0]);<span class="cstat-no" title="statement not covered" >v</span>ar a=KJUR.asn1.ASN1Util.oidHexToInt(b);<span class="cstat-no" title="statement not covered" >v</span>ar c=KJUR.asn1.x509.OID.oid2name(a);<span class="cstat-no" title="statement not covered" >r</span>eturn c}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getIssuerHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>return ASN1HEX.getDecendantHexTLVByNthList(this.hex,0,[0,3])}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getIssuerString=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>return X509.hex2dn(ASN1HEX.getDecendantHexTLVByNthList(this.hex,0,[0,3]))}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getSubjectHex=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>return ASN1HEX.getDecendantHexTLVByNthList(this.hex,0,[0,5])}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getSubjectString=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>return X509.hex2dn(ASN1HEX.getDecendantHexTLVByNthList(this.hex,0,[0,5]))}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getNotBefore=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var a=ASN1HEX.getDecendantHexVByNthList(this.hex,0,[0,4,0]);<span class="cstat-no" title="statement not covered" >a</span>=a.replace(/(..)/g,"%$1");<span class="cstat-no" title="statement not covered" >a</span>=decodeURIComponent(a);<span class="cstat-no" title="statement not covered" >r</span>eturn a}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getNotAfter=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var a=ASN1HEX.getDecendantHexVByNthList(this.hex,0,[0,4,1]);<span class="cstat-no" title="statement not covered" >a</span>=a.replace(/(..)/g,"%$1");<span class="cstat-no" title="statement not covered" >a</span>=decodeURIComponent(a);<span class="cstat-no" title="statement not covered" >r</span>eturn a}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.readCertPEM=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>var e=ASN1HEX.pemToHex(c);<span class="cstat-no" title="statement not covered" >v</span>ar b=X509.getPublicKeyHexArrayFromCertHex(e);<span class="cstat-no" title="statement not covered" >v</span>ar d=new RSAKey();<span class="cstat-no" title="statement not covered" >d</span>.setPublic(b[0],b[1]);<span class="cstat-no" title="statement not covered" >t</span>his.subjectPublicKeyRSA=d;<span class="cstat-no" title="statement not covered" >t</span>his.subjectPublicKeyRSA_hN=b[0];<span class="cstat-no" title="statement not covered" >t</span>his.subjectPublicKeyRSA_hE=b[1];<span class="cstat-no" title="statement not covered" >t</span>his.hex=e}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.readCertPEMWithoutRSAInit=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>var d=ASN1HEX.pemToHex(c);<span class="cstat-no" title="statement not covered" >v</span>ar b=X509.getPublicKeyHexArrayFromCertHex(d);<span class="cstat-no" title="statement not covered" >i</span>f(typeof this.subjectPublicKeyRSA.setPublic==="function"){<span class="cstat-no" title="statement not covered" >this.subjectPublicKeyRSA.setPublic(b[0],b[1])}<span class="cstat-no" title="statement not covered" ></span>t</span>his.subjectPublicKeyRSA_hN=b[0];<span class="cstat-no" title="statement not covered" >t</span>his.subjectPublicKeyRSA_hE=b[1];<span class="cstat-no" title="statement not covered" >t</span>his.hex=d}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getInfo=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var p="Basic Fields\n";<span class="cstat-no" title="statement not covered" >p</span>+="  serial number: "+this.getSerialNumberHex()+"\n";<span class="cstat-no" title="statement not covered" >p</span>+="  signature algorithm: "+this.getSignatureAlgorithmField()+"\n";<span class="cstat-no" title="statement not covered" >p</span>+="  issuer: "+this.getIssuerString()+"\n";<span class="cstat-no" title="statement not covered" >p</span>+="  notBefore: "+this.getNotBefore()+"\n";<span class="cstat-no" title="statement not covered" >p</span>+="  notAfter: "+this.getNotAfter()+"\n";<span class="cstat-no" title="statement not covered" >p</span>+="  subject: "+this.getSubjectString()+"\n";<span class="cstat-no" title="statement not covered" >p</span>+="  subject public key info: \n";<span class="cstat-no" title="statement not covered" >v</span>ar j=X509.getSubjectPublicKeyInfoPosFromCertHex(this.hex);<span class="cstat-no" title="statement not covered" >v</span>ar d=ASN1HEX.getHexOfTLV_AtObj(this.hex,j);<span class="cstat-no" title="statement not covered" >v</span>ar n=KEYUTIL.getKey(d,null,"pkcs8pub");<span class="cstat-no" title="statement not covered" >i</span>f(n instanceof RSAKey){<span class="cstat-no" title="statement not covered" >p+="    key algorithm: RSA\n";<span class="cstat-no" title="statement not covered" >p</span>+="    n="+n.n.toString(16).substr(0,16)+"...\n";<span class="cstat-no" title="statement not covered" >p</span>+="    e="+n.e.toString(16)+"\n"}<span class="cstat-no" title="statement not covered" ></span>p</span>+="X509v3 Extensions:\n";<span class="cstat-no" title="statement not covered" >v</span>ar m=X509.getV3ExtInfoListOfCertHex(this.hex);<span class="cstat-no" title="statement not covered" >f</span>or(var e=0;e&lt;m.length;e++){<span class="cstat-no" title="statement not covered" >var b=m[e];<span class="cstat-no" title="statement not covered" >v</span>ar o=KJUR.asn1.x509.OID.oid2name(b.oid);<span class="cstat-no" title="statement not covered" >i</span>f(o===""){<span class="cstat-no" title="statement not covered" >o=b.oid}<span class="cstat-no" title="statement not covered" ></span>v</span>ar k="";<span class="cstat-no" title="statement not covered" >i</span>f(b.critical===true){<span class="cstat-no" title="statement not covered" >k="CRITICAL"}<span class="cstat-no" title="statement not covered" ></span>p</span>+="  "+o+" "+k+":\n";<span class="cstat-no" title="statement not covered" >i</span>f(o==="basicConstraints"){<span class="cstat-no" title="statement not covered" >var g=X509.getExtBasicConstraints(this.hex);<span class="cstat-no" title="statement not covered" >i</span>f(g.cA===undefined){<span class="cstat-no" title="statement not covered" >p+="    {}\n"}</span>else{<span class="cstat-no" title="statement not covered" >p+="    cA=true";<span class="cstat-no" title="statement not covered" >i</span>f(g.pathLen!==undefined){<span class="cstat-no" title="statement not covered" >p+=", pathLen="+g.pathLen}<span class="cstat-no" title="statement not covered" ></span>p</span>+="\n"}</span>}</span>else{<span class="cstat-no" title="statement not covered" >if(o==="keyUsage"){<span class="cstat-no" title="statement not covered" >p+="    "+X509.getExtKeyUsageString(this.hex)+"\n"}</span>else{<span class="cstat-no" title="statement not covered" >if(o==="subjectKeyIdentifier"){<span class="cstat-no" title="statement not covered" >p+="    "+X509.getExtSubjectKeyIdentifier(this.hex)+"\n"}</span>else{<span class="cstat-no" title="statement not covered" >if(o==="authorityKeyIdentifier"){<span class="cstat-no" title="statement not covered" >var a=X509.getExtAuthorityKeyIdentifier(this.hex);<span class="cstat-no" title="statement not covered" >i</span>f(a.kid!==undefined){<span class="cstat-no" title="statement not covered" >p+="    kid="+a.kid+"\n"}</span>}</span>else{<span class="cstat-no" title="statement not covered" >if(o==="extKeyUsage"){<span class="cstat-no" title="statement not covered" >var h=X509.getExtExtKeyUsageName(this.hex);<span class="cstat-no" title="statement not covered" >p</span>+="    "+h.join(", ")+"\n"}</span>else{<span class="cstat-no" title="statement not covered" >if(o==="subjectAltName"){<span class="cstat-no" title="statement not covered" >var f=X509.getExtSubjectAltName(this.hex);<span class="cstat-no" title="statement not covered" >p</span>+="    "+f.join(", ")+"\n"}</span>else{<span class="cstat-no" title="statement not covered" >if(o==="cRLDistributionPoints"){<span class="cstat-no" title="statement not covered" >var l=X509.getExtCRLDistributionPointsURI(this.hex);<span class="cstat-no" title="statement not covered" >p</span>+="    "+l+"\n"}</span>else{<span class="cstat-no" title="statement not covered" >if(o==="authorityInfoAccess"){<span class="cstat-no" title="statement not covered" >var c=X509.getExtAIAInfo(this.hex);<span class="cstat-no" title="statement not covered" >i</span>f(c.ocsp!==undefined){<span class="cstat-no" title="statement not covered" >p+="    ocsp: "+c.ocsp.join(",")+"\n"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(c.caissuer!==undefined){<span class="cstat-no" title="statement not covered" >p+="    caissuer: "+c.caissuer.join(",")+"\n"}</span>}</span>}</span>}</span>}</span>}</span>}</span>}</span>}</span>}<span class="cstat-no" title="statement not covered" ></span>p</span>+="signature algorithm: "+X509.getSignatureAlgorithmName(this.hex)+"\n";<span class="cstat-no" title="statement not covered" >p</span>+="signature: "+X509.getSignatureValueHex(this.hex).substr(0,16)+"...\n";<span class="cstat-no" title="statement not covered" >r</span>eturn p}</span>}</span>X509.pemToBase64=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>var b=a;<span class="cstat-no" title="statement not covered" >b</span>=b.replace("-----BEGIN CERTIFICATE-----","");<span class="cstat-no" title="statement not covered" >b</span>=b.replace("-----END CERTIFICATE-----","");<span class="cstat-no" title="statement not covered" >b</span>=b.replace(/[ \n]+/g,"");<span class="cstat-no" title="statement not covered" >r</span>eturn b}</span>;X509.pemToHex=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>return ASN1HEX.pemToHex(a)}</span>;X509.getSubjectPublicKeyPosFromCertHex=<span class="fstat-no" title="function not covered" >function(f){<span class="cstat-no" title="statement not covered" ></span>var e=X509.getSubjectPublicKeyInfoPosFromCertHex(f);<span class="cstat-no" title="statement not covered" >i</span>f(e==-1){<span class="cstat-no" title="statement not covered" >return -1}<span class="cstat-no" title="statement not covered" ></span>v</span>ar b=ASN1HEX.getPosArrayOfChildren_AtObj(f,e);<span class="cstat-no" title="statement not covered" >i</span>f(b.length!=2){<span class="cstat-no" title="statement not covered" >return -1}<span class="cstat-no" title="statement not covered" ></span>v</span>ar d=b[1];<span class="cstat-no" title="statement not covered" >i</span>f(f.substring(d,d+2)!="03"){<span class="cstat-no" title="statement not covered" >return -1}<span class="cstat-no" title="statement not covered" ></span>v</span>ar c=ASN1HEX.getStartPosOfV_AtObj(f,d);<span class="cstat-no" title="statement not covered" >i</span>f(f.substring(c,c+2)!="00"){<span class="cstat-no" title="statement not covered" >return -1}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn c+2}</span>;X509.getSubjectPublicKeyInfoPosFromCertHex=<span class="fstat-no" title="function not covered" >function(d){<span class="cstat-no" title="statement not covered" ></span>var c=ASN1HEX.getStartPosOfV_AtObj(d,0);<span class="cstat-no" title="statement not covered" >v</span>ar b=ASN1HEX.getPosArrayOfChildren_AtObj(d,c);<span class="cstat-no" title="statement not covered" >i</span>f(b.length&lt;1){<span class="cstat-no" title="statement not covered" >return -1}<span class="cstat-no" title="statement not covered" ></span>i</span>f(d.substring(b[0],b[0]+10)=="a003020102"){<span class="cstat-no" title="statement not covered" >if(b.length&lt;6){<span class="cstat-no" title="statement not covered" >return -1}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn b[6]}</span>else{<span class="cstat-no" title="statement not covered" >if(b.length&lt;5){<span class="cstat-no" title="statement not covered" >return -1}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn b[5]}</span>}</span>;X509.getPublicKeyHexArrayFromCertHex=<span class="fstat-no" title="function not covered" >function(f){<span class="cstat-no" title="statement not covered" ></span>var e=X509.getSubjectPublicKeyPosFromCertHex(f);<span class="cstat-no" title="statement not covered" >v</span>ar b=ASN1HEX.getPosArrayOfChildren_AtObj(f,e);<span class="cstat-no" title="statement not covered" >i</span>f(b.length!=2){<span class="cstat-no" title="statement not covered" >return[]}<span class="cstat-no" title="statement not covered" ></span>v</span>ar d=ASN1HEX.getHexOfV_AtObj(f,b[0]);<span class="cstat-no" title="statement not covered" >v</span>ar c=ASN1HEX.getHexOfV_AtObj(f,b[1]);<span class="cstat-no" title="statement not covered" >i</span>f(d!=null&amp;&amp;c!=null){<span class="cstat-no" title="statement not covered" >return[d,c]}</span>else{<span class="cstat-no" title="statement not covered" >return[]}</span>}</span>;X509.getHexTbsCertificateFromCert=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>var a=ASN1HEX.getStartPosOfV_AtObj(b,0);<span class="cstat-no" title="statement not covered" >r</span>eturn a}</span>;X509.getPublicKeyHexArrayFromCertPEM=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>var d=ASN1HEX.pemToHex(c);<span class="cstat-no" title="statement not covered" >v</span>ar b=X509.getPublicKeyHexArrayFromCertHex(d);<span class="cstat-no" title="statement not covered" >r</span>eturn b}</span>;X509.hex2dn=<span class="fstat-no" title="function not covered" >function(f,b){<span class="cstat-no" title="statement not covered" ></span>if(b===undefined){<span class="cstat-no" title="statement not covered" >b=0}<span class="cstat-no" title="statement not covered" ></span>i</span>f(f.substr(b,2)!=="30"){<span class="cstat-no" title="statement not covered" >throw"malformed DN"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar c=new Array();<span class="cstat-no" title="statement not covered" >v</span>ar d=ASN1HEX.getPosArrayOfChildren_AtObj(f,b);<span class="cstat-no" title="statement not covered" >f</span>or(var e=0;e&lt;d.length;e++){<span class="cstat-no" title="statement not covered" >c.push(X509.hex2rdn(f,d[e]))}<span class="cstat-no" title="statement not covered" ></span>c</span>=c.map(<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>return a.replace("/","\\/")}</span>);<span class="cstat-no" title="statement not covered" >r</span>eturn"/"+c.join("/")}</span>;X509.hex2rdn=<span class="fstat-no" title="function not covered" >function(f,b){<span class="cstat-no" title="statement not covered" ></span>if(b===undefined){<span class="cstat-no" title="statement not covered" >b=0}<span class="cstat-no" title="statement not covered" ></span>i</span>f(f.substr(b,2)!=="31"){<span class="cstat-no" title="statement not covered" >throw"malformed RDN"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar c=new Array();<span class="cstat-no" title="statement not covered" >v</span>ar d=ASN1HEX.getPosArrayOfChildren_AtObj(f,b);<span class="cstat-no" title="statement not covered" >f</span>or(var e=0;e&lt;d.length;e++){<span class="cstat-no" title="statement not covered" >c.push(X509.hex2attrTypeValue(f,d[e]))}<span class="cstat-no" title="statement not covered" ></span>c</span>=c.map(<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>return a.replace("+","\\+")}</span>);<span class="cstat-no" title="statement not covered" >r</span>eturn c.join("+")}</span>;X509.hex2attrTypeValue=<span class="fstat-no" title="function not covered" >function(g,b){<span class="cstat-no" title="statement not covered" ></span>if(b===undefined){<span class="cstat-no" title="statement not covered" >b=0}<span class="cstat-no" title="statement not covered" ></span>i</span>f(g.substr(b,2)!=="30"){<span class="cstat-no" title="statement not covered" >throw"malformed attribute type and value"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar c=ASN1HEX.getPosArrayOfChildren_AtObj(g,b);<span class="cstat-no" title="statement not covered" >i</span>f(c.length!==2||g.substr(c[0],2)!=="06"){<span class="cstat-no" title="statement not covered" >"malformed attribute type and value"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar d=ASN1HEX.getHexOfV_AtObj(g,c[0]);<span class="cstat-no" title="statement not covered" >v</span>ar h=KJUR.asn1.ASN1Util.oidHexToInt(d);<span class="cstat-no" title="statement not covered" >v</span>ar f=KJUR.asn1.x509.OID.oid2atype(h);<span class="cstat-no" title="statement not covered" >v</span>ar a=ASN1HEX.getHexOfV_AtObj(g,c[1]);<span class="cstat-no" title="statement not covered" >v</span>ar e=hextorstr(a);<span class="cstat-no" title="statement not covered" >r</span>eturn f+"="+e}</span>;X509.getPublicKeyFromCertHex=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>var a,e,b;<span class="cstat-no" title="statement not covered" >v</span>ar g=6;<span class="cstat-no" title="statement not covered" >v</span>ar d=ASN1HEX;<span class="cstat-no" title="statement not covered" >v</span>ar f=d.getVbyList;<span class="cstat-no" title="statement not covered" >b</span>=d.getDecendantHexTLVByNthList(c,0,[0,0]);<span class="cstat-no" title="statement not covered" >i</span>f(b!=="a003020102"){<span class="cstat-no" title="statement not covered" >g=5}<span class="cstat-no" title="statement not covered" ></span>e</span>=f(c,0,[0,g,0,0],"06");<span class="cstat-no" title="statement not covered" >i</span>f(e==="2a864886f70d010101"){<span class="cstat-no" title="statement not covered" >a=new RSAKey()}</span>else{<span class="cstat-no" title="statement not covered" >if(e==="2a8648ce380401"){<span class="cstat-no" title="statement not covered" >a=new KJUR.crypto.DSA()}</span>else{<span class="cstat-no" title="statement not covered" >if(e==="2a8648ce3d0201"){<span class="cstat-no" title="statement not covered" >a=new KJUR.crypto.ECDSA()}</span>else{<span class="cstat-no" title="statement not covered" >throw"unsupported public key in X.509 cert"}</span>}</span>}<span class="cstat-no" title="statement not covered" ></span>a</span>.readCertPubKeyHex(c,g);<span class="cstat-no" title="statement not covered" >r</span>eturn a}</span>;X509.getPublicKeyFromCertPEM=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>var c=ASN1HEX;<span class="cstat-no" title="statement not covered" >v</span>ar b=c.pemToHex(a);<span class="cstat-no" title="statement not covered" >r</span>eturn X509.getPublicKeyFromCertHex(b)}</span>;X509.getPublicKeyInfoPropOfCertPEM=<span class="fstat-no" title="function not covered" >function(e){<span class="cstat-no" title="statement not covered" ></span>var i={};<span class="cstat-no" title="statement not covered" >i</span>.algparam=null;<span class="cstat-no" title="statement not covered" >v</span>ar f=ASN1HEX.pemToHex(e);<span class="cstat-no" title="statement not covered" >v</span>ar d=ASN1HEX.getPosArrayOfChildren_AtObj(f,0);<span class="cstat-no" title="statement not covered" >i</span>f(d.length!=3){<span class="cstat-no" title="statement not covered" >throw"malformed X.509 certificate PEM (code:001)"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(f.substr(d[0],2)!="30"){<span class="cstat-no" title="statement not covered" >throw"malformed X.509 certificate PEM (code:002)"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar c=ASN1HEX.getPosArrayOfChildren_AtObj(f,d[0]);<span class="cstat-no" title="statement not covered" >v</span>ar g=6;<span class="cstat-no" title="statement not covered" >i</span>f(f.substr(c[0],2)!=="a0"){<span class="cstat-no" title="statement not covered" >g=5}<span class="cstat-no" title="statement not covered" ></span>i</span>f(c.length&lt;g+1){<span class="cstat-no" title="statement not covered" >throw"malformed X.509 certificate PEM (code:003)"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar a=ASN1HEX.getPosArrayOfChildren_AtObj(f,c[g]);<span class="cstat-no" title="statement not covered" >i</span>f(a.length!=2){<span class="cstat-no" title="statement not covered" >throw"malformed X.509 certificate PEM (code:004)"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar h=ASN1HEX.getPosArrayOfChildren_AtObj(f,a[0]);<span class="cstat-no" title="statement not covered" >i</span>f(h.length!=2){<span class="cstat-no" title="statement not covered" >throw"malformed X.509 certificate PEM (code:005)"}<span class="cstat-no" title="statement not covered" ></span>i</span>.algoid=ASN1HEX.getHexOfV_AtObj(f,h[0]);<span class="cstat-no" title="statement not covered" >i</span>f(f.substr(h[1],2)=="06"){<span class="cstat-no" title="statement not covered" >i.algparam=ASN1HEX.getHexOfV_AtObj(f,h[1])}</span>else{<span class="cstat-no" title="statement not covered" >if(f.substr(h[1],2)=="30"){<span class="cstat-no" title="statement not covered" >i.algparam=ASN1HEX.getHexOfTLV_AtObj(f,h[1])}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(f.substr(a[1],2)!="03"){<span class="cstat-no" title="statement not covered" >throw"malformed X.509 certificate PEM (code:006)"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar b=ASN1HEX.getHexOfV_AtObj(f,a[1]);<span class="cstat-no" title="statement not covered" >i</span>.keyhex=b.substr(2);<span class="cstat-no" title="statement not covered" >r</span>eturn i}</span>;X509.getPublicKeyInfoPosOfCertHEX=<span class="fstat-no" title="function not covered" >function(c){<span class="cstat-no" title="statement not covered" ></span>var b=ASN1HEX.getPosArrayOfChildren_AtObj(c,0);<span class="cstat-no" title="statement not covered" >i</span>f(b.length!=3){<span class="cstat-no" title="statement not covered" >throw"malformed X.509 certificate PEM (code:001)"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(c.substr(b[0],2)!="30"){<span class="cstat-no" title="statement not covered" >throw"malformed X.509 certificate PEM (code:002)"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar a=ASN1HEX.getPosArrayOfChildren_AtObj(c,b[0]);<span class="cstat-no" title="statement not covered" >i</span>f(a.length&lt;7){<span class="cstat-no" title="statement not covered" >throw"malformed X.509 certificate PEM (code:003)"}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn a[6]}</span>;X509.getV3ExtInfoListOfCertHex=<span class="fstat-no" title="function not covered" >function(g){<span class="cstat-no" title="statement not covered" ></span>var b=ASN1HEX.getPosArrayOfChildren_AtObj(g,0);<span class="cstat-no" title="statement not covered" >i</span>f(b.length!=3){<span class="cstat-no" title="statement not covered" >throw"malformed X.509 certificate PEM (code:001)"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(g.substr(b[0],2)!="30"){<span class="cstat-no" title="statement not covered" >throw"malformed X.509 certificate PEM (code:002)"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar a=ASN1HEX.getPosArrayOfChildren_AtObj(g,b[0]);<span class="cstat-no" title="statement not covered" >i</span>f(a.length&lt;8){<span class="cstat-no" title="statement not covered" >throw"malformed X.509 certificate PEM (code:003)"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(g.substr(a[7],2)!="a3"){<span class="cstat-no" title="statement not covered" >throw"malformed X.509 certificate PEM (code:004)"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar h=ASN1HEX.getPosArrayOfChildren_AtObj(g,a[7]);<span class="cstat-no" title="statement not covered" >i</span>f(h.length!=1){<span class="cstat-no" title="statement not covered" >throw"malformed X.509 certificate PEM (code:005)"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(g.substr(h[0],2)!="30"){<span class="cstat-no" title="statement not covered" >throw"malformed X.509 certificate PEM (code:006)"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar f=ASN1HEX.getPosArrayOfChildren_AtObj(g,h[0]);<span class="cstat-no" title="statement not covered" >v</span>ar e=f.length;<span class="cstat-no" title="statement not covered" >v</span>ar d=new Array(e);<span class="cstat-no" title="statement not covered" >f</span>or(var c=0;c&lt;e;c++){<span class="cstat-no" title="statement not covered" >d[c]=X509.getV3ExtItemInfo_AtObj(g,f[c])}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn d}</span>;X509.getV3ExtItemInfo_AtObj=<span class="fstat-no" title="function not covered" >function(f,g){<span class="cstat-no" title="statement not covered" ></span>var e={};<span class="cstat-no" title="statement not covered" >e</span>.posTLV=g;<span class="cstat-no" title="statement not covered" >v</span>ar b=ASN1HEX.getPosArrayOfChildren_AtObj(f,g);<span class="cstat-no" title="statement not covered" >i</span>f(b.length!=2&amp;&amp;b.length!=3){<span class="cstat-no" title="statement not covered" >throw"malformed X.509v3 Ext (code:001)"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(f.substr(b[0],2)!="06"){<span class="cstat-no" title="statement not covered" >throw"malformed X.509v3 Ext (code:002)"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar d=ASN1HEX.getHexOfV_AtObj(f,b[0]);<span class="cstat-no" title="statement not covered" >e</span>.oid=ASN1HEX.hextooidstr(d);<span class="cstat-no" title="statement not covered" >e</span>.critical=false;<span class="cstat-no" title="statement not covered" >i</span>f(b.length==3){<span class="cstat-no" title="statement not covered" >e.critical=true}<span class="cstat-no" title="statement not covered" ></span>v</span>ar c=b[b.length-1];<span class="cstat-no" title="statement not covered" >i</span>f(f.substr(c,2)!="04"){<span class="cstat-no" title="statement not covered" >throw"malformed X.509v3 Ext (code:003)"}<span class="cstat-no" title="statement not covered" ></span>e</span>.posV=ASN1HEX.getStartPosOfV_AtObj(f,c);<span class="cstat-no" title="statement not covered" >r</span>eturn e}</span>;X509.getHexOfTLV_V3ExtValue=<span class="fstat-no" title="function not covered" >function(b,a){<span class="cstat-no" title="statement not covered" ></span>var c=X509.getPosOfTLV_V3ExtValue(b,a);<span class="cstat-no" title="statement not covered" >i</span>f(c==-1){<span class="cstat-no" title="statement not covered" >return null}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn ASN1HEX.getHexOfTLV_AtObj(b,c)}</span>;X509.getHexOfV_V3ExtValue=<span class="fstat-no" title="function not covered" >function(b,a){<span class="cstat-no" title="statement not covered" ></span>var c=X509.getPosOfTLV_V3ExtValue(b,a);<span class="cstat-no" title="statement not covered" >i</span>f(c==-1){<span class="cstat-no" title="statement not covered" >return null}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn ASN1HEX.getHexOfV_AtObj(b,c)}</span>;X509.getPosOfTLV_V3ExtValue=<span class="fstat-no" title="function not covered" >function(f,b){<span class="cstat-no" title="statement not covered" ></span>var d=b;<span class="cstat-no" title="statement not covered" >i</span>f(!b.match(/^[0-9.]+$/)){<span class="cstat-no" title="statement not covered" >d=KJUR.asn1.x509.OID.name2oid(b)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(d==""){<span class="cstat-no" title="statement not covered" >return -1}<span class="cstat-no" title="statement not covered" ></span>v</span>ar c=X509.getV3ExtInfoListOfCertHex(f);<span class="cstat-no" title="statement not covered" >f</span>or(var a=0;a&lt;c.length;a++){<span class="cstat-no" title="statement not covered" >var e=c[a];<span class="cstat-no" title="statement not covered" >i</span>f(e.oid==d){<span class="cstat-no" title="statement not covered" >return e.posV}</span>}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn -1}</span>;X509.getExtBasicConstraints=<span class="fstat-no" title="function not covered" >function(d){<span class="cstat-no" title="statement not covered" ></span>var a=X509.getHexOfV_V3ExtValue(d,"basicConstraints");<span class="cstat-no" title="statement not covered" >i</span>f(a===null){<span class="cstat-no" title="statement not covered" >return null}<span class="cstat-no" title="statement not covered" ></span>i</span>f(a===""){<span class="cstat-no" title="statement not covered" >return{}}<span class="cstat-no" title="statement not covered" ></span>i</span>f(a==="0101ff"){<span class="cstat-no" title="statement not covered" >return{cA:true}}<span class="cstat-no" title="statement not covered" ></span>i</span>f(a.substr(0,8)==="0101ff02"){<span class="cstat-no" title="statement not covered" >var c=ASN1HEX.getHexOfV_AtObj(a,6);<span class="cstat-no" title="statement not covered" >v</span>ar b=parseInt(c,16);<span class="cstat-no" title="statement not covered" >r</span>eturn{cA:true,pathLen:b}}<span class="cstat-no" title="statement not covered" ></span>t</span>hrow"unknown error"}</span>;X509.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"];X509.getExtKeyUsageBin=<span class="fstat-no" title="function not covered" >function(d){<span class="cstat-no" title="statement not covered" ></span>var b=X509.getHexOfV_V3ExtValue(d,"keyUsage");<span class="cstat-no" title="statement not covered" >i</span>f(b==""){<span class="cstat-no" title="statement not covered" >return""}<span class="cstat-no" title="statement not covered" ></span>i</span>f(b.length%2!=0||b.length&lt;=2){<span class="cstat-no" title="statement not covered" >throw"malformed key usage value"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar a=parseInt(b.substr(0,2));<span class="cstat-no" title="statement not covered" >v</span>ar c=parseInt(b.substr(2),16).toString(2);<span class="cstat-no" title="statement not covered" >r</span>eturn c.substr(0,c.length-a)}</span>;X509.getExtKeyUsageString=<span class="fstat-no" title="function not covered" >function(e){<span class="cstat-no" title="statement not covered" ></span>var d=X509.getExtKeyUsageBin(e);<span class="cstat-no" title="statement not covered" >v</span>ar b=new Array();<span class="cstat-no" title="statement not covered" >f</span>or(var c=0;c&lt;d.length;c++){<span class="cstat-no" title="statement not covered" >if(d.substr(c,1)=="1"){<span class="cstat-no" title="statement not covered" >b.push(X509.KEYUSAGE_NAME[c])}</span>}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn b.join(",")}</span>;X509.getExtSubjectKeyIdentifier=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>var a=X509.getHexOfV_V3ExtValue(b,"subjectKeyIdentifier");<span class="cstat-no" title="statement not covered" >r</span>eturn a}</span>;X509.getExtAuthorityKeyIdentifier=<span class="fstat-no" title="function not covered" >function(f){<span class="cstat-no" title="statement not covered" ></span>var b={};<span class="cstat-no" title="statement not covered" >v</span>ar e=X509.getHexOfTLV_V3ExtValue(f,"authorityKeyIdentifier");<span class="cstat-no" title="statement not covered" >i</span>f(e===null){<span class="cstat-no" title="statement not covered" >return null}<span class="cstat-no" title="statement not covered" ></span>v</span>ar c=ASN1HEX.getPosArrayOfChildren_AtObj(e,0);<span class="cstat-no" title="statement not covered" >f</span>or(var d=0;d&lt;c.length;d++){<span class="cstat-no" title="statement not covered" >if(e.substr(c[d],2)==="80"){<span class="cstat-no" title="statement not covered" >b.kid=ASN1HEX.getHexOfV_AtObj(e,c[d])}</span>}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn b}</span>;X509.getExtExtKeyUsageName=<span class="fstat-no" title="function not covered" >function(k){<span class="cstat-no" title="statement not covered" ></span>var b=new Array();<span class="cstat-no" title="statement not covered" >v</span>ar f=X509.getHexOfTLV_V3ExtValue(k,"extKeyUsage");<span class="cstat-no" title="statement not covered" >i</span>f(f===null){<span class="cstat-no" title="statement not covered" >return null}<span class="cstat-no" title="statement not covered" ></span>v</span>ar c=ASN1HEX.getPosArrayOfChildren_AtObj(f,0);<span class="cstat-no" title="statement not covered" >f</span>or(var e=0;e&lt;c.length;e++){<span class="cstat-no" title="statement not covered" >var j=ASN1HEX.getHexOfV_AtObj(f,c[e]);<span class="cstat-no" title="statement not covered" >v</span>ar g=KJUR.asn1.ASN1Util.oidHexToInt(j);<span class="cstat-no" title="statement not covered" >v</span>ar d=KJUR.asn1.x509.OID.oid2name(g);<span class="cstat-no" title="statement not covered" >b</span>.push(d)}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn b}</span>;X509.getExtSubjectAltName=<span class="fstat-no" title="function not covered" >function(g){<span class="cstat-no" title="statement not covered" ></span>var b=new Array();<span class="cstat-no" title="statement not covered" >v</span>ar f=X509.getHexOfTLV_V3ExtValue(g,"subjectAltName");<span class="cstat-no" title="statement not covered" >v</span>ar c=ASN1HEX.getPosArrayOfChildren_AtObj(f,0);<span class="cstat-no" title="statement not covered" >f</span>or(var e=0;e&lt;c.length;e++){<span class="cstat-no" title="statement not covered" >if(f.substr(c[e],2)==="82"){<span class="cstat-no" title="statement not covered" >var d=hextoutf8(ASN1HEX.getHexOfV_AtObj(f,c[e]));<span class="cstat-no" title="statement not covered" >b</span>.push(d)}</span>}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn b}</span>;X509.getExtCRLDistributionPointsURI=<span class="fstat-no" title="function not covered" >function(n){<span class="cstat-no" title="statement not covered" ></span>var p=new Array();<span class="cstat-no" title="statement not covered" >v</span>ar k=X509.getHexOfTLV_V3ExtValue(n,"cRLDistributionPoints");<span class="cstat-no" title="statement not covered" >v</span>ar o=ASN1HEX.getPosArrayOfChildren_AtObj(k,0);<span class="cstat-no" title="statement not covered" >f</span>or(var g=0;g&lt;o.length;g++){<span class="cstat-no" title="statement not covered" >var l=ASN1HEX.getHexOfTLV_AtObj(k,o[g]);<span class="cstat-no" title="statement not covered" >v</span>ar b=ASN1HEX.getPosArrayOfChildren_AtObj(l,0);<span class="cstat-no" title="statement not covered" >f</span>or(var e=0;e&lt;b.length;e++){<span class="cstat-no" title="statement not covered" >if(l.substr(b[e],2)==="a0"){<span class="cstat-no" title="statement not covered" >var f=ASN1HEX.getHexOfV_AtObj(l,b[e]);<span class="cstat-no" title="statement not covered" >i</span>f(f.substr(0,2)==="a0"){<span class="cstat-no" title="statement not covered" >var c=ASN1HEX.getHexOfV_AtObj(f,0);<span class="cstat-no" title="statement not covered" >i</span>f(c.substr(0,2)==="86"){<span class="cstat-no" title="statement not covered" >var m=ASN1HEX.getHexOfV_AtObj(c,0);<span class="cstat-no" title="statement not covered" >v</span>ar d=hextoutf8(m);<span class="cstat-no" title="statement not covered" >p</span>.push(d)}</span>}</span>}</span>}</span>}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn p}</span>;X509.getExtAIAInfo=<span class="fstat-no" title="function not covered" >function(g){<span class="cstat-no" title="statement not covered" ></span>var j={};<span class="cstat-no" title="statement not covered" >j</span>.ocsp=[];<span class="cstat-no" title="statement not covered" >j</span>.caissuer=[];<span class="cstat-no" title="statement not covered" >v</span>ar h=X509.getPosOfTLV_V3ExtValue(g,"authorityInfoAccess");<span class="cstat-no" title="statement not covered" >i</span>f(h==-1){<span class="cstat-no" title="statement not covered" >return null}<span class="cstat-no" title="statement not covered" ></span>i</span>f(g.substr(h,2)!="30"){<span class="cstat-no" title="statement not covered" >throw"malformed AIA Extn Value"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar d=ASN1HEX.getPosArrayOfChildren_AtObj(g,h);<span class="cstat-no" title="statement not covered" >f</span>or(var c=0;c&lt;d.length;c++){<span class="cstat-no" title="statement not covered" >var a=d[c];<span class="cstat-no" title="statement not covered" >v</span>ar b=ASN1HEX.getPosArrayOfChildren_AtObj(g,a);<span class="cstat-no" title="statement not covered" >i</span>f(b.length!=2){<span class="cstat-no" title="statement not covered" >throw"malformed AccessDescription of AIA Extn"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar e=b[0];<span class="cstat-no" title="statement not covered" >v</span>ar f=b[1];<span class="cstat-no" title="statement not covered" >i</span>f(ASN1HEX.getHexOfV_AtObj(g,e)=="2b06010505073001"){<span class="cstat-no" title="statement not covered" >if(g.substr(f,2)=="86"){<span class="cstat-no" title="statement not covered" >j.ocsp.push(hextoutf8(ASN1HEX.getHexOfV_AtObj(g,f)))}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(ASN1HEX.getHexOfV_AtObj(g,e)=="2b06010505073002"){<span class="cstat-no" title="statement not covered" >if(g.substr(f,2)=="86"){<span class="cstat-no" title="statement not covered" >j.caissuer.push(hextoutf8(ASN1HEX.getHexOfV_AtObj(g,f)))}</span>}</span>}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn j}</span>;X509.getSignatureAlgorithmName=<span class="fstat-no" title="function not covered" >function(d){<span class="cstat-no" title="statement not covered" ></span>var b=ASN1HEX.getDecendantHexVByNthList(d,0,[1,0]);<span class="cstat-no" title="statement not covered" >v</span>ar a=KJUR.asn1.ASN1Util.oidHexToInt(b);<span class="cstat-no" title="statement not covered" >v</span>ar c=KJUR.asn1.x509.OID.oid2name(a);<span class="cstat-no" title="statement not covered" >r</span>eturn c}</span>;X509.getSignatureValueHex=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>var a=ASN1HEX.getDecendantHexVByNthList(b,0,[2]);<span class="cstat-no" title="statement not covered" >i</span>f(a.substr(0,2)!=="00"){<span class="cstat-no" title="statement not covered" >throw"can't get signature value"}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn a.substr(2)}</span>;X509.getSerialNumberHex=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>return ASN1HEX.getDecendantHexVByNthList(a,0,[0,1])}</span>;X509.verifySignature=<span class="fstat-no" title="function not covered" >function(f,c){<span class="cstat-no" title="statement not covered" ></span>var d=X509.getSignatureAlgorithmName(f);<span class="cstat-no" title="statement not covered" >v</span>ar a=X509.getSignatureValueHex(f);<span class="cstat-no" title="statement not covered" >v</span>ar b=ASN1HEX.getDecendantHexTLVByNthList(f,0,[0]);<span class="cstat-no" title="statement not covered" >v</span>ar e=new KJUR.crypto.Signature({alg:d});<span class="cstat-no" title="statement not covered" >e</span>.init(c);<span class="cstat-no" title="statement not covered" >e</span>.updateHex(b);<span class="cstat-no" title="statement not covered" >r</span>eturn e.verify(a)}</span>;
/*! jws-3.3.6 (c) 2013-2017 Kenji Urushima | kjur.github.com/jsrsasign/license
 */
<span class="missing-if-branch" title="if path not taken" >I</span>if(typeof KJUR=="undefined"||!KJUR){<span class="cstat-no" title="statement not covered" >KJUR={}}<span class="missing-if-branch" title="else path not taken" >E</span></span>if(typeof KJUR.jws=="undefined"||<span class="branch-1 cbranch-no" title="branch not covered" >!KJUR.jws)</span>{KJUR.jws={}}KJUR.jws.JWS=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var a=KJUR.jws.JWS;<span class="cstat-no" title="statement not covered" >t</span>his.parseJWS=<span class="fstat-no" title="function not covered" >function(e,h){<span class="cstat-no" title="statement not covered" ></span>if((this.parsedJWS!==undefined)&amp;&amp;(h||(this.parsedJWS.sigvalH!==undefined))){<span class="cstat-no" title="statement not covered" >return}<span class="cstat-no" title="statement not covered" ></span>v</span>ar g=e.match(/^([^.]+)\.([^.]+)\.([^.]+)$/);<span class="cstat-no" title="statement not covered" >i</span>f(g==null){<span class="cstat-no" title="statement not covered" >throw"JWS signature is not a form of 'Head.Payload.SigValue'."}<span class="cstat-no" title="statement not covered" ></span>v</span>ar i=g[1];<span class="cstat-no" title="statement not covered" >v</span>ar c=g[2];<span class="cstat-no" title="statement not covered" >v</span>ar j=g[3];<span class="cstat-no" title="statement not covered" >v</span>ar l=i+"."+c;<span class="cstat-no" title="statement not covered" >t</span>his.parsedJWS={};<span class="cstat-no" title="statement not covered" >t</span>his.parsedJWS.headB64U=i;<span class="cstat-no" title="statement not covered" >t</span>his.parsedJWS.payloadB64U=c;<span class="cstat-no" title="statement not covered" >t</span>his.parsedJWS.sigvalB64U=j;<span class="cstat-no" title="statement not covered" >t</span>his.parsedJWS.si=l;<span class="cstat-no" title="statement not covered" >i</span>f(!h){<span class="cstat-no" title="statement not covered" >var f=b64utohex(j);<span class="cstat-no" title="statement not covered" >v</span>ar d=parseBigInt(f,16);<span class="cstat-no" title="statement not covered" >t</span>his.parsedJWS.sigvalH=f;<span class="cstat-no" title="statement not covered" >t</span>his.parsedJWS.sigvalBI=d}<span class="cstat-no" title="statement not covered" ></span>v</span>ar b=b64utoutf8(i);<span class="cstat-no" title="statement not covered" >v</span>ar k=b64utoutf8(c);<span class="cstat-no" title="statement not covered" >t</span>his.parsedJWS.headS=b;<span class="cstat-no" title="statement not covered" >t</span>his.parsedJWS.payloadS=k;<span class="cstat-no" title="statement not covered" >i</span>f(!a.isSafeJSONString(b,this.parsedJWS,"headP")){<span class="cstat-no" title="statement not covered" >throw"malformed JSON string for JWS Head: "+b}</span>}</span>}</span>;KJUR.jws.JWS.sign=<span class="fstat-no" title="function not covered" >function(a,i,c,m,l){<span class="cstat-no" title="statement not covered" ></span>var k=KJUR.jws.JWS;<span class="cstat-no" title="statement not covered" >v</span>ar q,e,j;<span class="cstat-no" title="statement not covered" >i</span>f(typeof i!="string"&amp;&amp;typeof i!="object"){<span class="cstat-no" title="statement not covered" >throw"spHeader must be JSON string or object: "+i}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof i=="object"){<span class="cstat-no" title="statement not covered" >e=i;<span class="cstat-no" title="statement not covered" >q</span>=JSON.stringify(e)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof i=="string"){<span class="cstat-no" title="statement not covered" >q=i;<span class="cstat-no" title="statement not covered" >i</span>f(!k.isSafeJSONString(q)){<span class="cstat-no" title="statement not covered" >throw"JWS Head is not safe JSON string: "+q}<span class="cstat-no" title="statement not covered" ></span>e</span>=k.readSafeJSONString(q)}<span class="cstat-no" title="statement not covered" ></span>j</span>=c;<span class="cstat-no" title="statement not covered" >i</span>f(typeof c=="object"){<span class="cstat-no" title="statement not covered" >j=JSON.stringify(c)}<span class="cstat-no" title="statement not covered" ></span>i</span>f((a==""||a==null)&amp;&amp;e.alg!==undefined){<span class="cstat-no" title="statement not covered" >a=e.alg}<span class="cstat-no" title="statement not covered" ></span>i</span>f((a!=""&amp;&amp;a!=null)&amp;&amp;e.alg===undefined){<span class="cstat-no" title="statement not covered" >e.alg=a;<span class="cstat-no" title="statement not covered" >q</span>=JSON.stringify(e)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(a!==e.alg){<span class="cstat-no" title="statement not covered" >throw"alg and sHeader.alg doesn't match: "+a+"!="+e.alg}<span class="cstat-no" title="statement not covered" ></span>v</span>ar d=null;<span class="cstat-no" title="statement not covered" >i</span>f(k.jwsalg2sigalg[a]===undefined){<span class="cstat-no" title="statement not covered" >throw"unsupported alg name: "+a}</span>else{<span class="cstat-no" title="statement not covered" >d=k.jwsalg2sigalg[a]}<span class="cstat-no" title="statement not covered" ></span>v</span>ar b=utf8tob64u(q);<span class="cstat-no" title="statement not covered" >v</span>ar g=utf8tob64u(j);<span class="cstat-no" title="statement not covered" >v</span>ar o=b+"."+g;<span class="cstat-no" title="statement not covered" >v</span>ar n="";<span class="cstat-no" title="statement not covered" >i</span>f(d.substr(0,4)=="Hmac"){<span class="cstat-no" title="statement not covered" >if(m===undefined){<span class="cstat-no" title="statement not covered" >throw"mac key shall be specified for HS* alg"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar h=new KJUR.crypto.Mac({alg:d,prov:"cryptojs",pass:m});<span class="cstat-no" title="statement not covered" >h</span>.updateString(o);<span class="cstat-no" title="statement not covered" >n</span>=h.doFinal()}</span>else{<span class="cstat-no" title="statement not covered" >if(d.indexOf("withECDSA")!=-1){<span class="cstat-no" title="statement not covered" >var p=new KJUR.crypto.Signature({alg:d});<span class="cstat-no" title="statement not covered" >p</span>.init(m,l);<span class="cstat-no" title="statement not covered" >p</span>.updateString(o);<span class="cstat-no" title="statement not covered" >h</span>ASN1Sig=p.sign();<span class="cstat-no" title="statement not covered" >n</span>=KJUR.crypto.ECDSA.asn1SigToConcatSig(hASN1Sig)}</span>else{<span class="cstat-no" title="statement not covered" >if(d!="none"){<span class="cstat-no" title="statement not covered" >var p=new KJUR.crypto.Signature({alg:d});<span class="cstat-no" title="statement not covered" >p</span>.init(m,l);<span class="cstat-no" title="statement not covered" >p</span>.updateString(o);<span class="cstat-no" title="statement not covered" >n</span>=p.sign()}</span>}</span>}<span class="cstat-no" title="statement not covered" ></span>v</span>ar f=hextob64u(n);<span class="cstat-no" title="statement not covered" >r</span>eturn o+"."+f}</span>;KJUR.jws.JWS.verify=<span class="fstat-no" title="function not covered" >function(p,t,j){<span class="cstat-no" title="statement not covered" ></span>var m=KJUR.jws.JWS;<span class="cstat-no" title="statement not covered" >v</span>ar q=p.split(".");<span class="cstat-no" title="statement not covered" >v</span>ar d=q[0];<span class="cstat-no" title="statement not covered" >v</span>ar l=q[1];<span class="cstat-no" title="statement not covered" >v</span>ar b=d+"."+l;<span class="cstat-no" title="statement not covered" >v</span>ar r=b64utohex(q[2]);<span class="cstat-no" title="statement not covered" >v</span>ar i=m.readSafeJSONString(b64utoutf8(q[0]));<span class="cstat-no" title="statement not covered" >v</span>ar h=null;<span class="cstat-no" title="statement not covered" >v</span>ar s=null;<span class="cstat-no" title="statement not covered" >i</span>f(i.alg===undefined){<span class="cstat-no" title="statement not covered" >throw"algorithm not specified in header"}</span>else{<span class="cstat-no" title="statement not covered" >h=i.alg;<span class="cstat-no" title="statement not covered" >s</span>=h.substr(0,2)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(j!=null&amp;&amp;Object.prototype.toString.call(j)==="[object Array]"&amp;&amp;j.length&gt;0){<span class="cstat-no" title="statement not covered" >var c=":"+j.join(":")+":";<span class="cstat-no" title="statement not covered" >i</span>f(c.indexOf(":"+h+":")==-1){<span class="cstat-no" title="statement not covered" >throw"algorithm '"+h+"' not accepted in the list"}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(h!="none"&amp;&amp;t===null){<span class="cstat-no" title="statement not covered" >throw"key shall be specified to verify."}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof t=="string"&amp;&amp;t.indexOf("-----BEGIN ")!=-1){<span class="cstat-no" title="statement not covered" >t=KEYUTIL.getKey(t)}<span class="cstat-no" title="statement not covered" ></span>i</span>f(s=="RS"||s=="PS"){<span class="cstat-no" title="statement not covered" >if(!(t instanceof RSAKey)){<span class="cstat-no" title="statement not covered" >throw"key shall be a RSAKey obj for RS* and PS* algs"}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(s=="ES"){<span class="cstat-no" title="statement not covered" >if(!(t instanceof KJUR.crypto.ECDSA)){<span class="cstat-no" title="statement not covered" >throw"key shall be a ECDSA obj for ES* algs"}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(h=="none"){}<span class="cstat-no" title="statement not covered" >v</span>ar n=null;<span class="cstat-no" title="statement not covered" >i</span>f(m.jwsalg2sigalg[i.alg]===undefined){<span class="cstat-no" title="statement not covered" >throw"unsupported alg name: "+h}</span>else{<span class="cstat-no" title="statement not covered" >n=m.jwsalg2sigalg[h]}<span class="cstat-no" title="statement not covered" ></span>i</span>f(n=="none"){<span class="cstat-no" title="statement not covered" >throw"not supported"}</span>else{<span class="cstat-no" title="statement not covered" >if(n.substr(0,4)=="Hmac"){<span class="cstat-no" title="statement not covered" >var k=null;<span class="cstat-no" title="statement not covered" >i</span>f(t===undefined){<span class="cstat-no" title="statement not covered" >throw"hexadecimal key shall be specified for HMAC"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar g=new KJUR.crypto.Mac({alg:n,pass:t});<span class="cstat-no" title="statement not covered" >g</span>.updateString(b);<span class="cstat-no" title="statement not covered" >k</span>=g.doFinal();<span class="cstat-no" title="statement not covered" >r</span>eturn r==k}</span>else{<span class="cstat-no" title="statement not covered" >if(n.indexOf("withECDSA")!=-1){<span class="cstat-no" title="statement not covered" >var f=null;<span class="cstat-no" title="statement not covered" >t</span>ry{<span class="cstat-no" title="statement not covered" >f=KJUR.crypto.ECDSA.concatSigToASN1Sig(r)}</span>catch(o){<span class="cstat-no" title="statement not covered" >return false}<span class="cstat-no" title="statement not covered" ></span>v</span>ar e=new KJUR.crypto.Signature({alg:n});<span class="cstat-no" title="statement not covered" >e</span>.init(t);<span class="cstat-no" title="statement not covered" >e</span>.updateString(b);<span class="cstat-no" title="statement not covered" >r</span>eturn e.verify(f)}</span>else{<span class="cstat-no" title="statement not covered" >var e=new KJUR.crypto.Signature({alg:n});<span class="cstat-no" title="statement not covered" >e</span>.init(t);<span class="cstat-no" title="statement not covered" >e</span>.updateString(b);<span class="cstat-no" title="statement not covered" >r</span>eturn e.verify(r)}</span>}</span>}</span>}</span>;KJUR.jws.JWS.parse=<span class="fstat-no" title="function not covered" >function(g){<span class="cstat-no" title="statement not covered" ></span>var c=g.split(".");<span class="cstat-no" title="statement not covered" >v</span>ar b={};<span class="cstat-no" title="statement not covered" >v</span>ar f,e,d;<span class="cstat-no" title="statement not covered" >i</span>f(c.length!=2&amp;&amp;c.length!=3){<span class="cstat-no" title="statement not covered" >throw"malformed sJWS: wrong number of '.' splitted elements"}<span class="cstat-no" title="statement not covered" ></span>f</span>=c[0];<span class="cstat-no" title="statement not covered" >e</span>=c[1];<span class="cstat-no" title="statement not covered" >i</span>f(c.length==3){<span class="cstat-no" title="statement not covered" >d=c[2]}<span class="cstat-no" title="statement not covered" ></span>b</span>.headerObj=KJUR.jws.JWS.readSafeJSONString(b64utoutf8(f));<span class="cstat-no" title="statement not covered" >b</span>.payloadObj=KJUR.jws.JWS.readSafeJSONString(b64utoutf8(e));<span class="cstat-no" title="statement not covered" >b</span>.headerPP=JSON.stringify(b.headerObj,null,"  ");<span class="cstat-no" title="statement not covered" >i</span>f(b.payloadObj==null){<span class="cstat-no" title="statement not covered" >b.payloadPP=b64utoutf8(e)}</span>else{<span class="cstat-no" title="statement not covered" >b.payloadPP=JSON.stringify(b.payloadObj,null,"  ")}<span class="cstat-no" title="statement not covered" ></span>i</span>f(d!==undefined){<span class="cstat-no" title="statement not covered" >b.sigHex=b64utohex(d)}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn b}</span>;KJUR.jws.JWS.verifyJWT=<span class="fstat-no" title="function not covered" >function(d,j,l){<span class="cstat-no" title="statement not covered" ></span>var h=KJUR.jws.JWS;<span class="cstat-no" title="statement not covered" >v</span>ar i=d.split(".");<span class="cstat-no" title="statement not covered" >v</span>ar c=i[0];<span class="cstat-no" title="statement not covered" >v</span>ar g=i[1];<span class="cstat-no" title="statement not covered" >v</span>ar m=c+"."+g;<span class="cstat-no" title="statement not covered" >v</span>ar k=b64utohex(i[2]);<span class="cstat-no" title="statement not covered" >v</span>ar f=h.readSafeJSONString(b64utoutf8(c));<span class="cstat-no" title="statement not covered" >v</span>ar e=h.readSafeJSONString(b64utoutf8(g));<span class="cstat-no" title="statement not covered" >i</span>f(f.alg===undefined){<span class="cstat-no" title="statement not covered" >return false}<span class="cstat-no" title="statement not covered" ></span>i</span>f(l.alg===undefined){<span class="cstat-no" title="statement not covered" >throw"acceptField.alg shall be specified"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(!h.inArray(f.alg,l.alg)){<span class="cstat-no" title="statement not covered" >return false}<span class="cstat-no" title="statement not covered" ></span>i</span>f(e.iss!==undefined&amp;&amp;typeof l.iss==="object"){<span class="cstat-no" title="statement not covered" >if(!h.inArray(e.iss,l.iss)){<span class="cstat-no" title="statement not covered" >return false}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(e.sub!==undefined&amp;&amp;typeof l.sub==="object"){<span class="cstat-no" title="statement not covered" >if(!h.inArray(e.sub,l.sub)){<span class="cstat-no" title="statement not covered" >return false}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(e.aud!==undefined&amp;&amp;typeof l.aud==="object"){<span class="cstat-no" title="statement not covered" >if(typeof e.aud=="string"){<span class="cstat-no" title="statement not covered" >if(!h.inArray(e.aud,l.aud)){<span class="cstat-no" title="statement not covered" >return false}</span>}</span>else{<span class="cstat-no" title="statement not covered" >if(typeof e.aud=="object"){<span class="cstat-no" title="statement not covered" >if(!h.includedArray(e.aud,l.aud)){<span class="cstat-no" title="statement not covered" >return false}</span>}</span>}</span>}<span class="cstat-no" title="statement not covered" ></span>v</span>ar b=KJUR.jws.IntDate.getNow();<span class="cstat-no" title="statement not covered" >i</span>f(l.verifyAt!==undefined&amp;&amp;typeof l.verifyAt==="number"){<span class="cstat-no" title="statement not covered" >b=l.verifyAt}<span class="cstat-no" title="statement not covered" ></span>i</span>f(l.gracePeriod===undefined||typeof l.gracePeriod!=="number"){<span class="cstat-no" title="statement not covered" >l.gracePeriod=0}<span class="cstat-no" title="statement not covered" ></span>i</span>f(e.exp!==undefined&amp;&amp;typeof e.exp=="number"){<span class="cstat-no" title="statement not covered" >if(e.exp+l.gracePeriod&lt;b){<span class="cstat-no" title="statement not covered" >return false}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(e.nbf!==undefined&amp;&amp;typeof e.nbf=="number"){<span class="cstat-no" title="statement not covered" >if(b&lt;e.nbf-l.gracePeriod){<span class="cstat-no" title="statement not covered" >return false}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(e.iat!==undefined&amp;&amp;typeof e.iat=="number"){<span class="cstat-no" title="statement not covered" >if(b&lt;e.iat-l.gracePeriod){<span class="cstat-no" title="statement not covered" >return false}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(e.jti!==undefined&amp;&amp;l.jti!==undefined){<span class="cstat-no" title="statement not covered" >if(e.jti!==l.jti){<span class="cstat-no" title="statement not covered" >return false}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(!KJUR.jws.JWS.verify(d,j,l.alg)){<span class="cstat-no" title="statement not covered" >return false}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn true}</span>;KJUR.jws.JWS.includedArray=<span class="fstat-no" title="function not covered" >function(b,a){<span class="cstat-no" title="statement not covered" ></span>var d=KJUR.jws.JWS.inArray;<span class="cstat-no" title="statement not covered" >i</span>f(b===null){<span class="cstat-no" title="statement not covered" >return false}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof b!=="object"){<span class="cstat-no" title="statement not covered" >return false}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof b.length!=="number"){<span class="cstat-no" title="statement not covered" >return false}<span class="cstat-no" title="statement not covered" ></span>f</span>or(var c=0;c&lt;b.length;c++){<span class="cstat-no" title="statement not covered" >if(!d(b[c],a)){<span class="cstat-no" title="statement not covered" >return false}</span>}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn true}</span>;KJUR.jws.JWS.inArray=<span class="fstat-no" title="function not covered" >function(d,b){<span class="cstat-no" title="statement not covered" ></span>if(b===null){<span class="cstat-no" title="statement not covered" >return false}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof b!=="object"){<span class="cstat-no" title="statement not covered" >return false}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof b.length!=="number"){<span class="cstat-no" title="statement not covered" >return false}<span class="cstat-no" title="statement not covered" ></span>f</span>or(var c=0;c&lt;b.length;c++){<span class="cstat-no" title="statement not covered" >if(b[c]==d){<span class="cstat-no" title="statement not covered" >return true}</span>}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn false}</span>;KJUR.jws.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS384:"HmacSHA384",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none",};KJUR.jws.JWS.isSafeJSONString=<span class="fstat-no" title="function not covered" >function(c,b,d){<span class="cstat-no" title="statement not covered" ></span>var e=null;<span class="cstat-no" title="statement not covered" >t</span>ry{<span class="cstat-no" title="statement not covered" >e=jsonParse(c);<span class="cstat-no" title="statement not covered" >i</span>f(typeof e!="object"){<span class="cstat-no" title="statement not covered" >return 0}<span class="cstat-no" title="statement not covered" ></span>i</span>f(e.constructor===Array){<span class="cstat-no" title="statement not covered" >return 0}<span class="cstat-no" title="statement not covered" ></span>i</span>f(b){<span class="cstat-no" title="statement not covered" >b[d]=e}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn 1}</span>catch(a){<span class="cstat-no" title="statement not covered" >return 0}</span>}</span>;KJUR.jws.JWS.readSafeJSONString=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>var c=null;<span class="cstat-no" title="statement not covered" >t</span>ry{<span class="cstat-no" title="statement not covered" >c=jsonParse(b);<span class="cstat-no" title="statement not covered" >i</span>f(typeof c!="object"){<span class="cstat-no" title="statement not covered" >return null}<span class="cstat-no" title="statement not covered" ></span>i</span>f(c.constructor===Array){<span class="cstat-no" title="statement not covered" >return null}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn c}</span>catch(a){<span class="cstat-no" title="statement not covered" >return null}</span>}</span>;KJUR.jws.JWS.getEncodedSignatureValueFromJWS=<span class="fstat-no" title="function not covered" >function(b){<span class="cstat-no" title="statement not covered" ></span>var a=b.match(/^[^.]+\.[^.]+\.([^.]+)$/);<span class="cstat-no" title="statement not covered" >i</span>f(a==null){<span class="cstat-no" title="statement not covered" >throw"JWS signature is not a form of 'Head.Payload.SigValue'."}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn a[1]}</span>;KJUR.jws.JWS.getJWKthumbprint=<span class="fstat-no" title="function not covered" >function(d){<span class="cstat-no" title="statement not covered" ></span>if(d.kty!=="RSA"&amp;&amp;d.kty!=="EC"&amp;&amp;d.kty!=="oct"){<span class="cstat-no" title="statement not covered" >throw"unsupported algorithm for JWK Thumprint"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar a="{";<span class="cstat-no" title="statement not covered" >i</span>f(d.kty==="RSA"){<span class="cstat-no" title="statement not covered" >if(typeof d.n!="string"||typeof d.e!="string"){<span class="cstat-no" title="statement not covered" >throw"wrong n and e value for RSA key"}<span class="cstat-no" title="statement not covered" ></span>a</span>+='"e":"'+d.e+'",';<span class="cstat-no" title="statement not covered" >a</span>+='"kty":"'+d.kty+'",';<span class="cstat-no" title="statement not covered" >a</span>+='"n":"'+d.n+'"}'}</span>else{<span class="cstat-no" title="statement not covered" >if(d.kty==="EC"){<span class="cstat-no" title="statement not covered" >if(typeof d.crv!="string"||typeof d.x!="string"||typeof d.y!="string"){<span class="cstat-no" title="statement not covered" >throw"wrong crv, x and y value for EC key"}<span class="cstat-no" title="statement not covered" ></span>a</span>+='"crv":"'+d.crv+'",';<span class="cstat-no" title="statement not covered" >a</span>+='"kty":"'+d.kty+'",';<span class="cstat-no" title="statement not covered" >a</span>+='"x":"'+d.x+'",';<span class="cstat-no" title="statement not covered" >a</span>+='"y":"'+d.y+'"}'}</span>else{<span class="cstat-no" title="statement not covered" >if(d.kty==="oct"){<span class="cstat-no" title="statement not covered" >if(typeof d.k!="string"){<span class="cstat-no" title="statement not covered" >throw"wrong k value for oct(symmetric) key"}<span class="cstat-no" title="statement not covered" ></span>a</span>+='"kty":"'+d.kty+'",';<span class="cstat-no" title="statement not covered" >a</span>+='"k":"'+d.k+'"}'}</span>}</span>}<span class="cstat-no" title="statement not covered" ></span>v</span>ar b=rstrtohex(a);<span class="cstat-no" title="statement not covered" >v</span>ar c=KJUR.crypto.Util.hashHex(b,"sha256");<span class="cstat-no" title="statement not covered" >v</span>ar e=hextob64u(c);<span class="cstat-no" title="statement not covered" >r</span>eturn e}</span>;KJUR.jws.IntDate={};KJUR.jws.IntDate.get=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>if(a=="now"){<span class="cstat-no" title="statement not covered" >return KJUR.jws.IntDate.getNow()}</span>else{<span class="cstat-no" title="statement not covered" >if(a=="now + 1hour"){<span class="cstat-no" title="statement not covered" >return KJUR.jws.IntDate.getNow()+60*60}</span>else{<span class="cstat-no" title="statement not covered" >if(a=="now + 1day"){<span class="cstat-no" title="statement not covered" >return KJUR.jws.IntDate.getNow()+60*60*24}</span>else{<span class="cstat-no" title="statement not covered" >if(a=="now + 1month"){<span class="cstat-no" title="statement not covered" >return KJUR.jws.IntDate.getNow()+60*60*24*30}</span>else{<span class="cstat-no" title="statement not covered" >if(a=="now + 1year"){<span class="cstat-no" title="statement not covered" >return KJUR.jws.IntDate.getNow()+60*60*24*365}</span>else{<span class="cstat-no" title="statement not covered" >if(a.match(/Z$/)){<span class="cstat-no" title="statement not covered" >return KJUR.jws.IntDate.getZulu(a)}</span>else{<span class="cstat-no" title="statement not covered" >if(a.match(/^[0-9]+$/)){<span class="cstat-no" title="statement not covered" >return parseInt(a)}</span>}</span>}</span>}</span>}</span>}</span>}<span class="cstat-no" title="statement not covered" ></span>t</span>hrow"unsupported format: "+a}</span>;KJUR.jws.IntDate.getZulu=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>return zulutosec(a)}</span>;KJUR.jws.IntDate.getNow=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var a=~~(new Date()/1000);<span class="cstat-no" title="statement not covered" >r</span>eturn a}</span>;KJUR.jws.IntDate.intDate2UTCString=<span class="fstat-no" title="function not covered" >function(a){<span class="cstat-no" title="statement not covered" ></span>var b=new Date(a*1000);<span class="cstat-no" title="statement not covered" >r</span>eturn b.toUTCString()}</span>;KJUR.jws.IntDate.intDate2Zulu=<span class="fstat-no" title="function not covered" >function(e){<span class="cstat-no" title="statement not covered" ></span>var i=new Date(e*1000);<span class="cstat-no" title="statement not covered" >v</span>ar h=("0000"+i.getUTCFullYear()).slice(-4);<span class="cstat-no" title="statement not covered" >v</span>ar g=("00"+(i.getUTCMonth()+1)).slice(-2);<span class="cstat-no" title="statement not covered" >v</span>ar b=("00"+i.getUTCDate()).slice(-2);<span class="cstat-no" title="statement not covered" >v</span>ar a=("00"+i.getUTCHours()).slice(-2);<span class="cstat-no" title="statement not covered" >v</span>ar c=("00"+i.getUTCMinutes()).slice(-2);<span class="cstat-no" title="statement not covered" >v</span>ar f=("00"+i.getUTCSeconds()).slice(-2);<span class="cstat-no" title="statement not covered" >r</span>eturn h+g+b+a+c+f+"Z"}</span>;
/*! jwsjs-2.1.0 (c) 2010-2016 Kenji Urushima | kjur.github.com/jsrsasign/license
 */
<span class="missing-if-branch" title="if path not taken" >I</span>if(typeof KJUR=="undefined"||!KJUR){<span class="cstat-no" title="statement not covered" >KJUR={}}<span class="missing-if-branch" title="if path not taken" >I</span></span>if(typeof KJUR.jws=="undefined"||!KJUR.jws){<span class="cstat-no" title="statement not covered" >KJUR.jws={}}</span>KJUR.jws.JWSJS=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>var b=KJUR.jws.JWS;<span class="cstat-no" title="statement not covered" >v</span>ar a=KJUR.jws.JWS;<span class="cstat-no" title="statement not covered" >t</span>his.aHeader=[];<span class="cstat-no" title="statement not covered" >t</span>his.sPayload="";<span class="cstat-no" title="statement not covered" >t</span>his.aSignature=[];<span class="cstat-no" title="statement not covered" >t</span>his.init=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>this.aHeader=[];<span class="cstat-no" title="statement not covered" >t</span>his.sPayload=undefined;<span class="cstat-no" title="statement not covered" >t</span>his.aSignature=[]}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.initWithJWS=<span class="fstat-no" title="function not covered" >function(d){<span class="cstat-no" title="statement not covered" ></span>this.init();<span class="cstat-no" title="statement not covered" >v</span>ar c=d.split(".");<span class="cstat-no" title="statement not covered" >i</span>f(c.length!=3){<span class="cstat-no" title="statement not covered" >throw"malformed input JWS"}<span class="cstat-no" title="statement not covered" ></span>t</span>his.aHeader.push(c[0]);<span class="cstat-no" title="statement not covered" >t</span>his.sPayload=c[1];<span class="cstat-no" title="statement not covered" >t</span>his.aSignature.push(c[2])}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.addSignature=<span class="fstat-no" title="function not covered" >function(c,f,k,i){<span class="cstat-no" title="statement not covered" ></span>if(this.sPayload===undefined||this.sPayload===null){<span class="cstat-no" title="statement not covered" >throw"there's no JSON-JS signature to add."}<span class="cstat-no" title="statement not covered" ></span>v</span>ar j=this.aHeader.length;<span class="cstat-no" title="statement not covered" >i</span>f(this.aHeader.length!=this.aSignature.length){<span class="cstat-no" title="statement not covered" >throw"aHeader.length != aSignature.length"}<span class="cstat-no" title="statement not covered" ></span>t</span>ry{<span class="cstat-no" title="statement not covered" >var d=KJUR.jws.JWS.sign(c,f,this.sPayload,k,i);<span class="cstat-no" title="statement not covered" >v</span>ar h=d.split(".");<span class="cstat-no" title="statement not covered" >v</span>ar l=h[0];<span class="cstat-no" title="statement not covered" >v</span>ar e=h[2];<span class="cstat-no" title="statement not covered" >t</span>his.aHeader.push(h[0]);<span class="cstat-no" title="statement not covered" >t</span>his.aSignature.push(h[2])}</span>catch(g){<span class="cstat-no" title="statement not covered" >if(this.aHeader.length&gt;j){<span class="cstat-no" title="statement not covered" >this.aHeader.pop()}<span class="cstat-no" title="statement not covered" ></span>i</span>f(this.aSignature.length&gt;j){<span class="cstat-no" title="statement not covered" >this.aSignature.pop()}<span class="cstat-no" title="statement not covered" ></span>t</span>hrow"addSignature failed: "+g}</span>}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.addSignatureByHeaderKey=<span class="fstat-no" title="function not covered" >function(f,c){<span class="cstat-no" title="statement not covered" ></span>var e=b64utoutf8(this.sPayload);<span class="cstat-no" title="statement not covered" >v</span>ar d=new KJUR.jws.JWS();<span class="cstat-no" title="statement not covered" >v</span>ar g=d.generateJWSByP1PrvKey(f,e,c);<span class="cstat-no" title="statement not covered" >t</span>his.aHeader.push(d.parsedJWS.headB64U);<span class="cstat-no" title="statement not covered" >t</span>his.aSignature.push(d.parsedJWS.sigvalB64U)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.addSignatureByHeaderPayloadKey=<span class="fstat-no" title="function not covered" >function(f,e,c){<span class="cstat-no" title="statement not covered" ></span>var d=new KJUR.jws.JWS();<span class="cstat-no" title="statement not covered" >v</span>ar g=d.generateJWSByP1PrvKey(f,e,c);<span class="cstat-no" title="statement not covered" >t</span>his.aHeader.push(d.parsedJWS.headB64U);<span class="cstat-no" title="statement not covered" >t</span>his.sPayload=d.parsedJWS.payloadB64U;<span class="cstat-no" title="statement not covered" >t</span>his.aSignature.push(d.parsedJWS.sigvalB64U)}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.verifyAll=<span class="fstat-no" title="function not covered" >function(f){<span class="cstat-no" title="statement not covered" ></span>if(this.aHeader.length!==f.length||this.aSignature.length!==f.length){<span class="cstat-no" title="statement not covered" >return false}<span class="cstat-no" title="statement not covered" ></span>f</span>or(var e=0;e&lt;f.length;e++){<span class="cstat-no" title="statement not covered" >var d=f[e];<span class="cstat-no" title="statement not covered" >i</span>f(d.length!==2){<span class="cstat-no" title="statement not covered" >return false}<span class="cstat-no" title="statement not covered" ></span>v</span>ar c=this.verifyNth(e,d[0],d[1]);<span class="cstat-no" title="statement not covered" >i</span>f(c===false){<span class="cstat-no" title="statement not covered" >return false}</span>}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn true}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.verifyNth=<span class="fstat-no" title="function not covered" >function(d,h,e){<span class="cstat-no" title="statement not covered" ></span>if(this.aHeader.length&lt;=d||this.aSignature.length&lt;=d){<span class="cstat-no" title="statement not covered" >return false}<span class="cstat-no" title="statement not covered" ></span>v</span>ar f=this.aHeader[d];<span class="cstat-no" title="statement not covered" >v</span>ar i=this.aSignature[d];<span class="cstat-no" title="statement not covered" >v</span>ar j=f+"."+this.sPayload+"."+i;<span class="cstat-no" title="statement not covered" >v</span>ar c=false;<span class="cstat-no" title="statement not covered" >t</span>ry{<span class="cstat-no" title="statement not covered" >c=a.verify(j,h,e)}</span>catch(g){<span class="cstat-no" title="statement not covered" >return false}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn c}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.verifyWithCerts=<span class="fstat-no" title="function not covered" >function(d){<span class="cstat-no" title="statement not covered" ></span>if(this.aHeader.length!=d.length){<span class="cstat-no" title="statement not covered" >throw"num headers does not match with num certs"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(this.aSignature.length!=d.length){<span class="cstat-no" title="statement not covered" >throw"num signatures does not match with num certs"}<span class="cstat-no" title="statement not covered" ></span>v</span>ar l=this.sPayload;<span class="cstat-no" title="statement not covered" >v</span>ar h="";<span class="cstat-no" title="statement not covered" >f</span>or(var e=0;e&lt;d.length;e++){<span class="cstat-no" title="statement not covered" >var f=d[e];<span class="cstat-no" title="statement not covered" >v</span>ar g=this.aHeader[e];<span class="cstat-no" title="statement not covered" >v</span>ar n=this.aSignature[e];<span class="cstat-no" title="statement not covered" >v</span>ar c=g+"."+l+"."+n;<span class="cstat-no" title="statement not covered" >v</span>ar k=new KJUR.jws.JWS();<span class="cstat-no" title="statement not covered" >t</span>ry{<span class="cstat-no" title="statement not covered" >var m=k.verifyJWSByPemX509Cert(c,f);<span class="cstat-no" title="statement not covered" >i</span>f(m!=1){<span class="cstat-no" title="statement not covered" >h+=(e+1)+"th signature unmatch. "}</span>}</span>catch(j){<span class="cstat-no" title="statement not covered" >h+=(e+1)+"th signature fail("+j+"). "}</span>}<span class="cstat-no" title="statement not covered" ></span>i</span>f(h==""){<span class="cstat-no" title="statement not covered" >return 1}</span>else{<span class="cstat-no" title="statement not covered" >throw h}</span>}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.readJWSJS=<span class="fstat-no" title="function not covered" >function(e){<span class="cstat-no" title="statement not covered" ></span>if(typeof e==="string"){<span class="cstat-no" title="statement not covered" >var d=b.readSafeJSONString(e);<span class="cstat-no" title="statement not covered" >i</span>f(d==null){<span class="cstat-no" title="statement not covered" >throw"argument is not safe JSON object string"}<span class="cstat-no" title="statement not covered" ></span>t</span>his.aHeader=d.headers;<span class="cstat-no" title="statement not covered" >t</span>his.sPayload=d.payload;<span class="cstat-no" title="statement not covered" >t</span>his.aSignature=d.signatures}</span>else{<span class="cstat-no" title="statement not covered" >try{<span class="cstat-no" title="statement not covered" >if(e.headers.length&gt;0){<span class="cstat-no" title="statement not covered" >this.aHeader=e.headers}</span>else{<span class="cstat-no" title="statement not covered" >throw"malformed header"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(typeof e.payload==="string"){<span class="cstat-no" title="statement not covered" >this.sPayload=e.payload}</span>else{<span class="cstat-no" title="statement not covered" >throw"malformed signatures"}<span class="cstat-no" title="statement not covered" ></span>i</span>f(e.signatures.length&gt;0){<span class="cstat-no" title="statement not covered" >this.signatures=e.signatures}</span>else{<span class="cstat-no" title="statement not covered" >throw"malformed signatures"}</span>}</span>catch(c){<span class="cstat-no" title="statement not covered" >throw"malformed JWS-JS JSON object: "+c}</span>}</span>}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.getJSON=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>return{headers:this.aHeader,payload:this.sPayload,signatures:this.aSignature}}</span>;<span class="cstat-no" title="statement not covered" >t</span>his.isEmpty=<span class="fstat-no" title="function not covered" >function(){<span class="cstat-no" title="statement not covered" ></span>if(this.aHeader.length==0){<span class="cstat-no" title="statement not covered" >return 1}<span class="cstat-no" title="statement not covered" ></span>r</span>eturn 0}</span>}</span>;
exports.SecureRandom = SecureRandom;
exports.rng_seed_time = rng_seed_time;
&nbsp;
exports.BigInteger = BigInteger;
exports.RSAKey = RSAKey;
exports.ECDSA = KJUR.crypto.ECDSA;
exports.DSA = KJUR.crypto.DSA;
exports.Signature = KJUR.crypto.Signature;
exports.MessageDigest = KJUR.crypto.MessageDigest;
exports.Mac = KJUR.crypto.Mac;
exports.Cipher = KJUR.crypto.Cipher;
exports.KEYUTIL = KEYUTIL;
exports.ASN1HEX = ASN1HEX;
exports.X509 = X509;
exports.CryptoJS = CryptoJS;
&nbsp;
// ext/base64.js
exports.b64tohex = b64tohex;
exports.b64toBA = b64toBA;
&nbsp;
// base64x.js
exports.stoBA = stoBA;
exports.BAtos = BAtos;
exports.BAtohex = BAtohex;
exports.stohex = stohex;
exports.stob64 = stob64;
exports.stob64u = stob64u;
exports.b64utos = b64utos;
exports.b64tob64u = b64tob64u;
exports.b64utob64 = b64utob64;
exports.hex2b64 = hex2b64;
exports.hextob64u = hextob64u;
exports.b64utohex = b64utohex;
exports.b64tohex = b64tohex;
exports.utf8tob64u = utf8tob64u;
exports.b64utoutf8 = b64utoutf8;
exports.utf8tob64 = utf8tob64;
exports.b64toutf8 = b64toutf8;
exports.utf8tohex = utf8tohex;
exports.hextoutf8 = hextoutf8;
exports.hextorstr = hextorstr;
exports.rstrtohex = rstrtohex;
exports.newline_toUnix = newline_toUnix;
exports.newline_toDos = newline_toDos;
exports.intarystrtohex = intarystrtohex;
exports.strdiffidx = strdiffidx;
exports.hextob64 = hextob64;
exports.hextob64nl = hextob64nl;
exports.b64nltohex = b64nltohex;
exports.hextoArrayBuffer = hextoArrayBuffer;
exports.ArrayBuffertohex = ArrayBuffertohex;
&nbsp;
// name spaces
exports.KJUR = KJUR;
exports.crypto = KJUR.crypto;
exports.asn1 = KJUR.asn1;
exports.jws = KJUR.jws;
exports.lang = KJUR.lang;
&nbsp;
&nbsp;
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Sun Apr 23 2017 05:29:03 GMT+0000 (UTC)</div>
</div>
</body>
</html>
